jQuery(function(c){var r={init:function(){c(document).on("change",".urcl-form-settings-logic-wrap .urcl-conditional-group .urcl-field-conditional-field-select",function(){r.replace_field_values(".urcl-conditional-group",this)}),c(document).on("change",".urcl-form-settings-logic-wrap .urcl-conditional-or-group .urcl-field-conditional-field-select",function(){r.replace_field_values(".urcl-conditional-or-group",this)}),e.add_settings()},ready:function(){e.ready(),c(document).on("click",".urcl-form-settings-logic-wrap .urcl-add-or-condition-btn",function(){r.add_or_condition_handler(c(this),"urcl-user-role-field")}),c(document).on("click",".urcl-conditional-group .add-btn, .urcl-or-groups .add-btn",r.and_condition_handler),c(document).on("click",".urcl-form-settings-logic-wrap .remove-btn",r.remove_logic_handler),c(document).on("click",".urcl-add-or-condition-btn, .add-btn, .remove-btn",r.hide_show_remove_btn),r.hide_show_remove_btn(),c(document.body).on("ur_field_option_changed",r.update_dropdown_value_on_change),c(document).on("change",".ur-options-list li",function(e){var t=c(".ur-selected-item.ur-item-active");r.update_dropdown_value_on_change(e,{action:"change",$wrapper:t})})},get_fields_list:function(){var n="";return c(".ur-grid-lists .ur-selected-item .ur-general-setting").each(function(){var e,t=c(this).closest(".ur-selected-item").find(" .ur-admin-template .ur-label label").clone().children().remove().end().text(),i=c(this).closest(".ur-selected-item").find(" .ur-admin-template .ur-field").data("field-key");["user_pass","user_confirm_password","section_title","html","wysiwyg","billing_address_title","shipping_address_title"].includes(i)||void 0!==(e=c(this).find("[data-field='field_name']").val())&&(n+='<option value="'+e+'" data-type="'+i+'">'+t+"</option>")}),n},add_or_condition_handler:function(e,t=""){var i=e.closest(".urcl-form-settings-logic-wrap").attr("data-group"),n='<p class="urcl-or-label"> '+("undefined"!=typeof urcl_redirection_params.or_text?urcl_redirection_params.or_text:"OR")+" </p>";n+='<ul class="urcl-form-settings-logic-box urcl-or-groups urcl-redirection-logic-box" data-group ="'+i+'" data-last-key="1">',n+='<li class="urcl-conditional-or-group" data-key="1">',n+='<div class="urcl-form-group">',n+='<select class="urcl-form-settings-field '+t+' urcl-field-conditional-field-select" name="user_registration_form_fields[condition_'+i+'][1]">',n+='<option value="">-- Select Field --</option>',n+=r.get_fields_list(),n+="</select></div>",n+='<div class="urcl-operator"><select class="urcl-form-settings-field '+t+'" name="user_registration_form_operator[condition_'+i+'][1]">',n+='<option value = "is" >is</option>',n+='<option value = "is_not" >is not</option>',n+='<option value = "empty"> empty </option>',n+='<option value = "not_empty"> not empty </option>',n+='<option value = "greater_than"> greater than </option>',n+='<option value = "less_than"> less_than </option>',n+="</select></div>",n+='<div class="urcl-value"><input class="urcl-form-settings-field '+t+'" name="user_registration_form_value[condition_'+i+'][1]" type="text" /></div>',n+='<span class="add add-btn">',n+="AND",n+="</span>",n+='<span class="remove remove-btn">',n+='<i class="dashicons dashicons-minus"></i>',n+="</span></li>",e.before(n+="</ul>")},and_condition_handler:function(){condition_id=c(this).closest(".urcl-form-settings-logic-box").attr("data-group");var e=c(this).closest(".urcl-form-settings-logic-box").attr("data-last-key");e++;var t=c(this).closest(".urcl-or-groups").length,i="urcl-conditional-group",i=r.get_single_condition_row_html(i=1===t?"urcl-conditional-or-group":i,e,condition_id);c(this).closest(".urcl-form-settings-logic-box").append(i),c(this).closest(".urcl-form-settings-logic-box").attr("data-last-key",e)},get_single_condition_row_html:function(e="",t="",i=""){return $output='<li class="'+e+'" data-key='+t+">",$output+='<div class="urcl-form-group">',$output+='<select class="urcl-form-settings-field urcl-user-role-field urcl-field-conditional-field-select" name="user_registration_form_fields['+i+"]["+t+']">',$output+='<option value="">-- Select Field --</option>',$output+=r.get_fields_list(),$output+="</select></div>",$output+='<div class="urcl-operator"><select class="urcl-form-settings-field urcl-user-role-field" name="user_registration_form_operator['+i+"]["+t+']">',$output+='<option value = "is" >is</option>',$output+='<option value = "is_not" >is not</option>',$output+='<option value = "empty"> empty </option>',$output+='<option value = "not_empty"> not empty </option>',$output+='<option value = "greater_than"> greater than </option>',$output+='<option value = "less_than"> less_than </option>',$output+="</select></div>",$output+='<div class="urcl-value"><input class="urcl-form-settings-field" name = "user_registration_form_value['+i+"]["+t+']" type="text" /></div>',$output+='<span class="add add-btn">',$output+="AND",$output+="</span>",$output+='<span class="remove remove-btn">',$output+='<i class="dashicons dashicons-minus"></i>',$output+="</span></li>",$output},remove_logic_handler:function(){var e,t;c(this).parent().hasClass("urcl-conditional-group")?1<c(this).closest(".urcl-form-settings-logic-wrap").find(".urcl-conditional-group").length?c(this).parent().remove():0<c(this).parent().parent().parent().find(".urcl-conditional-or-group").length&&(c(this).parent().parent().next(".urcl-or-label").remove(),c(this).parent().parent().remove()):c(this).parent().hasClass("urcl-conditional-or-group")&&(1==c(this).parent().parent().find(".urcl-conditional-or-group").length?0===c(this).parent().parent().parent().find(".urcl-conditional-group").length?(e=c(this).parent().parent().prev(".urcl-or-label").length,t=c(this).parent().parent().next(".urcl-or-label").length,0===e?0<t&&(c(this).parent().parent().next(".urcl-or-label").remove(),c(this).parent().parent().remove()):(c(this).parent().parent().prev(".urcl-or-label").remove(),c(this).parent().parent().remove())):(c(this).parent().parent().prev(".urcl-or-label").remove(),c(this).parent().parent().remove()):c(this).parent().remove())},hide_show_remove_btn:function(){var e=c(".urcl-form-settings-logic-wrap");c.each(e,function(e,t){t=c(t).find(".urcl-conditional-group, .urcl-conditional-or-group");1===t.length?t.first().find(".remove-btn").addClass("urcl-remove-btn-hidden").hide():1<t.length&&t.find(".urcl-remove-btn-hidden").removeClass("urcl-remove-btn-hidden").show()})},replace_field_values:function(e,t){var i,n,o,r=c("option:selected",t).attr("data-type"),l=c("option:selected",t).val(),a=c(t).closest(e).find(".urcl-value").children().first(),t=a.attr("name"),e=a.attr("class");"checkbox"==r||"radio"==r||"select"==r||"country"==r||"billing_country"==r||"shipping_country"==r||"select2"==r||"multi_select2"==r?("select"==r||"select2"==r||"multi_select2"==r?i=c('.ur-selected-inputs .ur-selected-item .ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-field option").map(function(){return c(this).val()}):"country"==r||"billing_country"==r||"shipping_country"==r?(c('.ur-selected-inputs .ur-selected-item .ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-field option").map(function(){return c(this).val()}),c('.ur-selected-inputs .ur-selected-item .ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-field option").map(function(){return c(this).text()})):i=c('.ur-selected-inputs .ur-selected-item .ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-field input").map(function(){return c(this).val()}),n="<option value>-- Select --</option>","country"==r||"billing_country"==r||"shipping_country"==r?(l=c('.ur-general-setting-field-name input[value="'+l+'"').closest(".ur-selected-item").find(".ur-advance-selected_countries select option:selected"),o=[],c(this).find(".urcl-value select").html('<option value="">--select--</option>'),l.each(function(){var e=c(this).val(),t=c(this).text();o.push('<option value="'+e+'">'+t+"</option>")}),n=o.join("")):1==i.length&&""===i[0]?n='<option value="1">'+urcl_data.checkbox_checked+"</option>":c(i).each(function(e,t){n=n+'<option value="'+t+'">'+t+"</option>"}),a.replaceWith('<select name="'+t+'" class="'+e+'">'+n+"</select>")):a.replaceWith('<input type="text" name="'+t+'" class="'+e+'">')},get_conditional_setting_data:function(e){var n=[],e=c(e);return c.each(e,function(){var e=[],i={},t=c(".urcl-form-settings-action-wrapper").find("select, input");c.each(t,function(){var e=c(this).attr("name"),t=c(this).val();i[e]=t});t=c(this).find(".urcl-form-settings-logic-box");c.each(t,function(){var i=[];c.each(c(this).find(".urcl-conditional-group, .urcl-conditional-or-group"),function(){var t=[],e=c(this).find(".urcl-form-settings-field");c.each(e,function(){var e={field_key:c(this).attr("name"),field_value:c(this).val()};t.push(e)}),i.push(t)}),e.push(i)}),n.push({actions:i,conditions:e})}),n},select_dropdown_value_on_load:function(){var e=c(document).find(".urcl-form-settings-logic-wrap.urcl-redirection-wrap").find(".urcl-form-group"),t=["check_box","radio","select","country","billing_country","shipping_country","select2","multi_select2"];c.each(e,function(e,n){var o=c(n).find("select");c.each(t,function(e,t){if(o.val().startsWith(t)){var i=c(n).parent().find(".urcl-value"),t=i.find("input").val();return o.change(),i.find("select").find('option[value="'+t+'"]').attr("selected","selected"),!1}})})},update_dropdown_value_on_change:function(e,t){var i=c(document).find(".urcl-form-settings-logic-wrap.urcl-redirection-wrap").find(".urcl-form-group"),n=r.get_active_field_name();c.each(i,function(e,t){var i=c(t).find("select");i.find(":selected").val()===n&&(t=i.closest(".urcl-conditional-group").find(".urcl-value select").find(":selected").val(),i.change(),i.closest(".urcl-conditional-group").find(".urcl-value select").find('option[value="'+t+'"]').attr("selected","selected"))})},get_active_field_name:function(){var e=!1,t=c(".ur-selected-item.ur-item-active");return!t.length||(t=t.find('[name="ur_general_setting[field_name]"]')).length&&(e=t.val()),e}},e={ready:function(){e.hide_show_settings(),e.hide_show_redirection_target_fields(),c("#user_registration_form_setting_enable_conditional_redirection").on("change",e.hide_show_settings),c(document).ready(function(){c(".urcl-redirection-field").on("change",e.hide_show_redirection_target_fields)}),c(document).on("user_registration_admin_before_form_submit",e.save_settings),r.select_dropdown_value_on_load()},add_settings:function(){var e=c("#user_registration_form_setting_enable_conditional_redirection").closest(".form-row"),t=c(urcl_redirection_params.templates.redirection_action),i=urcl_redirection_params.conditional_settings.redirection,o="";i.length?c.each(i,function(){var e=c(this)[0],i=e.actions,n=t.find(".urcl-form-settings-action-wrapper");c.each(i,function(e){var t=i[e],e=n.find("#"+e);void 0!==e&&("SELECT"===e.prop("tagName")?e.val(t).change():e.val(t))});e=e.conditions;c.each(e,function(e){e&&(o+='<p class="urcl-or-label">OR</p>');var t='<ul class="urcl-form-settings-logic-box" data-group="condition_1" data-last-key="1">';c.each(this,function(e){var n=c(r.get_single_condition_row_html("urcl-conditional-group",e+1,"condition_1"));c.each(this,function(e,t){var i=n.find('[name="'+t.field_key+'"]');void 0!==i&&("SELECT"===i.prop("tagName")?i.find('option[value="'+t.field_value+'"]').attr("selected","selected").change():i.attr("value",t.field_value))}),t+=n.prop("outerHTML")}),o+=t+="</ul>"})}):(o='<ul class="urcl-form-settings-logic-box" data-group="condition_1" data-last-key="1">',i=c(r.get_single_condition_row_html("urcl-conditional-group",1,"condition_1")),o+=i.prop("outerHTML"),o+="</ul>"),t.find(".urcl-redirection-wrap .urcl-form-settings-action-wrapper").after(c(o)),e.after(t)},hide_show_settings:function(){var e=c(".urcl-redirection-wrap").parent();c("#user_registration_form_setting_enable_conditional_redirection").is(":checked")?e.slideDown(500):e.slideUp(500)},hide_show_redirection_target_fields:function(){var e=c(".urcl-redirection-field");c("#urcl-redirection-custom-page").hide(500),c("#urcl-redirection-external-url").hide(500),"custom_page"===e.val()?c("#urcl-redirection-custom-page").show(500):"external_url"===e.val()&&c("#urcl-redirection-external-url").show(500)},save_settings:function(e,t){var i=r.get_conditional_setting_data(".urcl-redirection-wrap");t.data.conditional_redirection_settings=i}};r.init(),c(document).ready(r.ready)});