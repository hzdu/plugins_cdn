document.addEventListener("DOMContentLoaded",()=>{tpsocialFeed(document)});function tpsocialFeed(a){let b=a.querySelectorAll(".tpgb-social-feed");b&&b.forEach(b=>{function c(a){var d=a.target;if(d.classList.contains("readbtn")&&d.closest(".tpgb-social-feed")){let a=d.closest(".tpgb-social-feed"),c=d.getAttribute("aria-label");var e=d.closest(".tpgb-message"),g=e.closest(".tpgb-isotope .post-loop-inner"),h=f,i=e.querySelector(".showtext");if(e.classList.contains("show-text"))e.classList.remove("show-text","show-less"),d.innerHTML=c,e.querySelector(".sf-dots").style.display="inline",!0===h.ScrollOn&&!0===h.TextLimit&&(i.classList.remove(h.className),i.removeAttribute("style"));else{e.classList.add("show-text","show-less"),d.innerHTML="Show Less",e.querySelector(".sf-dots").style.display="none";var j=b.querySelectorAll(".showtext");!0===h.ScrollOn&&!0===h.TextLimit&&j&&j.forEach(function(a){a.clientHeight>=h.Height&&(i.classList.add(h.className),i.style.height=h.Height+"px")})}if(g){var k=new Isotope(g,{itemSelector:".grid-item",resizable:!0,sortBy:"original-order"});k.layout()}}if(d.classList.contains("readbtn")&&d.closest(".fancybox-si")){let a=d.closest(".tpgb-message"),b=f,c=d.closest(".tpgb-message");a.classList.contains("show-text")?(a.classList.remove("show-text","show-less"),d.innerHTML="Show More",a.querySelector(".sf-dots").style.display="inline","true"===b.FancyScroll&&"true"===b.TextLimit&&(c.classList.remove(b.Fancyclass),c.removeAttribute("style"))):(a.classList.add("show-text","show-less"),d.innerHTML="Show Less",a.querySelector(".sf-dots").style.display="none","true"===b.FancyScroll&&"true"===b.TextLimit&&Array.from(c).forEach(function(a){a.clientHeight>=b.FancyHeight&&(a.classList.add(b.Fancyclass),a.style.height=b.FancyHeight+"px")}))}this.removeEventListener("click",a=>{c(a)})}let d=b.getAttribute("data-id"),e=b.getAttribute("data-fancy-option")?JSON.parse(b.getAttribute("data-fancy-option")):"",f=b.getAttribute("data-scroll-normal")?JSON.parse(b.getAttribute("data-scroll-normal")):"",g={Carousel:{infinite:e.loop,transition:e.transitionEffect},Toolbar:{display:{right:e.button}},contentClick:e.clickContent};e.arrows||(g.Carousel.Navigation=!1),g.Thumbs=!1,Fancybox.bind("[data-fancybox=\""+d+"\"]",g);let h=b.querySelectorAll(".grid-item.feed-Facebook");if(h&&h.forEach(a=>{let b=a.getAttribute("data-index");Fancybox.bind("[data-fancybox=\"album-"+b+"-"+d+"\"]",g)}),f&&!0===f.ScrollOn&&!1===f.TextLimit){let a=b.querySelectorAll(".tpgb-message");a&&a.forEach(function(a){a.clientHeight>=f.Height&&(a.classList.add(f.className),a.style.height=f.Height+"px")})}if(!0===f.FancyScroll&&!1===f.TextLimit){let a=b.querySelectorAll(".fancybox-si .tpgb-message");a.forEach(function(a){a.classList.add(f.Fancyclass),a.style.height=f.FancyHeight+"px"})}document.addEventListener("click",function(a){c(a)});let i=b.querySelector(".feed-load-more");i&&i.addEventListener("click",function(c){c.preventDefault();let d=i.getAttribute("data-loadattr"),e=i.getAttribute("data-display"),f=i.getAttribute("data-loadview"),g=i.getAttribute("data-loadclass"),h=i.getAttribute("data-layout"),j=i.getAttribute("data-loadingtxt"),k=i.textContent,l=c.currentTarget.closest(".tpgb-block-"+g);i.dataset.requestRunning&&"true"==i.dataset.requestRunning||(i.dataset.requestRunning="true",i.textContent=j,fetch(tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=tpgb_feed_load&view="+e+"&loadFview="+f+"&loadattr="+d}).then(function(a){return a.json()}).then(function(c){var d=c&&c.HTMLContent?c.HTMLContent:"",g=c&&c.totalFeed?c.totalFeed:"",j=c&&c.FilterStyle?c.FilterStyle:"",m=c&&c.allposttext?c.allposttext:"";if(""==c)i.classList.add("hide");else{var n=l.querySelector(".all .tpgb-category-count"),o=l.querySelector(".post-loop-inner");o.insertAdjacentHTML("beforeend",d);var p=l.querySelectorAll(".grid-item").length;if(n&&(n.innerHTML="",n.insertAdjacentHTML("beforeend",p)),"style-2"==j||"style-3"==j){var q=b.querySelectorAll(".tpgb-filter-list .tpgb-category-list:not(.all)");q&&q.forEach(function(a){var b=a.querySelector("span:nth-child(2)").dataset.hover,c=l.querySelectorAll(".grid-item."+b).length;a.querySelector("span:nth-child(1).tpgb-category-count").innerHTML="",a.querySelector("span:nth-child(1).tpgb-category-count").insertAdjacentHTML("beforeend",c)})}("grid"==h||"masonry"==h)&&b.classList.contains("tpgb-isotope")&&"function"==typeof tppoMaso&&tppoMaso(a),p>=g?(i.classList.add("hide"),i.parentNode.insertAdjacentHTML("beforeend","<div class=\"tpgb-feed-loaded\">"+m+"</div>")):i.textContent=k}e=+e+ +f,i.setAttribute("data-display",e)}).finally(function(){if(i.dataset.requestRunning="false",("grid"==h||"masonry"==h)&&"function"==typeof tppoMaso&&b.classList.contains("tpgb-isotope")&&tppoMaso(a),l.classList.contains("tpgb-isotope")&&("grid"==h||"masonry"==h)){var c=l.querySelectorAll(".tpgb-carousel:not(.is-initialized)");c.forEach(function(a){"function"==typeof splide_init&&splide_init(a)})}}))});let j=b.querySelector(".tpgb-feed-lazy-load");if(j&&b.classList.contains("tpgb-isotope")){var k,l,m,n,o,p,q=window,r=function(){k=q.innerWidth,l=q.innerHeight,m=document.querySelector("body").offsetHeight,o=b.offsetHeight,p=b.offsetTop+50,setTimeout(function(){o=b.offsetHeight,p=b.offsetTop+50},50)};r(),q.addEventListener("resize",r),q.addEventListener("scroll",function(c){if(c.preventDefault(),r(),n=q.pageYOffset,o=b.offsetHeight,p=b.offsetTop+50,b.querySelector(".tpgb-feed-lazy-load")&&n<m&&n+60>o+p-l){let b=j.querySelector(".feed-lazy-load"),c=b.dataset.lazyattr,d=b.dataset.totalfeed,e=b.getAttribute("data-display"),f=b.dataset.lazyview,g=b.dataset.lazyclass,h=b.dataset.lazylayout,i=b.innerHTML,k=b.closest(".tpgb-block-"+g);if(b.dataset.requestRunning&&"true"==b.dataset.requestRunning)return;b.dataset.requestRunning="true",+d>=+e&&fetch(tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=tpgb_feed_load&view="+e+"&loadFview="+f+"&loadattr="+c}).then(function(a){return a.json()}).then(function(c){var d=c&&c.HTMLContent?c.HTMLContent:"",g=c&&c.totalFeed?c.totalFeed:"",j=c&&c.FilterStyle?c.FilterStyle:"",l=c&&c.allposttext?c.allposttext:"";if(""===c)b.classList.add("hide");else{var m=k.querySelector(".all .tpgb-category-count"),n=k.querySelector(".post-loop-inner");n.insertAdjacentHTML("beforeend",d);var o=k.querySelectorAll(".grid-item").length;if(m&&(m.innerHTML="",m.appendChild(document.createTextNode(o))),"style-2"===j||"style-3"===j){var p=k.querySelectorAll(".tpgb-filter-list .tpgb-category-list:not(.all)");p&&p.forEach(function(a){var b=a.querySelector("span:nth-child(2)").dataset.hover,c=k.querySelectorAll(".grid-item."+b).length;a.querySelector("span:nth-child(1).tpgb-category-count").innerHTML="",a.querySelector("span:nth-child(1).tpgb-category-count").appendChild(document.createTextNode(c))})}if(("grid"===h||"masonry"===h)&&"function"==typeof tppoMaso&&k.classList.contains("tpgb-isotope")&&tppoMaso(a),!(o>=+g))b.innerHTML=i;else if(!b.nextElementSibling||!b.nextElementSibling.classList.contains("tpgb-feed-loaded")){b.classList.add("hide");var q=document.createElement("div");q.classList.add("tpgb-feed-loaded"),q.innerHTML=l,b.parentNode.appendChild(q)}}e=+e+ +f,b.setAttribute("data-display",e)}).finally(function(){b.dataset.requestRunning="false"}).then(function(){if(k.classList.contains("tpgb-isotope")){("grid"===h||"masonry"===h)&&"function"==typeof tppoMaso&&tppoMaso(a);var b=k.querySelectorAll(".tpgb-carousel:not(.is-initialized)");b.forEach(function(a){"function"==typeof splide_init&&splide_init(a)})}})}})}})}