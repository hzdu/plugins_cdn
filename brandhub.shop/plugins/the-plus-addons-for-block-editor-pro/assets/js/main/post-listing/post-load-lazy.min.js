var loading=!1;document.addEventListener("DOMContentLoaded",function(){var t=document.querySelectorAll(".tpgb-lazy-load");t&&t.forEach(function(t){var e=t.closest(".tpgb-isotope"),t=t.closest(".tpgb-metro"),t=e||t;t.offsetHeight&&lazyInit(t)})});var windowWidth,windowHeight,documentHeight,scrollTop,containerHeight,containerOffset,tpagblazystore="",recalcValues=function(){windowWidth=window.innerWidth,windowHeight=window.innerHeight,documentHeight=document.body.clientHeight};function lazyInit(t){var e=(tpagblazystore=t).closest(".tpgb-tab-content"),o=t.closest(".tpgb-tab-content")&&t.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content")?t.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content"):"";o&&o.length&&!o.classList.contains("active")||((t=t.closest(".tpgb-tab-content")?t.closest(".tpgb-tab-content").parentNode.closest(".tpgb-tab-content"):"")&&t.length&&!t.classList.contains("active")||e&&!e.classList.contains("active")||(window.addEventListener("resize",recalcValues),window.removeEventListener("scroll",tpgblazycall),window.addEventListener("scroll",tpgblazycall)))}function tpgblazycall(t){t.preventDefault(),recalcValues(),scrollTop=window.scrollY;var e=tpagblazystore.offsetHeight,t=tpagblazystore.offsetTop+50;scrollTop<documentHeight&&e+t-windowHeight<scrollTop&&!loading&&(loading=!0,tpgb_lazy_load_ajax(tpagblazystore))}function tpgb_lazy_load_ajax(t=""){var s,i=t.querySelector(".post-lazy-load"),r=JSON.parse(i.dataset.dypost),t=i.dataset.postOption;null!=r.offset_posts&&""!=r.offset_posts||(r.offset_posts=0),r.total_page>=r.page?(r.offset=parseInt(r.page-1)*parseInt(r.load_more)+parseInt(r.display_post)+parseInt(r.offset_posts),(s=new XMLHttpRequest).open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),s.onload=function(){if(200===s.status&&s.status<400){var t=s.responseText;if(""===t)i.classList.add("hide");else{var e,o,n=document.getElementById(r.load_class),a=n.querySelector(".post-loop-inner");if("grid"!==r.layout&&"masonry"!==r.layout||n.classList.contains("tpgb-isotope")&&(e=new Isotope(a,{itemSelector:".grid-item",resizable:!0,sortBy:"original-order",layoutMode:"masonry"==r.layout?"masonry":"fitRows",transitionDuration:r.disableAnim?0:"0.4s"}),(o=document.createElement("div")).innerHTML=t,e.insert(o.querySelectorAll(".grid-item")),e.layout(),e.reloadItems()),n.classList.contains("tpgb-metro")&&(a.insertAdjacentHTML("beforeend",t),"function"==typeof tppoMetro&&tppoMetro(document)),"function"==typeof tppostList&&tppostList(document),0<n.querySelectorAll(".tpgb-category-filter").length&&(n.querySelectorAll(" .tpgb-filter-data .tpgb-categories > .tpgb-filter-list > a").forEach(function(t){var e=t.dataset.filter,o=0;void 0!==e&&""!==e&&(o=("*"===e?n.querySelectorAll(".post-loop-inner .grid-item"):n.querySelectorAll(" .post-loop-inner .grid-item"+e)).length),0<o&&null!=t.querySelector(".tpgb-category-count")&&(t.querySelector(".tpgb-category-count").innerHTML=o)}),"function"==typeof tpFilter&&tpFilter(n)),n.classList.contains("tpgb-equal-height")&&"function"==typeof tpeqHeight&&(l=document.getElementById(r.load_class),tpeqHeight(l)),0<n.querySelectorAll(".tpgb-messagebox").length&&"function"==typeof tpmsgBox&&tpmsgBox(n),0<n.querySelectorAll(".tpgb-fancy-popup").length){let t=n.querySelectorAll(".tpgb-fancy-popup");t.forEach(function(t){tpgb_fancy_popup(t)})}0<n.querySelectorAll(".tpgb-accordion").length&&"function"==typeof accordionJS&&accordionJS(n),0<n.querySelectorAll(".tpgb-heading-animation").length&&"function"==typeof tpheAnim&&tpheAnim(n)}r.page++,r.page===r.total_page?(i.classList.add("hide"),r.page=r.page,i.parentNode.insertAdjacentHTML("beforeend",'<div class="tpgb-post-loaded">'+r.loaded_posts+"</div>")):(r.page=r.page,i.setAttribute("data-page",r.page));var l=JSON.stringify(r);i.dataset.dypost=l}loading=!1},s.send("action=tpgb_post_load&option="+encodeURIComponent(t)+"&dyOpt="+encodeURIComponent(JSON.stringify(r)))):i.classList.add("hide")}