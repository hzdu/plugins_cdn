class CircleMenu{constructor(a,b){this._timeouts=[],this.element=a,this.options=Object.assign({},CircleMenu.defaults,b),this._name="circleMenu",this._state="closed",this.init(),this.hook()}static get defaults(){return{depth:0,item_diameter:30,circle_radius:80,angle:{start:0,end:90},speed:500,delay:1e3,step_out:20,step_in:-20,trigger:"hover",transition_function:"ease"}}init(){const a={"bottom-left":[180,90],bottom:[135,45],right:[-45,45],left:[225,135],top:[225,315],"bottom-half":[180,0],"right-half":[-90,90],"left-half":[270,90],"top-half":[180,360],"top-left":[270,180],"top-right":[270,360],full:[-90,270-Math.floor(360/(this.element.children.length-1))],"bottom-right":[0,90]};if(this.element.classList.add(this._name+"-closed"),"string"==typeof this.options.direction){const b=a[this.options.direction.toLowerCase()];b&&(this.options.angle.start=b[0],this.options.angle.end=b[1])}this.menu_items=Array.from(this.element.children).filter(a=>"LI"===a.tagName&&!a.isEqualNode(this.element.firstElementChild)),this.initCss(),this.item_count=this.menu_items.length,this._step=(this.options.angle.end-this.options.angle.start)/(this.item_count-1),this.menu_items.forEach((a,b)=>{const c=(this.options.angle.start+this._step*b)*(Math.PI/180),d=Math.round(this.options.circle_radius*Math.cos(c)),e=Math.round(this.options.circle_radius*Math.sin(c));a.dataset.posX=d,a.dataset.posY=e,a.addEventListener("click",()=>{this.select(b+2)})}),["open","close","init","select"].forEach(a=>{const b=this.options[a];b&&(this.element.addEventListener(this._name+"-"+a,b.bind(this)),delete this.options[a])}),this.submenus=this.menu_items.map(a=>a.querySelector("ul")),this.submenus.forEach(a=>{a&&new CircleMenu(a,Object.assign({},this.options,{depth:this.options.depth+1}))}),this.trigger("init")}trigger(a,...b){const c=new CustomEvent(a,{detail:b});this.element.dispatchEvent(c)}hook(){"hover"===this.options.trigger?(this.element.addEventListener("mouseenter",()=>{this.open()}),this.element.addEventListener("mouseleave",()=>{this.close()})):"click"===this.options.trigger&&this.element.firstElementChild.addEventListener("click",a=>(a.preventDefault(),"closed"===this._state||"closing"===this._state?this.open():this.close(!0),!1))}open(){let a;return(this.clearTimeouts(),"open"===this._state)?this:(this.element.classList.add(this._name+"-open"),this.element.classList.remove(this._name+"-closed"),a=0<=this.options.step_out?this.menu_items:this.menu_items.slice().reverse(),a.forEach((a,b)=>{this._timeouts.push(setTimeout(()=>{a.style.left=a.dataset.posX+"px",a.style.top=a.dataset.posY+"px",vendorPrefixes(a,"transform","scale(1)")},0+Math.abs(this.options.step_out)*b))}),this._timeouts.push(setTimeout(()=>{"opening"===this._state&&this.trigger("open"),this._state="open"},0+Math.abs(this.options.step_out)*a.length)),this._state="opening",this)}close(a){const b=()=>{let a;return(this.submenus.forEach(a=>{a&&a.close()}),this.clearTimeouts(),"closed"===this._state)?this:(a=0<=this.options.step_in?this.menu_items:this.menu_items.slice().reverse(),a.forEach((a,b)=>{this._timeouts.push(setTimeout(()=>{a.style.top=0,a.style.left=0,vendorPrefixes(a,"transform","scale(.5)")},0+Math.abs(this.options.step_in)*b))}),this._timeouts.push(setTimeout(()=>{"closing"===this._state&&this.trigger("close"),this._state="closed"},0+Math.abs(this.options.step_in)*a.length)),this.element.classList.remove(this._name+"-open"),this.element.classList.add(this._name+"-closed"),this._state="closing",this)};return a?b():this._timeouts.push(setTimeout(b,this.options.delay)),this}select(a){let b,c;("open"===this._state||"opening"===this._state)&&(this.clearTimeouts(),c=this.element.querySelectorAll("li:not(:nth-child("+a+"),:first-child)"),b=this.element.querySelector("li:nth-child("+a+")"),this.trigger("select",b),[b,...c].forEach(a=>{a.style.transition="all 500ms ease-out",a.style.transform=a===b?"scale(2)":"scale(0)",a.style.opacity="0"}),this.element.classList.remove(this._name+"-open"),setTimeout(()=>this.initCss(),500))}clearTimeouts(){for(let a;a=this._timeouts.shift();)clearTimeout(a)}initCss(){this._state="closed",this.element.classList.remove(this._name+"-open"),this.element.style.listStyle="none",this.element.style.margin=0,this.element.style.padding=0,this.element.style.width=this.options.item_diameter+"px",this.menu_items.forEach(a=>{a.style.display="block",a.style.width=this.options.item_diameter+"px",a.style.height=this.options.item_diameter+"px",a.style.textAlign="center",a.style.lineHeight=this.options.item_diameter+"px",a.style.position="absolute",a.style.zIndex=1,a.style.opacity=""}),this.element.firstElementChild.style.zIndex=1e3-this.options.depth,this.menu_items.forEach(a=>{a.style.top=0,a.style.left=0,vendorPrefixes(a,"borderRadius",this.options.item_diameter+"px"),vendorPrefixes(a,"transform","scale(.5)")}),setTimeout(()=>{this.menu_items.forEach(a=>{a.style.transition="all "+this.options.speed+"ms "+this.options.transition_function})},0)}}function vendorPrefixes(a,b,c){["-webkit-","-moz-","-o-","-ms-",""].forEach(d=>{a.style[d+b]=c})}