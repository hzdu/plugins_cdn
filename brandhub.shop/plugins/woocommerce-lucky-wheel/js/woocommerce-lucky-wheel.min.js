!function(e){"use strict";if("undefined"==typeof _wlwl_get_email_params||!_wlwl_get_email_params?.coupon_type)return;let l,t,i,o,w=_wlwl_get_email_params,n=window.innerWidth,a=window.innerHeight,r=n<760,s=w?.wlwl_mobile_enable;if(r&&!s)return;let _=w.coupon_type.length,c=360/_,h=-c/2;function d(t,i,o){let n=e("#wlwl_canvas"),a=e("#wlwl_canvas2"),r="";window.devicePixelRatio&&(r="width:"+l+"px;height:"+l+"px;"),n.attr("style",r),a.attr("style",r);let s=360-c*t,_=w.spinning_time,h=360*w.wheel_speed*_+s,d=r+"-moz-transform: rotate("+h+"deg);-webkit-transform: rotate("+h+"deg);-o-transform: rotate("+h+"deg);-ms-transform: rotate("+h+"deg);transform: rotate("+h+"deg);";d+="-webkit-transition: transform "+_+"s ease;-moz-transition: transform "+_+"s ease;-ms-transition: transform "+_+"s ease;-o-transition: transform "+_+"s ease;transition: transform "+_+"s ease;",n.attr("style",d),a.attr("style",d),setTimeout((function(){d=r+"transform: rotate("+s+"deg);",n.attr("style",d),a.attr("style",d),e(".wlwl_lucky_wheel_content").addClass("wlwl-finish-spinning"),e(".wlwl-overlay").off().on("click",(function(){e("html").removeClass("wlwl-html"),e(this).hide(),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show"),e(".wlwl_wheel_spin").css({"margin-left":"0",transition:"2s"})})),"win"===o&&"firework"===w.congratulations_effect&&e(".wlwl-congratulations-effect").addClass("wlwl-congratulations-effect-firework"),e(".wlwl_user_lucky").html('<div class="wlwl-frontend-result">'+i+"</div>").fadeIn(300);let l=parseInt(w.auto_close);l>0&&setTimeout((function(){e(".wlwl-overlay").trigger("click")}),1e3*l)}),parseInt(1e3*_))}function m(e,l,t){let i=new Date;i.setTime(i.getTime()+1e3*t);let o="expires="+i.toUTCString();document.cookie=e+"="+l+";"+o+";path=/"}async function p(i=!1){t=l/2,await u("wlwl_canvas"),await u("wlwl_canvas1"),await u("wlwl_canvas2"),i&&e(".woocommerce-lucky-wheel-popup-icon").trigger("click")}async function u(n){var a;if(n&&(i=document.getElementById(n),i))switch(o=i.getContext("2d"),i.width=l,i.height=l,window.devicePixelRatio&&(e(i).attr({width:l*window.devicePixelRatio,height:l*window.devicePixelRatio}),e(i).css({width:l,height:l}),o.scale(window.devicePixelRatio,window.devicePixelRatio)),n){case"wlwl_canvas":for(let e=0;e<_;e++)y(h,w.bg_color[e]),g(h+c/2,w.label[e],w.slices_text_color[e]||w.slice_text_color),h+=c;break;case"wlwl_canvas1":a=w.wheel_center_color,o.save(),o.beginPath(),o.fillStyle=a,o.shadowBlur=1,o.shadowOffsetX=8,o.shadowOffsetY=8,o.shadowColor="rgba(0,0,0,0.2)",o.arc(t,t,l/8,0,2*Math.PI),o.fill(),o.clip(),o.restore(),l<=480?f(w.wheel_border_color,"rgba(0,0,0,0)",20,4,5,"rgba(0,0,0,0.2)"):f(w.wheel_border_color,"rgba(0,0,0,0)",30,6,7,"rgba(0,0,0,0.2)");break;case"wlwl_canvas2":l<=480?f("rgba(0,0,0,0)",w.wheel_dot_color,20,4,5,"rgba(0,0,0,0)"):f("rgba(0,0,0,0)",w.wheel_dot_color,30,6,7,"rgba(0,0,0,0)")}}function f(e,l,i,w,n,a=""){let r,s,h;o.beginPath(),o.strokeStyle=e,o.lineWidth=i,a&&(o.shadowBlur=1,o.shadowOffsetX=8,o.shadowOffsetY=8,o.shadowColor=a),o.arc(t,t,t,0,2*Math.PI),o.stroke(),h=c/2;let d=t-n;for(let e=0;e<_;e++)o.beginPath(),o.fillStyle=l,r=t+d*Math.cos(h*Math.PI/180),s=t-d*Math.sin(h*Math.PI/180),o.arc(r,s,w,0,2*Math.PI),o.fill(),h+=c}function g(e,i,n){let a="Helvetica",r=parseInt(l/28)*parseInt(w.font_size||100)/100;void 0!==w.font_text_wheel&&""!==w.font_text_wheel&&(a=w.font_text_wheel),o.save(),o.translate(t,t),o.rotate(k(e)),o.textAlign="right",o.fillStyle=n,o.font="200 "+r+"px "+a,o.shadowOffsetX=0,o.shadowOffsetY=0;let s=(i=(i=i.replace(/&#(\d{1,4});/g,(function(e,l){return String.fromCharCode(l)}))).replace(/&nbsp;/g," ")).split("/n"),_="",c="";if(s.length>1?(_=s[0],c=s.splice(1,s.length-1),c=c.join("")):(s=i.split("\\n"),s.length>1&&(_=s[0],c=s.splice(1,s.length-1),c=c.join(""))),""!==_.trim()&&""!==c.trim())o.fillText(_.trim(),7*t/8,-1*r/4),o.fillText(c.trim(),7*t/8,3*r/4);else{i=i.replace(/\\n/g,"").replace(/\/n/g,"");let e=function(e,l,t,i,o,w){let n=l.split(" "),a=n.length,r="",s="",_=[],c=[];for(let l in n){s+=`${n[l]} `,e.measureText(s).width>o&&l>0?(_.push({text:r,x:t,y:i}),r=`${n[l]} `,s=`${n[l]} `):r+=`${n[l]} `,l==a-1&&_.push({text:r,x:t,y:i})}let h=i/2-2,d=_.length;d>4?h=-i:d>2?h=-1*i/2:d>1&&(h=-1*i/4);for(let e in _){let l=_[e];e>0&&(h+=w),l.y=h,c.push(l)}return c}(o,i,7*t/8,r,l<=480?l/3-10:l/3-14,r);for(let l of e)o.fillText(l.text,l.x,l.y)}o.restore()}function y(e,i){o.beginPath(),o.fillStyle=i,o.moveTo(t,t);let w=t;32!==t&&(w=l<=480?l/2-10:l/2-14),o.arc(t,t,w,k(e),k(e+c)),o.lineTo(t,t),o.fill()}function k(e){return e*Math.PI/180}function v(){if(e(".wlwl_lucky_wheel_content.wlwl-background-effect-falling-leaves:not(.wlwl_lucky_wheel_content_init)").length){let e=document.querySelector(".wlwl_lucky_wheel_content.wlwl-background-effect-falling-leaves"),l=new b(e);l.init(),l.render()}e(".wlwl_wheel_spin").css({width:l+"px",height:l+"px"}),e(".wlwl_lucky_wheel_content").removeClass("wlwl_lucky_wheel_content_mobile lucky_wheel_content_tablet"),r?e(".wlwl_lucky_wheel_content").addClass("wlwl_lucky_wheel_content_mobile"):("on"===w.show_full_wheel?e(".wlwl_lucky_wheel_content").css({"max-width":l+600+"px"}):e(".wlwl_lucky_wheel_content").css({"max-width":.6*l+600+"px"}),n<1024&&e(".wlwl_lucky_wheel_content").addClass("lucky_wheel_content_tablet")),r&&!w.custom_field_name_enable_mobile?e(".wlwl_field_name_wrap").hide():e(".wlwl_field_name_wrap").show(),r&&!w.custom_field_mobile_enable_mobile?e(".wlwl_field_mobile_wrap").hide():e(".wlwl_field_mobile_wrap").show();let i=".wlwl_lucky_wheel_content:not(.wlwl_lucky_wheel_content_mobile) .wheel-content-wrapper .wheel_content_left{min-width:"+(l+35)+"px}";if(i+=".wlwl_lucky_wheel_content.wlwl_lucky_wheel_content_mobile .wheel_description{min-height:"+e(".wheel_description").css("height")+"}","center"===w.pointer_position?i+=".wlwl_pointer:before{font-size:"+parseInt(l/4)+"px !important; }":(i+=".wlwl_pointer:before{font-size:"+parseInt(l/10)+"px !important; }",i+=".wlwl_margin_position .wlwl_wheel_spin_container .wlwl_pointer_content .wlwl_pointer:after{width:"+parseInt(l/25)+"px;height:"+parseInt(l/25)+"px;bottom:"+parseInt(l/30)+"px; }"),e("#wlwl_lucky_wheel_custom_inline_css").length||e("head").append('<style id="wlwl_lucky_wheel_custom_inline_css"></style>'),e("#wlwl_lucky_wheel_custom_inline_css").html(i),e("#wlwl_center_image").val()){let i=new Image;i.onload=function(){let e=document.getElementById("wlwl_canvas1").getContext("2d"),o=2*(l/8-7);e.arc(t,t,o/2,0,2*Math.PI),e.clip(),e.drawImage(i,t-o/2,t-o/2,o,o)},i.src=e("#wlwl_center_image").val()}}e(window).on("resize",(function(){n=window.innerWidth,a=window.innerHeight,r=n<760,s||!r?e(document.body).trigger("wlwl-render-popup-wheel"):e(".wlwl_lucky_wheel_wrap").removeClass("wlwl_lucky_wheel_active")})),e(window).on("load",(function(){"on"==w.wlwl_recaptcha&&w.wlwl_recaptcha_site_key?2==w.wlwl_recaptcha_version?I():(C(),e(".wlwl-recaptcha-field").hide()):e(".wlwl-recaptcha-field").hide()})),e(document).ready((function(e){setTimeout((function(){e(document.body).trigger("wlwl-render-popup-wheel")}),100),e(document.body).on("wlwl-render-popup-wheel",(function(){if(!x("wlwl_cookie"))if(e(".wlwl_lucky_wheel_wrap").addClass("wlwl_lucky_wheel_active"),l=n>a?a:n,l=r?parseInt(.6*l+16):parseInt((w.wheel_size||100)*(.55*l+16)/100),v(),e(".wlwl_lucky_wheel_content_rendered").length)p();else switch(function(){if(i=document.getElementById("wlwl_popup_canvas"),!i)return;o=i.getContext("2d"),t=32;for(let e=0;e<_;e++)y(h,w.bg_color[e]),h+=c;e=w.wheel_center_color,o.save(),o.beginPath(),o.fillStyle=e,o.arc(t,t,8,0,2*Math.PI),o.fill(),o.restore(),f(w.wheel_border_color,w.wheel_dot_color,4,1,0);var e}(),w.intent){case"popup_icon":setTimeout((function(){e(".wlwl_wheel_icon").addClass("wlwl_show")}),1e3*w.show_wheel);break;case"show_wheel":setTimeout((function(){e(".wlwl_wheel_icon").trigger("click")}),1e3*w.show_wheel);break;case"on_scroll":e(document).on("scroll",(function(){if(!x("wlwl_cookie")&&(!r||s)){let l=e("html").prop("scrollHeight"),t=window.innerHeight,i=e("html").prop("scrollTop");if(l>0){100*(i+t)/l>w.scroll_amount&&e(".wlwl_wheel_icon").trigger("click")}}}));break;case"on_exit":e(window).on("mousemove",(function(l){let t=e("html").prop("scrollTop"),i=l.pageY;x("wlwl_cookie")||r&&!s||i-t<15&&e(".wlwl_wheel_icon").trigger("click")}))}})),e(document).on("click",".woocommerce-lucky-wheel-popup-icon",(function(){if(!e(".wlwl_lucky_wheel_wrap.wlwl_lucky_wheel_content_rendered").length)return e(".wlwl_lucky_wheel_wrap").addClass("wlwl_lucky_wheel_content_rendered"),void p(!0);e(".wlwl_lucky_wheel_wrap").hasClass("wlwl_lucky_wheel_active")&&(e(".wlwl_wheel_icon").removeClass("wlwl_show"),e(".wlwl-overlay").show(),e("html").addClass("wlwl-html"),e(".wlwl_lucky_wheel_content").addClass("lucky_wheel_content_show"))})),e(document).on("click",".wlwl-close-wheel , .wlwl-close, .wlwl-overlay",(function(){e("html").removeClass("wlwl-html"),e(".wlwl-overlay").hide(),m("wlwl_cookie","closed",w.time_if_close),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show"),w.hide_popup||e(".wlwl_wheel_icon").addClass("wlwl_show")})),e(document).on("click",".wlwl-never-again span",(function(){m("wlwl_cookie","never_show_again",2592e3),e(".wlwl_wheel_icon").addClass("wlwl_show"),e(".wlwl-overlay").hide(),e("html").removeClass("wlwl-html"),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show")})),e(document).on("click",".wlwl-reminder-later-a",(function(){m("wlwl_cookie","reminder_later",86400),e(".wlwl_wheel_icon").addClass("wlwl_show"),e(".wlwl-overlay").hide(),e("html").removeClass("wlwl-html"),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show")})),e(document).on("click",".wlwl-hide-after-spin",(function(){e(".wlwl-overlay").hide(),e("html").removeClass("wlwl-html"),e(".wlwl_lucky_wheel_content").removeClass("lucky_wheel_content_show"),e(".wlwl_wheel_spin").css({"margin-left":"0",transition:"2s"})})),e(document).on("renderReCaptcha",".wheel-content-wrapper",(function(){"on"==w.wlwl_recaptcha&&(2==w.wlwl_recaptcha_version?I():(C(),e(".wheel-content-wrapper").find(".wlwl-recaptcha-field").hide()))})),e(document).on("keypress",(function(l){e(".wlwl_lucky_wheel_content").hasClass("lucky_wheel_content_show")&&13===l.keyCode&&e("#wlwl_chek_mail").trigger("click")})),e(document).on("click","#wlwl_chek_mail",(function(){if(!e(".wlwl_lucky_wheel_wrap").hasClass("wlwl_lucky_wheel_active"))return;if(e("#wlwl_error_mail,#wlwl_error_name,#wlwl_error_mobile,#wlwl_warring_recaptcha").html(""),e(".wlwl-required-field").removeClass("wlwl-required-field"),w.gdpr&&!e('.wlwl-gdpr-checkbox-wrap input[type="checkbox"]').prop("checked"))return e("#wlwl_error_mail").html(w.gdpr_warning),!1;let l=e("#wlwl_player_mail").val(),t=e("#wlwl_player_name").val(),i=function(e){if(e){let l=(e=e.replace(/\(|\)|-|\.|\s|\+/gi,"")).slice(0,1);e=0===parseInt(l)?e.slice(1):e}return e||""}(e("#wlwl_player_mobile").val()||""),o=e("#wlwl-g-validate-response").val()||"",n=!0;if(w.wlwl_recaptcha&&w.wlwl_recaptcha_site_key&&!o?(e(".wlwl-recaptcha-field #wlwl-recaptcha > div").addClass("wlwl-required-field").focus(),e("#wlwl_warring_recaptcha").html(w.wlwl_warring_recaptcha),n=!1):w.wlwl_recaptcha&&w.wlwl_recaptcha_site_key&&(e(".wlwl-recaptcha-field #wlwl-recaptcha > div").removeClass("wlwl-required-field"),n=!0),!w.custom_field_name_enable||r&&!w.custom_field_name_enable_mobile||!w.custom_field_name_required||t||(e("#wlwl_error_name").html(w.custom_field_name_message),e(".wlwl_field_name").addClass("wlwl-required-field"),n=!1),!w.custom_field_mobile_enable||r&&!w.custom_field_mobile_enable_mobile||("on"!=w.custom_field_mobile_required||i||(e("#wlwl_error_mobile").html(w.custom_field_mobile_message),e(".wlwl_field_mobile").addClass("wlwl-required-field"),n=!1),function(e){if(""===e||"on"===w.custom_field_mobile_required)return!0;return/^\d{8,15}$/.test(e)}(i)||(e("#wlwl_error_mobile").html(w.custom_field_mobile_warning),e(".wlwl_field_mobile").addClass("wlwl-required-field"),n=!1),i&&(i=(e("#wlwl_country_code").val()||"")+i)),l||(e("#wlwl_player_mail").prop("disabled",!1).focus(),e("#wlwl_error_mail").html(w.empty_email_warning),e(".wlwl_field_email").addClass("wlwl-required-field"),n=!1),!1===n)return!1;e(this).unbind(),e(".wlwl-overlay").unbind(),e("#wlwl_player_mail").prop("disabled",!0),""===x("wlwl_cookie")||"closed"===x("wlwl_cookie")?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/i.test(l)?(e("#wlwl_chek_mail").addClass("wlwl-adding"),e.ajax({type:"post",dataType:"json",url:w.ajaxurl,data:{origin_prize:w.coupon_type,user_email:l,user_name:t,user_mobile:i,language:w.language,g_validate_response:o,is_desktop:r?"":1,_woocommerce_lucky_wheel_nonce:e("#_woocommerce_lucky_wheel_nonce").val()},success:function(t){if("yes"===t.allow_spin){e(".wlwl-show-again-option").hide(),e(".wlwl-close-wheel").hide(),e(".wlwl-hide-after-spin").show(),d(t.stop_position,t.result_notification,t.result);let i=w.show_again;switch(w.show_again_unit){case"m":i*=60;break;case"h":i*=3600;break;case"d":i*=86400}m("wlwl_cookie",l,i)}else e("#wlwl_chek_mail").removeClass("wlwl-adding"),e("#wlwl_player_mail").prop("disabled",!1),t.g_validate_response?e("#wlwl_error_mail").html(t.warning):e("#wlwl_error_mail").html(t.allow_spin);if(t.hasOwnProperty("metrilo_response")){"success"===t.metrilo_response.status&&window.hasOwnProperty("metrilo")&&window.metrilo.hasOwnProperty("customEvent")&&"function"==typeof window.metrilo.customEvent&&window.metrilo.customEvent("wordpress_lucky_wheel")}}})):(e("#wlwl_player_mail").prop("disabled",!1).focus(),e("#wlwl_error_mail").html(w.invalid_email_warning),e(".wlwl_field_email").addClass("wlwl-required-field")):(e("#wlwl_error_mail").html(w.limit_time_warning),e("#wlwl_player_mail").prop("disabled",!1))}))}));let b=function(e){this.viewport=e,this.world=document.createElement("div"),this.leaves=[],this.options={numLeaves:30,wind:{magnitude:1.2,maxSpeed:3,duration:500,start:0,speed:0}},this.width=this.viewport.offsetWidth,this.height=this.viewport.offsetHeight,this.timer=0,this._resetLeaf=function(e){e.x=2*this.width-Math.random()*this.width*1.75,e.y=-10,e.z=200*Math.random(),e.x>this.width&&(e.x=this.width+10,e.y=Math.random()*this.height/2),0==this.timer&&(e.y=Math.random()*this.height),e.rotation.speed=10*Math.random();let l=Math.random();return l>.5?e.rotation.axis="X":l>.25?(e.rotation.axis="Y",e.rotation.x=180*Math.random()+90):(e.rotation.axis="Z",e.rotation.x=360*Math.random()-180,e.rotation.speed=3*Math.random()),e.xSpeedVariation=.8*Math.random()-.4,e.ySpeed=Math.random()+1.5,e},this._updateLeaf=function(e){let l=this.options.wind.speed(this.timer-this.options.wind.start,e.y)+e.xSpeedVariation;e.x-=l,e.y+=e.ySpeed,e.rotation.value+=e.rotation.speed;let t="translateX( "+e.x+"px ) translateY( "+e.y+"px ) translateZ( "+e.z+"px ) ";_wlwl_get_email_params.rotate&&(t+=" rotate"+e.rotation.axis+"( "+e.rotation.value+"deg )","X"!==e.rotation.axis&&(t+=" rotateX("+e.rotation.x+"deg)")),e.el.style.webkitTransform=t,e.el.style.MozTransform=t,e.el.style.oTransform=t,e.el.style.transform=t,(e.x<-10||e.y>this.height+10)&&this._resetLeaf(e)},this._updateWind=function(){if(0===this.timer||this.timer>this.options.wind.start+this.options.wind.duration){this.options.wind.magnitude=Math.random()*this.options.wind.maxSpeed,this.options.wind.duration=50*this.options.wind.magnitude+(20*Math.random()-10),this.options.wind.start=this.timer;let e=this.height;this.options.wind.speed=function(l,t){let i=this.magnitude/2*(e-2*t/3)/e;return i*Math.sin(2*Math.PI/this.duration*l+3*Math.PI/2)+i}}},this.init=function(){for(let e=0;e<this.options.numLeaves;e++){let e={el:document.createElement("div"),x:0,y:0,z:0,rotation:{axis:"X",value:0,speed:0,x:0},xSpeedVariation:0,ySpeed:0,path:{type:1,start:0},image:1};this._resetLeaf(e),this.leaves.push(e),this.world.appendChild(e.el)}this.world.className="wlwl-leaf-scene",this.viewport.appendChild(this.world),this.world.style.webkitPerspective="400px",this.world.style.MozPerspective="400px",this.world.style.oPerspective="400px",this.world.style.perspective="400px";let e=this;window.onresize=function(l){e.width=e.viewport.offsetWidth,e.height=e.viewport.offsetHeight}},this.render=function(){this._updateWind();for(let e=0;e<this.leaves.length;e++)this._updateLeaf(this.leaves[e]);this.timer++,requestAnimationFrame(this.render.bind(this))}};function x(e){let l=e+"=",t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let i=t[e];for(;" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(l))return i.substring(l.length,i.length)}return""}function C(){grecaptcha.ready((function(){grecaptcha.execute(_wlwl_get_email_params.wlwl_recaptcha_site_key,{action:"homepage"}).then((function(e){M(e)}))}))}function I(){if(0==jQuery.find(".wlwl-recaptcha").length||jQuery.find(".wlwl-recaptcha iframe").length)return!0;grecaptcha.render("wlwl-recaptcha",{sitekey:_wlwl_get_email_params.wlwl_recaptcha_site_key,callback:M,"expired-callback":P,theme:_wlwl_get_email_params.wlwl_recaptcha_secret_theme,isolated:!1})}function M(e){e&&jQuery(".wlwl-recaptcha-field #wlwl-g-validate-response").val(e)}function P(){jQuery(".wlwl-recaptcha-field #wlwl-g-validate-response").val(null)}}(jQuery);