jQuery(function(l){var i=l("div.ywctm-default-form").data("option-id"),d=l(".ywctm-default-form-main-table"),a=l(document).find(".ywctm-default-form__popup_wrapper"),o={message:null,overlayCSS:{background:"#fff",opacity:.7},ignoreIfBlocked:!0},t=function(e){var t;""!==e&&(t=(e=l("<div></div>").html(e)).find(".ywctm-default-form-main-table"),e=e.find(".ywctm-default-form__popup_wrapper"),l(".ywctm-default-form-main-table").html(t.html()),l(".ywctm-default-form__popup_wrapper").html(e.html()),a=l(document).find(".ywctm-default-form__popup_wrapper"),n())},n=function(){l(".ywctm-default-form-main-table tbody").sortable({placeholder:"ui-state-highlight",axis:"y",handle:".action__sort",stop:function(){var e=d.find('[data-name="name"]'),a=[];e.each(function(e,t){a.push(l(t).val())}),e=a,d.block(o),l.post(document.location.href,{ywctm_default_form:i,request:"sort",order:e}).done(function(e){t(e),d.unblock()})},start:function(e,t){l(":root").css("--dragged-item-width",t.item.width()+"px")}}).disableSelection()},r=function(){(a=l(document).find(".ywctm-default-form__popup_wrapper")).dialog({closeText:"",title:ywctm_default_form_field.popup_title,width:400,modal:!0,dialogClass:"yith-plugin-ui ywctm-default-form-popup",buttons:[{text:ywctm_default_form_field.save,click:function(){var e;l("#name").hasClass("field-exists")||((e=l("form.ywctm-default-form__form_row").serializeArray()).push({name:"ywctm_default_form",value:i}),e.push({name:"request",value:"save"}),d.block(o),a.dialog("close"),l.post(document.location.href,e).done(function(e){t(e),d.unblock()}))},"class":"yith-save-button"}]}),l(document).find(".ywctm-default-form__popup_wrapper [data-deps]").each(function(){var e=l(this),d=e.closest("tr"),t=e.attr("data-deps").split(","),n=e.attr("data-deps_value").split(","),r=[];l.each(t,function(o,e){l('[name="'+e+'"]').on("change",function(){var e=l(this),t=e.val(),a=e.attr("type"),i="";"radio"===a&&!e.is(":checked")||("checkbox"===a&&(t=e.is(":checked")?"yes":"no"),i=(i=n[o]+"").split("|"),r[o]=-1!==l.inArray(t,i),-1===l.inArray(!1,r)?d.fadeIn():d.fadeOut())}).trigger("change")})})};n(),l(document).on("blur","#name",function(){var e=l(this),t=e.val(),a=e.closest("td"),i=l(".yith-save-button");if(i.removeClass("disabled").removeAttr("disabled"),e.removeClass("required"),e.removeClass("field-exists"),a.find(".description.field-exists").hide(),a.find(".description.required").hide(),!e.is("[readonly]")){if(""===(t=t.trim().toLowerCase().replace(/\s/g,"_").replace(/[^A-Za-z0-9_]+/gi,"")))return e.addClass("required"),a.find(".description.required").show(),i.addClass("disabled").attr("disabled","true"),!1;var o=d.find('input[value="'+t+'"]');l.each(o,function(){if(l(this).val()===t)return e.addClass("field-exists"),a.find(".description.field-exists").show(),i.addClass("disabled").attr("disabled","true"),!1})}}),l(document).on("click",".action__edit",function(e){e.preventDefault();var e=l(this).closest("tr"),o=a.find("form");l.each(e.find('input[type="hidden"]'),function(e,t){var a=l(t).data("name"),i=l(o).find('td *[name="'+a+'"]'),t=l(t).val();"name"===a&&i.prop("readonly",!0),i.length&&("checkbox"===i.attr("type")?"yes"===t?i.prop("checked",!0):i.prop("checked",!1):i.val(t)),i.trigger("change")}),r()}),l(document).on("change",'input[name="enabled"]',function(){var e=l(this),t=e.closest("tr").find('[data-name="name"]').val(),e=e.is(":checked")?"yes":"no";t=t,e=e,d.block(o),l.post(document.location.href,{ywctm_default_form:i,request:"activate",activated:e,row:t}).done(function(){d.unblock()})})});