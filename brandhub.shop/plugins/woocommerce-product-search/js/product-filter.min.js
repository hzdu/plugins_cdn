/*!
 * product-filter.js
 *
 * Copyright (c) "kento" Karim Rahimpur www.itthinx.com
 *
 * This code is provided subject to the license granted.
 * Unauthorized use and distribution is prohibited.
 * See COPYRIGHT.txt and LICENSE.txt
 *
 * This code is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 *
 * This header and all notices must be kept intact.
 *
 * @author itthinx
 * @package woocommerce-product-search
 * @since 2.0.0
 */
;var ixwpsf={blinkerTimeouts:[],blinkerTimeout:5000,productsBlinker:false,taxonomy:[],ts:0,autoToggleFilterWidgets:true,embed:true,expandTime:200,retractTime:320,xhr:null};var ix_dropdown_thumbnails=[],ix_dropdown_order=[];(function(a){ixwpsf.productFilter=function(e,k,b){var v=decodeURI(window.location.href),x=false,j=a(k.products).filter(function(){return a(this).closest('.related.products,[class^="wp-block-woocommerce"]').length<1}),o=j.css("width"),l=j.css("height"),u=ixwpsf.blinkerTimeout,z=true,h=true,B=typeof b.origin_id!=="undefined"?b.origin_id:null;if(typeof b.href!=="undefined"){if(v!==b.href){v=b.href;x=true}}var d="page";if(typeof woocommerce_product_search_context!=="undefined"){d=woocommerce_product_search_context.pagination_base}if(typeof b.unpage_url==="undefined"||b.unpage_url!==false){var y=new RegExp("\\/"+d+"\\/[0-9]+","gi");var f=v.replace(y,"");f=ixwpsf.updateQueryArg("paged","",f);f=ixwpsf.updateQueryArg("product-page","",f);v=f}var r=null;if(typeof b.reset!=="undefined"&&b.reset&&typeof b.reset_url!=="undefined"){r=decodeURI(b.reset_url);if(typeof b.unpage_url==="undefined"||b.unpage_url!==false){var y=new RegExp("\\/"+d+"\\/[0-9]+","gi");r=r.replace(y,"");r=ixwpsf.updateQueryArg("paged","",r);r=ixwpsf.updateQueryArg("product-page","",r)}}if(typeof b.term!=="undefined"){var c=new RegExp("ixwpst\\["+b.taxonomy+"\\]\\[[0-9]+\\]","g");v=v.replace(c,"ixwpst["+b.taxonomy+"][]");if(!a.isArray(b.term)){switch(b.action){case"add":v=ixwpsf.addQueryArg("ixwpst["+b.taxonomy+"][]",b.term,v);break;case"remove":v=ixwpsf.removeQueryArg("ixwpst["+b.taxonomy+"][]",b.term,v);break;default:v=ixwpsf.updateQueryArg("ixwpst["+b.taxonomy+"][]",b.term,v)}}else{v=ixwpsf.updateQueryArg("ixwpst["+b.taxonomy+"][]","",v);for(var t=0;t<b.term.length;t++){v=ixwpsf.addQueryArg("ixwpst["+b.taxonomy+"][]",b.term[t],v)}}}var w="";if(typeof b.min_price!=="undefined"){v=ixwpsf.updateQueryArg("min_price",b.min_price,v);w+=b.min_price}else{var s=ixwpsf.getQueryArg(v,"min_price");if(s!==null&&s.length>0){w+=s}}if(typeof b.max_price!=="undefined"){v=ixwpsf.updateQueryArg("max_price",b.max_price,v);w+=b.max_price}else{var n=ixwpsf.getQueryArg(v,"max_price");if(n!==null&&n.length>0){w+=n}}var g=w.length>0?"1":"";v=ixwpsf.updateQueryArg("ixwpsp",g,v);if(g!==""){b.ixwpsp=g}if(typeof b.blinkerTimeout!=="undefined"){u=b.blinkerTimeout}if(typeof b.updateAddressBar!=="undefined"){z=b.updateAddressBar}if(typeof b.updateDocumentTitle!=="undefined"){h=b.updateDocumentTitle}e=a.trim(e);v=ixwpsf.updateQueryArg("ixwpss",encodeURIComponent(e),v);if(typeof b.title!=="undefined"){v=ixwpsf.updateQueryArg("title",b.title,v)}if(typeof b.excerpt!=="undefined"){v=ixwpsf.updateQueryArg("excerpt",b.excerpt,v)}if(typeof b.content!=="undefined"){v=ixwpsf.updateQueryArg("content",b.content,v)}if(typeof b.categories!=="undefined"){v=ixwpsf.updateQueryArg("categories",b.categories,v)}if(typeof b.attributes!=="undefined"){v=ixwpsf.updateQueryArg("attributes",b.attributes,v)}if(typeof b.tags!=="undefined"){v=ixwpsf.updateQueryArg("tags",b.tags,v)}if(typeof b.sku!=="undefined"){v=ixwpsf.updateQueryArg("sku",b.sku,v)}if(typeof b.order_by!=="undefined"){v=ixwpsf.updateQueryArg("order_by",b.order_by,v)}if(typeof b.order!=="undefined"){v=ixwpsf.updateQueryArg("order",b.order,v)}if(typeof b.wpml!=="undefined"){v=ixwpsf.updateQueryArg("wpml",b.wpml,v)}if(typeof b.terms!=="undefined"){v=ixwpsf.updateQueryArg("terms",b.terms,v)}if(ixwpsf.taxonomy.length>0){var p=null,m=null;if(B!==null){for(var t=0;t<ixwpsf.taxonomy.length;t++){if(typeof ixwpsf.taxonomy[t].origin_id!=="undefined"){if(ixwpsf.taxonomy[t].origin_id===B){p=ixwpsf.taxonomy[t].taxonomy;m=t;break}}}}for(var t=0;t<ixwpsf.taxonomy.length;t++){if(p!==null&&ixwpsf.taxonomy[t].taxonomy===p&&t!==m){continue}if(typeof ixwpsf.taxonomy[t].show!=="undefined"){v=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[t].taxonomy+"][show]",ixwpsf.taxonomy[t].show,v)}if(typeof ixwpsf.taxonomy[t].multiple!=="undefined"){v=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[t].taxonomy+"][multiple]",ixwpsf.taxonomy[t].multiple?1:0,v)}if(typeof ixwpsf.taxonomy[t].filter!=="undefined"){v=ixwpsf.updateQueryArg("ixwpsf[taxonomy]["+ixwpsf.taxonomy[t].taxonomy+"][filter]",ixwpsf.taxonomy[t].filter?1:0,v)}}}if(typeof b.ixwpse!=="undefined"){v=ixwpsf.updateQueryArg("ixwpse",b.ixwpse,v)}if(typeof b.on_sale!=="undefined"){v=ixwpsf.updateQueryArg("on_sale",b.on_sale,v)}if(typeof b.rating!=="undefined"){v=ixwpsf.updateQueryArg("rating",b.rating,v)}if(typeof b.in_stock!=="undefined"){v=ixwpsf.updateQueryArg("in_stock",b.in_stock,v)}if(u!==0){a(k.field).addClass("blinker")}if(ixwpsf.productsBlinker){j.addClass("product-search-filter-blinker").html("").show()}j.css("minWidth",o);j.css("minHeight",l);a(k.pagination).hide();a(k.count).hide();if(u>0){ixwpsf.blinkerTimeouts[k.field]=setTimeout(function(){a(k.field).removeClass("blinker")},u);ixwpsf.blinkerTimeouts[k.products]=setTimeout(function(){j.removeClass("product-search-filter-blinker")},u)}var A=(typeof Date.now==="function")?Date.now():0;if(r!==null){v=r}var q=ixwpsf.updateQueryArg("ixmbd",ixwpsf.embed?"1":"",v);a("body").addClass("product-search-filter-loading");if(ixwpsf.xhr!==null){ixwpsf.xhr.abort()}ixwpsf.xhr=a.ajax({url:q,error:function(D,E,C){if(typeof E==="undefined"||E!=="abort"){a("body").removeClass("product-search-filter-loading");a(".loading-term-filter").removeClass("loading-term-filter");a(k.field).removeClass("blinker");a(k.pagination).show();a(k.count).show()}},success:function(E,D,L){a("body").removeClass("product-search-filter-loading");ixwpsf.xhr=null;if(A>=ixwpsf.ts){ixwpsf.ts=A}else{return}var G=a(E).find(k.breadcrumb);if(G.length>0){a(k.breadcrumb).replaceWith(G);a(k.breadcrumb).show()}else{a(k.breadcrumb).html("");a(k.breadcrumb).hide()}var F=a(E).find(k.header);if(F.length>0){a(k.header).replaceWith(F);a(k.header).show()}else{a(k.header).html("");a(k.header).hide()}a(k.field).removeClass("blinker");if(ixwpsf.productsBlinker){j.removeClass("product-search-filter-blinker")}else{j.html("").show()}if(u>0){clearTimeout(ixwpsf.blinkerTimeouts[k.field]);clearTimeout(ixwpsf.blinkerTimeouts[k.products])}var K=a(E).find(k.products).filter(function(){return a(this).closest('.related.products,[class^="wp-block-woocommerce"]').length<1});var M=false,C=false;if(K.length===0){M=true}if(a(K).find(k.product).length>0){if(j.length>0){j.show().replaceWith(K)}else{a(k.header).parent().replaceWith(a(E).find(k.header).parent());M=false}a(k.info).remove();a(k.ordering).show()}else{if(j.length>0){a(k.info).remove();j.html("").hide().after(a(E).find(k.info));a(k.ordering).hide();M=false}if(a(E).find(k.info).length===0){C=true}}if(M){console.log("Could not find the general Products Container, expected the selector "+k.products)}if(!M&&C){console.log("Could not find the individual Product Container, expected the selector "+k.product)}var N=a(E).find(k.pagination);a.each(a(k.pagination),function(O,P){if(N.eq(O).length>0){a(k.pagination).eq(O).replaceWith(N.eq(O))}else{a(k.pagination).eq(O).html("")}});var J=a(E).find(k.count);a.each(a(k.count),function(O,P){if(J.eq(O).length>0){a(k.count).eq(O).replaceWith(J.eq(O))}else{a(k.count).eq(O).html("")}});a(k.pagination).show();a(k.count).show();if(!x){if(z){window.history.pushState({query:e,href:v},"",v)}if(h){var I=a(E).filter("title").text();document.title=I}}ixwpsf.updateOrderingForm(e,k,b,v);if(r!==null){a(".product-filter-field").val("");a(".product-filter-field").parent().find(".product-search-filter-search-clear").hide()}if(typeof a().slider!=="undefined"){var H=a(E).find(".product-search-filter-price-slider");a.each(a(".product-search-filter-price-slider"),function(V,Y){if(H.eq(V).length>0){var W=H.eq(V).data("min_price"),S=H.eq(V).data("max_price"),T=H.eq(V).data("precision"),P=isNaN(parseFloat(W))?W:parseFloat(W).toFixed(T),Q=isNaN(parseFloat(S))?S:parseFloat(S).toFixed(T);a(Y).slider("option","min",W);a(Y).slider("option","max",S);a(Y).find("span.slider-limit-min").text(P);a(Y).find("span.slider-limit-max").text(Q);a(Y).data("min_price",W);a(Y).data("max_price",S);var U=H.eq(V).find(".slider-min").text(),Z=H.eq(V).find(".slider-max").text();new_slider_min_display=isNaN(parseFloat(U))?U:parseFloat(U).toFixed(T),new_slider_max_display=isNaN(parseFloat(Z))?Z:parseFloat(Z).toFixed(T);a(Y).parent().find(".slider-min").text(new_slider_min_display);a(Y).parent().find(".slider-max").text(new_slider_max_display);if(r===null){var aa=W;if(U!==""){aa=wps_price_slider.easeOut(U,W,S)}var X=S;if(Z!==""){X=wps_price_slider.easeOut(Z,W,S)}a(Y).slider("disable");a(Y).slider("values",[aa,X]);a(Y).slider("values",[aa,X]);a(Y).slider("enable");a(Y).parent().find("input.product-search-filter-min-price").val(new_slider_min_display);a(Y).parent().find("input.product-search-filter-max-price").val(new_slider_max_display)}else{a(Y).slider("disable");a(Y).slider("values",[W,S]);a(Y).slider("values",[W,S]);a(Y).slider("enable");a(Y).parent().find("input.product-search-filter-min-price").val("").trigger("clear");a(Y).parent().find("input.product-search-filter-max-price").val("").trigger("clear");var O=a(Y).parent().find(".slider-min"),R=a(Y).parent().find(".slider-max");O.text("");R.text("");a(Y).parent().parent().find(".product-search-filter-price-clear").hide()}}});if(typeof wps_price_slider!=="undefined"){wps_price_slider.updateForm(e,".product-search-filter-price-slider",b,v)}}if(r!==null){a.each(a(".product-search-filter-price"),function(O,P){var Q=a(P).find(".product-search-filter-price-slider").length>0;if(!Q){a(P).find("input.product-search-filter-min-price").val("").trigger("clear");a(P).find("input.product-search-filter-max-price").val("").trigger("clear");a(P).find(".product-search-filter-price-clear").hide()}})}a(E).find(".product-search-filter-items option").each(function(P,Q){var R=a(Q).val(),O=a(Q).data();ix_dropdown_thumbnails[R]=O});a(".product-search-filter-terms").each(function(Q,S){var T=a(E).find("#"+this.id);if(T.length>0){var R=a(this).find("select.selectized");if(R.length===0){a("#"+this.id).replaceWith(T)}else{var P=T.find("#"+R.first()[0].id);if(P.length>0){P=P.first();var O=[];a(P).find("option").each(function(U,V){a(V).data("data",{$order:U});O[a(V).val()]=U});ix_dropdown_order[P.id]=O;a("#"+this.id).replaceWith(T);P.trigger("apply-selectize")}}}});a(".product-search-filter-extras").each(function(O,P){var Q=a(E).find("#"+this.id);if(Q.length>0){a("#"+this.id).replaceWith(Q)}});ixwpsf.toggleWidgets();a(".product-search-filter-reset .product-search-filter-reset-clear").removeClass("loading-reset-filter");a(".product-search-filter-reset").trigger("ixProductFilterRequestDone");a(document).triggerHandler("ixProductFilterRequestProcessed")}})};ixwpsf.updateOrderingForm=function(f,o,e,u){var j=a(o.ordering).closest("form");if(j.length>0){if(f.length>0){var g=a(j).find('input[name="ixwpss"]');if(g.length>0){g.val(f)}else{a(j).append('<input type="hidden" name="ixwpss" value="'+f+'"/>')}}if(typeof e.title!=="undefined"){var x=a(j).find('input[name="title"]');if(x.length>0){x.val(e.title)}else{a(j).append('<input type="hidden" name="title" value="'+e.title+'"/>')}}else{a(j).find('input[name="title"]').remove()}if(typeof e.excerpt!=="undefined"){var c=a(j).find('input[name="excerpt"]');if(c.length>0){c.val(e.excerpt)}else{a(j).append('<input type="hidden" name="excerpt" value="'+e.excerpt+'"/>')}}else{a(j).find('input[name="excerpt"]').remove()}if(typeof e.content!=="undefined"){var s=a(j).find('input[name="content"]');if(s.length>0){s.val(e.content)}else{a(j).append('<input type="hidden" name="content" value="'+e.content+'"/>')}}else{a(j).find('input[name="content"]').remove()}if(typeof e.categories!=="undefined"){var q=a(j).find('input[name="categories"]');if(q.length>0){q.val(e.categories)}else{a(j).append('<input type="hidden" name="categories" value="'+e.categories+'"/>')}}else{a(j).find('input[name="categories"]').remove()}if(typeof e.attributes!=="undefined"){var k=a(j).find('input[name="attributes"]');if(k.length>0){k.val(e.attributes)}else{a(j).append('<input type="hidden" name="attributes" value="'+e.attributes+'"/>')}}else{a(j).find('input[name="attributes"]').remove()}if(typeof e.tags!=="undefined"){var m=a(j).find('input[name="tags"]');if(m.length>0){m.val(e.tags)}else{a(j).append('<input type="hidden" name="tags" value="'+e.tags+'"/>')}}else{a(j).find('input[name="tags"]').remove()}if(typeof e.sku!=="undefined"){var n=a(j).find('input[name="sku"]');if(n.length>0){n.val(e.sku)}else{a(j).append('<input type="hidden" name="sku" value="'+e.sku+'"/>')}}else{a(j).find('input[name="sku"]').remove()}if(typeof e.wpml!=="undefined"){var l=a(j).find('input[name="wpml"]');if(l.length>0){l.val(e.wpml)}else{a(j).append('<input type="hidden" name="wpml" value="'+e.wpml+'"/>')}}else{a(j).find('input[name="wpml"]').remove()}a(j).find('input[name="min_price"]').remove();a(j).find('input[name="max_price"]').remove();a(j).find('input[name^="ixwpst"]').remove();a(j).find('input[name^="ixwpsf"]').remove();a(j).find('input[name="ixwpse"]').remove();a(j).find('input[name="on_sale"]').remove();a(j).find('input[name="rating"]').remove();a(j).find('input[name="in_stock"]').remove();var v=u.substring(u.indexOf("?")+1);var d=v.indexOf("#");if(d>=0){v=v.substring(0,d)}v=v.split("&");if(v.length>0){for(var t=0;t<v.length;t++){var p=v[t].split("="),w="",r="";w=unescape(p[0]);if(p.length>1){r=unescape(p[1])}if(w!==""&&w!=="orderby"&&w!=="ixwpss"&&w!=="title"&&w!=="excerpt"&&w!=="content"&&w!=="categories"&&w!=="attributes"&&w!=="tags"&&w!=="sku"&&w!=="wpml"&&(w==="min_price"||w==="max_price"||w.indexOf("ixwpst")===0||w.indexOf("ixwpsf")===0||w==="ixwpse"||w==="on_sale"||w==="rating"||w==="in_stock")){var b=a(j).find('input[name="'+w+'"]');if(b.length>0&&!w.endsWith("[]")){b.val(r)}else{a(j).append(a('<input type="hidden" name="'+w+'" />').attr({value:r}))}}}}if(typeof e.ixwpsp!=="undefined"){var h=a(j).find('input[name="ixwpsp"]');if(h.length>0){h.val(e.ixwpsp)}else{a(j).append('<input type="hidden" name="ixwpsp" value="'+e.ixwpsp+'"/>')}}else{a(j).find('input[name="ixwpsp"]').remove()}}};ixwpsf.updateQueryArg=function(j,h,b){b=ixwpsf.decodeURI(b);var c=j.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),g=new RegExp("([?&])"+c+"=.*?(&|#|$)","g"),k=null;if(typeof b==="undefined"){b=window.location.href}if(h===""){g=new RegExp("([?&])"+c+"=([^&#$]*)","g");k=b.replace(g,"$1");k=k.replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"")}else{var e;if(e=b.match(g)){rmregex=new RegExp("([?&])"+c+"=([^&#$]*)","g");k=b.replace(rmregex,"$1");k=k.replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"");k=ixwpsf.addQueryArg(j,h,k)}else{var d="",f=b.indexOf("?")!==-1?"&":"?";if(b.indexOf("#")!==-1){d=b.replace(/.*#/,"#");b=b.replace(/#.*/,"")}k=b+f+j+"="+h+d}}return k};ixwpsf.getQueryArgs=function(b){b=ixwpsf.decodeURI(b);var d=/[^=&?]+\s*=\s*[^&#]*/g;var f=b.match(d);var e=[];if(f!==null){for(var c=0;c<f.length;c++){var g=f[c].split("=");e.push(g)}}return e};ixwpsf.getQueryArg=function(c,e){c=ixwpsf.decodeURI(c);var f=new RegExp("[&?]"+e+"s*=s*[^&#]*","g");var g=c.match(f);var b=null;if(g!==null){for(var d=0;d<g.length;d++){var h=g[d].split("=");b=h[1];break}}return b};ixwpsf.addQueryArg=function(d,f,b){b=ixwpsf.decodeURI(b);var j=true;if(typeof b==="undefined"){b=window.location.href}var e=ixwpsf.getQueryArgs(b);for(var c=0;c<e.length;c++){if(e[c][0]==d&&e[c][1]==f){j=false;break}}if(j){var h="",g=b.indexOf("?")!==-1?"&":"?";if(b.indexOf("#")!==-1){h=b.replace(/.*#/,"#");b=b.replace(/#.*/,"")}b=b+g+d+"="+f+h}return b};ixwpsf.removeQueryArg=function(e,g,d){d=ixwpsf.decodeURI(d);var c=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),f=new RegExp("([?&])"+c+"="+g+"(&|#|$)","i"),b=d.replace(f,"$1$2").replace("?&","?").replace(/&&+/g,"&").replace(/&$/,"");return b};ixwpsf.categoryFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).parent().data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).parent().hasClass("current-cat")){a(this).addClass("loading-term-filter");if(c){a(this).parent().removeClass("current-cat");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),"product_cat","remove",f])}else{a(".product-search-product_cat-filter-item").removeClass("current-cat");a(".product-filter-field").first().trigger("ixTermFilter",["","product_cat",null,f])}}else{if(!c){a(".product-search-product_cat-filter-item").removeClass("current-cat")}a(this).parent().addClass("current-cat");a(this).addClass("loading-term-filter");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),"product_cat",g,f])}return false};ixwpsf.categoryFilterSelectOnChange=function(j){var d=a(this).closest(".product-search-filter-terms"),g=a(d).attr("id"),c=a(d).data("multiple"),b=false;var f=a(this).val();if(f===null||f===""||(typeof f==="object")&&f.length===0){f="";b=true}if(c&&!b){var h="add"}else{var h="replace"}if(typeof j.preventDefault==="function"){j.preventDefault()}if(typeof j.stopImmediatePropagation==="function"){j.stopImmediatePropagation()}if(typeof j.stopPropagation==="function"){j.stopPropagation()}a(".product-filter-field").first().trigger("ixTermFilter",[f,"product_cat",h,g]);return false};ixwpsf.attributeFilterSelectOnChange=function(k){var f=a(this).closest(".product-search-filter-terms"),h=a(f).attr("id"),c=a(f).data("multiple"),b=false,d=a(this).data("taxonomy");var g=a(this).val();if(g===null||g===""||(typeof g==="object")&&g.length===0){g="";b=true}if(c&&!b){var j="add"}else{var j="replace"}if(typeof k.preventDefault==="function"){k.preventDefault()}if(typeof k.stopImmediatePropagation==="function"){k.stopImmediatePropagation()}if(typeof k.stopPropagation==="function"){k.stopPropagation()}a(".product-filter-field").first().trigger("ixTermFilter",[g,d,j,h]);return false};ixwpsf.tagFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).hasClass("current-tag")){a(this).addClass("loading-term-filter");if(c){a(this).removeClass("current-tag");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).data("term"),"product_tag","remove",f])}else{a(".product-search-product_tag-filter-item").removeClass("current-tag");a(".product-filter-field").first().trigger("ixTermFilter",["","product_tag",null,f])}}else{if(!c){a(".product-search-product_tag-filter-item").removeClass("current-tag")}a(this).addClass("current-tag");a(this).addClass("loading-term-filter");a(".product-filter-field").first().trigger("ixTermFilter",[a(this).data("term"),"product_tag",g,f])}return false};ixwpsf.attributeFilterItemOnClick=function(h){var d=a(this).closest(".product-search-filter-terms"),f=a(d).attr("id"),c=a(d).data("multiple"),b=a(this).parent().data("term")==="";if(c&&!b){var g="add"}else{var g="replace"}if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}if(a(this).parent().hasClass("current-attribute")){a(".product-search-"+a(this).parent().data("taxonomy")+"-filter-item").removeClass("current-attribute");a(this).addClass("loading-term-filter");if(c){a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),a(this).parent().data("taxonomy"),"remove",f])}else{a(".product-filter-field").first().trigger("ixTermFilter",["",a(this).parent().data("taxonomy"),null,f])}}else{a(this).parent().addClass("current-attribute");a(this).addClass("loading-term-filter");if(a(this).parent().data("term")==="undefined"||a(this).parent().data("term")===""){a(".product-filter-field").first().trigger("ixTermFilter",["",a(this).parent().data("taxonomy"),null,f])}else{a(".product-filter-field").first().trigger("ixTermFilter",[a(this).parent().data("term"),a(this).parent().data("taxonomy"),g,f])}}return false};ixwpsf.decodeURI=function(b){try{b=decodeURI(b)}catch(c){b=b.replace(/%5B/g,"[").replace(/%5D/g,"]").replace(/%20/g," ")}return b};ixwpsf.toggleWidgets=function(){if(ixwpsf.autoToggleFilterWidgets){a(".product-search-filter-items").each(function(){if(!a(this).is("select")){if(!a(this).is(".selectize-control,.selectize-dropdown")){var b=a(this).children().length>0;if(b||a(this).hasClass("product-search-filter-toggle-widget")){a(this).closest(".widget").toggle(b)}if(b||a(this).hasClass("product-search-filter-toggle")){a(this).toggle(b)}}}else{if(!a(this).is("select.selectized")){var c=a(this).children(),b=true;if(c.length===0){b=false}else{if(c.length===1){var e=c.first().val();if(typeof e==="undefined"||e===""){b=false}}}}else{var b=true;if(typeof this.selectize!=="undefined"&&typeof this.selectize.options!=="undefined"){var d=Object.keys(this.selectize.options).length;if(d===0){b=false}else{if(d===1){for(i in this.selectize.options){if(typeof this.selectize.options[i].value==="undefined"||this.selectize.options[i].value===""){b=false;break}}}}}}if(b||a(this).hasClass("product-search-filter-toggle-widget")){a(this).closest(".widget").toggle(b)}if(b||a(this).hasClass("product-search-filter-toggle")){a(this).closest(".product-search-filter-terms").find(".selectize-control").toggle(b);a(this).filter("select:not(.apply-selectize)").toggle(b)}}})}};a(document).ready(function(){a(document).on("mouseenter",".expandable.auto-expand",function(d){if(typeof d.preventDefault==="function"){d.preventDefault()}if(typeof d.stopImmediatePropagation==="function"){d.stopImmediatePropagation()}if(typeof d.stopPropagation==="function"){d.stopPropagation()}var e=a(this).find(".term-expander").first();var b=false;if(typeof e.data("locked")!=="undefined"){b=e.data("locked")}if(b){return}a(this).addClass("expanded");var c=a(this).find("> ul");c.stop(true,true).show(ixwpsf.expandTime);if(a(this).hasClass("auto-retract")){a(this).closest(".product-search-filter-items").on("mouseleave.ixwpsf",function(f){c.parent().removeClass("expanded");c.stop(true,true).hide(ixwpsf.retractTime);a(this).off("mouseleave.ixwpsf")})}});a(document).on("click touchstart",".term-expander",function(g){if(typeof g.preventDefault==="function"){g.preventDefault()}if(typeof g.stopImmediatePropagation==="function"){g.stopImmediatePropagation()}if(typeof g.stopPropagation==="function"){g.stopPropagation()}var h=a(this).closest(".term-expander");var e=false;var c=false;if(typeof h.data("locked")!=="undefined"){c=h.data("locked")}switch(c){case true:e=true;break;default:h.data("locked",true);var b=setTimeout(function(){h.data("locked",false);h.data("lockedTimeout",null)},500);h.data("lockedTimeout",b)}if(e){return}var f=a(this).closest(".expandable");var d=f.find("> ul");if(!f.hasClass("expanded")){f.addClass("expanded");d.show(ixwpsf.expandTime)}else{f.removeClass("expanded");d.hide(ixwpsf.retractTime)}});a(".product-search-form input.product-filter-field").prop("disabled",false);a(".product-search-filter-price-form input.product-search-filter-price-field").prop("disabled",false);a(".product-search-filter-price.hide-fields .min-max-fields").hide();a("select.product-search-filter-product_cat").prop("disabled",false);a("select.product-search-filter-attribute").prop("disabled",false);a(document).on("click",".product-search-filter-terms:not(.filter-dead) .product-search-product_cat-filter-item a",ixwpsf.categoryFilterItemOnClick);a(document).on("change","select.product-search-filter-product_cat",ixwpsf.categoryFilterSelectOnChange);a(document).on("change","select.product-search-filter-attribute",ixwpsf.attributeFilterSelectOnChange);a(document).on("click",".product-search-filter-terms:not(.filter-dead) .product-search-product_tag-filter-item",ixwpsf.tagFilterItemOnClick);a(document).on("click",".product-search-filter-terms:not(.filter-dead) .product-search-attribute-filter-item:not(.product-search-product_cat-filter-item) a",ixwpsf.attributeFilterItemOnClick);a(document).on("change input textInput",".product-search-filter-search input.product-filter-field",function(){var b=a(this).val().trim();if(b.length>0){a(this).parent().find(".product-search-filter-search-clear").show()}else{a(this).parent().find(".product-search-filter-search-clear").hide()}});a(document).on("click",".product-search-filter-search .product-search-filter-search-clear",function(){a(this).parent().find("input.product-filter-field").val("").trigger("input")});a(document).on("change input textInput",".product-search-filter-price input.product-search-filter-min-price, .product-search-filter-price input.product-search-filter-max-price",function(){var c=a(this).parent().find("input.product-search-filter-min-price").val().trim(),b=a(this).parent().find("input.product-search-filter-max-price").val().trim();if(c.length>0||b.length>0){a(this).parent().parent().find(".product-search-filter-price-clear").show()}else{a(this).parent().parent().find(".product-search-filter-price-clear").hide()}});a(document).on("click",".product-search-filter-price .product-search-filter-price-clear",function(){var h=a(this).parent().parent().find("input.product-search-filter-min-price"),e=a(this).parent().parent().find("input.product-search-filter-max-price"),d=false,b=false;if(h.length>0){if(h.val()!==""){h.val("");d=true}}if(e.length>0){if(e.val()!==""){e.val("");b=true}}if(d){h.trigger("input")}else{if(b){e.trigger("input")}}if(typeof a().slider!=="undefined"){var g=a(this).parent().find(".product-search-filter-price-slider");if(g.length>0){var d=g.slider("option","min"),b=g.slider("option","max");g.slider("option","values",[d,b]);var f=g.parent().find(".slider-min"),c=g.parent().find(".slider-max");f.text(d);c.text(b)}}});a(document).on("click",".product-search-filter-extra:not(.filter-dead)",function(h){if(typeof h.preventDefault==="function"){h.preventDefault()}if(typeof h.stopImmediatePropagation==="function"){h.stopImmediatePropagation()}if(typeof h.stopPropagation==="function"){h.stopPropagation()}a(this).parent().find("a.product-search-filter-extra").addClass("loading-extra-filter");var d=null;if(a(this).is("a")){var b=a(this).parent().find('input[type="checkbox"]').first();b.prop("checked",!b.prop("checked"));if(a(this).is("a.rating-filter-option")){d=a(this).data("rating")}else{if(!a(this).is("a.rating-filter-clear")){var g=a(".product-search-filter-rating a.rating-selected");if(g.length>0){d=g.first().data("rating")}}}}var c={ixwpse:1};var f=a(this).parent().find('input[type="checkbox"]');f.each(function(){c[a(this).attr("name")]=this.checked?1:0});if(d!==null){c.rating=d}else{c.rating=""}a(".product-search-form input.product-filter-field").first().trigger("ixExtraFilter",c)});a(document).on("click",".product-search-filter-reset .product-search-filter-reset-clear",function(b){if(typeof b.preventDefault==="function"){b.preventDefault()}if(typeof b.stopImmediatePropagation==="function"){b.stopImmediatePropagation()}if(typeof b.stopPropagation==="function"){b.stopPropagation()}a(this).addClass("loading-reset-filter");a(".product-search-form input.product-filter-field").first().trigger("ixFilterReset")});a(document).on("ixProductFilterRequestDone",".product-search-filter-reset",function(c){var b=false;a(".product-filter-field").each(function(d){if(a(this).val().length>0){b=true;return false}});if(!b){b=a('.product-search-filter-terms .current-cat, .product-search-filter-terms .current-tag, .product-search-filter-terms .current-attribute, .product-search-filter-terms select.product-search-filter-items option[selected]:not([value=""]), .product-search-filter-terms select.selectized option[selected]:not([value=""])').length>0}if(!b){a(".product-search-filter-min-price, .product-search-filter-max-price").each(function(d){if(a(this).val().length>0){b=true;return false}})}if(!b){a("input.product-search-filter-on-sale").each(function(d){if(this.checked){b=true;return false}})}if(!b){b=a(".product-search-filter-rating .rating-filter-option.rating-selected").length>0}if(!b){a("input.product-search-filter-in-stock").each(function(d){if(this.checked){b=true;return false}})}if(b){a(this).show()}else{a(this).hide()}});a(".product-search-filter-reset").trigger("ixProductFilterRequestDone");a(".product-search-filter-items option").each(function(c,d){var e=a(d).val(),b=a(d).data();ix_dropdown_thumbnails[e]=b});a("select.apply-selectize").each(function(c,d){var b=[];a(d).find("option").each(function(e,f){a(f).data("data",{$order:e});b[a(f).val()]=e});ix_dropdown_order[d.id]=b});if(typeof a().selectize!=="undefined"){a("select.apply-selectize").trigger("apply-selectize");window.wps_did_apply_selectize=true}else{console.log("Tried to trigger the apply-selectize event but selectize is missing.")}ixwpsf.toggleWidgets()})})(jQuery);