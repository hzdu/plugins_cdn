!function(e){var a={};function i(o){if(a[o])return a[o].exports;var t=a[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=e,i.c=a,i.d=function(e,a,o){i.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:o})},i.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(a,"a",a),a},i.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},i.p="",i(i.s=0)}([function(e,a,i){i(1),e.exports=i(3)},function(e,a,i){jQuery(function(e){Promise.resolve().then(function(){return i(2)}).then(function(a){var i=a.WooVariationGalleryAdminPro;i.GWPAdmin(),i.ExtendMediaGrid(),i.DefaultProductGallery(),i.ImageUploader(),e("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){i.ImageUploader(),i.Sortable()}),e("#variable_product_options").on("woocommerce_variations_added",function(){i.ImageUploader(),i.Sortable()}),e(".dokan-product-variation-wrapper").on("dokan_variations_loaded dokan_variations_added",function(){i.ImageUploader(),i.Sortable()}),e(document).trigger("woo_variation_gallery_pro_admin_loaded")})})},function(e,a,i){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),i.d(a,"WooVariationGalleryAdminPro",function(){return n});var o=function(){function e(e,a){for(var i=0;i<a.length;i++){var o=a[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(a,i,o){return i&&e(a.prototype,i),o&&e(a,o),a}}();var t,n=(t=jQuery,function(){function e(){!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"GWPAdmin",value:function(){t().gwp_deactivate_popup&&t().gwp_deactivate_popup("woo-variation-gallery")}},{key:"ExtendMediaGrid",value:function(){wp.media,wp.media.view.Attachment.prototype.template=wp.template("wvg-attachment")}},{key:"DefaultProductGallery",value:function(){t(".add_product_images").off("click","a");var e=void 0,a=t("#product_image_gallery"),i=t("#product_images_container").find("ul.product_images");t(".add_product_images").on("click","a",function(o){var n=t(this);o.preventDefault(),e?e.open():((e=wp.media.frames.product_gallery=wp.media({title:n.data("choose"),button:{text:n.data("update")},states:[new wp.media.controller.Library({title:n.data("choose"),filterable:"all",multiple:!0})]})).on("select",function(){var o=e.state().get("selection"),t=a.val();o.map(function(e){if((e=e.toJSON()).id){t=t?t+","+e.id:e.id;var a=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url,o="image";e.woo_variation_gallery_video&&(o+=" video"),i.append('<li class="'+o+'" data-attachment_id="'+e.id+'"><img src="'+a+'" /><ul class="actions"><li><a href="#" class="delete" title="'+n.data("delete")+'">'+n.data("text")+"</a></li></ul></li>")}}),a.val(t)}),e.open())})}},{key:"ImageUploader",value:function(){t(document).off("click",".add-woo-variation-gallery-image"),t(document).off("click",".woo-variation-gallery-images > li.image"),t(document).off("click",".woo_variation_gallery_media_video_popup_link"),t(document).off("click",".remove-woo-variation-gallery-image"),t(document).on("click",".add-woo-variation-gallery-image",this.AddImage),t(document).on("click",".woo-variation-gallery-images > li.image",this.ChangeImage),t(document).on("click",".remove-woo-variation-gallery-image",this.RemoveImage),t(document).on("click",".woo_variation_gallery_media_video_popup_link",this.AttachmentVideoPopup),t(".woocommerce_variation").each(function(){var e=t(this).find(".options:first");t(this).find(".woo-variation-gallery-wrapper").insertBefore(e)}),t(document).trigger("woo_variation_gallery_admin_pro_image_uploader_attached",this)}},{key:"ChangeImage",value:function(a){var i=this;a.preventDefault(),a.stopPropagation();var o=void 0,n=t(this).closest(".woo-variation-gallery-wrapper").data("product_variation_id"),r=t(this).find("input.wvg_variation_id_input").val();if(t(this).index(),"undefined"!=typeof wp&&wp.media&&wp.media.editor){if(o)return void o.open();(o=wp.media({title:woo_variation_gallery_admin.choose_image,button:{text:woo_variation_gallery_admin.update_image},library:{type:["image"]}})).on("select",function(){var a=o.state().get("selection").toJSON().map(function(e){if("image"===e.type){var a=e.id,i=e.woo_variation_gallery_video,o=e.sizes,t=(o=void 0===o?{}:o).thumbnail,r=o.full,l=t?t.url:r.url;return wp.template("woo-variation-gallery-image")({id:a,url:l,product_variation_id:n,woo_variation_gallery_video:i})}}).join("");t(i).after(a),_.delay(function(){t(i).remove()},1),e.Sortable(),e.VariationChanged(i)}),o.on("open",function(){var e=o.state().get("selection");if(r>0){var a=wp.media.attachment(r);a.fetch(),e.add(a?[a]:[])}}),o.open()}}},{key:"AddImage",value:function(a){var i=this;a.preventDefault(),a.stopPropagation();var o=void 0,n=t(this).closest(".woo-variation-gallery-wrapper").data("product_variation_id");if(t(this).find("input.wvg_variation_id_input").val(),"undefined"!=typeof wp&&wp.media&&wp.media.editor){if(o)return void o.open();(o=wp.media({title:woo_variation_gallery_admin.choose_image,button:{text:woo_variation_gallery_admin.add_image},library:{type:["image"]},multiple:"add"})).on("select",function(){var a=o.state().get("selection").toJSON().map(function(e){if("image"===e.type){var a=e.id,i=e.woo_variation_gallery_video,o=e.sizes,t=(o=void 0===o?{}:o).thumbnail,r=o.full,l=t?t.url:r.url;return wp.template("woo-variation-gallery-image")({id:a,url:l,product_variation_id:n,woo_variation_gallery_video:i})}}).join("");t(i).closest(".woo-variation-gallery-wrapper").find(".woo-variation-gallery-images").append(a),_.delay(function(){t(i).is("li.image")&&t(i).remove()},1),e.Sortable(),e.VariationChanged(i)}),o.open()}}},{key:"VariationChanged",value:function(e){t(e).closest(".woocommerce_variation").addClass("variation-needs-update"),t("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled"),t("#variable_product_options").trigger("woocommerce_variations_input_changed"),t(e).closest(".dokan-product-variation-itmes").addClass("variation-needs-update"),t(".dokan-product-variation-wrapper").trigger("dokan_variations_input_changed"),t(document).trigger("woo_variation_gallery_admin_variation_changed",this)}},{key:"RemoveImage",value:function(a){var i=this;a.preventDefault(),a.stopPropagation(),e.VariationChanged(this),_.delay(function(){t(i).parent().remove()},1)}},{key:"Sortable",value:function(){t(".woo-variation-gallery-images").sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"woo-variation-gallery-sortable-placeholder",start:function(e,a){a.item.css("background-color","#F6F6F6")},stop:function(e,a){a.item.removeAttr("style")},update:function(){e.VariationChanged(this)}})}},{key:"AttachmentVideoPopup",value:function(e){var a=this;e.preventDefault(),e.stopPropagation();var i=void 0;if("undefined"!=typeof wp&&wp.media&&wp.media.editor){if(i)return void i.open();(i=wp.media({title:woo_variation_gallery_admin.choose_video,button:{text:woo_variation_gallery_admin.add_video},library:{type:["video"]},multiple:!1})).on("select",function(){var e=i.state().get("selection").first().toJSON();"video"===e.type&&t(a).closest(".compat-attachment-fields").find(".compat-field-woo_variation_gallery_media_video input").val(e.url).change()}),i.on("open",function(){i.$el.find(".media-frame-content").addClass("wvg-media-frame-modify")}),i.open()}}}]),e}())},function(e,a){}]);