function searchbarInit(){let e=document.querySelectorAll(".tpgb-search-bar");e&&e.forEach(function(y){var s=y.querySelector(".tpgb-search-form"),b=y.querySelector(".tpgb-search-list-inner"),f=y.querySelector(".tpgb-search-area"),m=".tpgb-search-slider tpgb-row",h=y.querySelector(".tpgb-search-header"),v=y.dataset.ajax_search?JSON.parse(y.dataset.ajax_search):[],o=y.dataset.acfdata?JSON.parse(y.dataset.acfdata):[],i=y.dataset.genericfilter?JSON.parse(y.dataset.genericfilter):[],S=y.dataset.resultSetting?JSON.parse(y.dataset.resultSetting):[],x=y.dataset.paginationData?JSON.parse(y.dataset.paginationData):[],l=y.dataset.defaultData?JSON.parse(y.dataset.defaultData):[];b.style.transform="translateX(0)",y.querySelector(".tpgb-rental-overlay")&&tp_overlay_body(y);let e=y.querySelectorAll(".tpgb-sbar-dropdown");if(0<e.length&&e.forEach(function(e){e.addEventListener("click",function(){this.setAttribute("tabindex",1),this.classList.toggle("active");var e=this.querySelector(".tpgb-sbar-dropdown-menu");slideToggleP(e,300)}),e.addEventListener("focusout",function(){this.classList.remove("active");var e=this.querySelector(".tpgb-sbar-dropdown-menu");slideUpP(e,300)}),e.querySelectorAll(".tpgb-sbar-dropdown-menu .tpgb-searchbar-li").forEach(function(e){e.addEventListener("click",function(){var e=this.closest(".tpgb-sbar-dropdown");e.querySelector("span.search-selected-text").textContent=this.textContent;let t=e.querySelector("input");t.getAttribute("data-extra")?t.value=t.getAttribute("data-extra")+","+this.getAttribute("id"):t.value=this.getAttribute("id");var a=new Event("change",{bubbles:!0});e.querySelector("input").dispatchEvent(a)})})}),"yes"==v.ajax){var p=l&&l.SpecialCTP?l.SpecialCTP:0,c=v&&v.ajaxsearchCharLimit?v.ajaxsearchCharLimit:0;let e=new URLSearchParams(new FormData(s)).toString();e=e.split("&");var a={};e.forEach(function(e){var t=e.split("="),e=decodeURIComponent(t[0]),t=decodeURIComponent(t[1]);a[e]=t});var n={searchData:e,text:"",postper:v.post_page,GFilter:i,ACFilter:o,styleColumn:v.styleColumn,style:v.style,tempId:v.tempid,ResultData:x,DefaultData:l,resultSetting:S,nonce:v.nonce},r={searchData:a,GFilter:i,ACFilter:o,ResultData:x,DefaultData:l,resultSetting:S};f.querySelector(".post-load-more")&&tp_loadmore_ajax("",r,x,y,v),f.querySelector(".post-lazy-load")&&tp_lazymore_ajax(r,x,y,v);let t=f.querySelector(".tpgb-search-pagina");if(t&&""!=t.innerHTML){let e=t.getAttribute("data-pageColumn");e=e||"",tp_pagination_ajax(e,n,x,y,v)}s.addEventListener("keypress",function(e){var t=e.keyCode||e.which;if("Enter"===e.key||13===t)return e.stopPropagation(),e.preventDefault(),!1});var d=null;function u(e){var t=y.querySelectorAll("input[name^=taxonomy_]"),n=e.type,a=y.querySelector("input[name=s]")?y.querySelector("input[name=s]").value:"",r=y.querySelector("input[name=post_type]")?y.querySelector("input[name=post_type]").value:"",e=t[0]?t[0].value:"",t=t[1]?t[1].value:"";if("keyup"===n&&a&&a.length>=c||"change"===n&&(r&&0===p||r&&a&&a.length>=c||""===r&&a.length>=c||e&&0===p||e&&a&&a.length>=c||""===e&&a&&a.length>=c||t&&0===p||t&&a&&a.length>=c||""===t&&a&&a.length>=c)){let e=y.querySelector(".tpgb-close-btn"),t=y.querySelector(".tpgb-ajx-loading"),a=y.querySelector(".tpgb-dd-icon");n="keyup"===n?1e3:300;clearTimeout(d),d=setTimeout(function(){e&&(e.style.display="none"),y.classList.contains("tpgb-ser-input-dis")&&(a.style.display="none"),t&&(t.style.display="flex"),function(){var e=y.querySelector("input[name=s]")?y.querySelector("input[name=s]").value:"";b.innerHTML="";let t=h.querySelector(".tpgb-search-pagina");t&&(t.innerHTML="");let a=new URLSearchParams(new FormData(s)).toString();a=a.split("&");var n={};a.forEach(function(e){var t=e.split("="),e=decodeURIComponent(t[0]),t=decodeURIComponent(t[1]);n[e]=t});var u={GFilter:i,ACFilter:o,ResultData:x,DefaultData:l,resultSetting:S,searchData:n},g=new XMLHttpRequest;g.open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),g.onreadystatechange=function(){if(4===g.readyState){if(200===g.status){var e=JSON.parse(g.responseText),t=y.querySelectorAll(".tpgb-search-error"),a=y.querySelector(".tpgb-search-header");if(e.error&&0<t.length)return t[0].style.cssText="display:block",t[0].innerHTML=e.message,a.style.cssText="display:none",void slideDownP(f,100);t[0].style.cssText="display:none",a.style.cssText="display:flex",t[0].innerHTML="";var n=e.data||"";if(!n||0===n.post_count)return t[0].style.cssText="display:block",t[0].innerHTML=S.errormsg,a.style.cssText="display:none",void slideDownP(f,100);var r,s,o,i=n.posts,l="",p='<div class="'+m.replace(".","")+'">%s</div>',c="";for(r in slideDownP(f,100),i)c+=i[r],(parseInt(r)+1)%n.limit_query!=0&&parseInt(r)!==i.length-1||(l+=p.replace("%s",c),c="");b.innerHTML=l,S.TotalResult&&(o=S.TotalResultTxt||"",(s=h.querySelector(".tpgb-search-resultcount"))&&(s.innerHTML=n.post_count+" "+o)),n.pagination?(y.querySelector(".tpgb-search-pagina").innerHTML=n.pagination,tp_pagination_ajax(n.columns||"",u,x,y,v)):null!=n.loadmore?(s=y.querySelector(".tpgb-load-more"),n.loadmore?n.limit_query<n.total_count?(s.innerHTML=n.loadmore,tp_loadmore_ajax(n,u,x,y,v)):0<(o=y.querySelectorAll(".tpgb-search-pagina")).length&&(o[0].innerHTML=n.loadmore_page):s.innerHTML=""):n.lazymore&&(d=y.querySelector(".tpgb-lazy-load"),n.limit_query<n.total_count?(d.innerHTML=n.lazymore,tp_lazymore_ajax(u,x,y,v)):d.innerHTML="")}else console.error("Error:",g.status);var d=document.querySelectorAll(".tpgb-search-input");0<d.length&&d.forEach(function(e){setTimeout(function(){e.blur()},500)}),setTimeout(function(){var e=y.querySelector(".tpgb-close-btn"),t=y.querySelector(".tpgb-ajx-loading");t&&(t.style.cssText="display:none"),e&&(e.style.cssText="display:flex")},500),function(){let t=y.querySelector(".tpgb-search-area"),a=y.querySelector("input[name=s]"),n=y.querySelector(".tpgb-rental-overlay"),r=y.querySelector(".tpgb-close-btn"),s=y.querySelector(".tpgb-dd-icon");r&&r.addEventListener("click",e=>{a&&(a.value=""),e.currentTarget.style.display="none",slideUpP(t),n&&(n.style.cssText="visibility:hidden;opacity:0;"),y.classList.contains("tpgb-ser-input-dis")&&(s.style.cssText="display:flex")}),y.addEventListener("keyup",e=>{"Escape"===e.key&&(a.value="",slideUpP(t),r.style.cssText="display:none")})}()}},g.send("action=tpgb_search&nonce="+v.nonce+"&text="+e+"&postper="+v.post_page+"&styleColumn="+v.styleColumn+"&style="+v.style+"&tempId="+v.tempid+"&data="+JSON.stringify(u))}()},n)}}y.addEventListener("change",u),y.addEventListener("keyup",u)}})}function tp_loadmore_ajax(e,a,o,i,n){let l=i.querySelector(".post-load-more"),p=i.querySelector(".tpgb-search-slider"),c=i.querySelector(".tpgb-search-pagina");c&&e&&(c.innerHTML=e.loadmore_page),l&&l.addEventListener("click",function(e){var t=Number(this.dataset.page),r=Number(t+1),t=i.querySelectorAll(".tpgb-ser-item"),s=new XMLHttpRequest;s.open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.readyState&&(l.textContent=o.loadingtxt),s.onload=function(){if(200===s.status){var e=JSON.parse(s.responseText);l.textContent=o.loadbtntxt;var t=e.data.posts,e=e.data.total_count,a=null,n="";for(a in t)n+=t[a];p.innerHTML+=n,l.setAttribute("data-page",r),c&&(c.querySelector(".tpgb-load-number").textContent=r),i.querySelectorAll(".tpgb-ser-item").length==e&&(l.classList.add("tp-hide"),l.parentNode.innerHTML+='<div class="tpgb-post-loaded">'+o.loadedtxt+"</div>")}else console.error("Request failed. Status: "+s.status)},s.onerror=function(){console.error("Request failed")},s.send("action=tpgb_search&nonce="+n.nonce+"&text=&postper="+n.post_page+"&styleColumn="+n.styleColumn+"&style="+n.style+"&tempId="+n.tempid+"&data="+JSON.stringify(a)+"&offset="+t.length+"&loadNumpost="+o.loadnumber)})}function tp_lazymore_ajax(n,i,l,r){let p=l.querySelector(".post-lazy-load"),c=l.querySelector(".tpgb-search-slider");l.querySelectorAll(".tpgb-search-pagina");function s(){e.innerWidth,d=e.innerHeight,u=document.body.offsetHeight,y=l.querySelector(".tpgb-search-area").offsetHeight,b=l.querySelector(".tpgb-search-area").offsetTop+50,setTimeout(function(){y=l.querySelector(".tpgb-search-area").offsetHeight,b=l.querySelector(".tpgb-search-area").offsetTop+50},50)}var d,u,g,y,b,e=window;s(),e.addEventListener("resize",s),unbindEventListeners(window,"scroll"),bindEventListener(window,"scroll",function(e){e.preventDefault(),s(),g=window.pageYOffset||document.documentElement.scrollTop;let t=l.querySelector(".tpgb-search-area");y=t.offsetHeight,b=t.offsetTop+50;var a=t.querySelector(".post-lazy-load"),e=l.querySelectorAll(".tpgb-ser-item");{var o;a&&g<u&&y+b-d<g+60&&(a.dataset.requestRunning&&"true"==a.dataset.requestRunning||(a.dataset.requestRunning="true",(o=new XMLHttpRequest).open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){if(200===o.status&&o.status<400){var r,s=JSON.parse(o.responseText);let e=s.data.posts,t=s.data.total_count,a=null,n="";for(a in e)n+=e[a];c.innerHTML+=n,l.querySelectorAll(".tpgb-ser-item").length==t&&(p.classList.add("tp-hide"),(r=p.parentNode).innerHTML+='<div class="tpgb-post-loaded">'+i.loadedtxt+"</div>",i.loadedtxt&&setTimeout(()=>{r.innerHTML=""},1e3))}a.dataset.requestRunning="false"},o.send("action=tpgb_search&nonce="+r.nonce+"&text=&postper="+r.post_page+"&styleColumn="+r.styleColumn+"&style="+r.style+"&tempId="+r.tempid+"&data="+JSON.stringify(n)+"&offset="+e.length+"&loadNumpost="+i.loadnumber)))}})}function tp_pagination_ajax(i,l,e,p,c){let d=p.querySelector(".tpgb-search-list-inner"),u=p.querySelectorAll(".tpgb-pagelink.tpgb-ajax-page"),g=p.querySelector(".tpgb-pagelink.next"),y=p.querySelector(".tpgb-pagelink.prev"),a=e.Pcounter||0,b=e.PClimit||3;var f=e.PNavigation||0;l&&l.post_page&&l.post_page;0<u.length&&u.forEach(function(e,o){if(Number(e.dataset.page)==Number(1)){let e=p.querySelector(".tpgb-search-slider");e&&e.classList.add("ajax-"+Number(1))}else d&&(d.innerHTML+='<div class="tpgb-search-slider tpgb-row ajax-'+Number(o+1)+'"></div>');e.addEventListener("click",function(e){var t=this.dataset.page,n=100*o,a=p.querySelectorAll(".tpgb-ser-item");tp_pagination_active(u,t),f&&(y.setAttribute("data-prev",t),g.setAttribute("data-next",t));let r=d.querySelector(".tpgb-search-slider.ajax-"+t);if(r&&r.querySelector(".tpgb-ser-item"))return d.style.cssText="transform: translateX("+-n+"%)",void tp_pagination_hidden(i,p);var s=new XMLHttpRequest;s.open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){if(200===s.status){var e,t=JSON.parse(s.responseText).data.posts,a="";for(e in t)a+=t[e];r.innerHTML+=a,d.style.cssText="transform: translateX("+-n+"%)",tp_pagination_hidden(i,p)}else console.error("Request failed with status:",s.status)},s.send("action=tpgb_search&nonce="+c.nonce+"&text=&postper="+c.post_page+"&styleColumn="+c.styleColumn+"&style="+c.style+"&tempId="+c.tempid+"&data="+JSON.stringify(l)+"&offset="+a.length)})}),g&&g.addEventListener("click",function(e){var t=Number(this.dataset.next),n=t+Number(1),r=-(t*Number(100)),t=p.querySelectorAll(".tpgb-ser-item");l.offset=t.length,a&&u.forEach(function(e,t){var a;n==Number(e.dataset.page)&&e.classList.contains("tp-hide")&&(a=Number(t+1-b),e.classList.remove("tp-hide"),u.forEach(function(e,t){a==t+1&&e.classList.add("tp-hide")}))}),tp_pagination_active(u,n),f&&(y.setAttribute("data-prev",n),g.setAttribute("data-next",n));let s=d.querySelector(".tpgb-search-slider.ajax-"+n);if(s&&s.querySelector(".tpgb-ser-item"))return d.style.cssText="transform: translateX("+r+"%)",void tp_pagination_hidden(i,p);var o=new XMLHttpRequest;o.open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){if(200===o.status){var e,t=JSON.parse(o.responseText).data.posts,a="";for(e in t)a+=t[e];s.innerHTML+=a,d.style.cssText="transform: translateX("+r+"%)",tp_pagination_hidden(i,p)}else console.error("Request failed with status:",o.status)},o.send("action=tpgb_search&nonce="+c.nonce+"&text=&postper="+c.post_page+"&styleColumn="+c.styleColumn+"&style="+c.style+"&tempId="+c.tempid+"&data="+JSON.stringify(l)+"&offset="+t.length)}),y&&y.addEventListener("click",function(e){var n=Number(this.dataset.prev)-Number(1),r=-100*n+100,t=p.querySelectorAll(".tpgb-ser-item");a&&u.forEach(function(e,t){var a;n==Number(e.dataset.page)&&e.classList.contains("tp-hide")&&(a=Number(t+1)+Number(b),e.classList.remove("tp-hide"),u.forEach(function(e,t){a==t+1&&e.classList.add("tp-hide")}))}),tp_pagination_active(u,n),f&&(y.setAttribute("data-prev",n),g.setAttribute("data-next",n));let s=d.querySelector(".tpgb-search-slider.ajax-"+n);if(s&&s.querySelector(".tpgb-ser-item"))return d.style.cssText="transform: translateX("+r+"%)",void tp_pagination_hidden(i,p);var o=new XMLHttpRequest;o.open("POST",tpgb_config&&tpgb_config.ajax_url?tpgb_config.ajax_url:tpgb_load.ajaxUrl,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){if(200===o.status){var e,t=JSON.parse(o.responseText).data.posts,a="";for(e in t)a+=t[e];s.innerHTML+=a,d.style.cssText="transform: translateX("+r+"%)",tp_pagination_hidden(i,p)}else console.error("Request failed with status:",o.status)},o.send("action=tpgb_search&nonce="+c.nonce+"&text=&postper="+c.post_page+"&styleColumn="+c.styleColumn+"&style="+c.style+"&tempId="+c.tempid+"&data="+JSON.stringify(l)+"&offset="+t.length)})}function tp_pagination_hidden(a,n){if(a){let e=n.querySelector(".tpgb-pagelink.next"),t=n.querySelector(".tpgb-pagelink.prev");e&&(n=e.dataset&&e.dataset.next?e.dataset.next:"",parseInt(n)==a?e.style.display="none":e.style.display="inline-block"),t&&(a=t.dataset&&t.dataset.prev?t.dataset.prev:"",1==parseInt(a)?t.style.display="none":t.style.display="inline-block")}}function tp_pagination_active(e,t){0<e.length&&e.forEach(function(e){t==Number(e.dataset.page)?e.classList.add("active"):e.classList.contains("active")&&e.classList.remove("active")})}function tp_overlay_body(e){let t=e.querySelector(".tpgb-rental-overlay"),a=e.querySelector(".tpgb-input-field"),n=e.querySelector(".tpgb-search-input");n&&(n.addEventListener("focus",()=>{t.style.cssText="visibility:visible;opacity:1;",a.style.cssText="z-index:1000;"}),n.addEventListener("focusout",()=>{t.style.cssText="visibility:hidden;opacity:0;",a.style.cssText=""}));let r=e.querySelector(".tpgb-select");r&&r.addEventListener("click",()=>{t.style.cssText="visibility:visible;opacity:1;"}),t&&t.addEventListener("click",()=>{t.style.cssText="visibility:hidden;opacity:0;"}),e.addEventListener("keyup",e=>{"Escape"===e.key&&(t.style.cssText="visibility:hidden;opacity:0;")})}function bindEventListener(e,t,a){e.eventListeners||(e.eventListeners={}),e.eventListeners[t]||(e.eventListeners[t]=[]),e.addEventListener(t,a),e.eventListeners[t].push(a)}function unbindEventListeners(t,a){t.eventListeners&&t.eventListeners[a]&&(t.eventListeners[a].forEach(e=>{t.removeEventListener(a,e)}),t.eventListeners[a]=[])}document.addEventListener("DOMContentLoaded",function(){searchbarInit(document)});