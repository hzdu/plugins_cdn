!function(){var e={20:function(e,t,r){"use strict";var o=r(609),n=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,s=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var o,a={},c=null,u=null;for(o in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,o)&&!l.hasOwnProperty(o)&&(a[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===a[o]&&(a[o]=t[o]);return{$$typeof:n,type:e,key:c,ref:u,props:a,_owner:s.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},556:function(e,t,r){e.exports=r(694)()},609:function(e){"use strict";e.exports=window.React},694:function(e,t,r){"use strict";var o=r(925);function n(){}function a(){}a.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,a,i){if(i!==o){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:n};return r.PropTypes=r,r}},848:function(e,t,r){"use strict";e.exports=r(20)},925:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},942:function(e,t){var r;!function(){"use strict";var o={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=i(e,a(r)))}return e}function a(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)o.call(e,r)&&e[r]&&(t=i(t,r));return t}function i(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=Array(t);r<t;r++)o[r]=e[r];return o}function t(t,r){if(t){if("string"==typeof t)return e(t,r);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,r):void 0}}function o(r){return function(t){if(Array.isArray(t))return e(t)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||t(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=window.wp.hooks,a=window.wp.i18n,i=window.wc.components,s=window.wp.apiFetch,l=r.n(s),c=window.wp.url,u=window.wc.navigation,d=function(e){return e},p=function(e){return{key:e.id,label:e.title}},m={name:"workflows",options:function(e){return l()({path:"/automatewoo/workflows?"+new URLSearchParams({search:e,per_page:10,orderby:"popularity",_fields:"id,title"}).toString()})},getOptionIdentifier:function(e){return e.id},getOptionLabel:function(e){return e.title},getOptionKeywords:function(e){return[e.title]},getOptionCompletion:p},f=[{label:(0,a.__)("Show","automatewoo"),staticParams:["section","paged","per_page"],param:"filter",showFilters:function(){return!0},filters:[{label:(0,a.__)("All Workflows","automatewoo"),value:"all"},{label:(0,a.__)("Single Workflow","automatewoo"),value:"select_workflow",subFilters:[{component:"Search",value:"single_workflow",path:["select_workflow"],settings:{type:"custom",param:"workflows",getLabels:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o="function"==typeof e?e(arguments.length>1?arguments[1]:void 0):e,n=(0,u.getIdsFromQuery)(r);if(n.length<1)return Promise.resolve([]);var a={include:n.join(","),per_page:n.length};return l()({path:(0,c.addQueryArgs)(o,a)}).then((function(e){return e.map(t)}))}}("/automatewoo/workflows",p),labels:{placeholder:(0,a.__)("Type to search for a workflow","automatewoo"),button:(0,a.__)("Single Workflow","automatewoo")},autocompleter:m}}]}]}];function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function g(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}function h(e,t,r){return(t=g(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,g(o.key),o)}}function w(e,t,r){return t&&v(e.prototype,t),r&&v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _(e,t){if(t&&("object"==y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function O(e){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}var S=window.wp.element,k=window.wp.compose,R=window.wp.date,C=window.wp.data,T=window.lodash,P=r(556),q=r.n(P),D=window.wc.data,E=window.wc.date,F=window.wc.currency,N=r.n(F),A=window.wc.wcSettings,I=(0,A.getSetting)("currency"),L=N()(I),B=function(e){var t=L.getCurrencyConfig(),r=(0,n.applyFilters)("woocommerce_admin_report_currency",t,e);return N()(r)},Q=(0,S.createContext)(L),M=r(848);function V(e){var t=e.className,r=(0,a.__)("There was an error getting your stats. Please try again.","woocommerce"),o=(0,a.__)("Reload","woocommerce");return(0,M.jsx)(i.EmptyContent,{className:t,title:r,actionLabel:o,actionCallback:function(){window.location.reload()}})}V.propTypes={className:q().string};var U=V;function W(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||0===e.length)return null;var o=e.slice(0),n=o.pop();if(n.showFilters(t,r)){var a=(0,u.flattenFilters)(n.filters),i=t[n.param]||n.defaultValue||"all";return(0,T.find)(a,{value:i})}return W(o,t,r)}function H(e){return function(t){return(0,R.format)(e,t)}}function Y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return t=O(t),_(e,G()?Reflect.construct(t,r||[],O(e).constructor):t.apply(e,r))}function G(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(G=function(){return!!e})()}var $=function(e){function t(){return b(this,t),z(this,t,arguments)}return x(t,e),w(t,[{key:"shouldComponentUpdate",value:function(e){return e.isRequesting!==this.props.isRequesting||e.primaryData.isRequesting!==this.props.primaryData.isRequesting||e.secondaryData.isRequesting!==this.props.secondaryData.isRequesting||!(0,T.isEqual)(e.query,this.props.query)}},{key:"getItemChartData",value:function(){var e=this.props,t=e.primaryData,r=e.selectedChart;return t.data.intervals.map((function(e){var t={};return e.subtotals.segments.forEach((function(e){if(e.segment_label){var o=t[e.segment_label]?e.segment_label+" (#"+e.segment_id+")":e.segment_label;t[e.segment_id]={label:o,value:e.subtotals[r.key]||0}}})),K({date:(0,R.format)("Y-m-d\\TH:i:s",e.date_start)},t)}))}},{key:"getTimeChartData",value:function(){var e=this.props,t=e.query,r=e.primaryData,o=e.secondaryData,n=e.selectedChart,a=e.defaultDateRange,i=(0,E.getIntervalForQuery)(t,a),s=(0,E.getCurrentDates)(t,a),l=s.primary,c=s.secondary;return r.data.intervals.map((function(e,r){var a=(0,E.getPreviousDate)(e.date_start,l.after,c.after,t.compare,i),s=o.data.intervals[r];return{date:(0,R.format)("Y-m-d\\TH:i:s",e.date_start),primary:{label:"".concat(l.label," (").concat(l.range,")"),labelDate:e.date_start,value:e.subtotals[n.key]||0},secondary:{label:"".concat(c.label," (").concat(c.range,")"),labelDate:a.format("YYYY-MM-DD HH:mm:ss"),value:s&&s.subtotals[n.key]||0}}}))}},{key:"getTimeChartTotals",value:function(){var e=this.props,t=e.primaryData,r=e.secondaryData,o=e.selectedChart;return{primary:(0,T.get)(t,["data","totals",o.key],null),secondary:(0,T.get)(r,["data","totals",o.key],null)}}},{key:"renderChart",value:function(e,t,r,o){var n=this.props,s=n.emptySearchResults,l=n.filterParam,c=n.interactiveLegend,u=n.itemsLabel,d=n.legendPosition,p=n.path,m=n.query,f=n.selectedChart,y=n.showHeaderControls,g=n.primaryData,h=n.defaultDateRange,b=(0,E.getIntervalForQuery)(m,h),v=(0,E.getAllowedIntervalsForQuery)(m,h),w=(0,E.getDateFormatsForInterval)(b,g.data.intervals.length,{type:"php"}),_=s?(0,a.__)("No data for the current search","woocommerce"):(0,a.__)("No data for the selected date range","woocommerce"),O=this.context,j=O.formatAmount,x=O.getCurrencyConfig;return(0,M.jsx)(i.Chart,{allowedIntervals:v,data:r,dateParser:"%Y-%m-%dT%H:%M:%S",emptyMessage:_,filterParam:l,interactiveLegend:c,interval:b,isRequesting:t,itemsLabel:u,legendPosition:d,legendTotals:o,mode:e,path:p,query:m,screenReaderFormat:H(w.screenReaderFormat),showHeaderControls:y,title:f.label,tooltipLabelFormat:H(w.tooltipLabelFormat),tooltipTitle:"time-comparison"===e&&f.label||null,tooltipValueFormat:(0,D.getTooltipValueFormat)(f.type,j),chartType:(0,E.getChartTypeForQuery)(m),valueType:f.type,xFormat:H(w.xFormat),x2Format:H(w.x2Format),currency:x()})}},{key:"renderItemComparison",value:function(){var e=this.props,t=e.isRequesting,r=e.primaryData;if(r.isError)return(0,M.jsx)(U,{});var o=t||r.isRequesting,n=this.getItemChartData();return this.renderChart("item-comparison",o,n)}},{key:"renderTimeComparison",value:function(){var e=this.props,t=e.isRequesting,r=e.primaryData,o=e.secondaryData;if(!r||r.isError||o.isError)return(0,M.jsx)(U,{});var n=t||r.isRequesting||o.isRequesting,a=this.getTimeChartData(),i=this.getTimeChartTotals();return this.renderChart("time-comparison",n,a,i)}},{key:"render",value:function(){return"item-comparison"===this.props.mode?this.renderItemComparison():this.renderTimeComparison()}}])}(S.Component);$.contextType=Q,$.propTypes={filters:q().array,isRequesting:q().bool,itemsLabel:q().string,limitProperties:q().array,mode:q().string,path:q().string.isRequired,primaryData:q().object,query:q().object.isRequired,secondaryData:q().object,selectedChart:q().shape({key:q().string.isRequired,label:q().string.isRequired,order:q().oneOf(["asc","desc"]),orderby:q().string,type:q().oneOf(["average","number","currency"]).isRequired}).isRequired},$.defaultProps={isRequesting:!1,primaryData:{data:{intervals:[]},isError:!1,isRequesting:!1},secondaryData:{data:{intervals:[]},isError:!1,isRequesting:!1}};var J=(0,k.compose)((0,C.withSelect)((function(e,t){var r=t.charts,o=t.endpoint,n=t.filters,a=t.isRequesting,i=t.limitProperties,s=t.query,l=t.advancedFilters,c=i||[o],u=W(n,s),d=(0,T.get)(u,["settings","param"]),p=t.mode||function(e,t){if(e&&t){var r=(0,T.get)(e,["settings","param"]);if(!r||Object.keys(t).includes(r))return(0,T.get)(e,["chartMode"])}return null}(u,s)||"time-comparison",m=e(D.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings").woocommerce_default_date_range,f=e(D.REPORTS_STORE_NAME),y={mode:p,filterParam:d,defaultDateRange:m};if(a)return y;var g=c.some((function(e){return s[e]&&s[e].length}));if(s.search&&!g)return K(K({},y),{},{emptySearchResults:!0});var h=r&&r.map((function(e){return e.key})),b=(0,D.getReportChartData)({endpoint:o,dataType:"primary",query:s,selector:f,limitBy:c,filters:n,advancedFilters:l,defaultDateRange:m,fields:h});if("item-comparison"===p)return K(K({},y),{},{primaryData:b});var v=(0,D.getReportChartData)({endpoint:o,dataType:"secondary",query:s,selector:f,limitBy:c,filters:n,advancedFilters:l,defaultDateRange:m,fields:h});return K(K({},y),{},{primaryData:b,secondaryData:v})})))($),X=window.wc.number,Z=window.wc.tracks;function ee(e,t,r){return t=O(t),_(e,te()?Reflect.construct(t,r||[],O(e).constructor):t.apply(e,r))}function te(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(te=function(){return!!e})()}var re=function(e){function t(){return b(this,t),ee(this,t,arguments)}return x(t,e),w(t,[{key:"formatVal",value:function(e,t){var r=this.context,o=r.formatAmount,n=r.getCurrencyConfig;return"currency"===t?o(e):(0,X.formatValue)(n(),t,e)}},{key:"getValues",value:function(e,t){var r=this.props,o=r.emptySearchResults,n=r.summaryData.totals,a=n.primary?n.primary[e]:0,i=n.secondary?n.secondary[e]:0,s=o?0:a,l=o?0:i;return{delta:(0,X.calculateDelta)(s,l),prevValue:this.formatVal(l,t),value:this.formatVal(s,t)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.charts,o=t.query,n=t.selectedChart,s=t.summaryData,l=t.endpoint,c=t.report,d=t.defaultDateRange,p=s.isError,m=s.isRequesting;if(p)return(0,M.jsx)(U,{});if(m)return(0,M.jsx)(i.SummaryListPlaceholder,{numberOfItems:r.length});var f=(0,E.getDateParamsFromQuery)(o,d).compare;return(0,M.jsx)(i.SummaryList,{children:function(t){var o=t.onToggle;return r.map((function(t){var r=t.key,s=t.order,d=t.orderby,p=t.label,m=t.type,y=t.isReverseTrend,g=t.labelTooltipText,h={chart:r};d&&(h.orderby=d),s&&(h.order=s);var b=(0,u.getNewPath)(h),v=n.key===r,w=e.getValues(r,m),_=w.delta,O=w.prevValue,j=w.value;return(0,M.jsx)(i.SummaryNumber,{delta:_,href:b,label:p,reverseTrend:y,prevLabel:"previous_period"===f?(0,a.__)("Previous period:","woocommerce"):(0,a.__)("Previous year:","woocommerce"),prevValue:O,selected:v,value:j,labelTooltipText:g,onLinkClickCallback:function(){o&&o(),(0,Z.recordEvent)("analytics_chart_tab_click",{report:c||l,key:r})}},r)}))}})}}])}(S.Component);re.propTypes={charts:q().array.isRequired,endpoint:q().string.isRequired,limitProperties:q().array,query:q().object.isRequired,selectedChart:q().shape({key:q().string.isRequired,label:q().string.isRequired,order:q().oneOf(["asc","desc"]),orderby:q().string,type:q().oneOf(["average","number","currency"]).isRequired}).isRequired,summaryData:q().object,report:q().string},re.defaultProps={summaryData:{totals:{primary:{},secondary:{}},isError:!1}},re.contextType=Q;var oe=(0,k.compose)((0,C.withSelect)((function(e,t){var r=t.charts,o=t.endpoint,n=t.limitProperties,a=t.query,i=t.filters,s=t.advancedFilters,l=n||[o],c=l.some((function(e){return a[e]&&a[e].length}));if(a.search&&!c)return{emptySearchResults:!0};var u=r&&r.map((function(e){return e.key})),d=e(D.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings").woocommerce_default_date_range;return{summaryData:(0,D.getSummaryNumbers)({endpoint:o,query:a,select:e,limitBy:l,filters:i,advancedFilters:s,defaultDateRange:d,fields:u}),defaultDateRange:d}})))(re);function ne(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,a,i,s=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(o=a.call(r)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return s}}(e,r)||t(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e,t,r,o,n,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(o,n)}function ie(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var a=e.apply(t,r);function i(e){ae(a,o,n,i,s,"next",e)}function s(e){ae(a,o,n,i,s,"throw",e)}i(void 0)}))}}var se=window.regeneratorRuntime,le=r.n(se),ce=window.wp.components,ue=window.AutomateWoo.Modal,de=r.n(ue);function pe(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;r[o]=e[o]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)r=a[o],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var me=window.wp.dom,fe=window.wc.csvExport,ye=r(942),ge=r.n(ye),he=function(){return(0,M.jsx)("svg",{role:"img","aria-hidden":"true",focusable:"false",version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24",children:(0,M.jsx)("path",{d:"M18,9c-0.009,0-0.017,0.002-0.025,0.003C17.72,5.646,14.922,3,11.5,3C7.91,3,5,5.91,5,9.5c0,0.524,0.069,1.031,0.186,1.519 C5.123,11.016,5.064,11,5,11c-2.209,0-4,1.791-4,4c0,1.202,0.541,2.267,1.38,3h18.593C22.196,17.089,23,15.643,23,14 C23,11.239,20.761,9,18,9z M12,16l-4-5h3V8h2v3h3L12,16z"})})};function be(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?be(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):be(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var we=["className","getHeadersContent","getRowsContent","getSummary","isRequesting","primaryData","tableData","endpoint","itemIdField","tableQuery","compareBy","compareParam","searchBy","labels","checkboxes","renderActionButton"],_e=["updateUserPreferences"];function Oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function je(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(r),!0).forEach((function(t){h(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var xe=function(e){var t=e.className,r=e.getHeadersContent,s=e.getRowsContent,l=e.getSummary,c=e.isRequesting,d=e.primaryData,p=e.tableData,m=e.endpoint,f=(e.itemIdField,e.tableQuery,e.compareBy),y=e.compareParam,g=e.searchBy,b=e.labels,v=void 0===b?{}:b,w=e.checkboxes,_=e.renderActionButton,O=pe(e,we),j=e.query,x=e.columnPrefsKey,k=p.items,R=p.query,C=j[y]?(0,u.getIdsFromQuery)(j[f]):[],P=ne((0,S.useState)(C),2),q=P[0],E=P[1],F=(0,S.useRef)(null),N=(0,D.useUserPreferences)(),A=N.updateUserPreferences,I=pe(N,_e);if(p.isError||d.isError)return(0,M.jsx)(U,{});var L=[];x&&(L=I&&I[x]?I[x]:L);var B,Q,V,W,H=function(e,t,o){var a=l?l(t,o):null;return(0,n.applyFilters)("woocommerce_admin_report_table",{endpoint:m,headers:r(),rows:s(e),totals:t,summary:a,items:k})},Y=function(t,r){var n=e.ids;if(r)E((0,T.uniq)([n[t]].concat(o(q))));else{var a=q.indexOf(n[t]);E([].concat(o(q.slice(0,a)),o(q.slice(a+1))))}},K=function(t){var r=e.ids,o=void 0===r?[]:r,n=-1!==q.indexOf(o[t]);return{display:(0,M.jsx)(ce.CheckboxControl,{onChange:(0,T.partial)(Y,t),checked:n}),value:!1}},z=c||p.isRequesting||d.isRequesting,G=(0,T.get)(d,["data","totals"],{}),$=k.totalResults||0,J=$>0,X=(0,u.getSearchWords)(j).map((function(e){return{key:e,label:e}})),ee=k.data,te=H(ee,G,$),re=te.headers,oe=te.rows,ae=te.summary;(w||f)&&(oe=oe.map((function(e,t){return[K(t)].concat(o(e))})),re=[(B=e.ids,Q=void 0===B?[]:B,V=Q.length>0,W=V&&Q.length===q.length,{cellClassName:"is-checkbox-column",key:"compare",label:(0,M.jsx)(ce.CheckboxControl,{onChange:function(t){var r=e.ids;E(t?r:[])},"aria-label":(0,a.__)("Select All","woocommerce"),checked:W,disabled:!V}),required:!0})].concat(o(re)));var ie=function(e,t){return t?e.map((function(e){return je(je({},e),{},{visible:e.required||!t.includes(e.key)})})):e.map((function(e){return je(je({},e),{},{visible:e.required||!e.hiddenByDefault})}))}(re,L);return(0,M.jsxs)(S.Fragment,{children:[(0,M.jsx)("div",{className:"woocommerce-report-table__scroll-point automatewoo-clone",ref:F,"aria-hidden":!0}),(0,M.jsx)(i.TableCard,je({className:ge()("woocommerce-report-table","automatewoo-clone",t),hasSearch:!!g,actions:[_&&_({selectedRows:q}),f&&(0,M.jsx)(i.CompareButton,{className:"woocommerce-table__compare",count:q.length,helpText:v.helpText||(0,a.__)("Check at least two items below to compare","woocommerce"),onClick:function(){f&&(0,u.onQueryChange)("compare")(f,y,q.join(","))},disabled:!J,children:v.compareButton||(0,a.__)("Compare","woocommerce")},"compare"),g&&(0,M.jsx)(i.Search,{allowFreeTextSearch:!0,inlineTags:!0,onChange:function(t){var r=e.baseSearchQuery,o=e.addCesSurveyForCustomerSearch,n=t.map((function(e){return e.label.replace(",","%2C")}));n.length?((0,u.updateQueryString)(je(je(h(h({filter:void 0},y,void 0),g,void 0),r),{},{search:(0,T.uniq)(n).join(",")})),o()):(0,u.updateQueryString)({search:void 0}),(0,Z.recordEvent)("analytics_table_filter",{report:m})},placeholder:v.placeholder||(0,a.__)("Search by item name","woocommerce"),selected:X,showClearButton:!0,type:g,disabled:!J},"search"),J&&(0,M.jsxs)(ce.Button,{className:"woocommerce-table__download-button",disabled:z,onClick:function(){var t=e.createNotice,r=e.startExport,o=e.title,n=Object.assign({},j),i=k.data,s=k.totalResults,l="browser";if(delete n.extended_info,n.search&&delete n[g],i&&i.length===s){var c=H(i,s),u=c.headers,d=c.rows;(0,fe.downloadCSVFile)((0,fe.generateCSVFileName)(o,n),(0,fe.generateCSVDataFromTable)(u,d))}else l="email",r(m,R).then((function(){return t("success",(0,a.sprintf)(/* translators: %s = type of report */ /* translators: %s = type of report */
(0,a.__)("Your %s Report will be emailed to you.","woocommerce"),o))})).catch((function(e){return t("error",e.message||(0,a.sprintf)(/* translators: %s = type of report */ /* translators: %s = type of report */
(0,a.__)("There was a problem exporting your %s Report. Please try again.","woocommerce"),o))}));(0,Z.recordEvent)("analytics_table_download",{report:m,rows:s,download_type:l})},children:[(0,M.jsx)(he,{}),(0,M.jsx)("span",{className:"woocommerce-table__download-button__label",children:v.downloadButton||(0,a.__)("Download","woocommerce")})]},"download")],headers:ie,isLoading:z,onQueryChange:u.onQueryChange,onColumnsChange:function(e,t){var r=re.map((function(e){return e.key})).filter((function(t){return!e.includes(t)}));if(x){var o=h({},x,r);A(o)}if(t){var n={report:m,column:t,status:e.includes(t)?"on":"off"};(0,Z.recordEvent)("analytics_table_header_toggle",n)}},onSort:function(e,t){(0,u.onQueryChange)("sort")(e,t);var r={report:m,column:e,direction:t};(0,Z.recordEvent)("analytics_table_sort",r)},onPageChange:function(e,t){F.current.scrollIntoView();var r=F.current.nextSibling.querySelector(".woocommerce-table__table"),o=me.focus.focusable.find(r);o.length&&o[0].focus(),t&&("goto"===t?(0,Z.recordEvent)("analytics_table_go_to_page",{report:m,page:e}):(0,Z.recordEvent)("analytics_table_page_click",{report:m,direction:t}))},rows:oe,rowsPerPage:parseInt(R.per_page,10)||D.QUERY_DEFAULTS.pageSize,summary:ae,totalRows:$},O))]})};xe.propTypes={className:q().string,baseSearchQuery:q().object,compareBy:q().string,compareParam:q().string,columnPrefsKey:q().string,endpoint:q().string,extendItemsMethodNames:q().shape({getError:q().string,isRequesting:q().string,load:q().string}),extendedItemsStoreName:q().string,getHeadersContent:q().func.isRequired,getRowsContent:q().func.isRequired,getSummary:q().func,itemIdField:q().string,labels:q().shape({compareButton:q().string,downloadButton:q().string,helpText:q().string,placeholder:q().string}),primaryData:q().object,searchBy:q().string,summaryFields:q().arrayOf(q().string),tableData:q().object.isRequired,tableQuery:q().object,title:q().string.isRequired,checkboxes:q().bool,renderActionButton:q().func},xe.defaultProps={primaryData:{},tableData:{items:{data:[],totalResults:0},query:{}},tableQuery:{},compareParam:"filter",downloadable:!1,onSearch:T.noop,baseSearchQuery:{}};var Se=[],ke={},Re=(0,k.compose)((0,C.withSelect)((function(e,t){var r=t.endpoint,o=t.getSummary,n=t.isRequesting,a=t.itemIdField,i=t.query,s=t.tableData,l=t.tableQuery,c=t.filters,u=t.advancedFilters,d=t.summaryFields,p=t.extendedItemsStoreName,m=e(D.REPORTS_STORE_NAME),f=p?e(p):null,y=e(D.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings").woocommerce_default_date_range,g=i.search&&!(i[r]&&i[r].length);if(n||g)return ke;var h="categories"===r?"products":r,b=o?(0,D.getReportChartData)({endpoint:h,selector:m,dataType:"primary",query:i,filters:c,advancedFilters:u,defaultDateRange:y,fields:d}):ke,v=s||(0,D.getReportTableData)({endpoint:r,query:i,selector:m,tableQuery:l,filters:c,advancedFilters:u,defaultDateRange:y}),w=f?function(e,t,r){var o=t.extendItemsMethodNames,n=t.itemIdField,a=r.items.data;if(!(Array.isArray(a)&&a.length&&o&&n))return r;var i=e[o.getError],s=e[o.isRequesting],l=e[o.load],c={include:a.map((function(e){return e[n]})).join(","),per_page:a.length},u=l(c),d=!!s&&s(c),p=!!i&&i(c),m=a.map((function(e){var t=(0,T.first)(u.filter((function(t){return e.id===t.id})));return ve(ve({},e),t)})),f=r.isRequesting||d,y=r.isError||p;return ve(ve({},r),{},{isRequesting:f,isError:y,items:ve(ve({},r.items),{},{data:m})})}(f,t,v):v;return{primaryData:b,ids:a&&w.items.data?w.items.data.map((function(e){return e[a]})):Se,tableData:w,query:i}})),(0,C.withDispatch)((function(e){var t=e(D.EXPORT_STORE_NAME).startExport;return{createNotice:e("core/notices").createNotice,startExport:t,addCesSurveyForCustomerSearch:e("wc/customer-effort-score").addCesSurveyForCustomerSearch}})))(xe),Ce=function(){var e=ie(le().mark((function e(t){var r,o;return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,C.dispatch)("core/notices"),o=r.createNotice,e.prev=1,e.next=2,l()({path:"/automatewoo/conversions/batch/",method:"DELETE",body:JSON.stringify({ids:t})});case 2:e.next=4;break;case 3:return e.prev=3,e.catch(1),o("error",(0,a.__)("There was an error unmarking conversions.","automatewoo")),e.abrupt("return");case 4:o("success",(0,a.__)("Orders successfully unmarked as conversions.","automatewoo"));case 5:case"end":return e.stop()}}),e,null,[[1,3]])})));return function(_x){return e.apply(this,arguments)}}();function Te(e){var t=e.query,r=e.filters,o=(0,C.useDispatch)(D.REPORTS_STORE_NAME).invalidateResolutionForStoreSelector,n=(0,A.getSetting)("admin",{}).dateFormat||E.defaultTableDateFormat,s=B(t),l=s.formatAmount,c=s.getCurrencyConfig,u=ne((0,S.useState)(!1),2),d=u[0],p=u[1],m=(0,S.useCallback)(function(){var e=ie(le().mark((function e(t){return le().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=2;break}return p(!0),e.next=1,Ce(t);case 1:p(!1),o("getReportStats"),o("getReportItems");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,o]);return(0,M.jsx)(Re,{className:"aw-conversions-table",endpoint:"conversions",getHeadersContent:function(){return[{key:"order",label:(0,a.__)("Order #","automatewoo"),screenReaderLabel:(0,a.__)("Order Number","automatewoo"),required:!0},{key:"customer",label:(0,a.__)("Customer","automatewoo"),isLeftAligned:!0},{key:"Workflow",label:(0,a.__)("Workflow","automatewoo"),isLeftAligned:!0},{key:"log",label:(0,a.__)("Log","automatewoo"),isLeftAligned:!0},{key:"interacted",label:(0,a.__)("First Interacted","automatewoo")},{key:"placed",label:(0,a.__)("Order Placed","automatewoo")},{key:"total",label:(0,a.__)("Order Total","automatewoo"),isCurrency:!0,isNumeric:!0}]},getRowsContent:function(e){return e.map((function(e){var t=e.order_id,r=e.order_number,o=e.workflow_id,a=e.conversion_id,s=e.date_created,c=e.total_sales,u=e.extended_info,d=u.conversion.date_opened,p=u.customer,m=p.user_id,f=p.first_name,y=p.last_name,g=u.workflow.name,h="".concat(f," ").concat(y);return[{display:(0,M.jsx)(i.Link,{href:"post.php?post=".concat(t,"&action=edit"),type:"wp-admin",children:(0,M.jsx)("strong",{children:r})}),value:t},{display:null===m?h:(0,M.jsx)(i.Link,{href:"user-edit.php?user_id=".concat(m,"&action=edit"),type:"wp-admin",children:h}),value:"".concat(h," (").concat(null===m?"guest":m,")")},{display:(0,M.jsx)(i.Link,{href:"post.php?post=".concat(o,"&action=edit"),type:"wp-admin",children:(0,M.jsx)("strong",{children:g})}),value:o},{display:(0,M.jsx)("a",{className:de().triggerClasses.openLink,href:"admin-ajax.php?action=aw_modal_log_info&log_id=".concat(a),children:a}),value:a},{display:(0,M.jsx)(i.Date,{date:d,visibleFormat:n}),value:d},{display:(0,M.jsx)(i.Date,{date:s,visibleFormat:n}),value:s},{display:l(c),value:c}]}))},getSummary:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.total_sales,o=void 0===r?0:r,n=e.net_revenue,i=void 0===n?0:n,s=c();return[{label:(0,a._n)("Conversion","Conversions",t,"automatewoo"),value:(0,X.formatValue)(s,"number",t)},{label:(0,a.__)("Total sales","automatewoo"),value:l(o)},{label:(0,a.__)("Net sales","automatewoo"),value:l(i)}]},summaryFields:["total_sales","net_revenue","orders_count"],itemIdField:"order_id",query:t,tableQuery:{orderby:t.orderby||"date",order:t.order||"desc",extended_info:!0},title:(0,a.__)("Conversions list","automatewoo"),columnPrefsKey:"conversions_report_columns",filters:r,checkboxes:!0,renderActionButton:function(e){var t=e.selectedRows;return(0,M.jsx)(ce.Tooltip,{text:(0,a.__)("Unmark selected orders as conversions","automatewoo"),children:(0,M.jsx)(ce.Button,{disabled:d||0===t.length,variant:"secondary",onClick:function(){return m(t)},children:(0,a.__)("Unmark","automatewoo")})})}})}var Pe=[{key:"total_sales",href:"",label:(0,a.__)("Total value","automatewoo"),labelTooltipText:(0,a.__)("Converted order value","automatewoo"),type:"currency"},{key:"net_revenue",href:"",label:(0,a.__)("Net revenue","automatewoo"),type:"currency"},{key:"orders_count",href:"",label:(0,a.__)("Orders","automatewoo"),labelTooltipText:(0,a.__)("Converted orders","automatewoo"),type:"number"}];function qe(e){var t=e.query,r=e.path,o=Pe.find((function(e){return e.key===t.chart}))||Pe[0];return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(i.ReportFilters,{query:t,path:r,filters:f}),(0,M.jsx)(oe,{charts:Pe,endpoint:"conversions",query:t,selectedChart:o,filters:f}),(0,M.jsx)(J,{endpoint:"conversions",path:r,query:t,filters:f,selectedChart:o,charts:Pe}),(0,M.jsx)(Te,{query:t,filters:f})]})}var De=[{key:"sent",href:"",label:(0,a.__)("Sent","automatewoo"),labelTooltipText:(0,a.__)("Trackable messages sent","automatewoo"),type:"number"},{key:"opens",href:"",label:(0,a.__)("Opens","automatewoo"),labelTooltipText:(0,a.__)("Unique opens","automatewoo"),type:"number"},{key:"unique-clicks",href:"",label:(0,a.__)("Unique clicks","automatewoo"),type:"number"},{key:"clicks",href:"",label:(0,a.__)("Clicks","automatewoo"),type:"number"}],Ee=[{key:"unsubscribers",href:"",label:(0,a.__)("Unsubscribers","automatewoo"),type:"number"}];function Fe(e){var t=e.query,r=e.path,o=De.find((function(e){return e.key===t.chart}))||De[0];return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(i.ReportFilters,{query:t,path:r,filters:f}),(0,M.jsx)(oe,{charts:De,endpoint:"email-tracking",query:t,selectedChart:o,filters:f}),(0,M.jsx)(J,{endpoint:"email-tracking",path:r,query:t,filters:f,selectedChart:o,charts:De}),(0,M.jsx)(oe,{charts:Ee,endpoint:"unsubscribers",query:t,selectedChart:Ee[0],filters:f}),(0,M.jsx)(J,{endpoint:"unsubscribers",path:r,query:t,filters:f,selectedChart:Ee[0],charts:Ee})]})}var Ne=[{key:"runs",label:(0,a.__)("Runs","automatewoo"),labelTooltipText:(0,a.__)("Workflows have run for the selected period","automatewoo"),type:"number"}];function Ae(e){var t=e.query,r=e.path;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(i.ReportFilters,{query:t,path:r,filters:f}),(0,M.jsx)(oe,{charts:Ne,endpoint:"workflow-runs",query:t,selectedChart:Ne[0],filters:f}),(0,M.jsx)(J,{endpoint:"workflow-runs",path:r,query:t,filters:f,selectedChart:Ne[0],charts:Ne})]})}(0,n.addFilter)("woocommerce_admin_reports_list","automatewoo",(function(e){return[].concat(o(e),[{report:"automatewoo-runs-by-date",title:(0,a._x)("Workflows","analytics report title","automatewoo"),component:Ae,navArgs:{id:"automatewoo-analytics-runs-by-date"}},{report:"automatewoo-email-tracking",title:(0,a._x)("Email & SMS Tracking","analytics report title","automatewoo"),component:Fe,navArgs:{id:"automatewoo-analytics-email-tracking"}},{report:"automatewoo-conversions",title:(0,a._x)("Conversions","analytics report title","automatewoo"),component:qe,navArgs:{id:"automatewoo-analytics-conversions"}}])}))}()}();