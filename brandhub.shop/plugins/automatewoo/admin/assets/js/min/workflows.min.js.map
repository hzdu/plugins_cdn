{"version":3,"file":"workflows.min.js","mappings":"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","sources":["webpack://automatewoo/./admin/assets/js/workflows.js"],"sourcesContent":["// Register eslint ignored glabals - to be revisited.\n// https://github.com/woocommerce/automatewoo/issues/1212\n/* global $metabox, _, ajaxurl, AutomateWoo, automatewooWorkflowLocalizeScript, AW, Backbone, Cookies, quicktags, tinyMCE */\n// Especially those seem pretty leaky, and dengerous.\n// eslint-disable-next-line no-unused-vars, @typescript-eslint/no-unused-vars\n/* global canvas, name, settings, html, theButtons, use, edButtons, inst, qt */\n\n/**\n * AutomateWoo Workflows Admin\n *\n * @param {Function} $            jQuery.\n * @param {Object}   workflowData automatewooWorkflowLocalizeScript\n */\n( function ( $, workflowData ) {\n\tAW.Workflow = Backbone.Model.extend( {\n\t\tgetAction( actionName ) {\n\t\t\tconst actions = AW.workflow.get( 'actions' );\n\n\t\t\tif ( actions[ actionName ] ) {\n\t\t\t\treturn actions[ actionName ];\n\t\t\t}\n\t\t},\n\t} );\n\n\tAW.WorkflowView = Backbone.View.extend( {\n\t\tel: $( 'form#post' ),\n\n\t\t$triggerSelect: $( '.js-trigger-select' ),\n\n\t\t$triggerDescription: $( '.js-trigger-description' ),\n\n\t\t$manualTriggerSelect: $( '.js-manual-trigger-select' ),\n\n\t\t$typeSelect: $( '.automatewoo-workflow-type-field' ),\n\n\t\tinitialize() {\n\t\t\tthis.listenTo( this.model, 'change:trigger', this.changeTrigger );\n\n\t\t\tthis.model.set( 'prevTrigger', this.$triggerSelect.val() );\n\t\t\tthis.model.set(\n\t\t\t\t'prevManualTrigger',\n\t\t\t\tthis.$manualTriggerSelect.val()\n\t\t\t);\n\t\t\tthis.model.set( 'prevType', this.$typeSelect.val() );\n\n\t\t\tthis.setTriggerOptions();\n\t\t\tthis.insertMetaboxHelpTips();\n\t\t},\n\n\t\tchangeTrigger() {\n\t\t\tAW.rules.resetAvailableRules();\n\n\t\t\t$( document.body ).trigger( 'wc-enhanced-select-init' );\n\t\t\tAW.initTooltips();\n\t\t\tAW.Validate.validateAllFields();\n\n\t\t\tif ( AutomateWoo.Workflows.trigger_compatibility_warning() ) {\n\t\t\t\tAW.workflowView.completeTriggerChange();\n\t\t\t}\n\t\t},\n\n\t\tcompleteTriggerChange() {\n\t\t\tAW.rules.clearIncompatibleRules();\n\t\t\tAutomateWoo.Workflows.clearIncompatibleActions();\n\n\t\t\tAutomateWoo.Modal.close();\n\n\t\t\tAutomateWoo.Workflows.refine_variables();\n\t\t\tAutomateWoo.Workflows.refine_action_selects();\n\t\t\tAutomateWoo.Workflows.maybe_disable_queueing();\n\n\t\t\tthis.updateTriggerDescription();\n\n\t\t\t// update the prev trigger, manual trigger, and type values\n\t\t\tthis.model.set( 'prevTrigger', this.$triggerSelect.val() );\n\t\t\tthis.model.set(\n\t\t\t\t'prevManualTrigger',\n\t\t\t\tthis.$manualTriggerSelect.val()\n\t\t\t);\n\t\t\tthis.model.set( 'prevType', this.$typeSelect.val() );\n\n\t\t\t$( document.body ).trigger( 'automatewoo_trigger_changed' );\n\t\t},\n\n\t\tcancelTriggerChange() {\n\t\t\tif ( this.$typeSelect.val() !== this.model.get( 'prevType' ) ) {\n\t\t\t\tthis.$typeSelect\n\t\t\t\t\t.val( this.model.get( 'prevType' ) )\n\t\t\t\t\t.trigger( 'change' );\n\t\t\t}\n\n\t\t\tthis.$triggerSelect\n\t\t\t\t.val( this.model.get( 'prevTrigger' ) )\n\t\t\t\t.trigger( 'change', true );\n\n\t\t\tthis.$manualTriggerSelect\n\t\t\t\t.val( this.model.get( 'prevManualTrigger' ) )\n\t\t\t\t.trigger( 'change' );\n\t\t},\n\n\t\tsetTriggerOptions() {\n\t\t\tconst options = [];\n\n\t\t\t$( '[name^=\"aw_workflow_data[trigger_options]\"]' ).each(\n\t\t\t\tfunction () {\n\t\t\t\t\tif ( $( this ).attr( 'type' ) === 'checkbox' ) {\n\t\t\t\t\t\toptions.push( {\n\t\t\t\t\t\t\tname: $( this ).attr( 'name' ),\n\t\t\t\t\t\t\tvalue: $( this ).is( ':checked' ),\n\t\t\t\t\t\t} );\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.push( {\n\t\t\t\t\t\t\tname: $( this ).attr( 'name' ),\n\t\t\t\t\t\t\ttext: $( this ).text(),\n\t\t\t\t\t\t\tvalue: $( this ).val(),\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tthis.model.set( 'prevTriggerOptions', options );\n\t\t},\n\n\t\t/**\n\t\t * Update the trigger description\n\t\t */\n\t\tupdateTriggerDescription() {\n\t\t\tconst trigger = this.model.get( 'trigger' );\n\n\t\t\tif ( trigger && trigger.description ) {\n\t\t\t\tthis.$triggerDescription.html(\n\t\t\t\t\t'<p class=\"aw-field-description\">' +\n\t\t\t\t\t\ttrigger.description +\n\t\t\t\t\t\t'</p>'\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.$triggerDescription.html( '' );\n\t\t\t}\n\t\t},\n\n\t\tinitAction( actionName, $action ) {\n\t\t\tconst data = this.model.getAction( actionName );\n\n\t\t\tif ( data ) {\n\t\t\t\t$action.attr( 'data-automatewoo-action-name', actionName );\n\t\t\t\t$action.attr( 'data-automatewoo-action-group', data.group );\n\t\t\t\t$action.attr(\n\t\t\t\t\t'data-automatewoo-action-can-be-previewed',\n\t\t\t\t\tdata.can_be_previewed\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t$action.removeAttr( 'data-automatewoo-action-name' );\n\t\t\t\t$action.removeAttr( 'data-automatewoo-action-group' );\n\t\t\t\t$action.removeAttr(\n\t\t\t\t\t'data-automatewoo-action-can-be-previewed'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// update dynamic fields\n\t\t\t$action\n\t\t\t\t.find( '[data-automatewoo-dynamic-select]' )\n\t\t\t\t.each( function ( i, el ) {\n\t\t\t\t\tAW.workflowView.initDynamicActionSelect( $( el ), $action );\n\t\t\t\t} );\n\n\t\t\tAW.initTooltips();\n\t\t\tAutomateWoo.Workflows.action_dependent_fields( $action );\n\t\t\tAutomateWoo.init_date_pickers();\n\n\t\t\t// Expand hidden action fields if required fields are empty when the form is submitted.\n\t\t\t$action.find( '.automatewoo-field' ).on( 'invalid', function () {\n\t\t\t\tconst actionsBox = $( '#aw_actions_box' );\n\t\t\t\tconst actionRow = $( this ).parents( '.automatewoo-action' );\n\n\t\t\t\tif ( actionsBox.hasClass( 'closed' ) ) {\n\t\t\t\t\tactionsBox.find( '.handlediv' ).trigger( 'click' );\n\t\t\t\t}\n\n\t\t\t\tif ( ! actionRow.hasClass( 'js-open' ) ) {\n\t\t\t\t\tAutomateWoo.Workflows.action_edit_open( actionRow );\n\t\t\t\t\tthis.scrollIntoView();\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\tinitDynamicActionSelect( $field, $action ) {\n\t\t\tconst referenceFieldName = $field.attr(\n\t\t\t\t'data-automatewoo-dynamic-select-reference'\n\t\t\t);\n\t\t\tconst $referenceField = $action.find(\n\t\t\t\t'.automatewoo-field[data-name=\"' + referenceFieldName + '\"]'\n\t\t\t);\n\n\t\t\t$referenceField.on( 'change', function () {\n\t\t\t\tAW.workflowView.updateDynamicActionSelect(\n\t\t\t\t\t$field,\n\t\t\t\t\t$referenceField,\n\t\t\t\t\t$action\n\t\t\t\t);\n\t\t\t} );\n\t\t},\n\n\t\tupdateDynamicActionSelect( $field, $referenceField, $action ) {\n\t\t\tif ( $field.is( '.automatewoo-field--loading' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// remove existing options\n\t\t\t$field.find( \"option[value!='']\" ).remove();\n\n\t\t\tif ( ! $referenceField.val() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $fieldRow = $field.parents( '.automatewoo-table__row' );\n\t\t\t$fieldRow.addClass( 'automatewoo-field-row--loading' );\n\n\t\t\tconst data = {\n\t\t\t\taction: 'aw_update_dynamic_action_select',\n\t\t\t\taction_name: $action.data( 'automatewoo-action-name' ),\n\t\t\t\ttarget_field_name: $field.attr( 'data-name' ),\n\t\t\t\treference_field_value: $referenceField.val(),\n\t\t\t\tnonce: AW.workflow.get( 'nonces' )\n\t\t\t\t\t.aw_update_dynamic_action_select,\n\t\t\t};\n\n\t\t\t$.post( ajaxurl, data, function ( response ) {\n\t\t\t\t$fieldRow.removeClass( 'automatewoo-field-row--loading' );\n\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\t$.each( response.data, function ( value, text ) {\n\t\t\t\t\t\t$field.append(\n\t\t\t\t\t\t\t$( '<option/>', {\n\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t);\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\tinitTrigger() {\n\t\t\tconst $triggerBox = $( '#aw_trigger_box' );\n\t\t\t$triggerBox\n\t\t\t\t.find( '[data-automatewoo-dynamic-select]' )\n\t\t\t\t.each( function ( i, el ) {\n\t\t\t\t\tAW.workflowView.initDynamicTriggerOptions(\n\t\t\t\t\t\t$( el ),\n\t\t\t\t\t\t$triggerBox\n\t\t\t\t\t);\n\t\t\t\t} );\n\n\t\t\t$( '[name^=\"aw_workflow_data[trigger_options]\"]' ).on(\n\t\t\t\t'change',\n\t\t\t\t() => {\n\t\t\t\t\tthis.setTriggerOptions();\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tinitDynamicTriggerOptions( $field, $triggerBox ) {\n\t\t\tconst referenceFieldName = $field.attr(\n\t\t\t\t'data-automatewoo-dynamic-select-reference'\n\t\t\t);\n\t\t\tconst $referenceField = $triggerBox.find(\n\t\t\t\t'.automatewoo-field[data-name=\"' + referenceFieldName + '\"]'\n\t\t\t);\n\n\t\t\t$referenceField.on( 'change', function () {\n\t\t\t\tAW.workflowView.updateDynamicTriggerOptions(\n\t\t\t\t\t$field,\n\t\t\t\t\t$referenceField\n\t\t\t\t);\n\t\t\t} );\n\t\t},\n\n\t\tupdateDynamicTriggerOptions( $field, $referenceField ) {\n\t\t\tif ( $field.is( '.automatewoo-field--loading' ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// remove existing options\n\t\t\t$field.empty();\n\n\t\t\tif ( ! $referenceField.val() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $fieldRow = $field.parents( '.automatewoo-table__row' );\n\t\t\t$fieldRow.addClass( 'automatewoo-field-row--loading' );\n\n\t\t\tconst data = {\n\t\t\t\taction: 'aw_update_dynamic_trigger_options_select',\n\t\t\t\ttrigger_name: $(\n\t\t\t\t\t'#aw_trigger_box select[name=\"aw_workflow_data[trigger_name]\"]'\n\t\t\t\t).val(),\n\t\t\t\ttarget_field_name: $field.attr( 'data-name' ),\n\t\t\t\treference_field_value: $referenceField.val(),\n\t\t\t\tnonce: AW.workflow.get( 'nonces' )\n\t\t\t\t\t.aw_update_dynamic_trigger_options_select,\n\t\t\t};\n\n\t\t\t$.post( ajaxurl, data, function ( response ) {\n\t\t\t\tif ( response.success ) {\n\t\t\t\t\tconst options = $.map(\n\t\t\t\t\t\tresponse.data,\n\t\t\t\t\t\tfunction ( text, value ) {\n\t\t\t\t\t\t\treturn $( '<option/>', {\n\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\n\t\t\t\t\tif ( options && options.length ) {\n\t\t\t\t\t\t$field.append( options );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$fieldRow.removeClass( 'automatewoo-field-row--loading' );\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Add helplinks to top of meta box\n\t\t */\n\t\tinsertMetaboxHelpTips() {\n\t\t\tconst tips = this.model.get( 'metaBoxHelpTips' );\n\n\t\t\t_.each( tips, function ( tipHtml, id ) {\n\t\t\t\t$metabox = $( '#aw_' + id );\n\t\t\t\t$metabox.find( 'h2.hndle' ).append( tipHtml );\n\t\t\t} );\n\t\t},\n\t} );\n\n\tAW.TriggerCompatibilityModalView = Backbone.View.extend( {\n\t\tclassName: 'aw-view-trigger-compatibility-modal',\n\n\t\ttemplate: wp.template( 'aw-trigger-compatibility-modal' ),\n\n\t\tdata: null,\n\n\t\tinitialize( data ) {\n\t\t\tthis.data = data;\n\n\t\t\tdocument.body.addEventListener(\n\t\t\t\t'awmodal-close',\n\t\t\t\t( event ) => {\n\t\t\t\t\tif ( event.detail.closedBy === 'dismiss' ) {\n\t\t\t\t\t\tAW.workflowView.cancelTriggerChange();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ once: true }\n\t\t\t);\n\n\t\t\tthis.$el.on( 'click', '.js-confirm', function () {\n\t\t\t\tAW.workflowView.completeTriggerChange();\n\t\t\t} );\n\t\t},\n\n\t\trender() {\n\t\t\tthis.$el.html( this.template( this.data ) );\n\t\t\treturn this;\n\t\t},\n\t} );\n\n\tAW.TriggerPresetActivationModalView = Backbone.View.extend( {\n\t\tclassName: 'aw-view-trigger-preset-activation-modal',\n\n\t\ttemplate: wp.template( 'aw-trigger-preset-activation-modal' ),\n\n\t\tdata: null,\n\n\t\tinitialize( data ) {\n\t\t\tthis.data = data;\n\n\t\t\tthis.$el.on( 'click', '.js-confirm', () => {\n\t\t\t\tthis.disableButtons();\n\n\t\t\t\t// Close with applicable tracking action set up.\n\t\t\t\tdata.action = 'confirm';\n\t\t\t\tAutomateWoo.Modal.close();\n\n\t\t\t\t// submit\n\t\t\t\t$( AW.workflowView.el )\n\t\t\t\t\t.data( 'aw-preset-workflow-confirmed', true )\n\t\t\t\t\t.trigger( 'submit' );\n\t\t\t} );\n\n\t\t\tthis.$el.on(\n\t\t\t\t'click',\n\t\t\t\t`.${ AutomateWoo.Modal.triggerClasses.close }`,\n\t\t\t\t() => {\n\t\t\t\t\tdata.action = 'cancel';\n\n\t\t\t\t\tthis.disableButtons();\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\n\t\tdisableButtons() {\n\t\t\tthis.$el\n\t\t\t\t.find( '.automatewoo-modal__footer button' )\n\t\t\t\t.addClass( 'disabled' );\n\t\t},\n\n\t\trender() {\n\t\t\tthis.$el.html( this.template( this.data ) );\n\t\t\treturn this;\n\t\t},\n\n\t\t/**\n\t\t * Opens `AutomateWoo.Modal`, fills it with rendered message.\n\t\t * Record Tracking events `preset_activation_alert_rendered` when executed,\n\t\t * and 'preset_activation_alert_closed' with applicable `action` and `is_active` once eventually closed.\n\t\t */\n\t\topen() {\n\t\t\t// Once the modal is open, the default close action for built-in Modal close features is 'dismiss'.\n\t\t\tthis.data.action = 'dismiss';\n\n\t\t\tAutomateWoo.Modal.open();\n\t\t\tAutomateWoo.Modal.contents( this.render().el );\n\n\t\t\tAW.tracks.recordEvent( 'preset_activation_alert_rendered', {\n\t\t\t\tis_active: this.data.isActive,\n\t\t\t} );\n\n\t\t\t// If the modal is dismissed by AutomateWoo.Modal features.\n\t\t\tdocument.body.addEventListener(\n\t\t\t\t'awmodal-close',\n\t\t\t\t() =>\n\t\t\t\t\tAW.tracks.recordEvent( 'preset_activation_alert_closed', {\n\t\t\t\t\t\tis_active: this.data.isActive,\n\t\t\t\t\t\taction: this.data.action,\n\t\t\t\t\t} ),\n\t\t\t\t{ once: true }\n\t\t\t);\n\t\t},\n\t} );\n\n\tAW.workflow = new AW.Workflow( workflowData );\n\n\tAW.workflowView = new AW.WorkflowView( {\n\t\tmodel: AW.workflow,\n\t} );\n\n\tAW.Validate.init();\n} )( jQuery, automatewooWorkflowLocalizeScript );\n\njQuery( function ( $ ) {\n\tAutomateWoo.Workflows = {\n\t\t$triggers_box: $( '#aw_trigger_box' ),\n\t\t$manual_workflow_box: $( '#aw_manual_workflow_box' ),\n\n\t\t$actions_box: $( '#aw_actions_box' ),\n\n\t\t$actions_container: $( '.aw-actions-container' ),\n\n\t\t$action_template: $( '.aw-action-template' ),\n\n\t\t$trigger_select: $( '.js-trigger-select' ).first(),\n\t\t$manual_trigger_select: $( '.js-manual-trigger-select' ).first(),\n\n\t\tinit() {\n\t\t\tAutomateWoo.Workflows.init_triggers_box();\n\t\t\tAutomateWoo.Workflows.init_actions_box();\n\t\t\tAutomateWoo.Workflows.init_options_box();\n\t\t\tAutomateWoo.Workflows.refine_variables();\n\t\t},\n\n\t\t/**\n\t\t */\n\t\tinit_triggers_box() {\n\t\t\tAutomateWoo.Workflows.$trigger_select.on(\n\t\t\t\t'change',\n\t\t\t\tfunction ( event, restoreOptions ) {\n\t\t\t\t\tAutomateWoo.Workflows.fill_trigger_fields(\n\t\t\t\t\t\t$( this ).val(),\n\t\t\t\t\t\trestoreOptions\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tAutomateWoo.Workflows.$manual_trigger_select.on(\n\t\t\t\t'change',\n\t\t\t\tfunction () {\n\t\t\t\t\tAutomateWoo.Workflows.fill_manual_workflow_trigger_fields(\n\t\t\t\t\t\t$( this ).val()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tAW.workflowView.initTrigger();\n\t\t},\n\n\t\t/**\n\t\t */\n\t\tinit_actions_box() {\n\t\t\t$( '.automatewoo-action.js-open' ).each( function () {\n\t\t\t\tAutomateWoo.Workflows.action_edit_open( $( this ) );\n\t\t\t} );\n\n\t\t\t$( '.js-aw-add-action' ).on( 'click', function ( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tAutomateWoo.Workflows.add_new_action();\n\t\t\t} );\n\n\t\t\t$( document ).on( 'click', '.js-edit-action', function ( e ) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tconst $action = $( this )\n\t\t\t\t\t.parents( '.automatewoo-action' )\n\t\t\t\t\t.first();\n\n\t\t\t\tif ( $action.is( '.js-open' ) ) {\n\t\t\t\t\tAutomateWoo.Workflows.action_edit_close( $action );\n\t\t\t\t} else {\n\t\t\t\t\tAutomateWoo.Workflows.action_edit_open( $action );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\t$( document ).on( 'click', '.js-delete-action', function ( e ) {\n\t\t\t\te.preventDefault();\n\t\t\t\tconst $action = $( this )\n\t\t\t\t\t.parents( '.automatewoo-action' )\n\t\t\t\t\t.first();\n\t\t\t\tAutomateWoo.Workflows.action_delete( $action );\n\t\t\t} );\n\n\t\t\t// Action select change\n\t\t\t$( document ).on( 'change', '.js-action-select', function () {\n\t\t\t\tconst $action = $( this )\n\t\t\t\t\t.parents( '.automatewoo-action' )\n\t\t\t\t\t.first();\n\t\t\t\tAutomateWoo.Workflows.fill_action_fields(\n\t\t\t\t\t$action,\n\t\t\t\t\t$( this ).val()\n\t\t\t\t);\n\t\t\t} );\n\n\t\t\t// preview links\n\t\t\t$( document ).on(\n\t\t\t\t'click',\n\t\t\t\t'[data-automatewoo-preview]',\n\t\t\t\tfunction ( e ) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tconst $action = $( this )\n\t\t\t\t\t\t.parents( '.automatewoo-action' )\n\t\t\t\t\t\t.first();\n\t\t\t\t\tAutomateWoo.Workflows.preview_action( $action );\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif ( ! AW.workflow.get( 'isNew' ) ) {\n\t\t\t\tAutomateWoo.Workflows.refine_action_selects();\n\t\t\t\tAutomateWoo.Workflows.refine_variables();\n\t\t\t\tAutomateWoo.Workflows.maybe_disable_queueing();\n\n\t\t\t\t$( '.automatewoo-action' ).each( function ( i, el ) {\n\t\t\t\t\tAW.workflowView.initAction(\n\t\t\t\t\t\t$( el ).find( '.js-action-select' ).val(),\n\t\t\t\t\t\t$( el )\n\t\t\t\t\t);\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\n\t\tinit_options_box() {\n\t\t\tconst $checkboxClickTracking = $(\n\t\t\t\t'.aw-checkbox-enable-click-tracking'\n\t\t\t);\n\n\t\t\tAutomateWoo.Workflows.maybe_hide_tracking_options();\n\n\t\t\t$checkboxClickTracking.on( 'click', function () {\n\t\t\t\tAutomateWoo.Workflows.maybe_hide_tracking_options();\n\t\t\t} );\n\t\t},\n\n\t\tmaybe_hide_tracking_options() {\n\t\t\tconst $checkboxClickTracking = $(\n\t\t\t\t'.aw-checkbox-enable-click-tracking'\n\t\t\t);\n\t\t\tconst checked = $checkboxClickTracking.is( ':checked' );\n\n\t\t\tif ( ! checked ) {\n\t\t\t\t$( '.js-require-email-tracking' ).hide();\n\t\t\t} else {\n\t\t\t\t$( '.js-require-email-tracking' ).show();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * @param {*}       triggerName\n\t\t * @param {boolean} [restoreOptions=false] If true then the trigger fields will be populated from the previous trigger options\n\t\t */\n\t\tfill_trigger_fields( triggerName, restoreOptions = false ) {\n\t\t\t// Remove existing fields\n\t\t\tAutomateWoo.Workflows.$triggers_box\n\t\t\t\t.find( 'tr.aw-trigger-option' )\n\t\t\t\t.remove();\n\n\t\t\tif ( triggerName ) {\n\t\t\t\tAutomateWoo.Workflows.$triggers_box.addClass( 'aw-loading' );\n\n\t\t\t\tthis.fetch_trigger_data( triggerName ).done(\n\t\t\t\t\tfunction ( response ) {\n\t\t\t\t\t\tif ( ! response.success ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tAutomateWoo.Workflows.$triggers_box\n\t\t\t\t\t\t\t.find( 'tbody' )\n\t\t\t\t\t\t\t.append( response.data.fields );\n\t\t\t\t\t\tAutomateWoo.Workflows.$triggers_box.removeClass(\n\t\t\t\t\t\t\t'aw-loading'\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif ( restoreOptions ) {\n\t\t\t\t\t\t\tconst options =\n\t\t\t\t\t\t\t\tAW.workflow.get( 'prevTriggerOptions' );\n\n\t\t\t\t\t\t\t$.each( options, function ( index, option ) {\n\t\t\t\t\t\t\t\tconst element = $(\n\t\t\t\t\t\t\t\t\t`[name=\"${ option.name }\"]`\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tswitch ( element.prop( 'type' ) ) {\n\t\t\t\t\t\t\t\t\tcase 'select-one':\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\telement.find( 'option' ).length ===\n\t\t\t\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tconst selected = $( '<option />' )\n\t\t\t\t\t\t\t\t\t\t\t\t.attr( 'value', option.value )\n\t\t\t\t\t\t\t\t\t\t\t\t.text( option.text );\n\n\t\t\t\t\t\t\t\t\t\t\telement.append( selected );\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\telement.val( option.value );\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'checkbox':\n\t\t\t\t\t\t\t\t\t\telement.prop( 'checked', option.value );\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\telement.val( option.value );\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\telement.trigger( 'change' );\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tAW.workflow.set( 'trigger', response.data.trigger );\n\t\t\t\t\t\tAW.workflowView.initTrigger();\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tAW.workflow.set( 'trigger', false );\n\t\t\t}\n\t\t},\n\n\t\tfetch_trigger_data( triggerName ) {\n\t\t\treturn $.ajax( {\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'aw_fill_trigger_fields',\n\t\t\t\t\ttrigger_name: triggerName,\n\t\t\t\t\tworkflow_id: AW.workflow.get( 'id' ),\n\t\t\t\t\tis_new_workflow: AW.workflow.get( 'isNew' ),\n\t\t\t\t\tnonce: AW.workflow.get( 'nonces' ).aw_fill_trigger_fields,\n\t\t\t\t},\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * @param {*} triggerName\n\t\t */\n\t\tfill_manual_workflow_trigger_fields( triggerName ) {\n\t\t\tconst $metabox = AutomateWoo.Workflows.$manual_workflow_box;\n\n\t\t\t// Remove existing fields\n\t\t\t$metabox.find( 'tr.aw-trigger-option' ).remove();\n\n\t\t\tif ( triggerName ) {\n\t\t\t\t$metabox.addClass( 'aw-loading' );\n\n\t\t\t\tthis.fetch_trigger_data( triggerName ).done(\n\t\t\t\t\tfunction ( response ) {\n\t\t\t\t\t\tif ( ! response.success ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$metabox.find( 'tbody' ).append( response.data.fields );\n\t\t\t\t\t\t$metabox.removeClass( 'aw-loading' );\n\n\t\t\t\t\t\tAW.workflow.set( 'trigger', response.data.trigger );\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tAW.workflow.set( 'trigger', false );\n\t\t\t}\n\t\t},\n\n\t\tadd_new_action() {\n\t\t\tconst actionNumber =\n\t\t\t\tAutomateWoo.Workflows.get_number_of_actions() + 1;\n\n\t\t\t$( '.js-aw-no-actions-message' ).hide();\n\n\t\t\tconst $newAction = AutomateWoo.Workflows.$action_template.clone();\n\t\t\t$newAction.removeClass( 'aw-action-template' );\n\t\t\t$newAction.addClass( 'automatewoo-action' );\n\n\t\t\tAutomateWoo.Workflows.$actions_container.append( $newAction );\n\n\t\t\t$newAction.attr( 'data-action-number', actionNumber );\n\n\t\t\tAutomateWoo.Workflows.action_edit_open( $newAction );\n\t\t},\n\n\t\t/**\n\t\t * Get the name for the cookie that stores if an action is being edited.\n\t\t *\n\t\t * @param {number} actionNumber\n\t\t * @return {string} Prefixed cookie name `aw_editing_action_${ workflowId }_${ actionNumber }`.\n\t\t */\n\t\tget_editing_action_cookie_name( actionNumber ) {\n\t\t\tconst workflowId = AW.workflow.get( 'id' );\n\t\t\treturn `aw_editing_action_${ workflowId }_${ actionNumber }`;\n\t\t},\n\n\t\taction_edit_open( $action ) {\n\t\t\tconst actionNumber = $action.data( 'action-number' );\n\n\t\t\t$action.addClass( 'js-open' );\n\t\t\t$action.find( '.automatewoo-action__fields' ).slideDown( 150 );\n\n\t\t\tAW.initTooltips();\n\n\t\t\t// save open state\n\t\t\tCookies.set(\n\t\t\t\tthis.get_editing_action_cookie_name( actionNumber ),\n\t\t\t\t1,\n\t\t\t\t{ sameSite: 'strict' }\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * Set up fields that are dependent on each other.\n\t\t *\n\t\t * @param {jQuery} $action\n\t\t */\n\t\taction_dependent_fields( $action ) {\n\t\t\tconst $hideWhenChecked = $action.find( '[data-hide-when-checked]' );\n\t\t\t$hideWhenChecked.each( function () {\n\t\t\t\tconst $this = $( this );\n\t\t\t\tconst $dependency = $this.data( 'hideWhenChecked' );\n\t\t\t\tconst $checkbox = $( `[data-name=\"${ $dependency }\"]` ).find(\n\t\t\t\t\t'input[type=\"checkbox\"]'\n\t\t\t\t);\n\n\t\t\t\tif ( ! $checkbox ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst $parentRow = $this.closest( 'tr.automatewoo-table__row' );\n\n\t\t\t\t$checkbox\n\t\t\t\t\t.on( 'change', function () {\n\t\t\t\t\t\tif ( this.checked ) {\n\t\t\t\t\t\t\t$parentRow.hide();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$parentRow.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t} )\n\t\t\t\t\t.trigger( 'change' );\n\t\t\t} );\n\t\t},\n\n\t\taction_edit_close( $action ) {\n\t\t\tconst actionNumber = $action.data( 'action-number' );\n\n\t\t\t$action.removeClass( 'js-open' );\n\t\t\t$action.find( '.automatewoo-action__fields' ).slideUp( 150 );\n\n\t\t\tCookies.remove(\n\t\t\t\tthis.get_editing_action_cookie_name( actionNumber )\n\t\t\t);\n\t\t},\n\n\t\t/**\n\t\t * @param {jQuery} $action\n\t\t */\n\t\taction_delete( $action ) {\n\t\t\t$action.remove();\n\t\t},\n\n\t\t/**\n\t\t * @param {jQuery} $action\n\t\t * @param {string} selectedAction\n\t\t */\n\t\tfill_action_fields( $action, selectedAction ) {\n\t\t\tconst actionNumber = $action.data( 'action-number' );\n\t\t\tconst $select = $action.find( '.js-action-select' );\n\n\t\t\tAutomateWoo.Workflows.$actions_box.addClass( 'aw-loading' );\n\n\t\t\t// Remove existing fields\n\t\t\t$action\n\t\t\t\t.find(\n\t\t\t\t\t'tr.automatewoo-table__row:not([data-name=\"action_name\"])'\n\t\t\t\t)\n\t\t\t\t.remove();\n\n\t\t\t$.ajax( {\n\t\t\t\tmethod: 'GET',\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'aw_fill_action_fields',\n\t\t\t\t\taction_name: selectedAction,\n\t\t\t\t\taction_number: actionNumber,\n\t\t\t\t\tworkflow_id: AW.workflow.get( 'id' ),\n\t\t\t\t\tnonce: AW.workflow.get( 'nonces' ).aw_fill_action_fields,\n\t\t\t\t},\n\t\t\t} ).done( function ( response ) {\n\t\t\t\t$action\n\t\t\t\t\t.find( '.automatewoo-table tbody' )\n\t\t\t\t\t.append( response.data.fields );\n\t\t\t\tAutomateWoo.Workflows.$actions_box.removeClass( 'aw-loading' );\n\n\t\t\t\t// Fill select box name\n\t\t\t\t$select.attr(\n\t\t\t\t\t'name',\n\t\t\t\t\t'aw_workflow_data[actions][' +\n\t\t\t\t\t\tactionNumber +\n\t\t\t\t\t\t'][action_name]'\n\t\t\t\t);\n\n\t\t\t\t// Pre fill title\n\t\t\t\t$action.find( '.action-title' ).text( response.data.title );\n\n\t\t\t\t$action\n\t\t\t\t\t.find( '.js-action-description' )\n\t\t\t\t\t.html( response.data.description );\n\n\t\t\t\tAW.workflowView.initAction( selectedAction, $action );\n\t\t\t} );\n\t\t},\n\n\t\tget_number_of_actions() {\n\t\t\treturn $( '.automatewoo-action' ).length;\n\t\t},\n\n\t\t/**\n\t\t * Show or hide text var groups based on the selected trigger\n\t\t */\n\t\trefine_variables() {\n\t\t\tconst trigger = AW.workflow.get( 'trigger' );\n\n\t\t\tif ( ! trigger ) {\n\t\t\t\t$( '#aw_variables_box' ).hide();\n\t\t\t} else {\n\t\t\t\t$( '#aw_variables_box' ).show();\n\t\t\t\t$( '.aw-variables-group' ).each( function ( i, el ) {\n\t\t\t\t\tconst group = $( el ).data( 'automatewoo-variable-group' );\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t$.inArray( group, trigger.supplied_data_items ) === -1\n\t\t\t\t\t) {\n\t\t\t\t\t\t$( el ).hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$( el ).show();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Show or hide select options based on the selected trigger\n\t\t * Also what if a trigger is changed after an action is already added\n\t\t */\n\t\trefine_action_selects() {\n\t\t\t$( '.js-action-select' ).each( function () {\n\t\t\t\t$( this )\n\t\t\t\t\t.find( 'option' )\n\t\t\t\t\t.each( function () {\n\t\t\t\t\t\t$( this ).prop(\n\t\t\t\t\t\t\t'disabled',\n\t\t\t\t\t\t\t! AutomateWoo.Workflows.is_action_compatible_with_current_trigger(\n\t\t\t\t\t\t\t\t$( this ).val()\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t} );\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * Hide queue if disabled for the selected trigger\n\t\t */\n\t\tmaybe_disable_queueing() {\n\t\t\tconst trigger = AW.workflow.get( 'trigger' );\n\n\t\t\tif ( trigger && trigger.allow_queueing ) {\n\t\t\t\t$( '#aw_timing_box' ).show();\n\t\t\t} else {\n\t\t\t\t$( '#aw_timing_box' ).hide();\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Be sure to run this before refine_action_selects\n\t\t *\n\t\t * @return {boolean} `false` if switching back to stop the trigger change.\n\t\t */\n\t\ttrigger_compatibility_warning() {\n\t\t\tlet incompatibleRules = [];\n\t\t\tlet incompatibleActions = [];\n\n\t\t\t_.each( AW.rules.get( 'ruleOptions' ), function ( ruleGroup ) {\n\t\t\t\t_.each( ruleGroup.get( 'rules' ), function ( rule ) {\n\t\t\t\t\tif (\n\t\t\t\t\t\trule.get( 'name' ) &&\n\t\t\t\t\t\t! AW.rules.isRuleAvailable( rule.get( 'name' ) )\n\t\t\t\t\t) {\n\t\t\t\t\t\tconst ruleObject = rule.get( 'object' );\n\t\t\t\t\t\tincompatibleRules.push( ruleObject.title );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\n\t\t\t$( '.js-action-select' ).each( function () {\n\t\t\t\tif (\n\t\t\t\t\t! AutomateWoo.Workflows.is_action_compatible_with_current_trigger(\n\t\t\t\t\t\t$( this ).val()\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tincompatibleActions.push(\n\t\t\t\t\t\t$( this ).find( 'option:selected' ).text()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif ( incompatibleRules.length || incompatibleActions.length ) {\n\t\t\t\tincompatibleActions = _.uniq( incompatibleActions );\n\t\t\t\tincompatibleRules = _.uniq( incompatibleRules );\n\n\t\t\t\tconst modalView = new AW.TriggerCompatibilityModalView( {\n\t\t\t\t\tincompatibleRules,\n\t\t\t\t\tincompatibleActions,\n\t\t\t\t} );\n\n\t\t\t\tAutomateWoo.Modal.open();\n\t\t\t\tAutomateWoo.Modal.contents( modalView.render().el );\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\n\t\tclearIncompatibleActions() {\n\t\t\t$( '.js-action-select' ).each( function () {\n\t\t\t\tif (\n\t\t\t\t\t! AutomateWoo.Workflows.is_action_compatible_with_current_trigger(\n\t\t\t\t\t\t$( this ).val()\n\t\t\t\t\t)\n\t\t\t\t) {\n\t\t\t\t\tconst $action = $( this )\n\t\t\t\t\t\t.parents( '.automatewoo-action' )\n\t\t\t\t\t\t.first();\n\t\t\t\t\tAutomateWoo.Workflows.action_delete( $action );\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t *\n\t\t * @param {string} actionName\n\t\t * @return {boolean} `true` is the action is compatible, `false` if it's not valid or compatible.\n\t\t */\n\t\tis_action_compatible_with_current_trigger( actionName ) {\n\t\t\tlet compatible = true;\n\t\t\tconst action = AW.workflow.getAction( actionName );\n\n\t\t\t// Not a valid action\n\t\t\tif ( ! action ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// No data items required\n\t\t\tif ( ! action.required_data_items.length ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst trigger = AW.workflow.get( 'trigger' );\n\n\t\t\t$.each( action.required_data_items, function ( i, value ) {\n\t\t\t\tif ( $.inArray( value, trigger.supplied_data_items ) === -1 ) {\n\t\t\t\t\tcompatible = false;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn compatible;\n\t\t},\n\n\t\tpreview_action( $action ) {\n\t\t\tconst actionNumber = $action.data( 'action-number' );\n\t\t\tconst trigger = AW.workflow.get( 'trigger' );\n\t\t\tconst fields = {};\n\n\t\t\tif ( AutomateWoo.isEmailPreviewOpen() ) {\n\t\t\t\tAutomateWoo.Workflows.$actions_box.addClass( 'aw-loading' );\n\t\t\t}\n\n\t\t\tif ( typeof tinyMCE !== 'undefined' ) {\n\t\t\t\ttinyMCE.triggerSave();\n\t\t\t}\n\n\t\t\tconst nameSelector =\n\t\t\t\t'aw_workflow_data[actions][' + actionNumber + ']';\n\n\t\t\t// get fields to preview\n\t\t\t$action\n\t\t\t\t.find( '[name*=\"' + nameSelector + '\"]' )\n\t\t\t\t.each( function ( i, el ) {\n\t\t\t\t\tlet elementName, val;\n\n\t\t\t\t\telementName = $( el ).attr( 'name' );\n\t\t\t\t\tconst isGrouped = /\\[]$/.test( elementName );\n\n\t\t\t\t\tif ( isGrouped ) {\n\t\t\t\t\t\telementName = elementName.replace( '[]', '' );\n\t\t\t\t\t}\n\n\t\t\t\t\t// get the name\n\t\t\t\t\tconst fieldName = elementName\n\t\t\t\t\t\t.replace( nameSelector, '' )\n\t\t\t\t\t\t.replace( '[', '' )\n\t\t\t\t\t\t.replace( ']', '' );\n\n\t\t\t\t\tif ( $( el ).attr( 'type' ) === 'checkbox' ) {\n\t\t\t\t\t\tval = el.checked ? '1' : '';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tval = $( el ).val();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( isGrouped ) {\n\t\t\t\t\t\tif ( ! fields.hasOwnProperty( fieldName ) ) {\n\t\t\t\t\t\t\tfields[ fieldName ] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfields[ fieldName ].push( val );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfields[ fieldName ] = val;\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\tAutomateWoo.openLoadingEmailPreview(); // open the preview window before saving so that the popup is not blocked\n\n\t\t\t$.ajax( {\n\t\t\t\tmethod: 'POST',\n\t\t\t\turl: ajaxurl,\n\t\t\t\tdata: {\n\t\t\t\t\taction: 'aw_save_preview_data',\n\t\t\t\t\tworkflow_id: AW.workflow.get( 'id' ),\n\t\t\t\t\ttrigger_name: trigger ? trigger.name : '',\n\t\t\t\t\taction_fields: fields,\n\t\t\t\t\tnonce: AW.workflow.get( 'nonces' ).aw_save_preview_data,\n\t\t\t\t},\n\t\t\t\tsuccess() {\n\t\t\t\t\tAutomateWoo.open_email_preview( 'workflow_action', {\n\t\t\t\t\t\tworkflow_id: AW.workflow.get( 'id' ),\n\t\t\t\t\t\taction_number: actionNumber,\n\t\t\t\t\t} );\n\t\t\t\t},\n\t\t\t\tcomplete() {\n\t\t\t\t\tAutomateWoo.Workflows.$actions_box.removeClass(\n\t\t\t\t\t\t'aw-loading'\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t} );\n\t\t},\n\n\t\t/**\n\t\t * @param {string} id\n\t\t */\n\t\tinit_ajax_wysiwyg( id ) {\n\t\t\tif (\n\t\t\t\ttypeof tinymce === 'undefined' ||\n\t\t\t\ttypeof tinyMCEPreInit.mceInit.automatewoo_editor === 'undefined'\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst mceInit = $.extend(\n\t\t\t\t{},\n\t\t\t\ttinyMCEPreInit.mceInit.automatewoo_editor\n\t\t\t);\n\t\t\tconst qtInit = $.extend(\n\t\t\t\t{},\n\t\t\t\ttinyMCEPreInit.qtInit.automatewoo_editor\n\t\t\t);\n\n\t\t\tmceInit.selector = '#' + id;\n\t\t\tmceInit.id = id;\n\t\t\tmceInit.wp_autoresize_on = false;\n\n\t\t\ttinyMCEPreInit.mceInit[ mceInit.id ] = mceInit;\n\n\t\t\tqtInit.id = id;\n\n\t\t\tconst $wrap = tinymce.$( '#wp-' + id + '-wrap' );\n\n\t\t\tif (\n\t\t\t\t$wrap.hasClass( 'tmce-active' ) ||\n\t\t\t\t! tinyMCEPreInit.qtInit.hasOwnProperty( id )\n\t\t\t) {\n\t\t\t\ttry {\n\t\t\t\t\ttinymce.init( mceInit );\n\t\t\t\t} catch ( e ) {}\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst qtags = quicktags( qtInit );\n\n\t\t\t\tthis.init_wysiwyg_buttons( qtags );\n\t\t\t} catch ( e ) {}\n\t\t},\n\n\t\t/**\n\t\t *\n\t\t * @param {Object} qtags\n\t\t */\n\t\tinit_wysiwyg_buttons( qtags ) {\n\t\t\tconst defaults =\n\t\t\t\t',strong,em,link,block,del,ins,img,ul,ol,li,code,more,close,';\n\n\t\t\tcanvas = qtags.canvas;\n\t\t\tname = qtags.name;\n\t\t\tsettings = qtags.settings;\n\t\t\thtml = '';\n\t\t\ttheButtons = {};\n\t\t\tuse = '';\n\n\t\t\t// set buttons\n\t\t\tif ( settings.buttons ) {\n\t\t\t\tuse = ',' + settings.buttons + ',';\n\t\t\t}\n\n\t\t\tfor ( const buttonIndex in edButtons ) {\n\t\t\t\tif ( ! edButtons[ buttonIndex ] ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst id = edButtons[ buttonIndex ].id;\n\t\t\t\tif (\n\t\t\t\t\tuse &&\n\t\t\t\t\tdefaults.indexOf( ',' + id + ',' ) !== -1 &&\n\t\t\t\t\tuse.indexOf( ',' + id + ',' ) === -1\n\t\t\t\t) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t! edButtons[ buttonIndex ].instance ||\n\t\t\t\t\tedButtons[ buttonIndex ].instance === inst\n\t\t\t\t) {\n\t\t\t\t\ttheButtons[ id ] = edButtons[ buttonIndex ];\n\n\t\t\t\t\tif ( edButtons[ buttonIndex ].html ) {\n\t\t\t\t\t\thtml += edButtons[ buttonIndex ].html( name + '_' );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( use && use.indexOf( ',fullscreen,' ) !== -1 ) {\n\t\t\t\ttheButtons.fullscreen = new qt.FullscreenButton();\n\t\t\t\thtml += theButtons.fullscreen.html( name + '_' );\n\t\t\t}\n\n\t\t\tif ( document.getElementsByTagName( 'html' )[ 0 ].dir === 'rtl' ) {\n\t\t\t\ttheButtons.textdirection = new qt.TextDirectionButton();\n\t\t\t\thtml += theButtons.textdirection.html( name + '_' );\n\t\t\t}\n\n\t\t\tqtags.toolbar.innerHTML = html;\n\t\t\tqtags.theButtons = theButtons;\n\t\t},\n\t};\n\n\tAutomateWoo.Workflows.init();\n\n\t/**\n\t * Customer win back trigger.\n\t *\n\t * Changes the max field placeholder so it's 3 days after the min field val.\n\t */\n\tfunction initCustomerWinBackTrigger() {\n\t\tconst $minField = $(\n\t\t\t'input[name=\"aw_workflow_data[trigger_options][days_since_last_purchase]\"]'\n\t\t);\n\t\tconst $maxField = $(\n\t\t\t'input[name=\"aw_workflow_data[trigger_options][days_since_last_purchase_max]\"]'\n\t\t);\n\t\tconst defaultRange = 3;\n\n\t\t$minField\n\t\t\t.on( 'change keyup', function () {\n\t\t\t\tconst minVal = $minField.val()\n\t\t\t\t\t? parseInt( $minField.val(), 10 )\n\t\t\t\t\t: 0;\n\t\t\t\tlet placeholder = '';\n\n\t\t\t\tif ( minVal ) {\n\t\t\t\t\tplaceholder = minVal + defaultRange;\n\t\t\t\t}\n\n\t\t\t\t$maxField.attr( 'min', minVal + 1 );\n\t\t\t\t$maxField.attr( 'placeholder', placeholder );\n\t\t\t} )\n\t\t\t.trigger( 'change' );\n\t}\n\n\t$( document.body ).on( 'automatewoo_trigger_changed', function () {\n\t\tinitCustomerWinBackTrigger();\n\t} );\n\n\tfunction initWorkflowType() {\n\t\tconst $typeSelectField = $( '.automatewoo-workflow-type-field' );\n\n\t\tfunction updateType( type, doReset ) {\n\t\t\tif ( type === 'manual' ) {\n\t\t\t\t$(\n\t\t\t\t\t'#aw_trigger_box, #automatewoo-workflow-status-field-row'\n\t\t\t\t).hide();\n\t\t\t\t$( '#aw_manual_workflow_box' ).show();\n\t\t\t\t$( '#automatewoo-workflow-run-btn' )\n\t\t\t\t\t.show()\n\t\t\t\t\t.css( 'display', 'inline-block' );\n\t\t\t} else {\n\t\t\t\t$(\n\t\t\t\t\t'#automatewoo-workflow-run-btn, #aw_manual_workflow_box'\n\t\t\t\t).hide();\n\t\t\t\t$(\n\t\t\t\t\t'#aw_trigger_box, #automatewoo-workflow-status-field-row'\n\t\t\t\t).show();\n\t\t\t}\n\n\t\t\tif ( doReset ) {\n\t\t\t\t// Reset select box to first option on type change\n\t\t\t\tAutomateWoo.Workflows.$manual_trigger_select[ 0 ].selectedIndex = 0;\n\t\t\t\tAutomateWoo.Workflows.$trigger_select[ 0 ].selectedIndex = 0;\n\n\t\t\t\tAutomateWoo.Workflows.$triggers_box\n\t\t\t\t\t.find( 'tr.aw-trigger-option' )\n\t\t\t\t\t.remove();\n\n\t\t\t\tAW.workflow.set( 'trigger', false );\n\t\t\t}\n\t\t}\n\n\t\t$typeSelectField.on( 'change', function () {\n\t\t\tupdateType( $typeSelectField.val(), true );\n\t\t} );\n\n\t\tupdateType( $typeSelectField.val(), false );\n\t}\n\n\t$( '#automatewoo-workflow-run-btn' ).on( 'click', function () {\n\t\t$( 'input[name=\"automatewoo_redirect_to_runner\"]' ).val( 1 );\n\t\t$( '#publish' ).trigger( 'click' );\n\t\treturn false;\n\t} );\n\n\t$( 'form#post' ).on( 'submit', function () {\n\t\tconst $form = $( this );\n\t\tconst isActive =\n\t\t\t$( 'select[name=workflow_status]', $form ).val() === 'active';\n\t\tconst isConfirmed = $form.data( 'aw-preset-workflow-confirmed' );\n\t\tconst isFirstPresetSave = /workflow-origin=preset/.test(\n\t\t\twindow.location.href\n\t\t);\n\n\t\tif ( isFirstPresetSave && ! isConfirmed ) {\n\t\t\tconst activationModalView = new AW.TriggerPresetActivationModalView(\n\t\t\t\t{ isActive }\n\t\t\t);\n\t\t\tactivationModalView.open();\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} );\n\n\tinitCustomerWinBackTrigger();\n\tinitWorkflowType();\n} );\n"],"names":["$","workflowData","AW","Workflow","Backbone","Model","extend","getAction","actionName","actions","workflow","get","WorkflowView","View","el","$triggerSelect","$triggerDescription","$manualTriggerSelect","$typeSelect","initialize","this","listenTo","model","changeTrigger","set","val","setTriggerOptions","insertMetaboxHelpTips","rules","resetAvailableRules","document","body","trigger","initTooltips","Validate","validateAllFields","AutomateWoo","Workflows","trigger_compatibility_warning","workflowView","completeTriggerChange","clearIncompatibleRules","clearIncompatibleActions","Modal","close","refine_variables","refine_action_selects","maybe_disable_queueing","updateTriggerDescription","cancelTriggerChange","options","each","attr","push","name","value","is","text","description","html","initAction","$action","data","group","can_be_previewed","removeAttr","find","i","initDynamicActionSelect","action_dependent_fields","init_date_pickers","on","actionsBox","actionRow","parents","hasClass","action_edit_open","scrollIntoView","$field","referenceFieldName","$referenceField","updateDynamicActionSelect","remove","$fieldRow","addClass","action","action_name","target_field_name","reference_field_value","nonce","aw_update_dynamic_action_select","post","ajaxurl","response","removeClass","success","append","initTrigger","$triggerBox","initDynamicTriggerOptions","updateDynamicTriggerOptions","empty","trigger_name","aw_update_dynamic_trigger_options_select","map","length","tips","_","tipHtml","id","$metabox","TriggerCompatibilityModalView","className","template","wp","addEventListener","event","detail","closedBy","once","$el","render","TriggerPresetActivationModalView","disableButtons","triggerClasses","open","contents","tracks","recordEvent","is_active","isActive","init","jQuery","automatewooWorkflowLocalizeScript","initCustomerWinBackTrigger","$minField","$maxField","minVal","parseInt","placeholder","$triggers_box","$manual_workflow_box","$actions_box","$actions_container","$action_template","$trigger_select","first","$manual_trigger_select","init_triggers_box","init_actions_box","init_options_box","restoreOptions","fill_trigger_fields","fill_manual_workflow_trigger_fields","e","preventDefault","add_new_action","action_edit_close","action_delete","fill_action_fields","preview_action","$checkboxClickTracking","maybe_hide_tracking_options","show","hide","triggerName","fetch_trigger_data","done","fields","index","option","element","prop","selected","ajax","method","url","workflow_id","is_new_workflow","aw_fill_trigger_fields","actionNumber","get_number_of_actions","$newAction","clone","get_editing_action_cookie_name","slideDown","Cookies","sameSite","$this","$dependency","$checkbox","$parentRow","closest","checked","slideUp","selectedAction","$select","action_number","aw_fill_action_fields","title","inArray","supplied_data_items","is_action_compatible_with_current_trigger","allow_queueing","incompatibleRules","incompatibleActions","ruleGroup","rule","isRuleAvailable","ruleObject","uniq","modalView","compatible","required_data_items","isEmailPreviewOpen","tinyMCE","triggerSave","nameSelector","elementName","isGrouped","test","replace","fieldName","hasOwnProperty","openLoadingEmailPreview","action_fields","aw_save_preview_data","open_email_preview","complete","init_ajax_wysiwyg","tinymce","tinyMCEPreInit","mceInit","automatewoo_editor","qtInit","selector","wp_autoresize_on","qtags","quicktags","init_wysiwyg_buttons","canvas","settings","theButtons","use","buttons","buttonIndex","edButtons","indexOf","instance","inst","fullscreen","qt","FullscreenButton","getElementsByTagName","dir","textdirection","TextDirectionButton","toolbar","innerHTML","$form","isConfirmed","window","location","href","$typeSelectField","updateType","type","doReset","css","selectedIndex","initWorkflowType"],"sourceRoot":""}