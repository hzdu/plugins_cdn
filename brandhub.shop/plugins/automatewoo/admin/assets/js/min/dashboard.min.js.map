{"version":3,"file":"dashboard.min.js","mappings":"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","sources":["webpack://automatewoo/./admin/assets/js/dashboard.js"],"sourcesContent":["// Register eslint ignored glabals - to be revisited.\n// https://github.com/woocommerce/automatewoo/issues/1212\n/* global AW, automatewooDashboardLocalizeScript, _, HTMLElement */\n\n( function ( $ ) {\n\tconst self = {\n\t\t$el: $( '.automatewoo-dashboard-widgets' ),\n\n\t\tparams: {},\n\n\t\tinit() {\n\t\t\tself.params = automatewooDashboardLocalizeScript;\n\t\t\tself.initMasonry();\n\t\t},\n\n\t\tinitMasonry() {\n\t\t\tself.$el.masonry( {\n\t\t\t\titemSelector: '.automatewoo-dashboard-widget',\n\t\t\t\tcolumnWidth: '.automatewoo-dashboard-widget-sizer',\n\t\t\t\tpercentPosition: true,\n\t\t\t\tgutter: 20,\n\t\t\t\ttransitionDuration: '0.2s',\n\t\t\t} );\n\t\t},\n\t\t/**\n\t\t * Calls `drawGraph` with data translated from WC Analytics API reponse.\n\t\t *\n\t\t * @param {string|HTMLElement} container Chart container element or id, to be forwarded to drawGraph.\n\t\t * @param {Array<object>}      intervals Intervals data object returned from Reports API.\n\t\t * @param {Array<string>}      fields    Fields/metrices to be extracted from the reponse.\n\t\t * @param {Array}              params    Parameters to be forwarded, to be forwarded to drawGraph.\n\t\t */\n\t\tdrawGraphFromAnalyticsAPI( container, intervals, fields, params ) {\n\t\t\tconst translated = [];\n\t\t\tfor ( const field of fields ) {\n\t\t\t\ttranslated.push(\n\t\t\t\t\tintervals.map( ( row ) => [\n\t\t\t\t\t\tnew Date( row.interval ).getTime(),\n\t\t\t\t\t\trow.subtotals[ field ],\n\t\t\t\t\t] )\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn self.drawGraph( container, translated, params );\n\t\t},\n\n\t\tdrawGraph( container, data, params ) {\n\t\t\tconst $chart = $(\n\t\t\t\ttypeof container === 'string' ? '#' + container : container\n\t\t\t);\n\t\t\tconst sets = [];\n\t\t\tconst setColors = [ '#3498db', '#d0a0e4', '#72c9b2' ];\n\n\t\t\t_.each( data, function ( values, index ) {\n\t\t\t\tconst set = {\n\t\t\t\t\tlabel: '',\n\t\t\t\t\tdata: values,\n\t\t\t\t\tcolor: setColors.shift(),\n\t\t\t\t\tpoints: {\n\t\t\t\t\t\tshow: true,\n\t\t\t\t\t\tradius: 3,\n\t\t\t\t\t\tlineWidth: 2,\n\t\t\t\t\t\tfillColor: '#ffffff',\n\t\t\t\t\t\tfill: true,\n\t\t\t\t\t},\n\t\t\t\t\tlines: {\n\t\t\t\t\t\tshow: true,\n\t\t\t\t\t\tlineWidth: 2,\n\t\t\t\t\t\tfill: true,\n\t\t\t\t\t\tfillColor: {\n\t\t\t\t\t\t\tcolors: [ { opacity: 0.02 }, { opacity: 0.16 } ],\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tshadowSize: 0,\n\t\t\t\t\tisCurrency:\n\t\t\t\t\t\tparams.is_currency === true ||\n\t\t\t\t\t\t( params.is_currency && params.is_currency[ index ] ),\n\t\t\t\t};\n\n\t\t\t\tif ( _.size( data ) > 1 ) {\n\t\t\t\t\tset.lines.fill = false;\n\t\t\t\t}\n\n\t\t\t\tsets.push( set );\n\t\t\t} );\n\n\t\t\tconst options = {\n\t\t\t\tlegend: {\n\t\t\t\t\tshow: false,\n\t\t\t\t},\n\t\t\t\tgrid: {\n\t\t\t\t\tcolor: '#aaa',\n\t\t\t\t\tborderColor: 'transparent',\n\t\t\t\t\tborderWidth: 0,\n\t\t\t\t\thoverable: true,\n\t\t\t\t},\n\t\t\t\txaxis: {\n\t\t\t\t\tcolor: '#e5e5e5',\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\ttickColor: 'transparent',\n\t\t\t\t\tmode: 'time',\n\t\t\t\t\tmonthNames: AW.params.locale.month_abbrev,\n\t\t\t\t\ttickLength: 1,\n\t\t\t\t\tfont: {\n\t\t\t\t\t\tcolor: '#aaa',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tyaxis: {\n\t\t\t\t\tcolor: '#fff',\n\t\t\t\t\tfont: {\n\t\t\t\t\t\tcolor: '#fff',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif ( Number( params.interval ) === 30 ) {\n\t\t\t\toptions.xaxis.minTickSize = [ 4, 'day' ];\n\t\t\t}\n\n\t\t\t$.plot( $chart, sets, options );\n\n\t\t\t$chart.on( 'plothover', function ( event, pos, item ) {\n\t\t\t\tconst $wrap = $chart.parents(\n\t\t\t\t\t'.automatewoo-dashboard-chart:first'\n\t\t\t\t);\n\t\t\t\tconst $tooltip = $chart.siblings(\n\t\t\t\t\t'.automatewoo-dashboard-chart__tooltip:first'\n\t\t\t\t);\n\t\t\t\tconst wrapOffset = $wrap.offset();\n\n\t\t\t\tif ( item && item.series.points.show ) {\n\t\t\t\t\tlet content = item.datapoint[ 1 ];\n\n\t\t\t\t\tif ( item.series.isCurrency ) {\n\t\t\t\t\t\tcontent = AW.price( content );\n\t\t\t\t\t}\n\n\t\t\t\t\t$tooltip\n\t\t\t\t\t\t.html( content )\n\t\t\t\t\t\t.css( {\n\t\t\t\t\t\t\ttop: item.pageY - 9 - wrapOffset.top,\n\t\t\t\t\t\t\tleft: item.pageX + 12 - wrapOffset.left,\n\t\t\t\t\t\t} )\n\t\t\t\t\t\t.fadeIn( 200 );\n\t\t\t\t} else {\n\t\t\t\t\t$tooltip.hide();\n\t\t\t\t}\n\t\t\t} );\n\t\t},\n\t};\n\n\tAW.Dashboard = self;\n\tself.init();\n\n\t// This is overly simplified implementation. Follows the behavior of the previous jQuery widget.\n\t// The element\n\t//  - Don't observe nor react to attribute changes.\n\t//  - Assumes upgrade scenario - attributes are already set once the element is connected;\n\t//\t\tentire light DOM content is well structured and already present.\n\t//  - Do not stop, abort, or bother about `fetch` races if the element is reconnected.\n\twindow.customElements.define(\n\t\t'automatewoo-dashboard-chart',\n\t\tclass AWDashboardChart extends HTMLElement {\n\t\t\tconnectedCallback() {\n\t\t\t\tthis.setAttribute( 'aw-loading', '' );\n\n\t\t\t\tconst fields = this.getAttribute( 'fields' ).split( ',' );\n\t\t\t\tconst isCurrency = JSON.parse(\n\t\t\t\t\t`[${ this.getAttribute( 'is-currency' ) || '' }]`\n\t\t\t\t);\n\n\t\t\t\tconst requestParams = new URLSearchParams( {\n\t\t\t\t\tinterval: 'day',\n\t\t\t\t\tafter: this.getAttribute( 'after' ),\n\t\t\t\t\tbefore: this.getAttribute( 'before' ),\n\t\t\t\t\tfields,\n\t\t\t\t\tper_page: 100,\n\t\t\t\t} );\n\t\t\t\twp.apiFetch( {\n\t\t\t\t\tpath:\n\t\t\t\t\t\tthis.getAttribute( 'endpoint' ) +\n\t\t\t\t\t\t'?' +\n\t\t\t\t\t\trequestParams.toString(),\n\t\t\t\t} ).then( ( response ) => {\n\t\t\t\t\tthis.removeAttribute( 'aw-loading' );\n\t\t\t\t\t// Draw chart.\n\t\t\t\t\tAW.Dashboard.drawGraphFromAnalyticsAPI(\n\t\t\t\t\t\tthis.querySelector(\n\t\t\t\t\t\t\t'automatewoo-dashboard-chart__flot'\n\t\t\t\t\t\t),\n\t\t\t\t\t\tresponse.intervals,\n\t\t\t\t\t\tfields,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tinterval: this.getAttribute( 'interval' ),\n\t\t\t\t\t\t\tis_currency: isCurrency,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\t// Fill totals.\n\t\t\t\t\tfor ( let index = 0; index < fields.length; index++ ) {\n\t\t\t\t\t\tconst key = fields[ index ];\n\t\t\t\t\t\tthis.querySelector(\n\t\t\t\t\t\t\t`automatewoo-dashboard-chart__header-figure[name=${ key }]`\n\t\t\t\t\t\t).innerHTML = isCurrency[ index ]\n\t\t\t\t\t\t\t? AW.price( response.totals[ key ] )\n\t\t\t\t\t\t\t: response.totals[ key ];\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\t);\n} )( jQuery );\n"],"names":["$","self","$el","params","init","automatewooDashboardLocalizeScript","initMasonry","masonry","itemSelector","columnWidth","percentPosition","gutter","transitionDuration","drawGraphFromAnalyticsAPI","container","intervals","fields","translated","field","push","map","row","Date","interval","getTime","subtotals","drawGraph","data","$chart","sets","setColors","_","each","values","index","set","label","color","shift","points","show","radius","lineWidth","fillColor","fill","lines","colors","opacity","shadowSize","isCurrency","is_currency","size","options","legend","grid","borderColor","borderWidth","hoverable","xaxis","position","tickColor","mode","monthNames","AW","locale","month_abbrev","tickLength","font","yaxis","Number","minTickSize","plot","on","event","pos","item","$wrap","parents","$tooltip","siblings","wrapOffset","offset","series","content","datapoint","price","html","css","top","pageY","left","pageX","fadeIn","hide","Dashboard","window","customElements","define","HTMLElement","connectedCallback","this","setAttribute","getAttribute","split","JSON","parse","requestParams","URLSearchParams","after","before","per_page","wp","apiFetch","path","toString","then","response","removeAttribute","querySelector","length","key","innerHTML","totals","jQuery"],"sourceRoot":""}