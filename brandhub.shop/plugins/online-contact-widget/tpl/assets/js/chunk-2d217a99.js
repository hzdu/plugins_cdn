(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217a99"],{c84b:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"wbs-content content-cd wp-contact-detail"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":t.isLoaded}},[e("div",{staticClass:"cd-wp"},[e("div",{staticClass:"wb-header"},[e("div",{domProps:{innerHTML:t._s(t.getStatus(t.row))}}),e("div",{staticClass:"wb-main-title"},[e("span",[t._v("["+t._s(t.row["type"])+"]")]),e("strong",{staticClass:"ml"},[t._v(t._s(t.row["title"]))])]),t.row["name"]?e("p",{staticClass:"meta-item"},[e("span",[t._v("联系人: "+t._s(t.row["name"]))])]):t._e(),t.row["email"]?e("p",{staticClass:"meta-item"},[e("span",[t._v("邮箱: "+t._s(t.row["email"]))])]):t._e(),t.row["mobile"]?e("p",{staticClass:"meta-item"},[e("span",[t._v("电话: "+t._s(t.row["mobile"]))])]):t._e(),t.row["qq"]?e("p",{staticClass:"meta-item"},[e("span",[t._v("QQ: "+t._s(t.row["qq"]))])]):t._e(),t.row["wx"]?e("p",{staticClass:"meta-item"},[e("span",[t._v("微信: "+t._s(t.row["wx"]))])]):t._e(),e("p",{staticClass:"meta-item"},[e("span",[t._v("发起时间: "+t._s(t.row["create_date"]))]),t.row["update_time"]?e("span",{staticClass:"ml-l"},[t._v("更新时间: "+t._s(t.row["update_time"]))]):t._e()]),e("div",{staticClass:"hd-ctrl-area"},[1==t.row["status"]?e("el-button",{attrs:{title:"关闭工单",icon:"el-icon-close",circle:""},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.doClose(t.row.id)}}}):t._e(),e("el-button",{attrs:{title:"返回列表",type:"primary",icon:"el-icon-back",circle:""},on:{click:t.backList}})],1)]),e("div",{staticClass:"rec-content-box cd-main"},[e("ul",t._l(t.list,(function(s,a){return e("li",{key:"item"+a,staticClass:"rec-detail ",class:a>0?"by-me":"by-wb"},[e("div",{staticClass:"msg-hd"},[e("div",{staticClass:"user-name"},[e("strong",[t._v(t._s(a>0?s["display_name"]+"备注:":"留言内容:"))]),e("span",{staticClass:"wk"},[t._v(t._s(s["create_date"]))])])]),e("div",{staticClass:"msg-detail"},[e("div",{domProps:{innerHTML:t._s(s["content"])}})])])})),0)]),e("div",{staticClass:"reply-box"},[e("el-input",{attrs:{clearable:"",type:"textarea",autosize:{minRows:1,maxRows:3},placeholder:"请输入备注"},model:{value:t.newReply.content,callback:function(s){t.$set(t.newReply,"content",s)},expression:"newReply.content"}}),e("div",{staticClass:"rb-ft"},[e("el-button",{staticClass:"ml",attrs:{size:"mini",plain:"",type:"primary"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.reply()}}},[t._v("添加备注")])],1),e("div",{staticClass:"rb-ft"},[2!=t.row.status?e("el-link",{staticClass:"ml",attrs:{size:"mini",plain:""},on:{click:function(s){return t.doClose(t.row.id)}}},[t._v("关闭")]):t._e(),e("el-link",{staticClass:"ml",attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(s){return t.doRemove(t.row.id)}}},[t._v("删除")]),1==t.row.status?e("el-button",{staticClass:"ml",attrs:{type:"success"},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),t.setProcessed.apply(null,arguments)}}},[t._v("标记为已处理")]):t._e()],1)],1)])])])},i=[],n={name:"ContactDetail",data(){return{formChanged:0,isLoaded:0,loading:null,cnf:{},row:{},list:[],newReply:{content:""},fileObj:null,uploadStatus:" ",isSelectFile:!1,files:[],remark:"",isMobile:!1}},inject:["reload"],created(){this.loading=this.$wbui.loading(),this._getData(),this.isMobile=/mobile/i.test(navigator.userAgent)},methods:{_getData(){const t=this,s=t.$route.query.id;t.$api.getData({action:"ocw_contact",op:"get_detail",id:s}).then(s=>{t.row=s["row"],t.list=s["list"],t.cnf=s["cnf"],t.isLoaded=1,t.$wbui.close(t.loading)})},backList(){this.$router.push({path:"/wo-list"})},getStatus(t){return 2==t.status?'<span class="wb-status-tag done">已关闭</span>':1==t.is_new?'<span class="wb-status-tag new">待处理</span>':3==t.status?'<span class="wb-status-tag success">已处理</span>':"-"},setProcessed(){const t=this;t.$wbui.confirm("确认标记为已处理？",()=>{const s={action:"ocw_contact",op:"processed",id:t.row.id};t.$api.saveData(s).then(s=>{t.$wbui.toast("已标记"),t.reload()})})},doClose(t){const s=this;s.$wbui.confirm("确认关闭？",()=>{const e={action:"ocw_contact",op:"set_close",id:t};s.$api.saveData(e).then(t=>{s.$wbui.toast("已关闭"),s._getData()})})},doRemove(t){const s=this;s.$wbui.confirm("删除后将无法恢复，确认删除？",(function(){const e={action:"ocw_contact",op:"delete",id:t};s.$api.saveData(e).then((function(t){s.$wbui.toast("删除成功"),s.backList()}))}))},reply(){const t=this;if(""===t.newReply.content)return t.$wbui.toast("请输入内容再提交"),!1;t.$api.saveData({action:"ocw_contact",op:"reply",id:t.row.id,content:t.newReply.content}).then(s=>{t.reload()})},removeFileItem(t){this.files.splice(t,1)}},beforeRouteLeave(t,s,e){const a=this;a.formChanged>1?a.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes(){return e(!1),a.updateData(()=>{e()}),!1},no(){return e(),!1}}):e()}},o=n,c=e("2877"),l=Object(c["a"])(o,a,i,!1,null,null,null);s["default"]=l.exports}}]);