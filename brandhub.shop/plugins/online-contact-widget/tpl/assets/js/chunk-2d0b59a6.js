(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b59a6"],{"1a33":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wbs-content"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":t.isLoaded}},[a("div",{staticClass:"wbs-main"},[a("el-button-group",{staticClass:"wbs-filter-items fr"},[a("el-button",{attrs:{size:"mini",plain:"",type:""==t.q.status?"primary":""},on:{click:function(e){return t.doFillter("status","")}}},[t._v("全部")]),t._l({1:"待处理",3:"已处理",2:"已关闭"},(function(e,s){return a("el-button",{key:s,attrs:{type:s==t.q.status?"primary":"",size:"mini",plain:""},on:{click:function(e){return t.doFillter("status",s)}}},[t._v(t._s(e))])}))],2),t.isLoaded?a("div",{staticClass:"wbs-ctrl-bar"},[a("el-select",{staticClass:"ctrl-item w8em",attrs:{clearable:"",filterable:"",placeholder:"工单类型",size:"medium"},model:{value:t.q.type,callback:function(e){t.$set(t.q,"type",e)},expression:"q.type"}},[a("el-option",{attrs:{label:"全部类型",value:"-1"}}),t._l(t.cnf.type,(function(t,e){return a("el-option",{key:e,attrs:{filterable:"",label:t,value:e}})}))],2),a("el-input",{staticClass:"m-hide ctrl-item wbs-input-short",attrs:{placeholder:"输入关键字",clearable:"",size:"medium"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearch.apply(null,arguments)}},model:{value:t.q.q,callback:function(e){t.$set(t.q,"q",e)},expression:"q.q"}}),a("el-button",{staticClass:"ctrl-item",attrs:{type:"primary",plain:"",name:"search",size:"medium"},on:{click:t.doSearch}},[t._v("筛选")]),a("div",{staticClass:"switch-btn align-right",on:{click:t.toggle_panel}},[t.isExpanded?a("div",[a("i",{staticClass:"el-icon-arrow-up"}),t._v(" "),a("span",[t._v("收起面板")])]):a("div",[a("i",{staticClass:"el-icon-search"}),t._v(" "),a("span",[t._v("筛选")])])])],1):t._e(),t.isLoaded?a("div",{staticClass:"mt log-box"},[a("el-table",{staticClass:"wbs-table",staticStyle:{width:"100%"},attrs:{data:t.list,"default-sort":{prop:"update_time",order:"descending"}},on:{"sort-change":t.sortChange}},[a("el-table-column",{attrs:{label:"状态","class-name":"w10"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"状态"},domProps:{innerHTML:t._s(t.getStatus(e.row))}})]}}],null,!1,576336415)}),a("el-table-column",{attrs:{label:"类型","class-name":"w10"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"类型"}},[a("em",[t._v(t._s(t.cnf.type[e.row.type]))])])]}}],null,!1,3892116586)}),a("el-table-column",{attrs:{label:"联系人"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"联系人"}},[a("span",[t._v(t._s(e.row.name))])])]}}],null,!1,685465711)}),a("el-table-column",{attrs:{label:"联系方式","class-name":"w20"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"联系方式"}},[e.row.email?a("span",[t._v("邮箱: "+t._s(e.row.email))]):t._e(),e.row.qq?a("span",[t._v("QQ: "+t._s(e.row.qq))]):t._e(),e.row.wx?a("span",[t._v("微信: "+t._s(e.row.wx))]):t._e(),e.row.mobile?a("span",[t._v("手机: "+t._s(e.row.mobile))]):t._e()])]}}],null,!1,1129001847)}),a("el-table-column",{attrs:{"sort-by":"create_date",label:"时间","class-name":"w15",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"时间"},domProps:{innerHTML:t._s(t.dataFormat(e.row.create_date))}})]}}],null,!1,345573946)}),a("el-table-column",{attrs:{align:"right","class-name":"w20 ctrl-items",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticClass:"ml-10",attrs:{size:"mini",type:"primary"},on:{click:function(a){return t.getDetail(e.row.id)}}},[t._v("详情")])]}}],null,!1,1896753338)})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],staticClass:"btns-bar"},[a("el-pagination",{attrs:{background:"",small:!!t.$cnf.is_mobile,layout:t.$cnf.is_mobile?"pager, total, prev, next":"total, prev, pager, next, jumper","page-size":20,total:1*t.total,"pager-count":5},on:{"current-change":t.nav_page}})],1)],1):t._e(),a("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1),t.isPro?t._e():a("wbs-more-sources")],1)])},l=[],n={name:"ManagerContactList",components:{},data(){return{isLoaded:0,cnf:{},list:[],isPro:1,loading_item:1,total:0,page:1,num:30,order:"desc",daterange:[],q:{status:1,q:""},search:{},isExpanded:!1,multipleSelection:[],batch_op:""}},created(){this._getData(),this.isPro=this.$cnf.is_pro,this.cnf.type=this.$cnf.subject_type},methods:{_getData(){const t=this;let e={action:"ocw_contact",op:"get_list",num:t.num,page:t.page,status:t.q.status};t.$api.getData(e).then(e=>{t.list=e["data"],t.total=e["total"],t.isLoaded=1})},sortChange(t){if("custom"!=t.column.sortable)return;if(!t.order)return;const e=this;e.search.page=e.page,e.search.orderby=t.column.sortBy,e.search.order="ascending"==t.order?"asc":"desc",e.total>0&&e.loadData()},navPage(t){this.page=t,this.loadData()},doSearch(){this.page=1,Object.assign(this.search,this.q),this.loadData()},doFillter(t,e){const a=this;let s={};a.page=1,s[t]=e,a.q[t]=e,Object.assign(this.search,s),this.loadData()},loadData(){const t=this;t.loading_item=t.$wbui.loading();let e={action:"ocw_contact",op:"get_list",num:t.num,page:t.page};Object.assign(e,t.search),console.log("opt",e),t.$api.getData(e).then(e=>{t.list=e.data,t.total=e.total,t.$wbui.close(t.loading_item)})},dataFormat(t){const e=t.split(" ");return e.length>1?'<em class="ib">'+e[0]+'</em> <em class="ib">'+e[1]+"</em>":t},doClose(t){const e=this;e.$wbui.confirm("确认关闭？",(function(){const a={action:"ocw_contact",op:"set_close",id:t};e.$api.saveData(a).then((function(t){e.$wbui.toast("已关闭"),e.loadData()}))}))},getStatus(t){return 2==t.status?'<em class="wb-status-tag done">已关闭</em>':1==t.is_new?'<em class="wb-status-tag new">待处理</em>':1==t.is_read?'<em class="wb-status-tag success">已处理</em>':"-"},getDetail(t){this.$router.push({path:"/wo-detail",query:{id:t}})},toggle_panel(){const t=this;t.$el.querySelector(".wbs-ctrl-bar").classList.toggle("expand"),t.isExpanded=!t.isExpanded}}},i=n,o=a("2877"),r=Object(o["a"])(i,s,l,!1,null,null,null);e["default"]=r.exports}}]);