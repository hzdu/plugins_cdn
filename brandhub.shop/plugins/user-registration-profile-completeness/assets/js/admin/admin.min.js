!function(o){var t={init:function(){t.bindUIActions(),o(document).ready(t.ready)},ready:function(){t.enableOrDisableOption(o("#user_registration_profile_completeness_enable_custom_percentage")),t.enableOrDisableOption(o("#user_registration_profile_completeness_enable_profile_incomplete_notice")),t.enableOrDisableProfileCompleteness(o("#user_registration_enable_profile_completeness")),t.updateRemainingPercent(),o(document.body).on("ur_new_field_created",function(e,t){var{fieldKey:t,label:n,visibleTo:i}=t;["hidden","section_title","html","billing_address_title","billing_country","billing_first_name","billing_last_name","billing_company","billing_address_1","billing_address_2","shipping_city","billing_state","billing_postcode","separate_shipping","shipping_address_title","shipping_country","shipping_first_name","shipping_last_name","shipping_company","shipping_address_1","shipping_address_2","shipping_city","shipping_state","shipping_postcode"].includes(t)||(t=o("<option>",{value:t,text:n}),o(".ur-advance-setting.ur-advance-field_visibility",o(document)).length&&"edit_form"!==i&&"both"!==i&&undefined!==i)||o("select.user-registration-profile-completeness-custom-percentage-field",o(document)).append(t).trigger("change")}),o(document.body).on("ur_field_removed",function(e,t){t=t.fieldName;o("select.user-registration-profile-completeness-custom-percentage-field",o(document)).find('option[value="'+t+'"]').remove().trigger("change")}),o(document.body).on("change",".ur-general-setting-field.ur-type-text",function(){var e=o(this).val(),t=o(this).parents(".ur-general-setting-block").attr("class").split("ur-general-setting-block ur-general-setting-")[1],n=o("select.user-registration-profile-completeness-custom-percentage-field",o(document.body));o('option[value="'+t+'"]',n).text(e)})},bindUIActions:function(){o(document).on("click","#user_registration_profile_completeness_enable_custom_percentage",function(){t.enableOrDisableOption(o(this))}),o(document).on("click","#user_registration_profile_completeness_enable_profile_incomplete_notice",function(){t.enableOrDisableOption(o(this))}),o(document).on("click","#user_registration_enable_profile_completeness",function(){t.enableOrDisableProfileCompleteness(o(this))}),o(document).on("change",".user-registration-profile-completeness-custom-percentage-field",function(){t.updateRemainingPercent()}),o(document).on("change",".user-registration-profile-completeness-custom-percentage-value, #user_registration_profile_completeness_completion_percentage",function(){var e=o(this).val(),e=parseFloat(e.replace(/[^\d\.]/g,"").replace(/\.(([^\.]*)\.)*/g,".$2"));isNaN(e)?o(this).val(""):/\./.test(e)&&2<e.toString().split(".")[1].length?o(this).val(e.toFixed(2).toString()+"%"):o(this).val(e.toString()+"%"),t.updateRemainingPercent()})},enableOrDisableOption:function(e){e.is(":checked")?e.parents(".form-row").next(".form-row").show():e.parents(".form-row").next(".form-row").hide()},enableOrDisableProfileCompleteness:function(e){e.is(":checked")?(e.closest("#profile-completeness-settings").find(".form-row").not(e.parents(".form-row")).show(),t.enableOrDisableOption(o("#user_registration_profile_completeness_enable_custom_percentage")),t.enableOrDisableOption(o("#user_registration_profile_completeness_enable_profile_incomplete_notice"))):e.closest("#profile-completeness-settings").find(".form-row").not(e.parents(".form-row")).hide()},updateRemainingPercent:function(){var t=0,e=(o(".user-registration-profile-completeness-custom-percentage-value",o(document)).each(function(){var e;o(this).parent(".user-registration-profile-completeness-custom-percentage-value-wrapper").prev("div").find("select.user-registration-profile-completeness-custom-percentage-field").val().length&&""!==(e=o(this).val())&&(e=parseFloat(e.replace("%","")),t+=e)}),t=t.toFixed(2),parseFloat(o("#user_registration_profile_completeness_completion_percentage").val())-t);o(".ur-profile-completeness-remaining-percentage").text(e)}};t.init()}(jQuery);