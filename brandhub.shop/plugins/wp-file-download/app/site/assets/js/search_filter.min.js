function initDatepicker(){initDateRange("cfrom","cto"),initDateRange("ufrom","uto"),initDateRange("widget_cfrom","widget_cto"),initDateRange("widget_ufrom","widget_uto")}function initDateRange(i,n){jQuery("#"+i).datetimepicker({format:wpfdvars.dateFormat,validateOnBlur:!0,scrollMonth:!1,scrollDate:!1,scrollInput:!1,onShow:function(t){this.setOptions({maxDate:0})},onSelectDate:function(t,e){var a=!!jQuery("#"+n).val()&&jQuery("#"+n).val();a&&t.dateFormat(wpfdvars.dateFormat)>a&&(alert("Please select dates smaller than "+a),e.val(""))},closeOnDateSelect:!0,timepicker:!1}),jQuery("#"+n).datetimepicker({format:wpfdvars.dateFormat,validateOnBlur:!0,scrollMonth:!1,scrollDate:!1,scrollInput:!1,onShow:function(t){this.setOptions({maxDate:0})},onSelectDate:function(t,e){var a=!!jQuery("#"+i).val()&&jQuery("#"+i).val();a&&t.dateFormat(wpfdvars.dateFormat)<a&&(alert("Please select a date greater than "+a),e.val(""))},closeOnDateSelect:!0,timepicker:!1})}function initSorting(){jQuery(".orderingCol").click(function(t){t.preventDefault(),ajaxSearch(jQuery(this).data("ordering"),jQuery(this).data("direction"))}),jQuery(".list-results #limit").change(function(t){return t.preventDefault(),ajaxSearch(),!1})}function initTags(){var e=jQuery;if(0<e("#input_tags").length){var a=e("#input_tags").val().split(",");e(".chk_ftags").each(function(){var t=e(this).val();-1<a.indexOf(t)&&e(this).prop("checked",!0)})}0<e("#filter_catid").length&&catChange("filter_catid")}function showDefautTags(){var i=jQuery;"undefined"!=typeof defaultAllTags&&0<defaultAllTags.length&&(i(".chk-tags-filtering ul").empty(),defaultAllTags.sort(function(t,e){return e<t?1:t<e?-1:0}),i.each(defaultAllTags,function(t,e){var a=i('<li><input title="" type="checkbox" name="chk_ftags[]" onclick="fillInputTags();" class="chk_ftags" id="ftags'+t+'" value="'+e+'"> <span>'+e.replace(/-/g," ")+"</span></li>");i(".chk-tags-filtering ul").append(a)}),i("#input_tags").val(""))}function catChange(t){var i=jQuery,e=i("#"+t).val();if(""===e)return showDefautTags(),void i(".chk_ftags").parent().show();0!==i(".chk-tags-filtering ul").length&&i.ajax({type:"GET",url:wpfdajaxurl+"task=search.getTagByCatId",data:{catId:e}}).done(function(t){if(!0===t.success)i(".chk-tags-filtering ul").empty(),i.each(t.tags,function(t,e){var a=i('<li><input title="" type="checkbox" name="chk_ftags[]" onclick="fillInputTags();" class="chk_ftags" id="ftags'+t+'" value="'+e.slug+'"> <span>'+e.name.replace(/-/g," ")+"</span></li>");i(".chk-tags-filtering ul").append(a)}),i("#input_tags").val("");else{i(".chk-tags-filtering ul").empty();var e=i("<li>"+t.message+"</li>");i(".chk-tags-filtering ul").append(e),i("#input_tags").val("")}})}function fillInputTags(){var t=[];jQuery(".chk_ftags").each(function(){this.checked&&jQuery(this).is(":visible")&&t.push(jQuery(this).val())}),0<t.length?jQuery("#input_tags").val(t.join(",")):jQuery("#input_tags").val("")}function getSearchParams(t){var i={};return location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(t,e,a){i[e]=a}),t?i[t]:i}function ajaxSearch(t,e){var a=jQuery,i=a("#adminForm"),n={q:a(i).find("input[name=q]").val(),catid:a(i).find("select[name=catid]").val(),ftags:a(i).find("input[name=ftags]").val(),cfrom:a(i).find("input[name=cfrom]").val(),cto:a(i).find("input[name=cto]").val(),ufrom:a(i).find("input[name=ufrom]").val(),uto:a(i).find("input[name=uto]").val(),limit:a(i).find("select[name=limit]").val()};if(n=cleanObj(n),jQuery.isEmptyObject(n))return a("#txtfilename").focus(),!1;void 0!==t&&(n.ordering=t),void 0!==e&&(n.dir=e);var r=jQuery.param(n);window.history.pushState(n,"",wpfdvars.basejUrl+"&"+r),a.ajax({type:"POST",url:wpfdajaxurl+"task=search.display&limit=-1",data:n,beforeSend:function(){a("#wpfd-results").html(""),a("#wpfd-results").prepend(a("#loader").html())}}).done(function(t){a("#wpfd-results").html(t),initSorting(),"undefined"!=typeof wpfdColorboxInit&&wpfdColorboxInit()})}jQuery(document).ready(function(l){initDatepicker(),initSorting(),l(".chk_ftags").click(function(){fillInputTags()}),l("#filter_catid").on("change",function(){catChange("filter_catid")}),l("#search_catid").change(function(){catChange("search_catid")}),l("#adminForm").submit(function(t){return t.preventDefault(),!1}),jQuery(".icon-date").click(function(){var t=jQuery(this).attr("data-id");jQuery("#"+t).datetimepicker("show")}),jQuery(".feature-toggle").click(function(){var t=jQuery(this).parents(".by-feature");jQuery(t).find(".feature").slideToggle("slow",function(){jQuery(".feature-toggle").toggleClass(function(){return jQuery(this).is(".feature-toggle-up")?"feature-toggle-down":"feature-toggle-up"})})}),l("#btnsearchbelow, #btnsearch").click(function(t){t.preventDefault(),ajaxSearch()}),l("#btnReset").click(function(t){t.preventDefault(),resetFilters(),l("#wpfd-results").html("")}),l("#widget_btnReset").click(function(t){t.preventDefault(),resetFilters("#widget_search")}),jQuery(".list-results table tr td a.file-item").click(function(t){return!0}),resetFilters=function(t){var e=l("#adminForm");null!=t&&(e=l(t));var a=l(e).find("input, select");l.each(a,function(t,e){"checkbox"===l(e).attr("type")?l(e).prop("checked",!1):(l(e).val("").trigger("change").trigger("liszt:updated").trigger("chosen:updated"),l(e).hasClass("tagit")&&l(e).tagit("removeAll"))})},populateFilters=function(t){var r=l("#adminForm");l.each(t,function(t,e){var a=l(r).find("input[name="+t+"], select[name="+t+"]");if(0<a.length&&(l(a).val(e).trigger("change").trigger("liszt:updated").trigger("chosen:updated"),l(a).hasClass("tagit")&&(l(a).tagit("removeAll"),""!==e)))for(var i=e.split(","),n=0;n<i.length;n++)l(a).tagit("createTag",i[n])})},cleanObj=function(t){for(var e in t)t.hasOwnProperty(e)&&(t[e]||delete t[e]);return t},jQuery(window).on("popstate",function(t){var e=t.originalEvent.state;if(resetFilters(),null!==e){var a=e;populateFilters(a),a.view="frontsearch",a.format="raw",l.ajax({type:"POST",url:basejUrl+"index.php?option=wpfd",data:a}).done(function(t){l("#wpfd-results").html(t)})}else l("#wpfd-results").html("")});var t=getSearchParams();void 0===t.q&&void 0===t.catid&&void 0===t.ftags&&void 0===t.cfrom&&void 0===t.cto&&void 0===t.ufrom&&void 0===t.uto||ajaxSearch()});