jQuery(function(s){var e=function(){if("undefined"==typeof user_registration_params)return!1;s(document).on("user_registration_frontend_form_data_render",function(e,r,t){"input"===r.get(0).tagName.toLowerCase()&&r.hasClass(".uraf-profile-picture-input")&&"undefined"!==r.val()&&0<r.val()&&(t.value=r.val())});var a={init:function(){s(document).ready(a.ready),this.load_validation(),this.init_event()},ready:function(){a.loadPhoneField()},load_validation:function(){if("undefined"==typeof s.fn.validate)return!1},loadPhoneField:function(){var e,r="",i={};if("undefined"==typeof s.fn.intlTelInput)return!1;"yes"!==user_registration_params.disable_user_details&&(i.geoIpLookup=a.currentIpToCountry),"yes"===user_registration_params.disable_user_details&&(e=this.getFirstBrowserLanguage(),r=-1<e.indexOf("-")?e.split("-").pop():""),r&&(e=window.intlTelInputGlobals.getCountryData(),r=(e=e.filter(function(e){return e.iso2===r.toLowerCase()})).length?r:""),i.initialCountry="yes"===user_registration_params.disable_user_details&&r?r:"auto",s(".ur-smart-phone-field").each(function(e,r){var t=s(r);i.hiddenInput=t.data("id"),i.utilsScript=user_registration_advanced_fields_params.utils_url,t.intlTelInput(i),t.blur(function(){var e,r=t.closest("p.form-row");t.intlTelInput("isValidNumber")?(t.siblings('input[type="hidden"]').val(t.intlTelInput("getNumber")),r.find("#"+t.data("id")).attr("aria-invalid",!1),r.find("#"+t.data("id")+"-error").remove()):""!==t.val()&&(r.find("#"+t.data("id")+"-error").remove(),e='<label id="'+t.data("id")+'-error" class="user-registration-error" for="'+t.data("id")+'">'+user_registration_params.message_validate_phone_number+"</label>",r.append(e),r.find("#"+t.data("id")).attr("aria-invalid",!0))})})},getFirstBrowserLanguage:function(){var e,r,t=window.navigator,i=["language","browserLanguage","systemLanguage","userLanguage"];if(Array.isArray(t.languages))for(e=0;e<t.languages.length;e++)if((r=t.languages[e])&&r.length)return r;for(e=0;e<i.length;e++)if((r=t[i[e]])&&r.length)return r;return""},currentIpToCountry:function(t){s.get("https://ipapi.co/json").always(function(e){var r=e&&e.country?e.country:"";r||(r=-1<(e=a.getFirstBrowserLanguage()).indexOf("-")?e.split("-").pop():""),t(r)})},dataURItoBlob:function(e){for(var r=(0<=e.split(",")[0].indexOf("base64")?atob:unescape)(e.split(",")[1]),e=e.split(",")[0].split(":")[1].split(";")[0],t=new Uint8Array(r.length),i=0;i<r.length;i++)t[i]=r.charCodeAt(i);return new Blob([t],{type:e})},send_file:function(n,e){var r=user_registration_advanced_fields_params.ajax_url+"?action=uraf_profile_picture_upload_method_upload&security="+user_registration_advanced_fields_params.uraf_profile_picture_upload_nonce,t=new FormData;s("#ur-profile-pic").data("crop-picture")&&(e=s("#crop_container").attr("src"),t.append("cropped_image",s(".cropped_image_size").val())),n[0].files[0]?t.append("file",n[0].files[0]):""!==e&&(e=a.dataURItoBlob(e),e=new File([e],"snapshot.jpg"),t.append("file",e),t.append("is_snapshot",!0)),t.append("form_id",s(".ur-frontend-form form").data("form-id"));var l=n.closest(".uraf-profile-picture-upload").find(".wp_uraf_profile_picture_upload"),u=l.text();s.ajax({url:r,data:t,type:"POST",processData:!1,contentType:!1,beforeSend:function(){l.text(user_registration_advanced_fields_params.uraf_profile_picture_uploading),l.closest(".ur-frontend-form").find(".ur-submit-button").prop("disabled",!0)},complete:function(e){var r,t="",i=0;l.closest(".ur-frontend-form").find(".ur-submit-button").prop("disabled",!1),n.parent().parent().parent().find(".user-registration-error").remove(),n.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-input").val("");try{var a=JSON.parse(e.responseText);if("undefined"==typeof a.success||"undefined"==typeof a.data)throw user_registration_advanced_fields_params.uraf_profile_picture_something_wrong;t=a.data.message,a.success||(t='<p class="uraf-profile-picture-error user-registration-error">'+t+"</p>"),a.success&&(t="",i=a.data.attachment_id,r=a.data.profile_picture_url,s(".user-registration-img-container").find(".profile-preview").attr("src",r),n.closest(".uraf-profile-picture-upload").find(".profile-preview").attr("src",r))}catch(o){t=user_registration_advanced_fields_params.uraf_profile_picture_something_wrong}n.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-remove").attr("data-attachment-id",a.data.attachment_id).removeAttr("style"),n.closest(".uraf-profile-picture-upload").find(".wp_uraf_take_snapshot ").attr("style","display:none"),n.closest(".uraf-profile-picture-upload").find(".wp_uraf_profile_picture_upload ").attr("style","display:none"),n.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-error").remove(),n.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-file-error").remove(),n.closest(".uraf-profile-picture-upload").append('<span class="uraf-profile-picture-file-error">'+t+"</span>"),0<i&&n.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-input").val(a.data.upload_files),l.text(u)}})},crop_image:function(r){var t;s(document.body).hasClass("theme-twentytwentytwo")&&s("#crop_container,.jcrop-holder, .jcrop-tracker").css({width:"400px",heigth:"400px"}),s("#crop_container").Jcrop({aspectRatio:1,boxWidth:400,boxHeight:400,onSelect:function(e){t={x:e.x,y:e.y,w:e.w,h:e.h}},setSelect:[100,100,50,50]}),s(".swal2-confirm").on("click",function(){var e={x:t.x,y:t.y,w:t.w,h:t.h,holder_width:s("#crop_container").css("width"),holder_height:s("#crop_container").css("height")};s(".cropped_image_size").val(JSON.stringify(e)),a.send_file(r,"")})},remove_avatar:function(e){var r=e.text(),t=e.data("attachment-id");e.closest(".uraf-profile-picture-upload").find(".ur_removed_profile_pic").length<=0&&((i=document.createElement("input")).setAttribute("type","hidden"),i.setAttribute("class","ur_removed_profile_pic"),i.setAttribute("name","ur_removed_profile_pic"),i.setAttribute("value",""),e.closest(".uraf-profile-picture-upload").append(i));var i=e.closest(".uraf-profile-picture-upload").find(".ur_removed_profile_pic").val(),i=new Set(i?JSON.parse(i):[]);i.add(t),e.closest(".uraf-profile-picture-upload").find(".ur_removed_profile_pic").val(JSON.stringify(Array.from(i))),e.text(user_registration_advanced_fields_params.uraf_profile_picture_removing),e.closest(".uraf-profile-picture-upload").find("#ur-profile-pic").val(""),e.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-input").val(""),e.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-file-error").remove(),s(".profile-preview").attr("src","https://secure.gravatar.com/avatar/?s=96&d=mm&r=g"),e.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-remove").data("attachment-id",""),e.closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-remove").attr("style","display:none"),e.closest(".uraf-profile-picture-upload").find(".wp_uraf_take_snapshot ").removeAttr("style"),e.closest(".uraf-profile-picture-upload").find(".wp_uraf_profile_picture_upload ").removeAttr("style"),e.closest(".uraf-profile-picture-upload").find(".uraf_profile_pic_file").remove(),e.closest(".uraf-profile-picture-upload").find('input[type="file"]').off("click"),e.text(r)},init_event:function(){a.handle_profile_picture_upload(),a.handle_range_field()},handle_profile_picture_upload:function(){s("body").on("change",'.uraf-profile-picture-upload-node input[type="file"]',function(){if(this.files&&this.files[0]){var e=this.files[0];if(-1===user_registration_advanced_fields_params.uraf_default_profile_picture_valid_file_types.split(",").indexOf(e.type))return s(this).closest(".uraf-profile-picture-upload").find(".uraf-profile-picture-error").remove(),void s(this).closest(".uraf-profile-picture-upload").append('<p class="uraf-profile-picture-error user-registration-error">'+user_registration_advanced_fields_params.uraf_profile_picture_invalid_file_type_error_text+"</p>");e=new FileReader;e.onload=function(e){s(".img").attr("src",e.target.result)},e.readAsDataURL(this.files[0]),s("#ur-profile-pic").data("crop-picture")?(Swal.fire({title:user_registration_advanced_fields_params.uraf_profile_picture_crop_picture_title,html:'<img id="crop_container" src="#" alt="your image" class="img"/><input type="hidden" name="cropped_image" class="cropped_image_size"/>',confirmButtonText:user_registration_advanced_fields_params.uraf_profile_picture_crop_picture_button,allowOutsideClick:!1,showCancelButton:!0,cancelButtonText:user_registration_advanced_fields_params.uraf_profile_picture_cancel_button,customClass:{container:"user-registration-swal2-container"}}),s(".swal2-cancel ").on("click",function(){s(".uraf-profile-picture-upload").find("#ur-profile-pic").val("")}),a.crop_image(s(this))):a.send_file(s(this),"")}}),s(document).on("click",".wp_uraf_profile_picture_upload",function(){s(this).closest(".uraf-profile-picture-upload").find('input[type="file"]').trigger("click")}),s(document).on("click",".wp_uraf_take_snapshot",function(){var r=s(this);Swal.fire({title:user_registration_advanced_fields_params.uraf_profile_picture_capture,html:'<div id="my_camera"></div>',confirmButtonText:user_registration_advanced_fields_params.uraf_profile_picture_capture,allowOutsideClick:!1,showCancelButton:!0,cancelButtonText:user_registration_advanced_fields_params.uraf_profile_picture_cancel_button,customClass:{container:"user-registration-swal2-container"}});var e=320,t=240;s(window).width()<s(window).height()&&(e=240,t=320),Webcam.set({width:e,height:t,dest_width:e,dest_height:t,crop_width:e,crop_height:t,image_format:"jpeg",jpeg_quality:90});var i=!1;Webcam.on("error",function(e){var r="",t="",t="WebcamError"===e.name?(r=user_registration_advanced_fields_params.uraf_profile_picture_ssl_error_title,user_registration_advanced_fields_params.uraf_profile_picture_ssl_error_text):(r=user_registration_advanced_fields_params.uraf_profile_picture_permission_error_title,user_registration_advanced_fields_params.uraf_profile_picture_permission_error_text);i=!0,swal.fire({icon:"warning",title:r,html:t,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:user_registration_advanced_fields_params.uraf_profile_picture_cancel_button_confirmation,cancelButtonColor:"#236bb0",customClass:{container:"user-registration-swal2-container"}})}),i||(Webcam.attach("#my_camera"),s(".swal2-confirm").on("click",function(){Webcam.snap(function(e){s("#ur-profile-pic").data("crop-picture")?(Swal.fire({title:user_registration_advanced_fields_params.uraf_profile_picture_crop_picture_title,html:'<img id="crop_container" src="#" alt="your image" class="img"/><input type="hidden" name="cropped_image" class="cropped_image_size"/>',confirmButtonText:user_registration_advanced_fields_params.uraf_profile_picture_crop_picture_button,allowOutsideClick:!1,showCancelButton:!0,cancelButtonText:user_registration_advanced_fields_params.uraf_profile_picture_cancel_button,customClass:{container:"user-registration-swal2-container"}}),s("#crop_container").attr("src",e),a.crop_image(r.closest(".uraf-profile-picture-upload").find('.uraf-profile-picture-upload-node input[type="file"]'))):a.send_file(r.closest(".uraf-profile-picture-upload").find('.uraf-profile-picture-upload-node input[type="file"]'),e)}),Webcam.reset()}),s(".swal2-cancel").on("click",function(){Webcam.reset()}))}),s(document).on("click",".uraf-profile-picture-remove",function(){a.remove_avatar(s(this))})},handle_range_field:function(){s(".ur-range-slider").each(function(){var e=s(this),r=s(this).closest(".ur-range-row").find(".ur-range-input"),t=s(this).closest(".ur-range-row").find(".ur-range-slider-reset-icon"),i=e.val();r.val(i),e.on("change",function(){var e=s(this).val();r.val(e),a.render_range_bubble(s(this))}),r.on("change",function(){e.val(s(this).val()),a.render_range_bubble(e)}),t.on("click",function(){e.val(i),r.val(i),a.render_range_bubble(e)}),"readonly"===e.attr("readonly")&&s(".ur-range-number").remove()})},render_range_bubble:function(e){var r,t=e.attr("max"),i=e.attr("min"),a=t-i,t=(e.val()-i)/a,i=e.width(),a=-1;t<0?r=0:1<t?r=i:(r=i*t+a,a-=t),e.next("output").css({left:r,marginLeft:a+"%"}).text(e.val()).show().trigger("change")}};a.init(jQuery),jQuery(document).ready(function(){jQuery(".input-timepicker").each(function(){var e=s(this),r=e.data("time-interval"),t=e.data("time-min"),i=e.data("time-max"),a=e.data("current-time");e.timepicker({disableTextInput:!0,step:r=void 0===r?30:r,minTime:t,maxTime:i}),a&&e.timepicker("setTime",new Date)}),s(".ur-frontend-form").find("form.edit-profile").hasClass("user-registration-EditProfileForm")&&s(".ur-smart-phone-field").each(function(e,r){var t=s(r),r=t.val();t.siblings('input[type="hidden"]').val(r)}),jQuery(".ur-field-item.field-select2 select, .ur-field-item.field-multi_select2 select, select.ur-field-profile-select2").selectWoo(),s.fn.select2.amd.define("select2/selectAllAdapter",["select2/utils","select2/dropdown","select2/dropdown/attachBody"],function(e,r,t){function i(){}return i.prototype.render=function(e){var i=this,e=e.call(this);return $selectAll=s('<a class="button-check-all" >'+user_registration_advanced_fields_params.uraf_select_all+"</a>"),$unselectAll=s('<a class="button-check-all">'+user_registration_advanced_fields_params.uraf_unselect_all+"</a>"),$btnContainer=s("<div>").append($selectAll).append($unselectAll),e.find(".select2-dropdown").prepend($btnContainer),$selectAll.on("click",function(e){var r=i.$element.find("option"),t=[];r.each(function(){t.push(s(this).val())}),i.$element.val(t),i.$element.trigger("change"),i.trigger("close")}),$unselectAll.on("click",function(e){i.$element.val([]),i.$element.trigger("change"),i.trigger("close")}),e},e.Decorate(e.Decorate(r,t),i)}),s("select[data-check-all=1]").select2({placeholder:"",dropdownAdapter:s.fn.select2.amd.require("select2/selectAllAdapter")})}),s(document).on("user_registration_frontend_after_ajax_complete",function(e,r,t,i){"message"===t&&(i.find("#ur-profile-pic").val(""),i.find(".uraf-profile-picture-file-error").remove(),s(".profile-preview").attr("src","https://secure.gravatar.com/avatar/?s=96&d=mm&r=g"),i.find(".uraf-profile-picture-remove").data("attachment-id",""),i.find(".uraf-profile-picture-remove").attr("style","display:none"),i.find(".wp_uraf_take_snapshot ").removeAttr("style"),i.find(".wp_uraf_profile_picture_upload ").removeAttr("style"),i.find('input[type="file"]').off("click"))})};e(jQuery),s(document).on("elementor/popup/show",function(){s(document).off("click",".wp_uraf_profile_picture_upload"),e(jQuery)}),s(".field-wysiwyg").each(function(){var e=s(this);"readonly"===e.find("input").attr("readonly")&&e.find(".wp-core-ui").css("pointer-events","none")}),s(window).bind("beforeunload",function(e){s(".ur-frontend-form ").each(function(){0===s(this).find(".edit-profile").length&&0<s(this).find(".uraf-profile-picture-upload").length&&s(this).find(".uraf-profile-picture-remove").trigger("click")})})});