!function(){"use strict";const e=e=>window.btoa(unescape(encodeURIComponent(e))),t=`o-countdown-last-visit-${e(window.location.pathname)}-`,i=`o-countdown-last-visit-time-${e(window.location.pathname)}-`;let n=0;class o{constructor(e){var o,s,d,a,l,r,h,c,u,m;this.id=n++,this.elem=e,this.elem.classList.add("ready");const{date:v,bhv:w,mode:g,timer:p,redirectLink:b,intvEnd:S,intvStart:E,onEndAction:T}=e.dataset;switch(this.rawData=null!=v?v:"",this.behaviour=null!==(o=w)&&void 0!==o?o:"default",this.mode=g,this.timer=null!=p?p:"0",this.redirectLink=b,this.startInterval=E,this.endInterval=S,this.hideTime=0,this.onEndAction=T,this.oneTimeRun={hideOrShow:!1},this.currentTime=Date.now(),this.components={},["second","minute","hour","day"].forEach((t=>{const i=e.querySelector(`div[name=${t}]`);if(i){const e=i.querySelector(".otter-countdown__label"),n=i.querySelector(".otter-countdown__value");this.components[t]={label:null!=e?e:void 0,value:null!=n?n:void 0}}})),this.onEndEvents=[()=>this.activateBehaviour(),()=>this.activateActions()],this.mode){case"timer":const e=localStorage.getItem(`${t}-${this.elem.id}`),n=localStorage.getItem(`${i}-${this.elem.id}`);this.deadline=parseInt(e)+parseInt(this.timer),(!e||parseInt(e)+parseInt(this.timer)-Date.now()>2592e6||n!==this.timer)&&(localStorage.setItem(`${t}-${this.elem.id}`,Date.now().toString()),localStorage.setItem(`${i}-${this.elem.id}`,this.timer),this.deadline=Date.now()+parseInt(this.timer)),this.canRestart&&(localStorage.setItem(`${t}--${this.elem.id}`,Date.now().toString()),this.deadline=Date.now()+parseInt(this.timer));break;case"interval":this.deadline=this.endInterval?new Date(this.endInterval+(null!==(s=null===(d=window)||void 0===d||null===(a=d.themeisleGutenbergCountdown)||void 0===a?void 0:a.timezone)&&void 0!==s?s:"")).getTime():0,this.hideTime=this.startInterval?new Date(this.startInterval+(null!==(l=null===(r=window)||void 0===r||null===(h=r.themeisleGutenbergCountdown)||void 0===h?void 0:h.timezone)&&void 0!==l?l:"")).getTime():0;break;default:this.deadline=this.rawData?new Date(this.rawData+(null!==(c=null===(u=window)||void 0===u||null===(m=u.themeisleGutenbergCountdown)||void 0===m?void 0:m.timezone)&&void 0!==c?c:"")).getTime():Date.now()}this.hideOrShow(this.isStopped&&"hide"===this.behaviour||this.mustBeHidden)}update(e){"interval"!==this.mode||this.oneTimeRun.hideOrShow||this.hideOrShow(this.mustBeHidden),e.forEach((e=>{var t,i,n,o,s,d,a;null!==(t=this.components)&&void 0!==t&&null!==(i=t[e.tag])&&void 0!==i&&i.label&&(null===(n=this.components[e.tag])||void 0===n||null===(o=n.label)||void 0===o?void 0:o.innerHTML)!==e.label&&(this.components[e.tag].label.innerHTML=null!==(a=e.label)&&void 0!==a?a:""),null!==(s=this.components)&&void 0!==s&&null!==(d=s[e.tag])&&void 0!==d&&d.value&&(this.components[e.tag].value.innerHTML=e.value)}))}onEnd(e){this.onEndEvents.push(e)}end(){const e=new CustomEvent("o-countdown-stop",{bubbles:!0,detail:{countdown:this}});this.elem.dispatchEvent(e),this.onEndEvents.forEach((e=>e()))}activateBehaviour(){switch(this.behaviour){case"default":break;case"hide":this.hide();break;case"redirectLink":this.redirectLink&&window.location.replace(this.redirectLink)}}activateActions(){const e=this.connectedBlocksSelector;e&&"all"===this.onEndAction&&(document.querySelectorAll(`${e}.o-cntdn-bhv-hide`).forEach((e=>e.classList.add("o-cntdn-hide"))),document.querySelectorAll(`${e}.o-cntdn-bhv-show`).forEach((e=>e.classList.remove("o-cntdn-bhv-show"))))}hideOrShow(e){e?this.hide():(this.oneTimeRun.hideOrShow=!0,this.show(),document.querySelectorAll(`${this.connectedBlocksSelector}.o-cntdn-bhv-hide`).forEach((e=>{e.classList.add("o-cntdn-ready")})))}hide(){this.elem.classList.add("o-hide")}show(){this.elem.classList.add("o-cntdn-ready"),this.elem.classList.remove("o-hide")}get connectedBlocksSelector(){return void 0===this.elem.id?null:`.o-countdown-trigger-on-end-${this.elem.id.split("-").pop()}`}get remainingTime(){return this.deadline-this.currentTime}get isStopped(){return 0>=this.remainingTime}get mustBeHidden(){return void 0!==this.startInterval&&0<=this.hideTime-this.currentTime}get canRestart(){return"restart"===this.behaviour&&"timer"===this.mode&&this.isStopped}set time(e){this.currentTime=e}}class s{constructor(){this.countdowns={},this.running=new Set,this.stopped=new Set}register(e){e&&(e.onEnd((()=>{this.running.delete(e.id),this.stopped.add(e.id)})),this.countdowns[e.id]=e,this.running.add(e.id))}startTimer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;this.timer=setInterval((()=>{const e=Date.now();this.running.forEach((t=>{this.updateCountdown(this.countdowns[t],e)})),0===this.running.size&&this.stopTimer()}),e)}stopTimer(){clearInterval(this.timer)}updateCountdown(e,t){const{id:i}=e;e.time=t;try{const{remainingTime:t}=e,i=Math.floor(t/864e5),n=Math.floor(t/36e5%24),o=Math.floor(t/6e4%60),s=Math.floor(t/1e3%60),{i18n:d}=window.themeisleGutenbergCountdown,a=[{tag:"day",label:1<i?d.days:d.day,value:i},{tag:"hour",label:1<n?d.hours:d.hour,value:n},{tag:"minute",label:1<o?d.minutes:d.minute,value:o},{tag:"second",label:1<s?d.seconds:d.second,value:s}].filter((t=>{var i,n;let{tag:o}=t;return!(null!==(i=e.settings)&&void 0!==i&&null!==(n=i.exclude)&&void 0!==n&&n.includes(o))})).map((t=>{var i;return{...t,value:null!==(i=e.settings)&&void 0!==i&&i.keepNeg?t.value.toString():Math.max(0,t.value).toString()}}));e.update(a),e.isStopped&&e.end()}catch(e){console.error(e),this.running.delete(i)}}}var d;d=()=>{const e=document.querySelectorAll(".wp-block-themeisle-blocks-countdown"),t=new s;e.forEach((e=>{const i=new o(e);t.register(i)})),t.startTimer()},"undefined"!=typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",d):d())}();