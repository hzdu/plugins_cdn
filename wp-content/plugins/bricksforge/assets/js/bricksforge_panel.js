var brfPanel;class BricksforgePanel{domContentLoadedEvent;currentUserRole;roles;hideElementsOnly=!1;timelines=[];splitTextInstances=[];timelineActions=[];constructor(e){e&&(this.domContentLoadedEvent=e),this.init()}async init(){this.setGlobals(),"undefined"!=typeof BRFVARS&&1==BRFVARS.panelActivated&&(bricksIsFrontend||this.loadPanel(),setTimeout((()=>{this.renderPanel()}))),this.renderLogic(),this.hideElementsOnly&&this.handlePermissionSettings()}setGlobals(){if("undefined"!=typeof BRFVARS&&(this.currentUserRole=BRFVARS.currentUserRole,this.roles=BRFVARS.permissions,this.roles&&Array.isArray(this.roles)))for(let e of this.roles)e.value==this.currentUserRole&&(this.hideElementsOnly=e.permissions.hideOnly)}renderLogic(){document.addEventListener("click",(e=>{const t=e.target;t instanceof HTMLElement&&"BUTTON"==t.tagName&&"brf-render"==t.parentNode.getAttribute("controlkey")&&(e.preventDefault(),document.querySelector("li.reload-canvas").click())}))}loadPanel(){let e=document.createElement("div");e.setAttribute("id","bricksforge-triggers"),document.querySelector("#bricks-preview")&&document.querySelector("#bricks-preview").appendChild(e);let t=document.querySelector("#bricks-toolbar ul.group-wrapper.left"),a=document.createElement("li");a.classList.add("brf-panel"),a.setAttribute("data-balloon","Bricksforge Panel (Shortcut: CTRL + P)"),a.setAttribute("data-balloon-pos","bottom");let i=document.createElement("span");i.classList.add("bricks-svg-wrapper"),a.appendChild(i),t&&t.appendChild(a),setTimeout((()=>{document.querySelector("#bricksforge-triggers .brf-triggers-container")&&(document.querySelector("#bricksforge-triggers .brf-triggers-container").style.bottom="-"+document.querySelector("#bricksforge-triggers .brf-triggers-container").getAttribute("data-height"))}),500),a.addEventListener("click",(()=>{const e=new Proxy(new URLSearchParams(window.location.search),{get:(e,t)=>e.get(t)});let t=document.querySelector("#bricksforge-triggers .brf-triggers-container");if(t.style.bottom&&1==t.style.opacity){if(t.style.bottom="-"+t.getAttribute("data-height"),t.style.opacity=0,e["brf-panel"]){const e=new URL(window.location.href);e.searchParams.delete("brf-panel"),window.history.replaceState(null,null,e)}}else if(t.style.bottom="-2px",t.style.opacity=1,!e["brf-panel"]){const e=new URL(window.location.href);e.searchParams.set("brf-panel","1"),window.history.replaceState(null,null,e)}}))}handlePermissionSettings(){document.addEventListener("mousedown",(e=>{let t=e.target;t&&(t.matches("li.elements")||t.closest("li")&&t.closest("li").classList.contains("elements"))&&setTimeout((()=>{this.hideCategories()}),250)})),setTimeout((()=>{this.hideCategories()}),750)}hideCategories(){for(let e of document.querySelectorAll("#bricks-panel-elements-categories .category")){if(!(e.classList.contains("category-layout")||e.classList.contains("category-basic")||e.classList.contains("category-general")||e.classList.contains("category-media")||e.classList.contains("category-wordpress")||e.classList.contains("category-single"))){let t=e.querySelector(".sortable-wrapper").querySelectorAll("li");for(let e of t)e.setAttribute("style","display:block !important");return}let t=e.querySelector(".sortable-wrapper").querySelectorAll("li"),a=!0;for(let e of t)"none"!=getComputedStyle(e).display&&(a=!1);a&&(e.style.display="none")}}renderPanel(e=!1,t=[],a=!1,i=!1){if(!BRFVARS||!BRFVARS.panel||!BRFVARS.panel.length){if(i){this.timelines=[];for(let e of t)this.handleTimeline(e,!1,a);return}return}if(i){this.timelines=[];for(let e of t)this.handleTimeline(e,!1,!0);return}if(0==e&&bricksIsFrontend){let e=BRFVARS.panel[0].instances;if(e&&e.length>0)for(let t of e){this.checkInstanceConditions({data:t,trigger:t.selector?t.selector:null,target:null})&&!t.disabled&&this.handleInstance(t)}}let n=BRFVARS.panel[0].timelines;if(!0===e&&(this.timelines=[],n=[],n.push(t)),!0===a&&(this.timelines=[],n=[],n=t),n&&n.length>0){if("undefined"==typeof gsap)return void console.warn("Bricksforge Panel: You try to use timelines, but GSAP is not loaded.");for(let t of n)if(!t.disabled||!bricksIsFrontend)if(t.matchMedia){gsap.matchMedia().add(t.matchMedia,(()=>{this.handleTimeline(t,e,a)}))}else this.handleTimeline(t,e,a)}}checkInstanceConditions(e){let t=e.data;if(!t.conditions||!t.conditions.length)return!0;let a=t.conditionsRelation?t.conditionsRelation:"and",i=[];for(let a of t.conditions)switch(a.type){case"elementNode":if(!a.elementNodeSelector||!a.elementNodeSelector||!a.elementNodeOption){i.push(!1);break}let t=document.querySelector(a.elementNodeSelector);if(!t){i.push(!1);break}switch(a.elementNodeOption){case"class":if(!a.elementNodeValue){i.push(!1);break}if("has"==a.elementNodeOperator){if(t.classList.contains(a.elementNodeValue)){i.push(!0);break}i.push(!1);break}if("notHas"==a.elementNodeOperator){if(t.classList.contains(a.elementNodeValue)){i.push(!1);break}i.push(!0);break}break;case"attribute":if(!a.elementNodeValue){i.push(!1);break}if(!a.elementNodeAttribute){i.push(!1);break}if("has"==a.elementNodeOperator){if(t.getAttribute(a.elementNodeAttribute)==a.elementNodeValue){i.push(!0);break}i.push(!1);break}if("notHas"==a.elementNodeOperator){if(t.getAttribute(a.elementNodeAttribute)!=a.elementNodeValue){i.push(!0);break}i.push(!1);break}}break;case"localStorage":if(!a.localStorageKey||!a.localStorageOperator){i.push(!1);break}switch(a.localStorageOperator){case"exists":i.push(null!=localStorage.getItem(a.localStorageKey));break;case"notExists":i.push(!localStorage.getItem(a.localStorageKey));break;case"==":i.push(localStorage.getItem(a.localStorageKey)==a.localStorageValue);break;case"!=":i.push(localStorage.getItem(a.localStorageKey)!=a.localStorageValue);break;case">":i.push(localStorage.getItem(a.localStorageKey)>parseInt(a.localStorageValue));break;case"<":i.push(localStorage.getItem(a.localStorageKey)<parseInt(a.localStorageValue));break;case">=":i.push(localStorage.getItem(a.localStorageKey)>=parseInt(a.localStorageValue));break;case"<=":i.push(localStorage.getItem(a.localStorageKey)<=parseInt(a.localStorageValue))}break;case"sessionStorage":if(!a.localStorageKey||!a.localStorageOperator){i.push(!1);break}switch(a.localStorageOperator){case"exists":i.push(null!=sessionStorage.getItem(a.localStorageKey));break;case"notExists":i.push(!sessionStorage.getItem(a.localStorageKey));break;case"==":i.push(sessionStorage.getItem(a.localStorageKey)==a.localStorageValue);break;case"!=":i.push(sessionStorage.getItem(a.localStorageKey)!=a.localStorageValue);break;case">":i.push(sessionStorage.getItem(a.localStorageKey)>parseInt(a.localStorageValue));break;case"<":i.push(sessionStorage.getItem(a.localStorageKey)<parseInt(a.localStorageValue));break;case">=":i.push(sessionStorage.getItem(a.localStorageKey)>=parseInt(a.localStorageValue));break;case"<=":i.push(sessionStorage.getItem(a.localStorageKey)<=parseInt(a.localStorageValue))}break;case"custom":if(!a.customCondition){i.push(!1);break}let n=e.trigger?e.trigger:null,o=e.target?e.target:null,r=new Function("return ((trigger, target) => {return "+a.customCondition+"})")();if("function"!=typeof r){i.push(!1);break}i.push(!0===r(n,o))}if(!i.length)return!1;switch(a){case"and":return!i.includes(!1);case"or":return i.includes(!0);default:return!1}}async handleInstance(e){if(!e.event||!e.selector||!e.actions.length){if(!e.selector&&"pageLoad"!=e.event&&!e.selector&&"scrollPosition"!=e.event&&"scrollUp"!=e.event&&"scrollDown"!=e.event&&"visibilitychange"!=e.event&&"resize"!=e.event)return void console.warn("You try to use the Bricksforge Panel, but there are some informations missing. This warning appears for the instance: "+(e.name?e.name:"No Name"));e.selector="html"}let t=e.selector,a=!1,i=e.event,n=e.actions,o=!!e.delay&&e.delay;switch(o&&await this.wait(o),e.selectorType){case"exactly":default:t=document.querySelector(t);break;case"all":t=document.querySelectorAll(t),a=!0;break;case"siblings":t=document.querySelector(t).parentNode.children,a=!0;break;case"parent":t=document.querySelector(t).parentNode;break;case"children":t=document.querySelector(t).children,a=!0;break;case"closest":if(!e.closestValue)break;t=document.querySelector(t).closest(e.closestValue)}if(null!=t)for(let o of n){let n=o.action.target,s=o.action.targetElement,l=!1;switch(n){case"same":default:if(!t)break;n=document.querySelector(e.selector);break;case"triggered":n="triggered";break;case"all":if(!t)break;n=document.querySelectorAll(e.selector),l=!0;break;case"siblings":if(!t)break;n=document.querySelector(e.selector).parentNode.children,l=!0;break;case"parent":if(!t)break;n=document.querySelector(e.selector).parentNode;break;case"children":if(!t)break;n=document.querySelector(e.selector).children,l=!0;break;case"closest":if(!t)break;if(!n)break;n=document.querySelector(e.selector).closest(s);break;case"querySelector":if(!t)break;n=document.querySelector(e.selector).querySelector(s);break;case"custom":n=document.querySelector(s);break;case"customAll":n=document.querySelectorAll(s),l=!0}switch(i){case"scrollPosition":document.addEventListener("scroll",(a=>{if(e.consoleLog&&"event"==e.consoleLog&&console.log(a),!e.scrollPosition||!e.scrollPositionOperator)return;let i;switch(e.scrollPositionOperator){case"==":default:i=window.scrollY==e.scrollPosition;break;case">":i=window.scrollY>e.scrollPosition;break;case"<":i=window.scrollY<e.scrollPosition;break;case">=":i=window.scrollY>=e.scrollPosition;break;case"<=":i=window.scrollY<=e.scrollPosition}i&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})}));break;case"scrollUp":var r=0;document.addEventListener("scroll",(a=>{var i=window.pageYOffset||document.documentElement.scrollTop;i<r&&(e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})),r=i<=0?0:i}),!1);break;case"scrollDown":r=0;document.addEventListener("scroll",(a=>{var i=window.pageYOffset||document.documentElement.scrollTop;i>r&&(e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})),r=i<=0?0:i}),!1);break;case"inViewport":if(!t)return;document.addEventListener("scroll",(i=>{if(a)t.forEach((t=>{var a=t.getBoundingClientRect(),r=a.top,s=a.bottom;let c=e.inViewportVisibility?e.inViewportVisibility:"partially",u=e.inViewportVisibilityOffset?e.inViewportVisibilityOffset:0;("partially"==c?r<window.innerHeight-u&&s>=0:r>=0&&s<=window.innerHeight+u)&&(e.consoleLog&&"event"==e.consoleLog&&console.log(i),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:i,actionDataRaw:o}))}));else{var r=t.getBoundingClientRect(),s=r.top,c=r.bottom;let a=e.inViewportVisibility?e.inViewportVisibility:"partially",u=e.inViewportVisibilityOffset?e.inViewportVisibilityOffset:0;("partially"==a?s<window.innerHeight-u&&c>=0:s>=0&&c<=window.innerHeight+u)&&(e.consoleLog&&"event"==e.consoleLog&&console.log(i),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:i,actionDataRaw:o}))}}));break;case"notInViewport":if(!t)return;document.addEventListener("scroll",(i=>{if(a)t.forEach((t=>{var a=t.getBoundingClientRect(),r=a.top,s=a.bottom;r<window.innerHeight&&s>=0||(e.consoleLog&&"event"==e.consoleLog&&console.log(i),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:i,actionDataRaw:o}))}));else{var r=t.getBoundingClientRect(),s=r.top,c=r.bottom;s<window.innerHeight&&c>=0||(e.consoleLog&&"event"==e.consoleLog&&console.log(i),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:i,actionDataRaw:o}))}}));break;case"pageLoad":this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:this.domContentLoadedEvent,actionDataRaw:o});break;case"visibilitychange":document.addEventListener("visibilitychange",(a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),e.visibilityState&&document.visibilityState==e.visibilityState&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})}));break;case"resize":window.addEventListener("resize",(a=>{if(e.consoleLog&&"event"==e.consoleLog&&console.log(a),e.resizeDimension&&e.resizeOperator&&e.resizeValue)switch(e.resizeOperator){case"==":"width"==e.resizeDimension&&window.innerWidth==e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o}),"height"==e.resizeDimension&&window.innerHeight==e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o});break;case">":"width"==e.resizeDimension&&window.innerWidth>e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o}),"height"==e.resizeDimension&&window.innerHeight>e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o});break;case"<":"width"==e.resizeDimension&&window.innerWidth<e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o}),"height"==e.resizeDimension&&window.innerHeight<e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o});break;case">=":"width"==e.resizeDimension&&window.innerWidth>=e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o}),"height"==e.resizeDimension&&window.innerHeight>=e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o});break;case"<=":"width"==e.resizeDimension&&window.innerWidth<=e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o}),"height"==e.resizeDimension&&window.innerHeight<=e.resizeValue&&this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o});break;default:this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})}else this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})}));break;case"resizeObserver":if(!t)return;new ResizeObserver((a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})})).observe(t);break;case"mutationObserver":if(!t)return;if(a)t.forEach((t=>{let a=!!e.mutationObserverAttributes&&e.mutationObserverAttributes,i=!!e.mutationObserverChildList&&e.mutationObserverChildList,r=!!e.mutationObserverCharacterData&&e.mutationObserverCharacterData,s=!!e.mutationObserverSubTree&&e.mutationObserverSubTree;new MutationObserver((a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})})).observe(t,{attributes:a,childList:i,characterData:r,subtree:s})}));else{let a=!!e.mutationObserverAttributes&&e.mutationObserverAttributes,i=!!e.mutationObserverChildList&&e.mutationObserverChildList,r=!!e.mutationObserverCharacterData&&e.mutationObserverCharacterData,s=!!e.mutationObserverSubTree&&e.mutationObserverSubTree;new MutationObserver((a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,actionData:o.action,event:a,actionDataRaw:o})})).observe(t,{attributes:a,childList:i,characterData:r,subtree:s})}break;case"custom":if(!e.customEventName){console.log("No");break}if(a){Array.prototype.forEach.call(t,(t=>{t.addEventListener(e.customEventName,(a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,event:a,actionData:o.action,actionDataRaw:o})}))}));break}t.addEventListener(e.customEventName,(a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,event:a,actionData:o.action,actionDataRaw:o})}));break;default:if(a){Array.prototype.forEach.call(t,(t=>{t.addEventListener(i,(a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,event:a,actionData:o.action,actionDataRaw:o})}))}));break}t.addEventListener(i,(a=>{e.consoleLog&&"event"==e.consoleLog&&console.log(a),this.fireAction({action:o.action.value,selector:t,target:n,queryAll:l,instance:e,event:a,actionData:o.action,actionDataRaw:o})}))}}}async fireAction(e){let t=e.instance,a=e.action,i=e.actionData,n=e.selector,o=e.target,r=e.queryAll,s=!!e.event&&e.event.target,l=e.actionDataRaw,c=!!i.delay&&i.delay;if(!a||!n||!o)return;if(l.conditions&&l.conditions.length>0){if(!this.checkInstanceConditions({data:l,trigger:n,target:o}))return}c&&await this.wait(c);let u=i.except&&"none"!=i.except,g=!!i.exceptSelector&&i.exceptSelector,d=s;switch(u&&!1!==g&&s&&s!=document.querySelector(g)&&(d=s.closest(g)),"triggered"==o&&(o=s!=document.querySelector(t.selector)?s.closest(t.selector):document.querySelector(t.selector)),a){case"show":if(r)for(let e of o)u&&d==e||(e.style.display=i.display?i.display:"block");else o.style.display=i.display?i.display:"block";break;case"hide":if(r)for(let e of o)u&&d==e||(e.style.display="none");else o.style.display="none";break;case"addClass":if(!i.cssClass)return;if(r)for(let e of o)u&&d==e||e.classList.add(i.cssClass);else o.classList.add(i.cssClass);break;case"removeClass":if(!i.cssClass)return;if(r)for(let e of o)u&&d==e||e.classList.remove(i.cssClass);else o.classList.remove(i.cssClass);break;case"toggleClass":if(!i.cssClass)return;if(r)for(let e of o)u&&d==e||e.classList.toggle(i.cssClass);else o.classList.toggle(i.cssClass);break;case"setAttribute":if(!i.attributeKey||!i.attributeValue)return;if(r)for(let e of o)u&&d==e||e.setAttribute(i.attributeKey,i.attributeValue);else o.setAttribute(i.attributeKey,i.attributeValue);break;case"removeAttribute":if(!i.attributeKeyRemoval)return;if(r)for(let e of o)u&&d==e||e.removeAttribute(i.attributeKeyRemoval);else o.removeAttribute(i.attributeKeyRemoval);break;case"gsap":if("pageLoad"==t.event&&await this.wait(0),!i.animationAction||!i.animationTimeline)return;let a=i.animationAction,l=i.animationTimeline,c=i.animationSelectorType?i.animationSelectorType:"all",g=[];"all"==c&&(g=this.timelines.filter((e=>e.id==l))),"trigger"==c&&(g=this.timelines.filter((e=>{let t=[...s.getElementsByTagName("*")].includes(e.trigger);return!(e.id!=l||e.trigger!=s&&!t)}))),g.forEach((e=>{let t=e.tl;switch(a){case"play":t.play();break;case"pause":t.pause();break;case"restart":t.restart();break;case"resume":t.resume();break;case"reverse":t.reverse()}}));break;case"jsFunction":if(!i.jsFunctionName)return;let m=e.event,p=i.jsFunctionName,f=new Function("return (async (trigger, event, timelines, getTimeline) => {"+p+"})")();"function"==typeof f&&(async()=>{const e=await this.getTimelines();await f(n,m,e,(async e=>await this.getTimelineById(e)))})();break;case"gsapFlip":if(!o)return;gsap.registerPlugin(Flip);let b=e.actionData.flipStylesProps?e.actionData.flipStylesProps:"",h=e.actionData.flipEase?e.actionData.flipEase:"power1.inOut",y=e.actionData.flipDuration?e.actionData.flipDuration:1,S=!!e.actionData.flipIncludeChildren&&e.actionData.flipIncludeChildren,w=!!e.actionData.flipAbsolute&&e.actionData.flipAbsolute;if(r)for(let t of o){if(u&&d==t)continue;const a=Flip.getState(1==S?[t,...t.children]:t,{props:b});if(o.style.transition="none",S)for(let e of o.children)e.style.transition="none";switch(e.actionData.flipStylesInput){case"custom":if(!e.actionData.flipStylesCode)break;let a=new Function("return ((trigger, target, event) => {"+e.actionData.flipStylesCode+"})")();"function"==typeof a&&a(n,t,e.event);break;case"removeClass":if(!e.actionData.flipStylesInputClassName)return;t.classList.remove(e.actionData.flipStylesInputClassName);break;case"addClass":if(!e.actionData.flipStylesInputClassName)return;t.classList.add(e.actionData.flipStylesInputClassName);break;case"toggleClass":if(!e.actionData.flipStylesInputClassName)return;t.classList.toggle(e.actionData.flipStylesInputClassName);break;case"appendTo":if(!e.actionData.flipStylesInputDOMElement)return;document.querySelector(e.actionData.flipStylesInputDOMElement).append(t)}Flip.from(a,{duration:y,ease:h,absolute:w,nested:!0})}else{const t=Flip.getState(1==S?[o,...o.children]:o,{props:b});if(o.style.transition="none",S)for(let e of o.children)e.style.transition="none";switch(e.actionData.flipStylesInput){case"custom":if(!e.actionData.flipStylesCode)break;let t=new Function("return ((trigger, target, event) => {"+e.actionData.flipStylesCode+"})")();"function"==typeof t&&t(n,o,e.event);break;case"removeClass":if(!e.actionData.flipStylesInputClassName)return;o.classList.remove(e.actionData.flipStylesInputClassName);break;case"addClass":if(!e.actionData.flipStylesInputClassName)return;o.classList.add(e.actionData.flipStylesInputClassName);break;case"toggleClass":if(!e.actionData.flipStylesInputClassName)return;o.classList.toggle(e.actionData.flipStylesInputClassName);break;case"appendTo":if(!e.actionData.flipStylesInputDOMElement)return;document.querySelector(e.actionData.flipStylesInputDOMElement).append(o)}Flip.from(t,{duration:y,ease:h,absolute:w})}break;case"gsapSet":if(!o)return;if(r)for(let t of o){let a=i.gsapSetObject,r=new Function("return (trigger, target, event) => { return "+a+" }")();gsap.set(o,"function"==typeof r?r(n,t,e.event):{})}else{let t=i.gsapSetObject,a=new Function("return (trigger, target, event) => { return "+t+" }")();gsap.set(o,"function"==typeof a?a(n,o,e.event):{})}break;case"gsapTo":if(!o)return;if(r)for(let t of o){let a=i.gsapSetObject,r=new Function("return (trigger, target, event) => { return "+a+" }")();gsap.to(o,"function"==typeof r?r(n,t,e.event):{})}else{let t=i.gsapSetObject,a=new Function("return (trigger, target, event) => { return "+t+" }")();gsap.to(o,"function"==typeof a?a(n,o,e.event):{})}break;case"video_self_hosted_play":if(!o)return;if(r)for(let e of o)u&&d==e||e.play();else o.play();break;case"video_self_hosted_pause":if(!o)return;if(r)for(let e of o)u&&d==e||e.pause();else o.pause();break;case"video_self_hosted_stop":if(!o)return;if(r)for(let e of o)u&&d==e||(e.pause(),e.currentTime=0);else o.pause(),o.currentTime=0;break;case"storageSetItem":if(!e.actionData.storageItemKey||!e.actionData.storageItemValue)return;localStorage.setItem(e.actionData.storageItemKey,e.actionData.storageItemValue);break;case"storageRemoveItem":if(!e.actionData.storageItemKey)return;localStorage.removeItem(e.actionData.storageItemKey);break;case"sessionStorageSetItem":if(!e.actionData.storageItemKey||!e.actionData.storageItemValue)return;sessionStorage.setItem(e.actionData.storageItemKey,e.actionData.storageItemValue);break;case"sessionStorageRemoveItem":if(!e.actionData.storageItemKey)return;sessionStorage.removeItem(e.actionData.storageItemKey)}}handleTimeline(e,t=!1,a=!1){bricksIsFrontend||gsap.config({nullTargetWarn:!1}),e.animations&&e.animations.length||console.warn("Bricksforge Panel: You try to use timelines, but we found no animations for it. This warning appears for the timeline: "+e.name);let i=e.repeat?parseInt(e.repeat):0,n=e.repeatDelay?parseInt(e.repeatDelay):0,o=e.trigger?e.trigger:"scrollTrigger",r=e.triggerSelector?e.triggerSelector:"",s=!!e.animateTrigger&&e.animateTrigger,l=null!=e.scrub&&e.scrub,c=e.scrubValue?e.scrubValue:1,u=e.scrollStart?e.scrollStart:"top bottom",g=e.scrollEnd?e.scrollEnd:"bottom top",d=null!=e.pin&&e.pin,m=!e.pinSelector||e.pinSelector,p=null!=e.pinSpacing&&e.pinSpacing,f=null!=e.markers&&e.markers,b=null!=e.stagger&&e.stagger,h=e.staggerAmount?e.staggerAmount:.2,y=e.staggerFrom?e.staggerFrom:"start",S=e.staggerEase?e.staggerEase:"linear",w=e.toggleActions?e.toggleActions:"play none none none",v=null!=e.snap&&e.snap,k=!!e.snapTo&&e.snapTo,D=e.snapDuration?e.snapDuration:.3,A=e.snapDelay?e.snapDelay:.1,I=e.snapEase?e.snapEase:"power1.inOut",L=!!e.toggleClass&&e.toggleClass,T=e.toggleClassTargets?e.toggleClassTargets:"",V=e.toggleClassClassName?e.toggleClassClassName:"",C=null!=e.batch&&e.batch;if("scrollTrigger"===o)bricksIsFrontend&&gsap.registerPlugin(ScrollTrigger);if(!r||"."==r||!this.isValidSelector(r)){if("custom"!=o)return;r="html"}gsap.utils.toArray(r).forEach(((R,q)=>{if(C&&(s=!1,q>=1))return;const N=gsap.timeline({repeat:i,repeatDelay:n,..."scrollTrigger"==o&&e.animations.length&&bricksIsFrontend&&!C&&{scrollTrigger:{...1==L&&{toggleClass:{targets:T,className:V}},trigger:R,markers:f,start:u,...1==v&&{snap:{snapTo:k,duration:D,delay:A,ease:I}},toggleActions:w,end:g,...1==l&&{scrub:c},...1==d&&m&&{pin:m||!0,pinSpacing:p}}}});!0===a&&N.pause(),"custom"==o&&N.pause();for(let i of e.animations){if(!(!0!==a||i.selector&&"."!=i.selector&&document.querySelector(i.selector))){let e=!0===s&&r?r:".brf-dummy";if(N.to(e,{duration:1}),bricksIsFrontend)continue}if(!i.selector&&!1===s){bricksIsFrontend&&console.warn("Bricksforge Panel: You try to use timeline animations, but we found no selector for it. This warning appears for the timeline: "+e.name);continue}if("."==i.selector&&!1===s||!1===s&&!document.querySelector(i.selector))continue;if((!i.data||""==i.data)&&bricksIsFrontend){console.warn("Bricksforge Panel: You try to use timeline animations, but we found no animation data for it. This warning appears for the timeline: "+e.name);continue}let n;try{n=new Function("return (trigger, target) => {return "+i.data.replace(/cssVar\((.*?)\)/g,((e,t)=>this.cssVar(t.trim())))+"}")(this)}catch(e){if(n=new Function,bricksIsFrontend)continue}try{n(r,i.selector)}catch(t){if(n=new Function,console.warn("Bricksforge Panel: You try to use timeline animations, but your Animation data object seems to be wrong. This warning appears for the timeline: "+e.name),bricksIsFrontend)continue}let o,q=n(r,i.selector),O=i.duration?i.duration:.5,F=i.delay?i.delay:0,E=i.position?i.position:"default",P=i.customPosition?i.customPosition:">",K=i.ease?i.ease:"linear",z=!!i.splitText&&i.splitText,B=i.splitTextType?i.splitTextType:"chars",x=!!i.stagger&&i.stagger,H=i.staggerValue?i.staggerValue:.02;switch(E){case"<":case">":o=E;break;case"custom":o=this.isNumeric(P)?parseInt(P):P;break;default:o=">"}!0===t&&gsap.set(i.selector,{clearProps:"all"});let Y=!0===s&&r?i.childSelector?(bricksIsFrontend,R.querySelector(i.childSelector)):R:i.selector;if(Y||(Y=".brf-dummy"),bricksIsFrontend||N.pause(),!0===z){let e;gsap.registerPlugin(SplitText);let t=this.splitTextInstances.find((e=>e.id==i.id));switch(bricksIsFrontend?e=new SplitText(Y,{type:"chars,words,lines"}):(t?e=t:(e=this.splitTextInstances.push({id:i.id,type:i.splitTextType,data:new SplitText(Y,{type:"chars,words,lines"})}),e=this.splitTextInstances.find((e=>e.id==i.id))),e=e.data),B){case"chars":Y=e.chars;break;case"words":Y=e.words;break;case"lines":Y=e.lines}}if(void 0===this.timelineActions.find((e=>e.finalSelector==Y&&JSON.stringify(e.animationData)==JSON.stringify(q)))||!bricksIsFrontend){switch(i.method){case"from":C&&bricksIsFrontend?ScrollTrigger.batch(Y,{once:1==l||w&&"none"==w.split(" ")[2],markers:f,start:u,end:g,...1==L&&{toggleClass:{targets:T,className:V}},onEnter:(e,t)=>{N.from(e,{duration:O,delay:F,...q,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}},scrollTrigger:{trigger:e,toggleActions:w,...1==v&&{snap:{snapTo:k,duration:D,delay:A,ease:I}},...1==d&&m&&{pin:m||!0,pinSpacing:p},...1==l&&{scrub:c}}})},animationPositionValue:o}):N.from(Y,{duration:O,delay:F,...q,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}}},o);break;case"to":C&&bricksIsFrontend?ScrollTrigger.batch(Y,{once:1==l||w&&"none"==w.split(" ")[2],markers:f,start:u,end:g,...1==L&&{toggleClass:{targets:T,className:V}},onEnter:(e,t)=>{N.to(e,{immediateRender:bricksIsFrontend,duration:O,delay:F,...q,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}},scrollTrigger:{trigger:e,...1==v&&{snap:{snapTo:k,duration:D,delay:A,ease:I}},...1==l&&{scrub:c},...1==d&&m&&{pin:m||!0,pinSpacing:p}}})},animationPositionValue:o}):N.to(Y,{duration:O,delay:F,...q,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}}},o);break;case"fromTo":let t;try{t=new Function("return (trigger, target) => {return "+i.data2.replace(/cssVar\((.*?)\)/g,((e,t)=>this.cssVar(t.trim())))+"}")(this)}catch(e){if(t=new Function,bricksIsFrontend)continue}try{t(r,i.selector)}catch(a){if(t=new Function,console.warn("Bricksforge Panel: You try to use timeline animations, but your Animation data object seems to be wrong. This warning appears for the timeline: "+e.name),bricksIsFrontend)continue}let a=t(r,i.selector);C&&bricksIsFrontend?ScrollTrigger.batch(Y,{once:1==l||w&&"none"==w.split(" ")[2],markers:f,start:u,end:g,...1==L&&{toggleClass:{targets:T,className:V}},onEnter:(e,t)=>{N.fromTo(e,{duration:O,delay:F,...q,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}},scrollTrigger:{trigger:e,...1==v&&{snap:{snapTo:k,duration:D,delay:A,ease:I}},...1==l&&{scrub:c},...1==d&&m&&{pin:m||!0,pinSpacing:p}}},{duration:O,delay:F,...a,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}},scrollTrigger:{trigger:e,...1==v&&{snap:{snapTo:k,duration:D,delay:A,ease:I}},...1==l&&{scrub:c},...1==d&&m&&{pin:m||!0,pinSpacing:p}}},o)}}):N.fromTo(Y,{...q,immediateRender:bricksIsFrontend,duration:O,delay:F,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}}},{...a,duration:O,delay:F,ease:K,...!0===x&&{stagger:H},...!x&&b&&{stagger:{from:y,amount:h,ease:S}}},o)}this.timelineActions.push({finalSelector:Y,animationData:q})}}!1===t&&this.timelines.push({id:e.id,tl:N,children:N.getChildren(),trigger:R})}))}async getTimelineById(e){return new Promise(((t,a)=>{setTimeout((()=>{let i=this.timelines.find((t=>t.id==e));i?t(i):a(new Error("Timeline not found"))}))}))}cssVar(e){let t,a="";e.includes(",")?(a=e.split(",")[0],t=e.split(",")[1]):a=e,a=a.replace(/['"]+/g,""),t&&(t=t.replace(/['"]+/g,""));let i="'"+getComputedStyle(t?document.querySelector(t):document.body).getPropertyValue(a.toString().trim())+"'";return i=i.replace(/' /g,"'"),i=i.trim(),i}async getTimelines(){return await new Promise((e=>{setTimeout((()=>{e()}))})),this.timelines}isValidSelector(e){try{return document.querySelector(e),!0}catch(e){}return!1}async wait(e=1e3){return new Promise((async t=>{setTimeout((()=>{t()}),e)}))}parseObject(e){return new Function("return "+e)}isNumeric(e){return"string"==typeof e&&(!isNaN(e)&&!isNaN(parseFloat(e)))}isParsable(e){try{JSON5.parse(e)}catch(e){return!1}return!0}}document.addEventListener("DOMContentLoaded",(e=>{brfPanel=new BricksforgePanel(e)}));