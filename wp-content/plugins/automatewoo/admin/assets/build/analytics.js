!function(){var e={184:function(e,t){var r;!function(){"use strict";var a={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)){if(r.length){var i=n.apply(null,r);i&&e.push(i)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var s in r)a.call(r,s)&&r[s]&&e.push(s)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)}()},703:function(e,t,r){"use strict";var a=r(414);function n(){}function o(){}o.resetWarningCache=n,e.exports=function(){function e(e,t,r,n,o,i){if(i!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return r.PropTypes=r,r}},697:function(e,t,r){e.exports=r(703)()},414:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function t(t,r){if(t){if("string"==typeof t)return e(t,r);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,r):void 0}}function a(r){return function(t){if(Array.isArray(t))return e(t)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||t(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=window.wp.hooks,o=window.wp.i18n,i=window.wp.element,s=window.wc.components,l=window.wp.apiFetch,c=r.n(l),u=window.wp.url,p=window.wc.navigation,m=function(e){return e},d=function(e){return{key:e.id,label:e.title}},f={name:"workflows",options:function(e){return c()({path:"/automatewoo/workflows?"+new URLSearchParams({search:e,per_page:10,orderby:"popularity",_fields:"id,title"}).toString()})},getOptionIdentifier:function(e){return e.id},getOptionLabel:function(e){return e.title},getOptionKeywords:function(e){return[e.title]},getOptionCompletion:d},y=[{label:(0,o.__)("Show","automatewoo"),staticParams:["section","paged","per_page"],param:"filter",showFilters:function(){return!0},filters:[{label:(0,o.__)("All Workflows","automatewoo"),value:"all"},{label:(0,o.__)("Single Workflow","automatewoo"),value:"select_workflow",subFilters:[{component:"Search",value:"single_workflow",path:["select_workflow"],settings:{type:"custom",param:"workflows",getLabels:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1?arguments[1]:void 0,n="function"==typeof e?e(a):e,o=(0,p.getIdsFromQuery)(r);if(o.length<1)return Promise.resolve([]);var i={include:o.join(","),per_page:o.length};return c()({path:(0,u.addQueryArgs)(n,i)}).then((function(e){return e.map(t)}))}}("/automatewoo/workflows",d),labels:{placeholder:(0,o.__)("Type to search for a workflow","automatewoo"),button:(0,o.__)("Single Workflow","automatewoo")},autocompleter:f}}]}]}];function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function v(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function _(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function k(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}var E=window.wp.compose,C=window.wp.date,S=window.wp.data,T=window.lodash,q=r(697),P=r.n(q),D=window.wc.data,j=window.wc.date,x=window.wc.currency,F=r.n(x),N=window.wc.wcSettings,A=(0,N.getSetting)("currency"),I=F()(A),L=(0,i.createContext)(I);function B(e){var t=e.className,r=(0,o.__)("There was an error getting your stats. Please try again.","woocommerce"),a=(0,o.__)("Reload","woocommerce");return(0,i.createElement)(s.EmptyContent,{className:t,title:r,actionLabel:a,actionCallback:function(){window.location.reload()}})}B.propTypes={className:P().string};var Q=B;function M(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||0===e.length)return null;var a=e.slice(0),n=a.pop();if(n.showFilters(t,r)){var o=(0,p.flattenFilters)(n.filters),i=t[n.param]||n.defaultValue||"all";return(0,T.find)(o,{value:i})}return M(a,t,r)}function V(e){return function(t){return(0,C.format)(e,t)}}function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var W=function(e){_(n,e);var t,r,a=(t=n,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=R(t);if(r){var n=R(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k(this,e)});function n(){return h(this,n),a.apply(this,arguments)}return v(n,[{key:"shouldComponentUpdate",value:function(e){return e.isRequesting!==this.props.isRequesting||e.primaryData.isRequesting!==this.props.primaryData.isRequesting||e.secondaryData.isRequesting!==this.props.secondaryData.isRequesting||!(0,T.isEqual)(e.query,this.props.query)}},{key:"getItemChartData",value:function(){var e=this.props,t=e.primaryData,r=e.selectedChart;return t.data.intervals.map((function(e){var t={};return e.subtotals.segments.forEach((function(e){if(e.segment_label){var a=t[e.segment_label]?e.segment_label+" (#"+e.segment_id+")":e.segment_label;t[e.segment_id]={label:a,value:e.subtotals[r.key]||0}}})),H({date:(0,C.format)("Y-m-d\\TH:i:s",e.date_start)},t)}))}},{key:"getTimeChartData",value:function(){var e=this.props,t=e.query,r=e.primaryData,a=e.secondaryData,n=e.selectedChart,o=e.defaultDateRange,i=(0,j.getIntervalForQuery)(t,o),s=(0,j.getCurrentDates)(t,o),l=s.primary,c=s.secondary;return r.data.intervals.map((function(e,r){var o=(0,j.getPreviousDate)(e.date_start,l.after,c.after,t.compare,i),s=a.data.intervals[r];return{date:(0,C.format)("Y-m-d\\TH:i:s",e.date_start),primary:{label:"".concat(l.label," (").concat(l.range,")"),labelDate:e.date_start,value:e.subtotals[n.key]||0},secondary:{label:"".concat(c.label," (").concat(c.range,")"),labelDate:o.format("YYYY-MM-DD HH:mm:ss"),value:s&&s.subtotals[n.key]||0}}}))}},{key:"getTimeChartTotals",value:function(){var e=this.props,t=e.primaryData,r=e.secondaryData,a=e.selectedChart;return{primary:(0,T.get)(t,["data","totals",a.key],null),secondary:(0,T.get)(r,["data","totals",a.key],null)}}},{key:"renderChart",value:function(e,t,r,a){var n=this.props,l=n.emptySearchResults,c=n.filterParam,u=n.interactiveLegend,p=n.itemsLabel,m=n.legendPosition,d=n.path,f=n.query,y=n.selectedChart,g=n.showHeaderControls,h=n.primaryData,b=n.defaultDateRange,v=(0,j.getIntervalForQuery)(f,b),w=(0,j.getAllowedIntervalsForQuery)(f,b),_=(0,j.getDateFormatsForInterval)(v,h.data.intervals.length,{type:"php"}),O=l?(0,o.__)("No data for the current search","woocommerce"):(0,o.__)("No data for the selected date range","woocommerce"),k=this.context,R=k.formatAmount,E=k.getCurrencyConfig;return(0,i.createElement)(s.Chart,{allowedIntervals:w,data:r,dateParser:"%Y-%m-%dT%H:%M:%S",emptyMessage:O,filterParam:c,interactiveLegend:u,interval:v,isRequesting:t,itemsLabel:p,legendPosition:m,legendTotals:a,mode:e,path:d,query:f,screenReaderFormat:V(_.screenReaderFormat),showHeaderControls:g,title:y.label,tooltipLabelFormat:V(_.tooltipLabelFormat),tooltipTitle:"time-comparison"===e&&y.label||null,tooltipValueFormat:(0,D.getTooltipValueFormat)(y.type,R),chartType:(0,j.getChartTypeForQuery)(f),valueType:y.type,xFormat:V(_.xFormat),x2Format:V(_.x2Format),currency:E()})}},{key:"renderItemComparison",value:function(){var e=this.props,t=e.isRequesting,r=e.primaryData;if(r.isError)return(0,i.createElement)(Q,null);var a=t||r.isRequesting,n=this.getItemChartData();return this.renderChart("item-comparison",a,n)}},{key:"renderTimeComparison",value:function(){var e=this.props,t=e.isRequesting,r=e.primaryData,a=e.secondaryData;if(!r||r.isError||a.isError)return(0,i.createElement)(Q,null);var n=t||r.isRequesting||a.isRequesting,o=this.getTimeChartData(),s=this.getTimeChartTotals();return this.renderChart("time-comparison",n,o,s)}},{key:"render",value:function(){return"item-comparison"===this.props.mode?this.renderItemComparison():this.renderTimeComparison()}}]),n}(i.Component);W.contextType=L,W.propTypes={filters:P().array,isRequesting:P().bool,itemsLabel:P().string,limitProperties:P().array,mode:P().string,path:P().string.isRequired,primaryData:P().object,query:P().object.isRequired,secondaryData:P().object,selectedChart:P().shape({key:P().string.isRequired,label:P().string.isRequired,order:P().oneOf(["asc","desc"]),orderby:P().string,type:P().oneOf(["average","number","currency"]).isRequired}).isRequired},W.defaultProps={isRequesting:!1,primaryData:{data:{intervals:[]},isError:!1,isRequesting:!1},secondaryData:{data:{intervals:[]},isError:!1,isRequesting:!1}};var Y=(0,E.compose)((0,S.withSelect)((function(e,t){var r=t.charts,a=t.endpoint,n=t.filters,o=t.isRequesting,i=t.limitProperties,s=t.query,l=t.advancedFilters,c=i||[a],u=M(n,s),p=(0,T.get)(u,["settings","param"]),m=t.mode||function(e,t){if(e&&t){var r=(0,T.get)(e,["settings","param"]);if(!r||Object.keys(t).includes(r))return(0,T.get)(e,["chartMode"])}return null}(u,s)||"time-comparison",d=e(D.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings").woocommerce_default_date_range,f=e(D.REPORTS_STORE_NAME),y={mode:m,filterParam:p,defaultDateRange:d};if(o)return y;var g=c.some((function(e){return s[e]&&s[e].length}));if(s.search&&!g)return H(H({},y),{},{emptySearchResults:!0});var h=r&&r.map((function(e){return e.key})),b=(0,D.getReportChartData)({endpoint:a,dataType:"primary",query:s,selector:f,limitBy:c,filters:n,advancedFilters:l,defaultDateRange:d,fields:h});if("item-comparison"===m)return H(H({},y),{},{primaryData:b});var v=(0,D.getReportChartData)({endpoint:a,dataType:"secondary",query:s,selector:f,limitBy:c,filters:n,advancedFilters:l,defaultDateRange:d,fields:h});return H(H({},y),{},{primaryData:b,secondaryData:v})})))(W),K=window.wc.number,z=window.wc.tracks;var G=function(e){_(n,e);var t,r,a=(t=n,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=R(t);if(r){var n=R(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return k(this,e)});function n(){return h(this,n),a.apply(this,arguments)}return v(n,[{key:"formatVal",value:function(e,t){var r=this.context,a=r.formatAmount,n=r.getCurrencyConfig;return"currency"===t?a(e):(0,K.formatValue)(n(),t,e)}},{key:"getValues",value:function(e,t){var r=this.props,a=r.emptySearchResults,n=r.summaryData.totals,o=n.primary?n.primary[e]:0,i=n.secondary?n.secondary[e]:0,s=a?0:o,l=a?0:i;return{delta:(0,K.calculateDelta)(s,l),prevValue:this.formatVal(l,t),value:this.formatVal(s,t)}}},{key:"render",value:function(){var e=this,t=this.props,r=t.charts,a=t.query,n=t.selectedChart,l=t.summaryData,c=t.endpoint,u=t.report,m=t.defaultDateRange,d=l.isError,f=l.isRequesting;if(d)return(0,i.createElement)(Q,null);if(f)return(0,i.createElement)(s.SummaryListPlaceholder,{numberOfItems:r.length});var y=(0,j.getDateParamsFromQuery)(a,m).compare;return(0,i.createElement)(s.SummaryList,null,(function(t){var a=t.onToggle;return r.map((function(t){var r=t.key,l=t.order,m=t.orderby,d=t.label,f=t.type,g=t.isReverseTrend,h=t.labelTooltipText,b={chart:r};m&&(b.orderby=m),l&&(b.order=l);var v=(0,p.getNewPath)(b),w=n.key===r,_=e.getValues(r,f),O=_.delta,k=_.prevValue,R=_.value;return(0,i.createElement)(s.SummaryNumber,{key:r,delta:O,href:v,label:d,reverseTrend:g,prevLabel:"previous_period"===y?(0,o.__)("Previous period:","woocommerce"):(0,o.__)("Previous year:","woocommerce"),prevValue:k,selected:w,value:R,labelTooltipText:h,onLinkClickCallback:function(){a&&a(),(0,z.recordEvent)("analytics_chart_tab_click",{report:u||c,key:r})}})}))}))}}]),n}(i.Component);G.propTypes={charts:P().array.isRequired,endpoint:P().string.isRequired,limitProperties:P().array,query:P().object.isRequired,selectedChart:P().shape({key:P().string.isRequired,label:P().string.isRequired,order:P().oneOf(["asc","desc"]),orderby:P().string,type:P().oneOf(["average","number","currency"]).isRequired}).isRequired,summaryData:P().object,report:P().string},G.defaultProps={summaryData:{totals:{primary:{},secondary:{}},isError:!1}},G.contextType=L;var J=(0,E.compose)((0,S.withSelect)((function(e,t){var r=t.charts,a=t.endpoint,n=t.limitProperties,o=t.query,i=t.filters,s=t.advancedFilters,l=n||[a],c=l.some((function(e){return o[e]&&o[e].length}));if(o.search&&!c)return{emptySearchResults:!0};var u=r&&r.map((function(e){return e.key})),p=e(D.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings").woocommerce_default_date_range;return{summaryData:(0,D.getSummaryNumbers)({endpoint:a,query:o,select:e,limitBy:l,filters:i,advancedFilters:s,defaultDateRange:p,fields:u}),defaultDateRange:p}})))(G);function X(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,o=[],_n=!0,i=!1;try{for(r=r.call(e);!(_n=(a=r.next()).done)&&(o.push(a.value),!t||o.length!==t);_n=!0);}catch(e){i=!0,n=e}finally{try{_n||null==r.return||r.return()}finally{if(i)throw n}}return o}}(e,r)||t(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,t,r,a,n,o,i){try{var s=e[o](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function Z(e){return function(){var t=this,r=arguments;return new Promise((function(a,n){var o=e.apply(t,r);function i(e){$(o,a,n,i,s,"next",e)}function s(e){$(o,a,n,i,s,"throw",e)}i(void 0)}))}}var ee=window.regeneratorRuntime,te=r.n(ee),re=window.wp.components,ae=window.AutomateWoo.Modal,ne=r.n(ae);function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},oe.apply(this,arguments)}function ie(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var se=window.wp.dom,le=window.wc.csvExport,ce=r(184),ue=r.n(ce),pe=function(){return(0,i.createElement)("svg",{role:"img","aria-hidden":"true",focusable:"false",version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},(0,i.createElement)("path",{d:"M18,9c-0.009,0-0.017,0.002-0.025,0.003C17.72,5.646,14.922,3,11.5,3C7.91,3,5,5.91,5,9.5c0,0.524,0.069,1.031,0.186,1.519 C5.123,11.016,5.064,11,5,11c-2.209,0-4,1.791-4,4c0,1.202,0.541,2.267,1.38,3h18.593C22.196,17.089,23,15.643,23,14 C23,11.239,20.761,9,18,9z M12,16l-4-5h3V8h2v3h3L12,16z"}))};function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var fe=["className","getHeadersContent","getRowsContent","getSummary","isRequesting","primaryData","tableData","endpoint","itemIdField","tableQuery","compareBy","compareParam","searchBy","labels","checkboxes","renderActionButton"],ye=["updateUserPreferences"];function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var be=function(e){var t=e.className,r=e.getHeadersContent,l=e.getRowsContent,c=e.getSummary,u=e.isRequesting,m=e.primaryData,d=e.tableData,f=e.endpoint,y=(e.itemIdField,e.tableQuery,e.compareBy),h=e.compareParam,b=e.searchBy,v=e.labels,w=void 0===v?{}:v,_=e.checkboxes,O=e.renderActionButton,k=ie(e,fe),R=e.query,E=e.columnPrefsKey,C=d.items,S=d.query,q=R[h]?(0,p.getIdsFromQuery)(R[y]):[],P=X((0,i.useState)(q),2),j=P[0],x=P[1],F=(0,i.useRef)(null),N=(0,D.useUserPreferences)(),A=N.updateUserPreferences,I=ie(N,ye);if(d.isError||m.isError)return(0,i.createElement)(Q,null);var L=[];E&&(L=I&&I[E]?I[E]:L);var B,M,V,U,H=function(e,t,a){var o=c?c(t,a):null;return(0,n.applyFilters)("woocommerce_admin_report_table",{endpoint:f,headers:r(),rows:l(e),totals:t,summary:o,items:C})},W=function(t,r){var n=e.ids;if(r)x((0,T.uniq)([n[t]].concat(a(j))));else{var o=j.indexOf(n[t]);x([].concat(a(j.slice(0,o)),a(j.slice(o+1))))}},Y=function(t){var r=e.ids,a=void 0===r?[]:r,n=-1!==j.indexOf(a[t]);return{display:(0,i.createElement)(re.CheckboxControl,{onChange:(0,T.partial)(W,t),checked:n}),value:!1}},K=u||d.isRequesting||m.isRequesting,G=(0,T.get)(m,["data","totals"],{}),J=C.totalResults||0,$=J>0,Z=(0,p.getSearchWords)(R).map((function(e){return{key:e,label:e}})),ee=C.data,te=H(ee,G,J),ae=te.headers,ne=te.rows,ce=te.summary;(_||y)&&(ne=ne.map((function(e,t){return[Y(t)].concat(a(e))})),ae=[(B=e.ids,M=void 0===B?[]:B,V=M.length>0,U=V&&M.length===j.length,{cellClassName:"is-checkbox-column",key:"compare",label:(0,i.createElement)(re.CheckboxControl,{onChange:function(t){var r=e.ids;x(t?r:[])},"aria-label":(0,o.__)("Select All","woocommerce"),checked:U,disabled:!V}),required:!0})].concat(a(ae)));var me=function(e,t){return t?e.map((function(e){return he(he({},e),{},{visible:e.required||!t.includes(e.key)})})):e.map((function(e){return he(he({},e),{},{visible:e.required||!e.hiddenByDefault})}))}(ae,L);return(0,i.createElement)(i.Fragment,null,(0,i.createElement)("div",{className:"woocommerce-report-table__scroll-point automatewoo-clone",ref:F,"aria-hidden":!0}),(0,i.createElement)(s.TableCard,oe({className:ue()("woocommerce-report-table","automatewoo-clone",t),hasSearch:!!b,actions:[O&&O({selectedRows:j}),y&&(0,i.createElement)(s.CompareButton,{key:"compare",className:"woocommerce-table__compare",count:j.length,helpText:w.helpText||(0,o.__)("Check at least two items below to compare","woocommerce"),onClick:function(){y&&(0,p.onQueryChange)("compare")(y,h,j.join(","))},disabled:!$},w.compareButton||(0,o.__)("Compare","woocommerce")),b&&(0,i.createElement)(s.Search,{allowFreeTextSearch:!0,inlineTags:!0,key:"search",onChange:function(t){var r,a=e.baseSearchQuery,n=e.addCesSurveyForCustomerSearch,o=t.map((function(e){return e.label.replace(",","%2C")}));o.length?((0,p.updateQueryString)(he(he((g(r={filter:void 0},h,void 0),g(r,b,void 0),r),a),{},{search:(0,T.uniq)(o).join(",")})),n()):(0,p.updateQueryString)({search:void 0}),(0,z.recordEvent)("analytics_table_filter",{report:f})},placeholder:w.placeholder||(0,o.__)("Search by item name","woocommerce"),selected:Z,showClearButton:!0,type:b,disabled:!$}),$&&(0,i.createElement)(re.Button,{key:"download",className:"woocommerce-table__download-button",disabled:K,onClick:function(){var t=e.createNotice,r=e.startExport,a=e.title,n=Object.assign({},R),i=C.data,s=C.totalResults,l="browser";if(delete n.extended_info,n.search&&delete n[b],i&&i.length===s){var c=H(i,s),u=c.headers,p=c.rows;(0,le.downloadCSVFile)((0,le.generateCSVFileName)(a,n),(0,le.generateCSVDataFromTable)(u,p))}else l="email",r(f,S).then((function(){return t("success",(0,o.sprintf)(/* translators: %s = type of report */
(0,o.__)("Your %s Report will be emailed to you.","woocommerce"),a))})).catch((function(e){return t("error",e.message||(0,o.sprintf)(/* translators: %s = type of report */
(0,o.__)("There was a problem exporting your %s Report. Please try again.","woocommerce"),a))}));(0,z.recordEvent)("analytics_table_download",{report:f,rows:s,download_type:l})}},(0,i.createElement)(pe,null),(0,i.createElement)("span",{className:"woocommerce-table__download-button__label"},w.downloadButton||(0,o.__)("Download","woocommerce")))],headers:me,isLoading:K,onQueryChange:p.onQueryChange,onColumnsChange:function(e,t){var r=ae.map((function(e){return e.key})).filter((function(t){return!e.includes(t)}));if(E){var a=g({},E,r);A(a)}if(t){var n={report:f,column:t,status:e.includes(t)?"on":"off"};(0,z.recordEvent)("analytics_table_header_toggle",n)}},onSort:function(e,t){(0,p.onQueryChange)("sort")(e,t);var r={report:f,column:e,direction:t};(0,z.recordEvent)("analytics_table_sort",r)},onPageChange:function(e,t){F.current.scrollIntoView();var r=F.current.nextSibling.querySelector(".woocommerce-table__table"),a=se.focus.focusable.find(r);a.length&&a[0].focus(),t&&("goto"===t?(0,z.recordEvent)("analytics_table_go_to_page",{report:f,page:e}):(0,z.recordEvent)("analytics_table_page_click",{report:f,direction:t}))},rows:ne,rowsPerPage:parseInt(S.per_page,10)||D.QUERY_DEFAULTS.pageSize,summary:ce,totalRows:J},k)))};be.propTypes={className:P().string,baseSearchQuery:P().object,compareBy:P().string,compareParam:P().string,columnPrefsKey:P().string,endpoint:P().string,extendItemsMethodNames:P().shape({getError:P().string,isRequesting:P().string,load:P().string}),extendedItemsStoreName:P().string,getHeadersContent:P().func.isRequired,getRowsContent:P().func.isRequired,getSummary:P().func,itemIdField:P().string,labels:P().shape({compareButton:P().string,downloadButton:P().string,helpText:P().string,placeholder:P().string}),primaryData:P().object,searchBy:P().string,summaryFields:P().arrayOf(P().string),tableData:P().object.isRequired,tableQuery:P().object,title:P().string.isRequired,checkboxes:P().bool,renderActionButton:P().func},be.defaultProps={primaryData:{},tableData:{items:{data:[],totalResults:0},query:{}},tableQuery:{},compareParam:"filter",downloadable:!1,onSearch:T.noop,baseSearchQuery:{}};var ve=[],we={},_e=(0,E.compose)((0,S.withSelect)((function(e,t){var r=t.endpoint,a=t.getSummary,n=t.isRequesting,o=t.itemIdField,i=t.query,s=t.tableData,l=t.tableQuery,c=t.filters,u=t.advancedFilters,p=t.summaryFields,m=t.extendedItemsStoreName,d=e(D.REPORTS_STORE_NAME),f=m?e(m):null,y=e(D.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings").woocommerce_default_date_range,g=i.search&&!(i[r]&&i[r].length);if(n||g)return we;var h="categories"===r?"products":r,b=a?(0,D.getReportChartData)({endpoint:h,selector:d,dataType:"primary",query:i,filters:c,advancedFilters:u,defaultDateRange:y,fields:p}):we,v=s||(0,D.getReportTableData)({endpoint:r,query:i,selector:d,tableQuery:l,filters:c,advancedFilters:u,defaultDateRange:y}),w=f?function(e,t,r){var a=t.extendItemsMethodNames,n=t.itemIdField,o=r.items.data;if(!(Array.isArray(o)&&o.length&&a&&n))return r;var i=e[a.getError],s=e[a.isRequesting],l=e[a.load],c={include:o.map((function(e){return e[n]})).join(","),per_page:o.length},u=l(c),p=!!s&&s(c),m=!!i&&i(c),d=o.map((function(e){var t=(0,T.first)(u.filter((function(t){return e.id===t.id})));return de(de({},e),t)})),f=r.isRequesting||p,y=r.isError||m;return de(de({},r),{},{isRequesting:f,isError:y,items:de(de({},r.items),{},{data:d})})}(f,t,v):v;return{primaryData:b,ids:o&&w.items.data?w.items.data.map((function(e){return e[o]})):ve,tableData:w,query:i}})),(0,S.withDispatch)((function(e){var t=e(D.EXPORT_STORE_NAME).startExport;return{createNotice:e("core/notices").createNotice,startExport:t,addCesSurveyForCustomerSearch:e("wc/customer-effort-score").addCesSurveyForCustomerSearch}})))(be),Oe=function(){var e=Z(te().mark((function e(t){var r,a;return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,S.dispatch)("core/notices"),a=r.createNotice,e.prev=1,e.next=4,c()({path:"/automatewoo/conversions/batch/",method:"DELETE",body:JSON.stringify({ids:t})});case 4:e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(1),a("error",(0,o.__)("There was an error unmarking conversions.","automatewoo")),e.abrupt("return");case 10:a("success",(0,o.__)("Orders successfully unmarked as conversions.","automatewoo"));case 11:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(_x){return e.apply(this,arguments)}}();function ke(e){var t=e.query,r=e.filters,a=(0,S.useDispatch)(D.REPORTS_STORE_NAME).invalidateResolutionForStoreSelector,l=(0,N.getSetting)("admin",{}).dateFormat||j.defaultTableDateFormat,c=function(e){var t=I.getCurrencyConfig(),r=(0,n.applyFilters)("woocommerce_admin_report_currency",t,e);return F()(r)}(t),u=c.formatAmount,p=c.getCurrencyConfig,m=X((0,i.useState)(!1),2),d=m[0],f=m[1],y=(0,i.useCallback)(function(){var e=Z(te().mark((function e(t){return te().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d){e.next=7;break}return f(!0),e.next=4,Oe(t);case 4:f(!1),a("getReportStats"),a("getReportItems");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,a]);return(0,i.createElement)(_e,{className:"aw-conversions-table",endpoint:"conversions",getHeadersContent:function(){return[{key:"order",label:(0,o.__)("Order #","automatewoo"),screenReaderLabel:(0,o.__)("Order Number","automatewoo"),required:!0},{key:"customer",label:(0,o.__)("Customer","automatewoo"),isLeftAligned:!0},{key:"Workflow",label:(0,o.__)("Workflow","automatewoo"),isLeftAligned:!0},{key:"log",label:(0,o.__)("Log","automatewoo"),isLeftAligned:!0},{key:"interacted",label:(0,o.__)("First Interacted","automatewoo")},{key:"placed",label:(0,o.__)("Order Placed","automatewoo")},{key:"total",label:(0,o.__)("Order Total","automatewoo"),isCurrency:!0,isNumeric:!0}]},getRowsContent:function(e){return e.map((function(e){var t=e.order_id,r=e.order_number,a=e.workflow_id,n=e.conversion_id,o=e.date_created,c=e.total_sales,p=e.extended_info,m=p.conversion.date_opened,d=p.customer,f=d.user_id,y=d.first_name,g=d.last_name,h=p.workflow.name,b="".concat(y," ").concat(g);return[{display:(0,i.createElement)(s.Link,{href:"post.php?post=".concat(t,"&action=edit"),type:"wp-admin"},(0,i.createElement)("strong",null,r)),value:t},{display:null===f?b:(0,i.createElement)(s.Link,{href:"user-edit.php?user_id=".concat(f,"&action=edit"),type:"wp-admin"},b),value:"".concat(b," (").concat(null===f?"guest":f,")")},{display:(0,i.createElement)(s.Link,{href:"post.php?post=".concat(a,"&action=edit"),type:"wp-admin"},(0,i.createElement)("strong",null,h)),value:a},{display:(0,i.createElement)("a",{className:ne().triggerClasses.openLink,href:"admin-ajax.php?action=aw_modal_log_info&log_id=".concat(n)},n),value:n},{display:(0,i.createElement)(s.Date,{date:m,visibleFormat:l}),value:m},{display:(0,i.createElement)(s.Date,{date:o,visibleFormat:l}),value:o},{display:u(c),value:c}]}))},getSummary:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e.total_sales,a=void 0===r?0:r,n=e.net_revenue,i=void 0===n?0:n,s=p();return[{label:(0,o._n)("Conversion","Conversions",t,"automatewoo"),value:(0,K.formatValue)(s,"number",t)},{label:(0,o.__)("Total sales","automatewoo"),value:u(a)},{label:(0,o.__)("Net sales","automatewoo"),value:u(i)}]},summaryFields:["total_sales","net_revenue","orders_count"],itemIdField:"order_id",query:t,tableQuery:{orderby:t.orderby||"date",order:t.order||"desc",extended_info:!0},title:(0,o.__)("Conversions list","automatewoo"),columnPrefsKey:"conversions_report_columns",filters:r,checkboxes:!0,renderActionButton:function(e){var t=e.selectedRows;return(0,i.createElement)(re.Tooltip,{text:(0,o.__)("Unmark selected orders as conversions","automatewoo")},(0,i.createElement)(re.Button,{disabled:d||0===t.length,variant:"secondary",onClick:function(){return y(t)}},(0,o.__)("Unmark","automatewoo")))}})}var Re=[{key:"total_sales",href:"",label:(0,o.__)("Total value","automatewoo"),labelTooltipText:(0,o.__)("Converted order value","automatewoo"),type:"currency"},{key:"net_revenue",href:"",label:(0,o.__)("Net revenue","automatewoo"),type:"currency"},{key:"orders_count",href:"",label:(0,o.__)("Orders","automatewoo"),labelTooltipText:(0,o.__)("Converted orders","automatewoo"),type:"number"}];function Ee(e){var t=e.query,r=e.path,a=Re.find((function(e){return e.key===t.chart}))||Re[0];return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(s.ReportFilters,{query:t,path:r,filters:y}),(0,i.createElement)(J,{charts:Re,endpoint:"conversions",query:t,selectedChart:a,filters:y}),(0,i.createElement)(Y,{endpoint:"conversions",path:r,query:t,filters:y,selectedChart:a,charts:Re}),(0,i.createElement)(ke,{query:t,filters:y}))}var Ce=[{key:"sent",href:"",label:(0,o.__)("Sent","automatewoo"),labelTooltipText:(0,o.__)("Trackable messages sent","automatewoo"),type:"number"},{key:"opens",href:"",label:(0,o.__)("Opens","automatewoo"),labelTooltipText:(0,o.__)("Unique opens","automatewoo"),type:"number"},{key:"unique-clicks",href:"",label:(0,o.__)("Unique clicks","automatewoo"),type:"number"},{key:"clicks",href:"",label:(0,o.__)("Clicks","automatewoo"),type:"number"}],Se=[{key:"unsubscribers",href:"",label:(0,o.__)("Unsubscribers","automatewoo"),type:"number"}];function Te(e){var t=e.query,r=e.path,a=Ce.find((function(e){return e.key===t.chart}))||Ce[0];return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(s.ReportFilters,{query:t,path:r,filters:y}),(0,i.createElement)(J,{charts:Ce,endpoint:"email-tracking",query:t,selectedChart:a,filters:y}),(0,i.createElement)(Y,{endpoint:"email-tracking",path:r,query:t,filters:y,selectedChart:a,charts:Ce}),(0,i.createElement)(J,{charts:Se,endpoint:"unsubscribers",query:t,selectedChart:Se[0],filters:y}),(0,i.createElement)(Y,{endpoint:"unsubscribers",path:r,query:t,filters:y,selectedChart:Se[0],charts:Se}))}var qe=[{key:"runs",label:(0,o.__)("Runs","automatewoo"),labelTooltipText:(0,o.__)("Workflows have run for the selected period","automatewoo"),type:"number"}];function Pe(e){var t=e.query,r=e.path;return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(s.ReportFilters,{query:t,path:r,filters:y}),(0,i.createElement)(J,{charts:qe,endpoint:"workflow-runs",query:t,selectedChart:qe[0],filters:y}),(0,i.createElement)(Y,{endpoint:"workflow-runs",path:r,query:t,filters:y,selectedChart:qe[0],charts:qe}))}(0,n.addFilter)("woocommerce_admin_reports_list","automatewoo",(function(e){return[].concat(a(e),[{report:"automatewoo-runs-by-date",title:(0,o._x)("Workflows","analytics report title","automatewoo"),component:Pe,navArgs:{id:"automatewoo-analytics-runs-by-date"}},{report:"automatewoo-email-tracking",title:(0,o._x)("Email & SMS Tracking","analytics report title","automatewoo"),component:Te,navArgs:{id:"automatewoo-analytics-email-tracking"}},{report:"automatewoo-conversions",title:(0,o._x)("Conversions","analytics report title","automatewoo"),component:Ee,navArgs:{id:"automatewoo-analytics-conversions"}}])}))}()}();