{"version":3,"sources":["automatewoo.js"],"names":["AutomateWoo","AW","$","init","params","automatewooLocalizeScript","initTooltips","initWorkflowStatusSwitch","initShowHide","initHoverableDates","document","body","on","initEnhancedSelects","tipTip","attribute","fadeIn","fadeOut","delay","filter","each","select2_args","allowClear","this","data","placeholder","minimumInputLength","escapeMarkup","m","ajax","url","dataType","quietMillis","term","action","sibling","$sibling","length","val","processResults","terms","id","text","push","results","cache","select2","addClass","$switch","new_state","is","attr","post","ajaxurl","workflow_id","removeClass","price","float","toFixed","symbol","locale","currency_symbol","currency_position","block","$el","message","overlayCSS","background","opacity","update","value","is_checkbox","show","hide","logic","split","indexOf","selector","jQuery","_email_preview_window","init_notice_dismiss","init_date_pickers","notices","success","$location","before","error","clear_all","slideUp","$notice","parents","notice","nonce","nonces","remove_notice","datepicker","dateFormat","numberOfMonths","showButtonPanel","isEmailPreviewOpen","closed","openLoadingEmailPreview","openPreviewWindow","admin","open_email_preview","type","args","request","page","param","window","open","$type","$days","siblings","trigger"],"mappings":"AAIA,IAAIA,YAAaC,GAAK,IAEtB,SAAUC,GAETD,GAAGE,KAAO,WAETF,GAAGG,OAASC,0BAEZJ,GAAGK,eACHL,GAAGM,2BACHN,GAAGO,eACHP,GAAGQ,qBAEGP,EAAEQ,SAASC,MAAMC,GAAG,2BAA2B,WACpDX,GAAGY,0BAQLZ,GAAGK,aAAe,WACjBJ,EAAG,8CAA+CY,OAAO,CACxDC,UAAW,WACXC,OAAQ,GACRC,QAAS,GACTC,MAAO,OAQTjB,GAAGY,oBAAsB,WAExBX,EAAG,kCAAmCiB,OAAQ,mBAAoBC,MAAM,WACvE,IAAIC,EAAe,CAClBC,aAAapB,EAAGqB,MAAOC,KAAM,eAC7BC,YAAavB,EAAGqB,MAAOC,KAAM,eAC7BE,mBAAoB,IACpBC,aAAc,SAAUC,GACvB,OAAOA,GAERC,KAAM,CACLC,IAAK7B,GAAGG,OAAO0B,IAAID,KACnBE,SAAU,OACVC,YAAa,IACbR,KAAM,SAAUpB,GAEf,IAAIoB,EAAO,CACVS,KAAM7B,EAAO6B,KACbC,OAAQhC,EAAGqB,MAAOC,KAAM,WAIrBW,EAAUjC,EAAEqB,MAAMC,KAAK,gBAC3B,GAAKW,EAAU,CACd,IAAIC,EAAWlC,EAAE,UAAWiC,EAAS,MAEhCC,EAASC,SACbb,EAAc,QAAIY,EAASE,OAI7B,OAAOd,GAERe,eAAgB,SAAUf,GACzB,IAAIgB,EAAQ,GAMZ,OALKhB,GACJtB,EAAEkB,KAAMI,GAAM,SAAUiB,EAAIC,GAC3BF,EAAMG,KAAM,CAAEF,GAAIA,EAAIC,KAAMA,OAGvB,CACNE,QAASJ,IAGXK,OAAO,IAIT3C,EAAGqB,MAAOuB,QAASzB,GAAe0B,SAAU,gBAM9C9C,GAAGM,yBAA2B,WAE7BL,EAAE,wCAAwCU,GAAI,SAAS,WAEtD,IAAIoC,EAAgBC,GAEpBD,EAAU9C,EAAEqB,OAEC2B,GAAG,iBAIhBD,EAAsB,OADdD,EAAQG,KAAM,kBACO,MAAQ,KAErCH,EAAQD,SAAS,cACjBC,EAAQG,KAAM,iBAAkBF,GAEhC/C,EAAEkD,KAAMC,QAAS,CAChBnB,OAAQ,4BACRoB,YAAaN,EAAQG,KAAM,oBAC3BF,UAAWA,IACT,WACFD,EAAQO,YAAY,sBAWvBtD,GAAGuD,MAAQ,SAAUC,GAEpB,IAAID,EAAQC,EAAMC,QAAQ,GACtBC,EAAS1D,GAAGG,OAAOwD,OAAOC,gBAE9B,OAAS5D,GAAGG,OAAOwD,OAAOE,mBACzB,IAAK,QACJN,GAAgBG,EAChB,MACD,IAAK,cACJH,EAAQA,EAAQ,IAAMG,EACtB,MACD,IAAK,OACJH,EAAQG,EAASH,EACjB,MACD,IAAK,aACL,QACCA,EAAQG,EAAS,IAAMH,EAIzB,OAAOA,GAIRvD,GAAG8D,MAAQ,SAAUC,GACdA,EAAID,MAAM,CACNE,QAAS,KACTC,WAAY,CACRC,WAAY,OACZC,QAAS,OASxBnE,GAAGO,aAAe,WAEjB,IAAI6D,EAAS,SAAUL,GACtB,IAAIvB,EAAKuB,EAAIxC,KAAM,oBACf8C,EAAQN,EAAI1B,MACZiC,EAAcP,EAAId,GAAG,0BAEzBhD,EAAE,2BAA2BkB,MAAK,WACjC,GAAKmD,GAAerE,EAAEqB,MAAMC,KAAK,sBAAwBiB,EACnDuB,EAAId,GAAG,YACOhD,EAAEqB,MAAMiD,OAGRtE,EAAEqB,MAAMkD,WAGvB,CACW,IAAIC,EAAQxE,EAAEqB,MAAMC,KAAK,oBAAoBmD,MAAM,KAEnD,GAAKD,EAAM,KAAOjC,EACd,QAKuC,IAFrBiC,EAAM,GAAGC,MAAM,KAEhBC,QAASN,GAC1BpE,EAAEqB,MAAMiD,OAGRtE,EAAEqB,MAAMkD,WAMpBvE,EAAE,2BAA2BkB,MAAK,WAC9B,GAAKmD,GAAerE,EAAEqB,MAAMC,KAAK,sBAAwBiB,EAChDuB,EAAId,GAAG,YACRhD,EAAEqB,MAAMkD,OAGRvE,EAAEqB,MAAMiD,WAGX,CACD,IAAIE,EAAQxE,EAAEqB,MAAMC,KAAK,oBAAoBmD,MAAM,KAEnD,GAAKD,EAAM,KAAOjC,EACd,QAKuC,IAFrBiC,EAAM,GAAGC,MAAM,KAEhBC,QAASN,GAC1BpE,EAAEqB,MAAMkD,OAGRvE,EAAEqB,MAAMiD,YAO9BtE,EAAEQ,UAAUE,GAAI,SAAU,2BAA2B,WACpDyD,EAAQnE,EAAEqB,UAGXrB,EAAE,2BAA2BkB,MAAK,WACjCiD,EAAQnE,EAAEqB,WAKZtB,GAAGQ,mBAAqB,WACvB,IAAIoE,EAAW,8BAEf3E,EAAGQ,SAASC,MACVC,GAAI,aAAciE,GAAU,WAC5B3E,EAAGqB,MAAOmB,KAAMxC,EAAGqB,MAAOC,KAAM,gCAEhCZ,GAAI,aAAciE,GAAU,WAC5B3E,EAAGqB,MAAOmB,KAAMxC,EAAGqB,MAAOC,KAAM,mCAKnCtB,GAAE,WACDD,GAAGE,UAvPL,CA2PI2E,QAIJA,QAAO,SAAS5E,IAGfF,YAAc,CAEb+E,sBAAuB,KAGvB5E,KAAM,WACLoB,KAAKyD,sBACLzD,KAAK0D,qBAINC,QAAS,CAERC,QAAS,SAAUlB,EAASmB,GACpBA,EAAU/C,QACjB+C,EAAUC,OAAO,2DAA6DpB,EAAU,wBAGzFqB,MAAO,SAAUrB,EAASmB,GAClBA,EAAU/C,QACjB+C,EAAUC,OAAO,yDAA2DpB,EAAU,wBAGvFsB,UAAW,WACVrF,EAAE,uBAAuBsF,YAO3BR,oBAAqB,WAEpB9E,EAAE,2BAA2BU,GAAG,QAAS,mBAAmB,WAC3DV,EAAE2B,KAAK,CACNC,IAAKuB,QACL7B,KAAM,CAAEU,OAAQ,uCAIlBhC,EAAE,yCAAyCU,GAAG,QAAS,mBAAmB,WACzE,IAAI6E,EAAUvF,EAAEqB,MAAMmE,QAAQ,yCAE9BxF,EAAEkD,KAAK,CACNtB,IAAKuB,QACL7B,KAAM,CACLU,OAAQ,4BACRyD,OAAQF,EAAQjE,KAAK,kCACrBoE,MAAO3F,GAAGG,OAAOyF,OAAOC,qBAM5Bb,kBAAmB,WAClB/E,EAAG,4BAA6B6F,WAAW,CAC1CC,WAAY,WACZC,eAAgB,EAChBC,iBAAiB,KAKnBC,mBAAoB,WACnB,OAAO5E,KAAKwD,wBAA2BxD,KAAKwD,sBAAsBqB,QAInEC,wBAAyB,WACxB9E,KAAK+E,kBAAmBrG,GAAGG,OAAO0B,IAAIyE,MAAQ,sDAQ/CC,mBAAoB,SAAUC,EAAMC,GACnC,IAAIC,EAAU,CACbC,KAAM,sBACN1E,OAAQ,aACRuE,KAAMA,EACNC,KAAMA,GAGPnF,KAAK+E,kBAAmBrG,GAAGG,OAAO0B,IAAIyE,MAAQ,aAAerG,EAAE2G,MAAOF,KAOvEL,kBAAmB,SAAUxE,GAC5BP,KAAKwD,sBAAwB+B,OAAOC,KAAMjF,EAAK,sBAAuB,0EAM5D3B,OAGZD,EAAG,0DACFU,GAAI,UAAU,WACb,MAAMoG,EAAQ9G,EAAGqB,MACX0F,EAAQD,EAAME,SACnB,0DAGoB,eAAhBF,EAAM1E,MACV2E,EAAMxC,OAGNwC,EAAMzC,UAGR2C,QAAS","file":"automatewoo.min.js","sourcesContent":["/**\n * AutomateWoo main - loaded on every admin page\n */\n\nvar AutomateWoo, AW = {};\n\n(function($) {\n\n\tAW.init = function() {\n\n\t\tAW.params = automatewooLocalizeScript;\n\n\t\tAW.initTooltips();\n\t\tAW.initWorkflowStatusSwitch();\n\t\tAW.initShowHide();\n\t\tAW.initHoverableDates();\n\n        $(document.body).on('wc-enhanced-select-init', function() {\n\t\t\tAW.initEnhancedSelects();\n\t\t});\n\t};\n\n\n\t/**\n\t * Init tool tips\n\t */\n\tAW.initTooltips = function () {\n\t\t$( '.automatewoo-help-tip, .automatewoo-tiptip' ).tipTip({\n\t\t\tattribute: 'data-tip',\n\t\t\tfadeIn: 50,\n\t\t\tfadeOut: 50,\n\t\t\tdelay: 200\n\t\t});\n\t};\n\n\n\t/**\n\t * Ajax search search box\n\t */\n\tAW.initEnhancedSelects = function() {\n\n\t\t$( 'select.automatewoo-json-search' ).filter( ':not(.enhanced)' ).each( function() {\n\t\t\tvar select2_args = {\n\t\t\t\tallowClear:  $( this ).data( 'allow_clear' ) ? true : false,\n\t\t\t\tplaceholder: $( this ).data( 'placeholder' ),\n\t\t\t\tminimumInputLength: '1',\n\t\t\t\tescapeMarkup: function( m ) {\n\t\t\t\t\treturn m;\n\t\t\t\t},\n\t\t\t\tajax: {\n\t\t\t\t\turl: AW.params.url.ajax,\n\t\t\t\t\tdataType: 'json',\n\t\t\t\t\tquietMillis: 250,\n\t\t\t\t\tdata: function( params ) {\n\n\t\t\t\t\t\tvar data = {\n\t\t\t\t\t\t\tterm: params.term,\n\t\t\t\t\t\t\taction: $( this ).data( 'action' )\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// pass in sibling field data\n\t\t\t\t\t\tvar sibling = $(this).data('pass-sibling');\n\t\t\t\t\t\tif ( sibling ) {\n\t\t\t\t\t\t\tvar $sibling = $('[name=\"'+ sibling+ '\"]');\n\n\t\t\t\t\t\t\tif ( $sibling.length ) {\n\t\t\t\t\t\t\t\tdata['sibling'] = $sibling.val()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn data;\n\t\t\t\t\t},\n\t\t\t\t\tprocessResults: function( data ) {\n\t\t\t\t\t\tvar terms = [];\n\t\t\t\t\t\tif ( data ) {\n\t\t\t\t\t\t\t$.each( data, function( id, text ) {\n\t\t\t\t\t\t\t\tterms.push( { id: id, text: text } );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tresults: terms\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\tcache: true\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t$( this ).select2( select2_args ).addClass( 'enhanced' );\n\t\t});\n\n\t};\n\n\n\tAW.initWorkflowStatusSwitch = function() {\n\n\t\t$('.aw-switch.js-toggle-workflow-status').on( 'click', function(){\n\n\t\t\tvar $switch, state, new_state;\n\n\t\t\t$switch = $(this);\n\n\t\t\tif ( $switch.is('.aw-loading') )\n\t\t\t\treturn;\n\n\t\t\tstate = $switch.attr( 'data-aw-switch' );\n\t\t\tnew_state = state === 'on' ? 'off' : 'on';\n\n\t\t\t$switch.addClass('aw-loading');\n\t\t\t$switch.attr( 'data-aw-switch', new_state );\n\n\t\t\t$.post( ajaxurl, {\n\t\t\t\taction: 'aw_toggle_workflow_status',\n\t\t\t\tworkflow_id: $switch.attr( 'data-workflow-id' ),\n\t\t\t\tnew_state: new_state\n\t\t\t}, function() {\n\t\t\t\t$switch.removeClass('aw-loading');\n\t\t\t});\n\n\t\t});\n\t};\n\n\n\t/**\n\t * @param float\n\t * @return string\n\t */\n\tAW.price = function( float ) {\n\n\t\tvar price = float.toFixed(2);\n\t\tvar symbol = AW.params.locale.currency_symbol;\n\n\t\tswitch ( AW.params.locale.currency_position ) {\n\t\t\tcase 'right':\n\t\t\t\tprice = price + symbol;\n\t\t\t\tbreak;\n\t\t\tcase 'right_space':\n\t\t\t\tprice = price + ' ' + symbol;\n\t\t\t\tbreak;\n\t\t\tcase 'left':\n\t\t\t\tprice = symbol + price;\n\t\t\t\tbreak;\n\t\t\tcase 'left_space':\n\t\t\tdefault:\n\t\t\t\tprice = symbol + ' ' + price;\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn price;\n\t};\n\n\n\tAW.block = function( $el ) {\n        $el.block({\n            message: null,\n            overlayCSS: {\n                background: '#fff',\n                opacity: 0.6\n            }\n        });\n\t};\n\n\n\t/**\n\t * Show / hide logic with data attributes\n\t */\n\tAW.initShowHide = function() {\n\n\t\tvar update = function( $el ) {\n\t\t\tvar id = $el.data( 'automatewoo-bind' );\n\t\t\tvar value = $el.val();\n\t\t\tvar is_checkbox = $el.is('input[type=\"checkbox\"]');\n\n\t\t\t$('[data-automatewoo-show]').each(function() {\n\t\t\t\tif ( is_checkbox && $(this).data('automatewoo-show') === id ) {\n\t\t\t\t\tif ( $el.is(':checked') ) {\n                        $(this).show();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n                        $(this).hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n                    var logic = $(this).data('automatewoo-show').split('=');\n\n                    if ( logic[0] !== id ) {\n                        return;\n                    }\n\n                    var possible_values = logic[1].split('|');\n\n                    if ( possible_values.indexOf( value ) !== -1 ) {\n                        $(this).show();\n                    }\n                    else {\n                        $(this).hide();\n                    }\n\t\t\t\t}\n\t\t\t});\n\n\n            $('[data-automatewoo-hide]').each(function() {\n                if ( is_checkbox && $(this).data('automatewoo-hide') === id ) {\n                    if ( $el.is(':checked') ) {\n                        $(this).hide();\n                    }\n                    else {\n                        $(this).show();\n                    }\n                }\n                else {\n                    var logic = $(this).data('automatewoo-hide').split('=');\n\n                    if ( logic[0] !== id ) {\n                        return;\n                    }\n\n                    var possible_values = logic[1].split('|');\n\n                    if ( possible_values.indexOf( value ) !== -1 ) {\n                        $(this).hide();\n                    }\n                    else {\n                        $(this).show();\n                    }\n\t\t\t\t}\n            });\n\t\t};\n\n\n\t\t$(document).on( 'change', '[data-automatewoo-bind]', function() {\n\t\t\tupdate( $(this) );\n\t\t});\n\n\t\t$('[data-automatewoo-bind]').each(function() {\n\t\t\tupdate( $(this) );\n\t\t});\n\n\t};\n\n\tAW.initHoverableDates = function() {\n\t\tvar selector = '.automatewoo-hoverable-date';\n\n\t\t$( document.body )\n\t\t\t.on( 'mouseenter', selector, function() {\n\t\t\t\t$( this ).text( $( this ).data( 'automatewoo-date-no-diff' ) );\n\t\t\t} )\n\t\t\t.on( 'mouseleave', selector, function() {\n\t\t\t\t$( this ).text( $( this ).data( 'automatewoo-date-with-diff' ) );\n\t\t\t} )\n\t\t;\n\t};\n\n\t$(function() {\n\t\tAW.init();\n\t});\n\n\n})( jQuery );\n\n\n\njQuery(function($) {\n\n\n\tAutomateWoo = {\n\n\t\t_email_preview_window: null,\n\n\n\t\tinit: function() {\n\t\t\tthis.init_notice_dismiss();\n\t\t\tthis.init_date_pickers();\n\t\t},\n\n\n\t\tnotices: {\n\n\t\t\tsuccess: function( message, $location ) {\n\t\t\t\tif ( ! $location.length ) return;\n\t\t\t\t$location.before('<div class=\"automatewoo-notice updated fade\"><p><strong>' + message + '</strong></p></div>');\n\t\t\t},\n\n\t\t\terror: function( message, $location ) {\n\t\t\t\tif ( ! $location.length ) return;\n\t\t\t\t$location.before('<div class=\"automatewoo-notice error fade\"><p><strong>' + message + '</strong></p></div>');\n\t\t\t},\n\n\t\t\tclear_all: function() {\n\t\t\t\t$('.automatewoo-notice').slideUp();\n\t\t\t}\n\n\t\t},\n\n\n\n\t\tinit_notice_dismiss: function(){\n\n\t\t\t$('.aw-notice-system-error').on('click', '.notice-dismiss', function(){\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: ajaxurl,\n\t\t\t\t\tdata: { action: 'aw_dismiss_system_error_notice' }\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$('[data-automatewoo-dismissible-notice]').on('click', '.notice-dismiss', function () {\n\t\t\t\tvar $notice = $(this).parents('[data-automatewoo-dismissible-notice]');\n\n\t\t\t\t$.post({\n\t\t\t\t\turl: ajaxurl,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\taction: 'automatewoo_remove_notice',\n\t\t\t\t\t\tnotice: $notice.data('automatewoo-dismissible-notice'),\n\t\t\t\t\t\tnonce: AW.params.nonces.remove_notice\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tinit_date_pickers: function() {\n\t\t\t$( '.automatewoo-date-picker' ).datepicker({\n\t\t\t\tdateFormat: 'yy-mm-dd',\n\t\t\t\tnumberOfMonths: 1,\n\t\t\t\tshowButtonPanel: true\n\t\t\t});\n\t\t},\n\n\n\t\tisEmailPreviewOpen: function() {\n\t\t\treturn this._email_preview_window && ! this._email_preview_window.closed;\n\t\t},\n\n\n\t\topenLoadingEmailPreview: function() {\n\t\t\tthis.openPreviewWindow( AW.params.url.admin + 'admin.php?page=automatewoo-preview&action=loading' )\n\t\t},\n\n\n        /**\n\t\t * @param type\n\t\t * @param args\n         */\n\t\topen_email_preview: function( type, args ) {\n\t\t\tvar request = {\n\t\t\t\tpage: 'automatewoo-preview',\n\t\t\t\taction: 'preview-ui',\n\t\t\t\ttype: type,\n\t\t\t\targs: args\n\t\t\t};\n\n\t\t\tthis.openPreviewWindow( AW.params.url.admin + 'admin.php?' + $.param( request ) );\n\t\t},\n\n\n\t\t/**\n\t\t * @param url\n         */\n\t\topenPreviewWindow: function( url ) {\n\t\t\tthis._email_preview_window = window.open( url, 'automatewoo_preview', 'titlebar=no,toolbar=no,height=768,width=860,resizable=yes,status=no' );\n\t\t}\n\n\n\t};\n\n\tAutomateWoo.init();\n\n\n\t$( '.automatewoo-before-after-day-field-group__field--type' ).\n\t\ton( 'change', function() {\n\t\t\tconst $type = $( this );\n\t\t\tconst $days = $type.siblings(\n\t\t\t\t'.automatewoo-before-after-day-field-group__field--days',\n\t\t\t);\n\n\t\t\tif ( $type.val() === 'on_the_day' ) {\n\t\t\t\t$days.hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$days.show();\n\t\t\t}\n\t\t} ).\n\t\ttrigger( 'change' );\n\n});\n"]}