!function(e){e((function(){TD.matches=new Backbone.Collection(TD.matches||[]),TD.sets=new Backbone.Collection(TD.sets||[]),new t({el:e("#tvd-contents-sets")})}));const t=Backbone.View.extend({events:{"click .removeMatchedTag":e=>{const t=parseInt(e.currentTarget.parentNode.getAttribute("data-id")),n=TD.matches.findWhere({id:t});n&&TD.matches.remove(n)}},initialize:function(t){e.extend(this,!0,t),this.listenTo(TD.matches,"add remove",this.renderMatchedTags),this.$autocomplete=this.$("#tvd-content-sets-autocomplete"),this.$matchedWrapper=this.$("#tvd-matched-content-sets"),this.renderMatchedTags()},renderMatchedTags:function(){this.$matchedWrapper.empty();const e=[];TD.matches.each((t=>{this.$matchedWrapper.append(`<div data-id="${t.get("id")}"><span>${t.get("text")}</span><span class="removeMatchedTag"></span></div>`),e.push(t.get("id"))})),this.bindAutocomplete(),e.length&&this.$matchedWrapper.append(`<input type="hidden" name="tvd_matched_content_sets_id" value="${e.toString()}" />`)},_escape:function(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},bindAutocomplete:function(){this.$autocomplete.data("autocomplete")&&(this.$autocomplete.autocomplete("destroy"),this.$autocomplete.removeData("autocomplete")),this.$autocomplete.autocomplete({appendTo:this.$autocomplete.parent(),minLength:0,classes:{"ui-autocomplete":"tvd-content-sets-dropdown"},source:(t,n)=>{const a=new RegExp(this._escape(t.term),"i"),s=TD.sets.toJSON().filter((e=>void 0===TD.matches.findWhere({id:e.id}))),o=0===t.term.trim().length?s:e.grep(s,(function(e){return a.test(e.text)}));n(e.map(o,(function(e){return{label:e.text,key:e.id}})))},select:(e,t)=>{this.$autocomplete.val("");const n=TD.sets.findWhere({id:t.item.key});return n&&TD.matches.add(n.clone()),!1}})}})}(jQuery);