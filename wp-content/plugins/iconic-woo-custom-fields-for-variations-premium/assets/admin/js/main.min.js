!function(r,e){var a={cache:function(){a.els={},a.vars={},a.tpl={},a.els.fields_table=r(".iconic-cffv-fields"),a.els.fields_table_body=a.els.fields_table.find("tbody");var e=new URLSearchParams(location.search);a.vars.post_id=e.get("post");e=a.vars.post_id?'<p><label><strong>Meta ID</strong></label><br><input type="text" class="large-text" value="{{meta_key}}" name="meta_key" readonly><p>':"";a.tpl.field_editor_layout='<form class="iconic-cffv-field-editor"><h2>{{field_action}} Field</h2><p><label><strong>Field Label</strong></label><br><input type="text" class="large-text" value="{{label}}" name="label"></p>'+e+'<p style="display:none"><label><strong>Field ID</strong></label><br><input type="text" class="large-text" value="{{id}}" name="id" readonly></p><p><label><strong>Field Type</strong></label><br><select class="iconic-cffv-field-editor__type" name="type"><option value="text">Text</option><option value="textarea">Textarea</option><option value="select">Select</option><option value="checkboxes">Checkboxes</option><option value="radio_buttons">Radio Buttons</option></select></p><div class="iconic-cffv-placeholder--options"></div><p><label><strong>Field Description</strong></label><br><textarea class="large-text" rows="5" name="description">{{description}}</textarea></p><p><label><strong>Default Value</strong></label><br><input type="text" class="large-text" name="default" value="{{default}}"><p><h3>Product Page Display Options</h3><p>Choose how the variation data is displayed on the frontend to the customer.</p><p><label><strong>Show on Frontend?</strong></label><br><select class="iconic-cffv-field-editor__display_frontend" name="display_frontend"><option value="yes">Yes</option><option value="no">No</option></select></p><p><label><strong>Show Label?</strong></label><br><select class="iconic-cffv-field-editor__display_label" name="display_label"><option value="yes">Yes</option><option value="no">No</option></select></p><div class="iconic-cffv-placeholder--display-as"></div><div class="iconic-cffv-placeholder--label-position"></div><a href="javascript: void(0);" class="button button-primary iconic-cffv-save-field" data-save-type="{{field_action}}" data-index="{{field_index}}">{{field_action}} Field</a></form>',a.tpl.field_row='<tr class="iconic-cffv-fields__field" data-index="{{index}}"><td><strong>{{order}}</strong><input type="hidden" class="iconic-cffv-field-data" name="iconic-cffv-field-data[{{index}}]" value="{{json}}"></td><td class="title column-title has-row-actions column-primary page-title"><strong><a href="#" class="row-title iconic-cffv-edit-field iconic-cffv-field-label">{{label}}</a></strong><div class="row-actions"><a href="javascript: void(0);" class="iconic-cffv-edit-field" title="Edit Field">Edit</a> |<span class="trash"><a href="javascript: void(0);" class="iconic-cffv-delete-field" title="Delete Field">Bin</a></span></div></td><td class="iconic-cffv-field-type">{{type}}</td><td class="iconic-cffv-field-shortcode"><input type="text" readonly value="{{shortcode}}"/></td></tr>',a.tpl.options='<div class="iconic-cffv-field-editor__options-wrapper"><strong>Field Options</strong><br>Enter each option on a new line.<br><textarea class="large-text iconic-cffv-field-editor__options" rows="5" name="options">{{options}}</textarea></div>',a.tpl.display_as='<p><label><strong>Display as</strong></label><br><select class="iconic-cffv-field-editor__display_as" name="display_as"><option value="list">List</option><option value="comma_separated">Comma Separated</option></select></p>',a.tpl.label_position='<p><label><strong>Label Position</strong></label><br><select class="iconic-cffv-field-editor__label_position" name="label_position"><option value="above">Above</option><option value="left">Left</option></select></p>'},on_ready:function(){a.cache(),a.setup_field_groups_edit_page(),a.setup_product_edit_page()},setup_field_groups_edit_page:function(){a.setup_field_editor()},setup_product_edit_page:function(){a.setup_help_tips()},setup_field_editor:function(){r(e).on("keyup",".iconic-cffv-field-editor [name='label']",function(){var e=r(this),i=e.val(),e=e.closest(".iconic-cffv-field-editor").find("[name='id']"),i=a.slugify(i);e.val(i)}),r(e).on("click",".iconic-cffv-edit-field",function(){var t=a.get_field_data_from_row(r(this)),o=null,e="",i="",l=!(!t||void 0===t.json.display_as)&&t.json.display_as;return t?(e=a.tpl.field_editor_layout.replace(/{{field_action}}/g,"Edit").replace("{{field_index}}",t.index).replace("{{label}}",t.json.label).replace("{{id}}",t.json.id).replace("{{default}}",t.json.default||"").replace("{{description}}",a.br2nl(t.json.description)).replace("{{meta_key}}",a.generate_field_meta_key(t)),t.json.options?i=a.tpl.options.replace("{{options}}",t.json.options):e=e.replace("{{options}}",""),o=r(e),a.has_display_as(t.json.type)&&a.add_to_placeholder("display-as",a.tpl.display_as,o),a.has_options(t.json.type)&&a.add_to_placeholder("options",i,o),a.has_label_position(t.json.type,l)&&a.add_to_placeholder("label-position",a.tpl.label_position,o),r.each(["type","display_frontend","display_label","label_position","display_as"],function(e,i){o.find('select[name="'+i+'"] option[value="'+t.json[i]+'"]').attr("selected",!0)})):(l=r(".iconic-cffv-fields__field").length,e=a.tpl.field_editor_layout.replace(/{{field_action}}/g,"Add").replace("{{field_index}}",l).replace("{{label}}","").replace("{{id}}","").replace("{{default}}","").replace("{{description}}","").replace("{{meta_key}}",""),o=r(e),a.add_to_placeholder("label-position",a.tpl.label_position,o)),e=o[0].outerHTML,r.magnificPopup.open({items:{src:'<div class="white-popup">'+e+"</div>",type:"inline"}},0),!1}),r(e).on("click",".iconic-cffv-save-field",function(){var e=parseInt(r(this).attr("data-index")),i=r(this).attr("data-save-type"),t=a.get_edit_field_data(),o=JSON.stringify(t),l=!1;return"Edit"===i?((l=r(".iconic-cffv-fields__field").eq(e)).find(".iconic-cffv-field-data").val(o),l.find(".iconic-cffv-field-label").html(t.label),l.find(".iconic-cffv-field-type").html(t.type)):(i="[iconic-variation-fields fields='"+a.generate_field_meta_key(t)+"']",(l=r(a.tpl.field_row.replace(/{{index}}/g,e).replace("{{order}}",e+1).replace("{{label}}",t.label).replace("{{type}}",t.type).replace("{{default}}",t.default).replace("{{shortcode}}",i))).find(".iconic-cffv-field-data").val(o),a.els.fields_table_body.append(l)),r.magnificPopup.close(),!1}),r(e).on("change",".iconic-cffv-field-editor__type",function(){var e=r(this).closest(".iconic-cffv-field-editor"),i=r(this).val(),t=r(".iconic-cffv-field-editor__options");a.has_display_as(i)?a.add_to_placeholder("display-as",a.tpl.display_as,e):a.empty_placeholder("display-as",e),a.has_label_position(i)?a.add_to_placeholder("label-position",a.tpl.label_position,e):a.empty_placeholder("label-position",e),a.has_options(i)?t.length<=0&&a.add_to_placeholder("options",a.tpl.options.replace("{{options}}",""),e):a.empty_placeholder("options",e)}),r(e).on("change",".iconic-cffv-field-editor__display_as",function(){var e=r(this).closest(".iconic-cffv-field-editor");"comma_separated"===r(this).val()?a.add_to_placeholder("label-position",a.tpl.label_position,e):a.empty_placeholder("label-position",e)}),r(e).on("click",".iconic-cffv-delete-field",function(){r(this).closest("tr").remove(),a.update_field_orders()})},update_field_orders:function(){r(".iconic-cffv-fields__field-order").each(function(e,i){r(i).html(e+1)})},get_field_data_from_row:function(e){var i=e.closest("tr"),t=!1;if(i.length<=0)return t;e=i.find(".iconic-cffv-field-data").val();return void 0===e||void 0===(t={index:i.attr("data-index"),json:r.parseJSON(e)}).json.id&&(t.json.id=a.slugify(t.json.label)),t},get_edit_field_data:function(){var e=r(".iconic-cffv-field-editor");return a.serialize_assoc(e)},serialize_assoc:function(e){var i,t=e.serializeArray(),o={};for(i in t)if(t.hasOwnProperty(i)){var l,a,n,s,c=t[i].name.split(/\]|\[/),d=o;for(l in c=r.grep(c,function(e){return""!==e}))c.hasOwnProperty(l)&&(a=c[l],n={},parseInt(l)===c.length-1&&(n=t[i].value),(s={})[a]=n,r.extend(!0,d,s),d=d[a])}return o},nl2br:function(e,i){return(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(i||void 0===i?"<br />":"<br>"))},br2nl:function(e){return(e+"").replace(/<br \/>/g,"\r\n")},slugify:function(e){e=(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var i="àáäâèéëêìíïîòóöôùúüûñç·/,:;",t=0,o=i.length;t<o;t++)e=e.replace(new RegExp(i.charAt(t),"g"),"aaaaeeeeiiiioooouuuunc_____".charAt(t));return e=a.sanitize_str(e).replace(/\s+/g,"_").replace(/\.+/g,"_").replace(/-+/g,"_").replace(/_+/g,"_")},sanitize_str:function(e){var i={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","ß":"s","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","ĝ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"l","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"n","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","ƒ":"f","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ǻ":"A","ǻ":"a","Ǽ":"AE","ǽ":"ae","Ǿ":"O","ǿ":"o"," ":"_","'":"","?":"","/":"","\\":"",".":"",",":"","`":"",">":"","<":"",'"':"","[":"","]":"","|":"","{":"","}":"","(":"",")":""};return e=(e=e.replace(/\W/g,function(e){return void 0!==i[e]?i[e]:e})).toLowerCase()},add_to_placeholder:function(e,i,t){t.find(".iconic-cffv-placeholder--"+e).html(i)},empty_placeholder:function(e,i){i.find(".iconic-cffv-placeholder--"+e).html("")},has_options:function(e){return"checkboxes"===e||"radio_buttons"===e||"select"===e},has_display_as:function(e){return"checkboxes"===e},has_label_position:function(e,i){return i=void 0!==i&&i,"text"===e||"radio_buttons"===e||"select"===e||"checkboxes"===e&&"comma_separated"===i},setup_help_tips:function(){r(e.body).on("wc-enhanced-select-init",function(){var e=r(".iconic-cffv-field-groups .woocommerce-help-tip");e.length<=0||e.each(function(){var e=r(this).closest(".form-row"),i=e.find("legend"),i=i.length<=0?e.find("label:first"):i;i.length<=0||i.append(r(this))})})},generate_field_meta_key:function(e){return"iconic_cffv_"+a.vars.post_id+"_"+(e.json||e).id}};r(e).ready(a.on_ready())}(jQuery,document);