"use strict";function wpie_set_local_file_uploader(){var e=new plupload.Uploader({runtimes:"html5,silverlight,flash,html4",url:wpiePluginSettings.wpieAjaxURL,drop_element:"wpie_upload_drag_drop",chunk_size:"1024kb",file_data_name:"local_file",multiple_queues:!1,multi_selection:!1,max_file_size:"100Gb",browse_button:"plupload_browse_button",container:"wpie_upload_container",filters:{prevent_duplicates:!1},multipart_params:{action:"wpie_import_local_upload_file",wpie_import_id:wpiePluginSettings.wpieImportId,wpieSecurity:wpiePluginSettings.wpieSecurity},flash_swf_url:"plupload.flash.swf",silverlight_xap_url:"plupload.silverlight.xap"});e.bind("BeforeUpload",function(i,t){e.settings.multipart_params.wpie_import_id=wpiePluginSettings.wpieImportId}),e.bind("Init",function(e){var i=jQuery("#wpie_upload_container");e.features.dragdrop?(i.addClass("wpie_drag_drop"),jQuery("#wpie_upload_container").bind("dragover.wp_uploader",function(){i.addClass("wpie_drag_over")}).bind("dragleave.wp_uploader, drop.wp_uploader",function(){i.removeClass("wpie_drag_over")})):(i.removeClass("drag_drop"),jQuery(".wpie_upload_drag_drop").unbind(".wp_uploader"))}),e.init(),e.bind("FilesAdded",function(e,i){jQuery(".wpie_upload_container_wrapper .wpie_file_list_wrapper").html(""),jQuery(".wpie_upload_drag_drop_data").attr("wpie_status","processing"),jQuery(".wpie_local_uploaded_filename_label").text(wpiePluginSettings.wpieLocalizeText.wpieUploadingText);var t="",p=!0;if(jQuery.each(i,function(e,i){var a=i.name.split(".").pop().toLowerCase();if(-1==jQuery.inArray(a,["txt","zip","json","xml","xls","xlsx","csv","ods","gz","tar"]))return p=!1,!1;t+=i.name+" ( "+plupload.formatSize(i.size)+" ) "}),!p)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.invalidFileExtensionText),!1;jQuery(".wpie_local_uploaded_filename").text(t),e.start()}),e.bind("UploadProgress",function(e,i){jQuery(".wpie_uploaded_file_list_wrapper").show(),jQuery(".wpie_import_upload_process_per").css("width",i.percent+"%").html(i.percent+"%")}),e.bind("FileUploaded",function(e,i,t){if(jQuery(".wpie_import_ref_id").val(""),null===t||void 0===t.response||null===t.response)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.invalidFileExtensionText),!1;var p=JSON.parse(t.response);if("error"==p.status)return wpieSetErrorMsg(p.message),!1;wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]=[],wpieSetFileData(p)}),e.bind("Error",function(e,i){if(jQuery(".wpie_uploaded_file_list").hide(),void 0!==i.code&&-601==i.code)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.invalidFileExtensionText),!1;wpieHandleAjaxError(i,"")})}function wpieProcessingReimport(e,i,t){wpieSetProcessLoader({processingReimport:wpiePluginSettings.wpieLocalizeText.processingReimport});var p={action:"wpie_import_process_reimport",import_id:e,nonce:i,ref_id:t,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:p,dataType:"json",async:!0,success:function(e){if(wpieUpdateProcessLoader("processingReimport"),"error"==e.status)return wpieSetErrorMsg(e.message),!1;void 0!==e.import_type&&jQuery(".wpie_import_type_select").val()!=e.import_type&&(jQuery(".wpie_import_type_select").val(e.import_type).trigger("change").trigger("chosen:updated"),"taxonomies"==e.import_type&&void 0!==e.taxonomy_type&&jQuery(".wpie_taxonomies_types_select").val()!=e.taxonomy_type&&jQuery(".wpie_taxonomies_types_select").val(e.taxonomy_type).trigger("change").trigger("chosen:updated"));var i=void 0===e.xpath?"":e.xpath,t=void 0===e.root?"":e.root;jQuery(".wpie_xpath").val(i);var p=void 0===e.activeFormat||""===e.activeFormat?"csv":e.activeFormat;jQuery(".wpie_text_format_list_"+p).prop("checked",!0),wpiePluginSettings.reImportData=[],wpiePluginSettings.reImportData.xpath=i,wpiePluginSettings.reImportData.root=t,wpiePluginSettings.reImportData.status="pending",wpiePluginSettings.reImportData.activeFile=void 0===e.activeFile?"":e.activeFile,wpieSetFileData(e)},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieSetFileData(e){if(0==wpiePluginSettings.wpieImportId&&void 0!==e.wpie_import_id&&null!==e.wpie_import_id&&(wpiePluginSettings.wpieImportId=e.wpie_import_id),void 0!==e.file_list&&null!==e.file_list){if(0==e.file_count)return jQuery(".wpie_upload_section_wrapper:visible .wpie_file_list_wrapper").html(""),wpieSetErrorMsg(e.message),!1;wpieHandleFileList(e.file_list,".wpie_upload_section_wrapper:visible")}jQuery(".wpie_upload_section_wrapper:visible .wpie_local_uploaded_filename_label").text(wpiePluginSettings.wpieLocalizeText.wpieUploadCompleteText);var i=jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").val(),t=!1;void 0!==wpiePluginSettings.reImportData&&void 0!==wpiePluginSettings.reImportData.activeFile&&(wpiePluginSettings.reImportData.activeFile!=i&&jQuery(".wpie_upload_section_wrapper:visible").find("."+wpiePluginSettings.reImportData.activeFile).length&&(jQuery(".wpie_upload_section_wrapper:visible").find("."+wpiePluginSettings.reImportData.activeFile).prop("checked",!0),i=jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").val(),t=!0),delete wpiePluginSettings.reImportData.activeFile),wpiePluginSettings.importData.activeFile=i,wpieSetFileAttributes(e),wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetTemplates:wpiePluginSettings.wpieLocalizeText.wpieGetTemplatesText,wpieGetSettingsList:wpiePluginSettings.wpieLocalizeText.wpieGetSettingList,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),wpieValidateUploadedFile(t,","),wpieImportGetTemplates(),wpieImportGetSettings()}function wpieSetFileAttributes(e){var i=wpiePluginSettings.importData.activeFile;void 0===wpiePluginSettings.importData[i]&&(wpiePluginSettings.importData[i]=[]),wpiePluginSettings.importData[i].fileType="",wpiePluginSettings.importData[i].fileName="",void 0!==e.file_name&&(wpiePluginSettings.importData[i].fileName=e.file_name,wpiePluginSettings.importData[i].fileType=e.file_name.substr(e.file_name.lastIndexOf(".")+1)),"txt"===wpiePluginSettings.importData[i].fileType?(jQuery(".wpie_text_format_list_wrapper").show(),void 0===wpiePluginSettings.importData[i].activeFormat&&(wpiePluginSettings.importData[i].activeFormat="csv"),wpiePluginSettings.importData[i].fileType=wpiePluginSettings.importData[i].activeFormat):jQuery(".wpie_text_format_list_wrapper").hide(),wpiePluginSettings.importData[i].fileSize="0kb",void 0!==e.file_size&&(wpiePluginSettings.importData[i].fileSize=plupload.formatSize(e.file_size));var t=wpiePluginSettings.importData[i].fileType;if(-1==jQuery.inArray(t,["xls","xlsx","csv","ods"])?jQuery(".wpie_file_options_wrapper").hide():(jQuery(".wpie_file_options_wrapper").show(),"csv"==t?jQuery(".wpie_csv_delimiter_wrapper").show():jQuery(".wpie_csv_delimiter_wrapper").hide()),void 0===wpiePluginSettings.importData.changeExcelSheet||!1===wpiePluginSettings.importData.changeExcelSheet){var p=void 0===e.sheetList?[]:e.sheetList,a=void 0===e.activeSheet?"":e.activeSheet;wpieHandleExcelSheetList(p,a),void 0===wpiePluginSettings.importData[i]&&(wpiePluginSettings.importData[i]=[]),wpiePluginSettings.importData[i].activeSheet=a}else wpiePluginSettings.importData.changeExcelSheet=!1;wpiePluginSettings.importData[i].activeFormat=void 0===e.activeFormat||""===e.activeFormat?"csv":e.activeFormat}function wpieSetProcessLoader(e){var i="";jQuery.each(e,function(e,t){i+='<div class="wpie_task_wrapper '+e+'" >',i+='<div class="wpie_task_icon_wrapper wpie_task_processing_icon"><i class="fas fa-spinner fa-spin wpie_spinner_btn_icon"></i></div>',i+='<div class="wpie_task_icon_wrapper wpie_task_completed_icon"><i class="fas fa-check-circle wpie_general_btn_icon " aria-hidden="true"></i></div>',i+='<div class="wpie_task_title">'+t+"</div>",i+="</div>"});var t=setInterval(function(){!0===wpiePluginSettings.isModalHide&&(clearInterval(t),jQuery(".wpie_task_list").html(i),void 0!==wpiePluginSettings.bsModal&&null!==wpiePluginSettings.bsModal?bootstrap.Modal.getInstance(jQuery(".wpie_processing_data")):wpiePluginSettings.bsModal=new bootstrap.Modal(jQuery(".wpie_processing_data"),{backdrop:"static",keyboard:!1}),wpiePluginSettings.bsModal.show(),jQuery(".wpie_processing_data").on("shown.bs.modal",function(e){wpiePluginSettings.isModalHide=!1}))},200)}function wpieHideProcessingLoader(){var e=setInterval(function(){!1===wpiePluginSettings.isModalHide&&(clearInterval(e),void 0===wpiePluginSettings.bsModal||null==wpiePluginSettings.bsModal?jQuery(".wpie_processing_data").modal("hide"):wpiePluginSettings.bsModal.hide(),jQuery(".wpie_processing_data").on("hidden.bs.modal",function(e){wpiePluginSettings.isModalHide=!0}))},200)}function wpieUpdateProcessLoader(e){var i=setInterval(function(){jQuery("."+e).length&&(clearInterval(i),jQuery("."+e).addClass("task_completed"),jQuery(".wpie_task_list").find(".wpie_task_wrapper:not(.task_completed)").length||wpieHideProcessingLoader())},200)}function wpieValidateUploadedFile(e,i){var t=wpiePluginSettings.importData.activeFile;if(void 0===wpiePluginSettings.importData[t]&&(wpiePluginSettings.importData[t]={}),e||void 0===wpiePluginSettings.importData[t].count){var p=e?0:1,a=jQuery(".wpie_file_first_row_is_title:checked").val(),r="";void 0!==wpiePluginSettings.importData[t].activeSheet&&(r=wpiePluginSettings.importData[t].activeSheet);var n="";void 0!==wpiePluginSettings.importData[t].activeFormat&&(n=wpiePluginSettings.importData[t].activeFormat);var o=wpieGetValidFormData([{name:"action",val:"wpie_import_validate_uploads"},{name:"wpie_import_id",val:wpiePluginSettings.wpieImportId},{name:"activeFile",val:t},{name:"activeSheet",val:r},{name:"activeFormat",val:n},{name:"wpie_csv_delimiter",val:i},{name:"is_new_req",val:p},{name:"wpie_file_first_row_is_title",val:a},{name:"wpieSecurity",val:wpiePluginSettings.wpieSecurity}]);jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:o,dataType:"json",async:!0,success:function(e){if("error"==e.status)return wpieSetErrorMsg(e.message),!1;wpieSetFileAttributes(e),jQuery(".wpie_csv_delimiter").val(e.delimiter),wpieUpdateProcessLoader("wpieValidateUpload"),jQuery(".wpie_import_step1_btn").show(),jQuery(document).trigger("wpieValidUploadFile"),wpieGetConfig()},error:function(e,i){wpieHandleAjaxError(e,i)}})}else{var s="undefined"!=wpiePluginSettings.importData[t].fileType?wpiePluginSettings.importData[t].fileType:"";-1==jQuery.inArray(s,["xls","xlsx","csv","ods"])?jQuery(".wpie_file_options_wrapper").hide():(jQuery(".wpie_file_options_wrapper").show(),"csv"==s?jQuery(".wpie_csv_delimiter_wrapper").show():jQuery(".wpie_csv_delimiter_wrapper").hide()),wpieUpdateProcessLoader("wpieValidateUpload"),jQuery(".wpie_import_step1_btn").show(),jQuery(document).trigger("wpieValidUploadFile"),wpieGetConfig()}}function wpieGetValidFormData(e){var i="";if("object"==typeof e&&!jQuery.isEmptyObject(e)){var t=jQuery("<form>");jQuery.each(e,function(e,i){"object"!=typeof i||jQuery.isEmptyObject(i)||jQuery("<input>").attr({type:"hidden",name:i.name}).val(i.val).appendTo(t)}),i=t.serialize(),t.remove()}return i}function wpieGetConfig(){if(void 0===wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]&&(wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]=[]),void 0!==wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config)wpieUpdateProcessLoader("wpieGetConfig"),wpieConfigImport();else{var e={action:"wpie_import_get_config",import_id:wpiePluginSettings.wpieImportId,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:e,dataType:"json",async:!0,success:function(e){if("error"==e.status)return wpieSetErrorMsg(e.message),!1;wpieUpdateProcessLoader("wpieGetConfig"),void 0!==e.config?wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config=e.config:wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config={},wpieConfigImport()},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieConfigImport(){var e=wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config;wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig=!0,void 0!==e.import_type&&""!=e.import_type&&(jQuery(".wpie_import_type_select").val()!=e.import_type&&(jQuery(".wpie_import_type_select").val(e.import_type).trigger("chosen:updated"),wpieImportGetTemplates(),wpieImportGetSettings()),"taxonomies"!=e.import_type?jQuery(".wpie_taxonomies_types_wrapper").hide():jQuery(".wpie_taxonomies_types_wrapper").show(),"taxonomies"==e.import_type&&void 0!==e.import_sub_type&&""!=e.import_type&&jQuery(".wpie_taxonomies_types_select").val()!=e.import_sub_type&&jQuery(".wpie_taxonomies_types_select").val(e.import_sub_type).trigger("change").trigger("chosen:updated")),wpieGetImportFields(jQuery(".wpie_import_type_select").val()),wpieGetFilteredRecords(0,1,"","",!0)}function wpieSetTemplate(e){if("object"==typeof e&&!jQuery.isEmptyObject(e)){wpieSetCF(e),wpieSetTaxonomy(e),jQuery(document).trigger("wpieChangeTemplate",[e]),jQuery(".wpie_item_update_field").prop("checked",!1),jQuery.each(e,function(e,i){if(e.match("^wpie_item_cf")||e.match("^wpie_item_acf")||e.match("^wpie_item_taxonomy")||e.match("^wpie_item_set_taxonomy")||!(e.match("^wpie_item_")||e.match("^wpie_existing_item")||e.match("^is_update_item")||e.match("^wpie_wpml_lang")||e.match("^wpie_polylang_lang")))return!0;if(jQuery("."+e).length)if(jQuery("."+e).first().is(".wpie_radio,.wpie_checkbox")){var t=!0;jQuery.each(jQuery("."+e),function(e){"as_specified"!==i&&jQuery(this).val()==i?(jQuery(this).prop("checked",!0),t=!1):jQuery(this).prop("checked",!1)}),!0===t?(jQuery("."+e+"_as_specified").prop("checked",!0).trigger("change"),jQuery("."+e+"_as_specified_data").val(i)):(jQuery("."+e+"_as_specified").prop("checked",!1).trigger("change"),jQuery("."+e+"_as_specified_data").val(""))}else if(jQuery("."+e).first().is(".wpie_content_data_select")){t=!0;jQuery.each(jQuery("."+e+" option"),function(e){if(jQuery(this).attr("value")==i)return t=!1,!1}),t?(jQuery("."+e).val("as_specified").trigger("chosen:updated").trigger("change"),jQuery("."+e+"_as_specified_wrapper").show(),jQuery("."+e+"_as_specified_data").val(i)):(jQuery("."+e).val(i).trigger("chosen:updated").trigger("change"),jQuery("."+e+"_as_specified_wrapper").hide(),jQuery("."+e+"_as_specified_data").val(""))}else jQuery("."+e).val(i)});var i=["wpie_item_unsuccess_set_draft","wpie_item_set_image_title","wpie_item_set_image_caption","wpie_item_set_image_alt","wpie_item_set_image_description","wpie_item_image_rename","wpie_item_change_ext","wpie_item_attachement_search_for_existing"];jQuery.each(i,function(i,t){void 0===e[t]&&jQuery("."+t).prop("checked",!1)}),i=["wpie_item_search_existing_images","wpie_item_keep_images","wpie_item_first_imaege_is_featured","wpie_item_import_img_tags"],jQuery.each(i,function(i,t){void 0===e[t]&&jQuery("."+t).prop("checked",!0)}),jQuery(document).trigger("wpieAfterChangeTemplate",[e]),wpieSetToolTip()}wpieUpdateProcessLoader("wpieChangeTemplates")}function wpieSetToolTip(){"function"==typeof jQuery.fn.tipso&&jQuery(".wpie_data_tipso").length&&jQuery(".wpie_data_tipso").tipso({useTitle:!1,background:"rgba(0,0,0,0.8)",color:"#ffffff",size:"small",tooltipHover:!0})}function wpieValidateProcess(){return!1!==wpieIsValidTime()&&!1!==wpieIsData()||(wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieInvalidLicense),!1)}function wpieGetImportFields(e){var i=jQuery(".wpie_taxonomies_types_select").val(),t={};if("taxonomies"===e?void 0!==wpiePluginSettings.importData[e]&&void 0!==wpiePluginSettings.importData[e][i]&&void 0!==wpiePluginSettings.importData[e][i].fields&&(t=wpiePluginSettings.importData[e][i]):void 0!==wpiePluginSettings.importData[e]&&void 0!==wpiePluginSettings.importData[e].fields&&(t=wpiePluginSettings.importData[e]),jQuery.isEmptyObject(t)){i=jQuery(".wpie_taxonomies_types_select").val();var p={action:"wpie_import_get_fields",type:e,taxonomy:i,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:p,dataType:"json",async:!0,success:function(t){if("error"==t.status)return wpieSetErrorMsg(t.message),!1;wpieUpdateProcessLoader("wpieGetFields");var p={};void 0!==t.fields&&(p.fields=t.fields,jQuery(".wpie_field_mapping_section").html(t.fields),jQuery(".wpie_field_mapping_section").find(".wpie_content_data_select").chosen()),void 0!==t.search_fields&&(p.searchFields=t.search_fields,jQuery(".wpie_search_item_wrapper").html(t.search_fields)),void 0!==t.update_fields&&(p.updateFields=t.update_fields,jQuery(".wpie_update_item_wrapper").html(t.update_fields)),void 0===wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]=[]),"taxonomies"===e?wpiePluginSettings.importData[e][i]=p:wpiePluginSettings.importData[e]=p,wpieChangeConfig()},error:function(e,i){wpieHandleAjaxError(e,i)}})}else jQuery(".wpie_field_mapping_section").html(t.fields),jQuery(".wpie_field_mapping_section").find(".wpie_content_data_select").chosen(),void 0!==t.searchFields&&jQuery(".wpie_search_item_wrapper").html(t.searchFields),void 0!==t.updateFields&&jQuery(".wpie_update_item_wrapper").html(t.updateFields),wpieUpdateProcessLoader("wpieGetFields"),wpieChangeConfig()}function wpieChangeConfig(){if(jQuery(document).trigger("wpieBeforeChangeConfig"),void 0!==wpiePluginSettings.importData[wpiePluginSettings.wpieImportId]&&void 0!==wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig&&1==wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig){wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].changeConfig=!1;var e=wpiePluginSettings.importData[wpiePluginSettings.wpieImportId].config;jQuery(document).trigger("wpieChangeConfig",[e.fields]),void 0!==e.fields&&wpieSetTemplate(e.fields)}wpieSetToolTip(),jQuery(document).trigger("wpieAfterChangeConfig")}function wpieGetFilteredRecords(e,i,t,p,a){var r={action:"wpie_import_get_filtered_records",wpie_import_id:wpiePluginSettings.wpieImportId,start:e,length:i,xpath:t,root:p,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:r,dataType:"json",success:function(i){if("error"==i.status)return wpieSetErrorMsg(i.message),!1;jQuery(".wpie_element_nav_element").val(e+1);var r=wpiePluginSettings.importData.activeFile;if(void 0!==i.count&&(wpiePluginSettings.importData[r].count=i.count,jQuery(".wpie_data_element_action_nav_total").html(i.count)),(""==t||a)&&void 0!==i.xpath){var n=i.xpath.substring(1);wpiePluginSettings.importData[r].xpath=n,jQuery(".wpie_xpath").val(n)}""!=p&&!a||void 0===i.root||(wpiePluginSettings.importData[r].root=i.root),void 0!==i.filter_element&&(wpiePluginSettings.importData[r].node_list=i.filter_element,jQuery(".wpie_element_list").html("").append(jQuery("<option></option>").val("").text(wpiePluginSettings.wpieLocalizeText.selectElementText)),jQuery.each(i.filter_element,function(e,i){jQuery(".wpie_element_list").append(jQuery("<option></option>").val(i).text(i))}),jQuery(".wpie_element_list").val("").trigger("chosen:updated"));var o="",s=!0;if(void 0===i.file_type||"csv"!=i.file_type&&"xls"!=i.file_type&&"xlsx"!=i.file_type){if(jQuery(".wpie_element_tag_outer").show(),void 0!==i.node_list&&!jQuery.isEmptyObject(i.node_list)){var l="";jQuery.each(i.node_list,function(e,i){if(wpiePluginSettings.importData[r].root==e)var t="wpie_active";else t="";l+='<div class="wpie_layout_tag_wrapper '+t+'"><div class="wpie_layout_tag_name">'+e+'</div><div class="wpie_layout_tag_count">'+i+"</div></div>"}),jQuery(".wpie_element_tag_wrapper").html(l),wpiePluginSettings.importData[r].node_list=i.node_list}void 0!==i.content&&jQuery.each(i.content,function(e,i){o+=wpieGenerateXmlTagView(i)})}else s=!1,jQuery(".wpie_element_tag_outer").hide(),void 0!==i.content&&jQuery.each(i.content,function(e,i){o+=wpieGenerateTableView(i)});return jQuery(".wpie_data_preview").html(o),jQuery(".wpie_data_fields_container").html(o),s?jQuery(".wpie_field_mapping_data_wrapper .wpie_data_fields_container").find(".wpie_tag.wpie_opening:not(.wpie_tag_has_child) .wpie_tag_name,.wpie_tag_attr_name").wpieInsertAtCaret():jQuery(".wpie_data_fields_container").find(".wpie_tag_table_header_data").wpieInsertAtCaret(),wpiePluginSettings.importData[r].content=i.content,wpieUpdateProcessLoader("wpieGetRecords"),wpieSetReimportData(),0==wpiePluginSettings.importData[r].count?(jQuery(".wpie_import_step1").is(":visible")&&jQuery(".wpie_import_step1_btn").hide(),wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieNoRecordsFoundText),!1):void 0},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieSetReimportData(){return void 0!==wpiePluginSettings.reImportData&&void 0!==wpiePluginSettings.reImportData.status&&("pending"==wpiePluginSettings.reImportData.status&&(wpiePluginSettings.reImportData.status="completed",void(jQuery(".wpie_xpath").val()!==wpiePluginSettings.reImportData.xpath&&wpieUpdateXpath(wpiePluginSettings.reImportData.xpath,wpiePluginSettings.reImportData.root))))}function wpieHandleAjaxError(e,i){return wpieSetErrorMsg(0===e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_not_connect_error:400==e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_400_error:404==e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_404_error:500==e.status?wpiePluginSettings.wpieLocalizeText.wpie_ajax_internal_server_error:"parsererror"===i?wpiePluginSettings.wpieLocalizeText.wpie_ajax_jason_parse_error:"timeout"===i?wpiePluginSettings.wpieLocalizeText.wpie_ajax_time_out_error:"abort"===i?wpiePluginSettings.wpieLocalizeText.wpie_ajax_request_aborted_error:wpiePluginSettings.wpieLocalizeText.wpie_ajax_uncaught_error+e.responseText),!1}function wpieSetStrictErrorMsg(e){wpieHideLoader(),jQuery(".wpie_strict_error_content").html(e),new bootstrap.Modal(jQuery(".wpie_strict_error_model"),{backdrop:"static",keyboard:!1}).show()}function wpieSetErrorMsg(e){wpieHideLoader(),wpieHideProcessingLoader(),jQuery(".wpie_error_content").html(e),new bootstrap.Modal(jQuery(".wpie_error_model"),{backdrop:!0}).show()}function wpieSetSuccessMsg(e){jQuery.notify({message:'<i class="far fa-check-circle"></i> '+e},{type:"success",placement:{align:"right",from:"bottom"},animate:{enter:"animate__animated animate__fadeInUp",exit:"animate__animated animate__fadeOutDown"}})}function wpieHandleExcelSheetList(e,i){var t=1;Array.isArray(e)&&(t=e.length);var p=jQuery(".wpie_upload_section_wrapper:visible .wpie_excel_sheets_wrapper");if(p.html(""),t>1){jQuery("<div>").addClass("wpie_sheet_list_header").text(wpiePluginSettings.wpieLocalizeText.wpieChooseSheetText).appendTo(p);var a=jQuery("<div>").addClass("wpie_sheet_list_container").appendTo(p),r=!1,n="";jQuery.each(e,function(e,t){r=t==i,n=jQuery("<div>").addClass("wpie_sheet_list_element").appendTo(a),jQuery("<input>").addClass("wpie_sheet_list wpie_upload_sheet_list wpie_radio").attr({type:"radio",id:"wpie_sheet_"+t,name:"wpie_import_excel_sheet"}).prop("checked",r).val(t).appendTo(n),jQuery("<label>").addClass("wpie_sheet_list_data wpie_radio_label").attr("for","wpie_sheet_"+t).text(t).appendTo(n)}),p.show()}else p.hide()}function wpieHandleFileList(e,i){var t='<div class="wpie_file_list_header">'+wpiePluginSettings.wpieLocalizeText.wpieChooseFileText+'</div><div class="wpie_file_list_container">',p=!0,a=(jQuery(".wpie_upload_type").val(),"");jQuery.each(e,function(e,i){if(1==p){p=!1;var r='checked="checked"';a=e}else r="";t+='<div class="wpie_file_list_element" ><input class="wpie_file_list wpie_upload_file_list wpie_radio '+i.fileKey+'"  type="radio" id="'+i.fileKey+'" value="'+i.fileKey+'" name="wpie_import_local_upload" '+r+'><label class="wpie_file_list_data wpie_radio_label"  for="'+i.fileKey+'">'+i.fileName+"</label></div>"}),t+="</div>",jQuery(i).find(".wpie_file_list_wrapper").html(t).show(),jQuery(i).find(".wpie_upload_finalFile").val(a)}function wpieShowLoader(){jQuery(".wpie_loader").removeClass("wpie_hidden")}function wpieHideLoader(){jQuery(".wpie_loader").addClass("wpie_hidden")}function wpieRefreshImport(){if(!wpieValidateImportExt())return!1;var e=jQuery(".wpie_import_type_select").val();jQuery(".wpie_content_data").attr("class","wpie_content_data wpie_"+e),wpieSetProcessLoader({wpieGetTemplates:wpiePluginSettings.wpieLocalizeText.wpieGetTemplatesText,wpieGetSettingsList:wpiePluginSettings.wpieLocalizeText.wpieGetSettingList,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText}),wpieImportGetTemplates(),wpieImportGetSettings(),"taxonomies"==e?jQuery(".wpie_taxonomies_types_wrapper").slideDown():jQuery(".wpie_taxonomies_types_wrapper").slideUp(),wpieGetImportFields(e)}function wpieValidateImportExt(){var e=jQuery(".wpie_import_type_select").val(),i=!0,t="";if(!Array.isArray(wpiePluginSettings.wpieExtensions)){var p=[];jQuery.isEmptyObject(wpiePluginSettings.wpieExtensions)||jQuery.each(wpiePluginSettings.wpieExtensions,function(e){p.push(e)}),wpiePluginSettings.wpieExtensions=p}return void 0!==wpiePluginSettings.isWcActive&&1!=wpiePluginSettings.isWcActive&&-1!==jQuery.inArray(e,["shop_customer","shop_order","shop_coupon","product","product_attributes"])?i=!0:"users"==e?wpiePluginSettings.wpieExtensions.indexOf("wpie_user_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportUserExtDisableText,i=!1):"shop_customer"==e?wpiePluginSettings.wpieExtensions.indexOf("wpie_wc_import")<0?(t=wpiePluginSettings.wpieLocalizeText.wpieImportWCExtDisableText,i=!1):wpiePluginSettings.wpieExtensions.indexOf("wpie_user_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportUserExtDisableText,i=!1):"shop_order"==e||"shop_coupon"==e||"product"==e?wpiePluginSettings.wpieExtensions.indexOf("wpie_wc_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportWCExtDisableText,i=!1):"product_attributes"==e&&wpiePluginSettings.wpieExtensions.indexOf("wpie_product_attribute_import")<0&&(t=wpiePluginSettings.wpieLocalizeText.wpieImportPAExtDisableText,i=!1),0!=i||(jQuery(".wpie_import_type_select").val("post").trigger("chosen:updated"),"taxonomies"==e?jQuery(".wpie_taxonomies_types_wrapper").slideDown():jQuery(".wpie_taxonomies_types_wrapper").slideUp(),wpieGetImportFields("post"),wpieSetErrorMsg(t),!1)}function wpieGotoRecord(e){var i=wpiePluginSettings.importData.activeFile,t=wpiePluginSettings.importData[i].root,p=wpiePluginSettings.importData[i].xpath,a=wpiePluginSettings.importData[i].count;e>=1&&e<=a?wpieGetFilteredRecords(e-1,1,p,t,!1):wpieUpdateProcessLoader("wpieGetRecords")}function wpieGenerateTableView(e){var i=jQuery("<table>");i.attr({width:"100%",cellspacing:0}).addClass("wpie_import_data_preview table table-striped table-bordered");var t=jQuery("<thead>");"object"==typeof e&&null!==e&&"object"==typeof e.value&&null!==e.value&&jQuery.each(e.value,function(e,i){var p=void 0!==i.path?i.path:"",a=void 0!==i.name?i.name:"",r=void 0!==i.value?i.value:"",n=jQuery("<tr>"),o=jQuery("<th>"),s=jQuery("<div>").attr("data_value",p).addClass("wpie_tag_table_header_data").text(a);o.addClass("wpie_tag_header_wrapper").append(s);var l="",_="";""!=r&&r.length>200&&((l=jQuery("<span>")).addClass("wpie_xml_data_more wpie_show_more_data").text(wpiePluginSettings.wpieLocalizeText.showMoreText),_=jQuery("<div>").addClass("wpie_tag_content_full_text").text(r),r=r.substring(0,200));var w=jQuery("<td>"),u=jQuery("<div>").addClass("wpie_tag_table_contant_data wpie_tag_content_text").text(r);w.addClass("wpie_tag_contant_data_wrapper").append(u).append(_).append(l),n.append(o).append(w),t.append(n)}),i.append(t);var p=jQuery("<tbody>");return i.append(p),jQuery("<div>").append(i).html()}function wpieGenerateXmlTagView(e){var i="";if("object"==typeof e&&null!==e){var t="",p="",a="",r="";"object"==typeof e.value&&null!==e.value?(jQuery.each(e.value,function(e,i){t+=wpieGenerateXmlTagView(i)}),a=" wpie_tag_section_container",r=" wpie_tag_has_child"):void 0!==e.value&&(p+=e.value);var n=e.name,o=e.path,s="";"object"!=typeof e["@attributes"]||null===e["@attributes"]||jQuery.isEmptyObject(e["@attributes"])||jQuery.each(e["@attributes"],function(e,i){s+='<span class="wpie_tag_attr" >',s+='<span class="wpie_tag_attr_name" data_value="'+o+"/@"+e+'"> '+e+'</span> = <span class="wpie_tag_attr_value">"'+i+'" </span>',s+="</span>"});var l="",_="",w="";(""!=t&&t.length>40||""!=p&&p.length>40)&&(l='<i aria-hidden="true" class="fas fa-plus wpie_layout_tag_icon wpie_layout_expand_icon"></i><i aria-hidden="true" class="fas fa-minus wpie_layout_collapsed_icon wpie_layout_tag_icon"></i>',""!=p&&p.length>200&&((_=jQuery("<span>")).addClass("wpie_xml_data_more wpie_show_more_data").text(wpiePluginSettings.wpieLocalizeText.showMoreText),w=jQuery("<div>").addClass("wpie_tag_content_full_text").text(p),p=p.substring(0,200)));var u=jQuery("<div>");u.addClass("wpie_tag_outer_wrapper");var c=jQuery("<span>");c.addClass("wpie_tag_name").attr("data_value",o).text(n);var d=jQuery("<div>");if(d.addClass("wpie_tag wpie_opening "+r).append(l).append("&lt;").append(c).append(s).append("&gt;"),(i=jQuery("<div>")).addClass("wpie_tag_content "+a),""===p)i.html(t);else{var g=jQuery("<div>").addClass("wpie_tag_content_text").text(p);i.append(g).append(w).append(_)}var m=jQuery("<span>");m.addClass("wpie_tag_name").text(n);var y=jQuery("<div>");y.addClass("wpie_tag wpie_closing").append("&lt;/").append(m).append(s).append("&gt;"),u.append(d).append(i).append(y),i=jQuery("<div>").append(u).html()}return i}function wpieAddNewImportRule(){var e=jQuery(".wpie_element_list").val(),i=jQuery(".wpie_element_list").find("option:selected").text(),t=jQuery(".wpie_element_rule").val(),p=jQuery(".wpie_element_rule").find("option:selected").text(),a=jQuery(".wpie_element_value").val();if(""==e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.selectElementText),!1;if(""==t)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.selectExportRuleText),!1;if(jQuery(".wpie_filter_data_rule").length>0){var r=Math.floor(1e8*Math.random()+1),n='<div class="wpie_rule_condition_wrapper"><input type="radio" class="wpie_radio wpie_rule_clause" checked="checked" name="wpie_content_data_rule_condition_'+r+'" id="wpie_content_data_rule_condition_and_'+r+'" value="and"/><label for="wpie_content_data_rule_condition_and_'+r+'" class="wpie_radio_label">'+wpiePluginSettings.wpieLocalizeText.andText+'</label></div><div class="wpie_rule_condition_wrapper wpie_rule_condition_or_wrapper"><input type="radio" class="wpie_radio wpie_rule_clause" name="wpie_content_data_rule_condition_'+r+'" id="wpie_content_data_rule_condition_or_'+r+'" value="or"/><label for="wpie_content_data_rule_condition_or_'+r+'" class="wpie_radio_label">'+wpiePluginSettings.wpieLocalizeText.orText+"</label></div>";jQuery(".wpie_filter_rule_table .wpie_filter_data_rule").last().find(".wpie_filter_data_rule_cond_data").html(n)}else jQuery(".wpie_apply_rule_wrapper").show();var o='<tr class="wpie_filter_data_rule" ><td class="wpie_filter_rule_list wpie_filter_data_rule_node" wpie_data="'+e+'">'+i+'</td><td class="wpie_filter_rule_list wpie_filter_data_rule_cond" wpie_data="'+t+'">'+p+'</td><td class="wpie_filter_rule_list wpie_filter_data_rule_val">"'+a+'"</td><td class="wpie_filter_rule_list wpie_filter_data_rule_cond_data"></td><td class="wpie_filter_rule_list wpie_filter_data_rule_action"><i class="fas fa-trash wpie_trash_general_btn_icon wpie_rule_trash_btn " aria-hidden="true"></i></td></tr>';return jQuery(".wpie_filter_rule_table").append(o),!0}function wpieXpathBuilder(e,i){var t="",p=wpiePluginSettings.importData.activeFile,a=wpiePluginSettings.importData[p].root;return i&&e.length>1&&(t+=" ("),e.each(function(){var p=jQuery(this).find(".wpie_filter_data_rule_node").attr("wpie_data"),r=jQuery(this).find(".wpie_filter_data_rule_cond").attr("wpie_data"),n=jQuery(this).find(".wpie_filter_data_rule_val").html();if(n=n.slice(1,-1),jQuery(this).find(".wpie_rule_clause:checked").length>0)var o=jQuery(this).find(".wpie_rule_clause:checked").val();else o=!1;var s=!1,l="",_="";switch(-1!=p.indexOf("@")&&(s=!0,l=p.split("@")[0],_=p.split("@")[1]),t+=s?l==a?"":l.replace(/->/g,"/"):p.replace(/->/g,"/"),s&&(t+="@"+_),r){case"equals":t+=' = "%s"';break;case"not_equals":t+=' != "%s"';break;case"greater":t+=' > "%s"';break;case"equals_or_greater":t+=' >= "%s"';break;case"less":t+=' < "%s"';break;case"equals_or_less":t+=' <= "%s"';break;case"contains":t+='[contains(.,"%s")]';break;case"not_contains":t+='[not(contains(.,"%s"))]';break;case"is_empty":t+="[not(string())]";break;case"is_not_empty":t+="[string()]"}t=t.replace("%s",n),o&&(t+=" "+o+" "),i&&e.length>1&&(t+=") ")}),t}function wpieAddSerialyzeLayout(e,i){if(e.closest(".wpie_cf_table").find(".wpie_cf_child_data").hide(),jQuery(".wpie-cf-activated").removeClass("wpie-cf-activated"),e.closest("tr").addClass("wpie-cf-activated"),e.closest("tr").find(".wpie_cf_child_data .wpie_cf_table").length>=1)!0===i&&e.closest("tr .wpie_item_cf_value_wrapper").children(".wpie_cf_child_data").show();else{var t=wpieRand(20);e.closest(".wpie_cf_table").find("select").chosen("destroy");var p=jQuery("<div>").append(e.closest(".wpie_cf_table").clone()).html(),a=e.closest("tr .wpie_item_cf_value_wrapper").children(".wpie_cf_child_data");a.html(p),!0===i&&a.show(),a.find("tbody tr:not(.wpie-cf-activated)").remove(),a.find("tbody tr").first().attr("wpie_row_id",t);var r=a.find(".wpie_item_cf_value").first().attr("name");r=wpieReplaceAll(r,"[value]","[values]"),a.find(".wpie_item_cf_name").first().attr("name",r+"["+t+"][name]").val(""),a.find(".wpie_item_cf_value").first().attr("name",r+"["+t+"][value]").val(""),a.find(".wpie_item_cf_option").first().attr("name",r+"["+t+"][option]").val("normal").trigger("change"),e.closest(".wpie_cf_table").find("select").chosen()}}function wpieRand(e){for(var i="",t="abcdefghijklmnopqrstuvwxyz0123456789",p=t.length,a=0;a<e;a++)i+=t.charAt(Math.floor(Math.random()*p));return i}function wpieAddNewCF(e){var i=e.children("tbody").children(".wpie_data_row").last(),t=i.attr("wpie_row_id"),p=wpieRand(20);i.find(".wpie_content_data_select").chosen("destroy");var a=jQuery("<div>").append(i.clone()).html();a=wpieReplaceAll(a,t,p),i.find(".wpie_content_data_select").chosen(),e.children("tbody").first().append(a);var r=e.children("tbody").children(".wpie_data_row").last();r.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_child_data").html("").hide(),r.children(".wpie_item_cf_option_wrapper").find(".wpie_content_data_select").val("normal").trigger("change").chosen(),r.children(".wpie_item_cf_name_wrapper").find(".wpie_item_cf_name").val(""),r.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_normal_data").find(".wpie_item_cf_value").val("")}function wpieEscapeRegExp(e){if(void 0!==e&&null!==typeof e)return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function wpieReplaceAll(e,i,t){return void 0!==e&&null!==typeof e?e.replace(new RegExp(wpieEscapeRegExp(i),"g"),t):e}function wpieAddNewSerializeCF(e){var i=e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_key").attr("name"),t=e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_value").attr("name"),p=parseInt(i.substring(i.lastIndexOf("[")+1,i.lastIndexOf("]"))),a="]["+(p+1)+"]",r="]["+p+"]";i=i.replace(r,a),t=t.replace(r,a);var n=e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").first().clone();e.find(".wpie_cf_serialized_option_container").append(n),e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_key").val("").attr("name",i),e.find(".wpie_cf_serialized_option_container .wpie_cf_serialized_option_wrapper").last().find(".wpie_item_cf_serialize_value").val("").attr("name",t)}function wpieUpdateXpath(e,i){wpieSetProcessLoader({wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),jQuery(".wpie_xpath").val(e);var t=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[t].xpath=e,wpiePluginSettings.importData[t].root=i,wpieGetFilteredRecords(0,1,e,i,!0)}function wpieValidateUpdateFields(){if(jQuery(".wpie_item_update_specific").is(":checked")){if(jQuery(".wpie_item_update_field:checked").length<1)return jQuery(".wpie_update_item_data_container").addClass("wpie_required"),!1}else if(jQuery(".wpie_item_update_product_price_stock").is(":checked")){var e=!1;if(jQuery(".is_update_item_product_price_data").is(":checked")&&(jQuery(".is_update_item_product_price_regular_price").is(":checked")||jQuery(".is_update_item_product_price_sale_price").is(":checked"))&&(e=!0),jQuery(".is_update_item_product_stock_data").is(":checked")&&(jQuery(".is_update_item_product_stock_stock").is(":checked")||jQuery(".is_update_item_product_stock_manage_stock").is(":checked")||jQuery(".is_update_item_product_stock_stock_status").is(":checked")||jQuery(".is_update_item_product_stock_low_stock_amount").is(":checked"))&&(e=!0),!1===e)return jQuery(".wpie_update_item_data_container").addClass("wpie_required"),!1}return jQuery(".wpie_update_item_data_container").removeClass("wpie_required"),!0}function wpieIsValidTime(){var e=wpiePluginSettings.wpiePluginData;if(""!==e){var i=JSON.parse(e);if(void 0!==i.home&&(i.home===wpiePluginSettings.wpieSiteUrl||wpiePluginSettings.wpieSiteUrl.lastIndexOf(i.home)==wpiePluginSettings.wpieSiteUrl.length-i.home.length))return!0}return!1}function wpieScrollTop(){jQuery("html, body").animate({scrollTop:0},300)}function wpieInitImport(e){wpieSetProcessLoader({wpieSaveSettings:wpiePluginSettings.wpieLocalizeText.wpieSaveSettingsText});var i=wpiePluginSettings.importData.activeFile,t=1;jQuery(".wpie_import_type.wpie_active").hasClass("wpie_update_item")&&(t=0);var p=wpiePluginSettings.wpieImportId,a=wpiePluginSettings.importData[i].xpath,r=wpiePluginSettings.importData[i].root,n=0;"bg"==e&&(n="1");var o=jQuery(".wpie_import_frm").serialize();jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:"action=wpie_import_update_data&wpie_import_id="+p+"&wpieSecurity="+wpiePluginSettings.wpieSecurity+"&bg="+n+"&xpath="+a+"&root="+r+"&is_new_items="+t+"&"+o,dataType:"json",async:!0,success:function(i){if("error"==i.status)return wpieSetErrorMsg(i.message),!1;if(wpieUpdateProcessLoader("wpieSaveSettings"),"import"==e)wpieResetImportProcess(),wpiePluginSettings.importData.processStatus="processing",jQuery(".wpie_import_step:visible").hide(),jQuery(".wpie_import_step7").show(),wpieScrollTop(),wpieImportData();else if("bg"==e){return new bootstrap.Modal(jQuery(".wpie_import_bg_set"),{backdrop:"static",keyboard:!1}).show(),!1}},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieResetImportProcess(){var e=wpiePluginSettings.importData.activeFile;jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText),jQuery(".wpie_import_filename").html(wpiePluginSettings.importData[e].fileName),jQuery(".wpie_import_filesize").html(wpiePluginSettings.importData[e].fileSize),jQuery(".wpie_import_process_per").css("width","auto").text("0%"),jQuery(".wpie_import_created").text("0"),jQuery(".wpie_import_updated").text("0"),jQuery(".wpie_import_skipped").text("0"),jQuery(".wpie_import_processing_total").text("0"),jQuery(".wpie_import_time_elapsed").text("00:00:00"),jQuery(".wpie_import_total").text(wpiePluginSettings.importData[e].count),void 0!==wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),wpiePluginSettings.importData.importIntervalSec=0,wpiePluginSettings.importData.importInterval=setInterval(function(){jQuery(".wpie_import_time_elapsed").html(wpieElapsedTimeString(wpiePluginSettings.importData.importIntervalSec++))},1e3)}function wpieElapsedTimeString(e){var i=Math.floor(e/3600);e%=3600;var t=Math.floor(e/60);e%=60;var p=Math.floor(e);return(i=wpiePrettyTimeString(i))+":"+(t=wpiePrettyTimeString(t))+":"+(p=wpiePrettyTimeString(p))}function wpiePrettyTimeString(e){return(e<10?"0":"")+e}function wpieObjectifyForm(e,i){var t={};return jQuery.each(e,function(e,i){t[i.name]=i.value}),jQuery.each(i,function(e,i){t[e]=i}),t}function wpieImportData(){if("processing"==wpiePluginSettings.importData.processStatus){wpiePluginSettings.importData.processing=!0;var e={action:"wpie_import_data",wpie_import_id:wpiePluginSettings.wpieImportId,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:e,dataType:"json",async:!0,success:function(e){if("error"==e.status)return wpieSetErrorMsg(e.message),!1;if(void 0!==e.imported&&null!==e.imported){jQuery(".wpie_import_created").text(parseInt(e.created)),jQuery(".wpie_import_updated").text(parseInt(e.updated)),jQuery(".wpie_import_skipped").text(parseInt(e.skipped)),jQuery(".wpie_import_processing_total").text(parseInt(e.imported));var i=wpiePluginSettings.importData.activeFile,t=parseInt(100*parseInt(e.imported)/parseInt(wpiePluginSettings.importData[i].count));t>100&&(t=100),jQuery(".wpie_import_process_per").css("width",t+"%").html(t+"%"),jQuery(".wpie_log_container").append(e.import_log),wpiePluginSettings.importData[i].count>parseInt(e.imported)?wpieImportData():wpieCompleteImport()}},error:function(e,i){wpiePluginSettings.importData.processing=!1,wpieHandleAjaxError(e,i)}})}else"pause"==wpiePluginSettings.importData.processStatus?(void 0!==wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),wpieUpdateProcessLoader("wpieProcessingNotice"),jQuery(".wpie_import_action_resume_btn").show(),jQuery(".wpie_import_action_pause_btn").hide(),wpiePluginSettings.importData.processing=!1):"stop"==wpiePluginSettings.importData.processStatus?(void 0!==wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),jQuery(".wpie_import_action_container").hide(),wpieUpdateProcessLoader("wpieProcessingNotice"),wpiePluginSettings.importData.processing=!1):"bg"==wpiePluginSettings.importData.processStatus&&(void 0!==wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),jQuery(".wpie_import_action_container").hide(),wpieUpdateProcessLoader("wpieProcessingNotice"),wpiePluginSettings.importData.processing=!1,wpieChangeStatus("bg"))}function wpieCompleteImport(){jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportCompleteText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportCompleteNoticeText),void 0!==wpiePluginSettings.importData.importInterval&&clearInterval(wpiePluginSettings.importData.importInterval),jQuery(".wpie_import_action_container").hide(),jQuery(".wpie_import_processing_wrapper").hide(),jQuery(".wpie_import_process_complete_wrapper").show()}function wpieRefreshTemplateList(e){var i=jQuery(".wpie_template_list").chosen("destroy").html("");i.append(new Option(wpiePluginSettings.wpieLocalizeText.selectTemplateText,"")),jQuery.isEmptyObject(e)||jQuery.each(e,function(e,t){i.append(new Option(t.name,t.id))}),i.chosen()}function wpieImportGetTemplates(){var e=jQuery(".wpie_import_type_select").val();if(void 0===wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]=[]),void 0!==wpiePluginSettings.importData[e].templates)wpieRefreshTemplateList(wpiePluginSettings.importData[e].templates),wpieUpdateProcessLoader("wpieGetTemplates");else{var i={action:"wpie_import_get_templates",wpie_import_type:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){if("error"==i.status)return wpieSetErrorMsg(i.message),!1;wpieUpdateProcessLoader("wpieGetTemplates"),void 0!==i.templates&&(wpiePluginSettings.importData[e].templates=i.templates,wpieRefreshTemplateList(i.templates))},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieRefreshSettingList(e){var i=jQuery(".wpie_setting_list").chosen("destroy").html("");i.append(new Option(wpiePluginSettings.wpieLocalizeText.selectTemplateText,"")),jQuery.isEmptyObject(e)||jQuery.each(e,function(e,t){i.append(new Option(t.name,t.id))}),i.chosen()}function wpieImportGetSettings(){var e=jQuery(".wpie_import_type_select").val();if(void 0===wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]=[]),void 0!==wpiePluginSettings.importData[e].settings)wpieRefreshSettingList(wpiePluginSettings.importData[e].settings),wpieUpdateProcessLoader("wpieGetSettingsList");else{var i={action:"wpie_import_get_settings",type:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:i,dataType:"json",async:!0,success:function(i){if("error"==i.status)return wpieSetErrorMsg(i.message),!1;wpieUpdateProcessLoader("wpieGetSettingsList"),void 0!==i.templates&&(wpiePluginSettings.importData[e].settings=i.templates,wpieRefreshSettingList(i.templates))},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieSaveTemplate(e){var i=jQuery(".wpie_template_name").val();if(""==i&&0===e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.enterSettingNameText),!1;wpieSetProcessLoader({wpieSaveTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieSaveSettingsText});var t=jQuery(".wpie_import_frm").serialize();jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:"action=wpie_import_save_templates&wpieSecurity="+wpiePluginSettings.wpieSecurity+"&template_id="+e+"&"+t,dataType:"json",async:!0,success:function(t){if("error"==t.status)return wpieSetErrorMsg(t.message),wpieUpdateProcessLoader("wpieSaveTemplatesText"),!1;0===e?(jQuery(".wpie_template_list").append(new Option(i,t.template_id)).val("").trigger("chosen:updated"),jQuery(".wpie_template_name").val("")):void 0!==wpiePluginSettings.importData.templateData&&void 0!==wpiePluginSettings.importData.templateData[e]&&delete wpiePluginSettings.importData.templateData[e],wpieSetSuccessMsg(t.message),wpieUpdateProcessLoader("wpieSaveTemplatesText")},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieImportGetTemplateData(e){if(void 0===wpiePluginSettings.importData.templateData&&(wpiePluginSettings.importData.templateData=[]),void 0!==wpiePluginSettings.importData.templateData[e])wpieUpdateProcessLoader("wpieGetTemplatesText"),wpieSetTemplate(wpiePluginSettings.importData.templateData[e]);else{var i={action:"wpie_import_get_template_data",wpie_template_id:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){if("error"==i.status)return wpieSetErrorMsg(i.message),!1;wpieUpdateProcessLoader("wpieGetTemplatesText"),void 0!==i.template_data&&(wpiePluginSettings.importData.templateData[e]=i.template_data,wpieSetTemplate(i.template_data)),wpieUpdateProcessLoader("wpieChangeTemplates")},error:function(e,i){wpieHandleAjaxError(e,i)}})}}function wpieExcludeCF(){jQuery(".wpie_exclude_cf_list").length&&jQuery(".wpie_exclude_cf_list").remove();var e=jQuery("<input>").attr("type","hidden").addClass("wpie_exclude_cf_list").appendTo(".wpie_content_data");e.val("_thumbnail_id||_price||_variation_description").trigger("add_exclude_cf_list");var i=e.val();return void 0===i||""===i.trim()?[]:(i=i.trim()).replace(/^\|+|\|+$/g,"").split("||")}function wpieSetCFRec(e,i){if(!jQuery.isEmptyObject(e)){var t=0,p=wpieExcludeCF();jQuery.each(e,function(e,a){var r="";if(void 0!==a.name&&(r=a.name),""===r.trim())return!0;if(-1!==jQuery.inArray(r,p))return!0;t>0&&wpieAddNewCF(i);var n=i.children("tbody").children(".wpie_data_row").last();n.children(".wpie_item_cf_name_wrapper").find(".wpie_item_cf_name").val(r);var o="";void 0!==a.value&&(o=a.value),n.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_normal_data").find(".wpie_item_cf_value").val(o);var s="";if(void 0!==a.option&&(s=a.option),n.children(".wpie_item_cf_option_wrapper").find(".wpie_item_cf_option").val(s).trigger("chosen:updated").trigger("change"),"serialized"===s&&void 0!==a.values){wpieAddSerialyzeLayout(n.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_serialized_data_btn"),!1);var l=n.children(".wpie_item_cf_value_wrapper").children(".wpie_cf_child_data").children(".wpie_cf_table");wpieSetCFRec(a.values,l)}t++})}}function wpieSetCF(e){if(jQuery(".wpie_cf_option_outer_wrapper .wpie_cf_option_wrapper:not(:first-child)").remove(),!jQuery.isEmptyObject(e))if(void 0!==e.wpie_item_cf&&null!==typeof e.wpie_item_cf){var i=jQuery(".wpie_cf_table");wpieSetCFRec(e.wpie_item_cf,i)}else if(void 0!==e.wpie_item_cf_name){var t=[];void 0!==e.wpie_item_cf_value&&(t=e.wpie_item_cf_value);var p=[];void 0!==e.wpie_item_cf_option&&(p=e.wpie_item_cf_option);var a=[];void 0!==e.wpie_item_cf_serialize_key&&(a=e.wpie_item_cf_serialize_key);var r=[];void 0!==e.wpie_item_cf_serialize_value&&(r=e.wpie_item_cf_serialize_value);var n={};if(jQuery.each(e.wpie_item_cf_name,function(e,i){var o=wpieRand(20);n[o]={},n[o].name=i;var s="";void 0!==t[e]&&(s=t[e]),n[o].value=s;var l="normal";if("undefined"!=p[e]&&"serialized"===p[e]&&(l=p[e]),n[o].option=l,"serialized"===l&&void 0!==a[e]){var _=[];n[o].values={},void 0!==r[e]&&(_=r[e]),jQuery.each(a[e],function(e,i){var t="";"undefined"!=_[e]&&(t=_[e]);var p=wpieRand(20);n[o].values[p]={},n[o].values[p].name=i,n[o].values[p].value=t,n[o].values[p].option="normal"})}}),!jQuery.isEmptyObject(n)){i=jQuery(".wpie_cf_table");wpieSetCFRec(n,i)}}}function wpieChangeStatus(e){wpieSetProcessLoader({wpieSetBGProcessText:wpiePluginSettings.wpieLocalizeText.wpieSetBGProcessText});var i={action:"wpie_import_update_status",wpie_import_id:wpiePluginSettings.wpieImportId,status:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){if("error"==i.status)return wpieSetErrorMsg(i.message),!1;wpieUpdateProcessLoader("wpieSetBGProcessText"),"bg"==e&&wpieSetSuccessMsg(wpiePluginSettings.wpieLocalizeText.wpieBgProcessingText)},error:function(e,i){wpieHandleAjaxError(e,i)}})}function wpieIsData(){var e=wpiePluginSettings.wpiePluginData;if(""!==e){var i=JSON.parse(e);if(void 0!==i.author&&"vjinfotech"===i.author)return!0}return!1}function wpieSetTaxonomy(e){if(wpieResetTaxonomy(),!jQuery.isEmptyObject(e)&&void 0!==e.wpie_item_set_taxonomy){var i=[];void 0!==e.wpie_item_taxonomy&&(i=e.wpie_item_taxonomy);var t=[];void 0!==e.wpie_item_taxonomy_delim&&(t=e.wpie_item_taxonomy_delim);var p=[];void 0!==e.wpie_item_taxonomy_hierarchical_delim&&(p=e.wpie_item_taxonomy_hierarchical_delim);var a=[];void 0!==e.wpie_item_taxonomy_child_only&&(a=e.wpie_item_taxonomy_child_only),jQuery.each(e.wpie_item_set_taxonomy,function(e,r){if(1!=r)return!0;if(jQuery(".wpie_item_set_taxonomy_"+e).prop("checked",!0),void 0!==i[e]){var n=i[e];jQuery(".wpie_item_taxonomy_"+e).val(n)}void 0!==t[e]&&jQuery(".wpie_item_taxonomy_delim_"+e).val(t[e]),void 0!==p[e]&&jQuery(".wpie_item_taxonomy_hierarchical_delim_"+e).val(p[e]),void 0!==a[e]&&1==a[e]?jQuery(".wpie_item_taxonomy_child_only_"+e).prop("checked",!0):jQuery(".wpie_item_taxonomy_child_only_"+e).prop("checked",!1)})}}function wpieResetTaxonomy(){jQuery(".wpie_item_set_taxonomy").prop("checked",!1),jQuery(".wpie_item_taxonomy").val(""),jQuery(".wpie_item_taxonomy_delim").val(","),jQuery(".wpie_item_taxonomy_hierarchical_delim").val(">"),jQuery(".wpie_taxonomy_hierarchical_child_only").prop("checked",!1)}jQuery(document).ready(function(e){if(null==wpiePluginSettings&&(wpiePluginSettings=[]),void 0===wpiePluginSettings.wpieImportId&&(wpiePluginSettings.wpieImportId=0),void 0===wpiePluginSettings.importData&&(wpiePluginSettings.importData=[]),wpiePluginSettings.isModalHide=!0,"function"==typeof jQuery.fn.chosen&&jQuery(".wpie_content_data_select").length&&jQuery(".wpie_content_data_select").chosen(),jQuery("#wpie_upload_container").length&&wpie_set_local_file_uploader(),jQuery(".wpie_import_ref_id").length){var i=jQuery(".wpie_import_ref_id").val();if(""===i){var t=jQuery(".wpie_error_msg").attr("msg");""!==t&&wpieSetErrorMsg(t)}else{wpieProcessingReimport(jQuery(".wpie_import_id").val(),jQuery(".wpie_import_nonce").val(),i)}}wpieSetToolTip(),"1"!==wpiePluginSettings.isUploadDirWritable&&wpieSetStrictErrorMsg(wpiePluginSettings.wpieLocalizeText.uploadDirWritableError)}),jQuery(document).on("wpieValidUploadFile",function(e){var i=jQuery(".wpie_import_ref_id").val();wpiePluginSettings.getImportTemplate=!1,""!==i&&(wpiePluginSettings.getImportTemplate=!0)}),jQuery(document).on("wpieAfterChangeConfig",function(e){if(void 0!==wpiePluginSettings.reImportData&&void 0!==wpiePluginSettings.reImportData.status&&"completed"==wpiePluginSettings.reImportData.status)return!0;""!==jQuery(".wpie_import_ref_id").val()&&void 0!==wpiePluginSettings.getImportTemplate&&!0===wpiePluginSettings.getImportTemplate&&(wpiePluginSettings.getImportTemplate=!1,wpieSetProcessLoader({wpieChangeTemplates:wpiePluginSettings.wpieLocalizeText.wpieChangeTemplatesText,wpieGetTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieGetTemplatesText}),wpieImportGetTemplateData(jQuery(".wpie_import_id").val()),jQuery(".wpie_import_step5_btn").trigger("click"),jQuery(".wpie_field_mapping_data_container").show())}),jQuery(document).on("click",".wpie_upload_menu",function(){if(!jQuery(this).hasClass("wpie_active")){jQuery(".wpie_upload_menu.wpie_active").removeClass("wpie_active"),jQuery(this).addClass("wpie_active"),jQuery(".wpie_upload_section_wrapper:visible").hide();var e=jQuery(this).attr("show_container");jQuery(".wpie_file_upload_method").val(e),jQuery("."+e).show()}}),jQuery(document).on("show.bs.modal",".modal",function(e){var i=999999+10*jQuery(".modal:visible").length;jQuery(this).css("z-index",i),setTimeout(function(){jQuery(".modal-backdrop").not(".modal-stack").css("z-index",i-1).addClass("modal-stack")},0)}),jQuery(document).on("change",".wpie_taxonomies_types_select",function(){wpieRefreshImport()}),jQuery(document).on("change",".wpie_import_type_select",function(){wpieRefreshImport()}),jQuery(document).on("change",".wpie_sheet_list",function(){wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[e].activeSheet=jQuery(this).val(),wpiePluginSettings.importData.changeExcelSheet=!0,wpieValidateUploadedFile(!0,",")}),jQuery(document).on("change",".wpie_text_format_list",function(){wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[e].activeFormat=jQuery(this).val(),jQuery(".wpie_element_tag_wrapper").html(""),wpiePluginSettings.importData[e].node_list=[],wpieValidateUploadedFile(!0,",")}),jQuery(document).on("change",".wpie_upload_file_list",function(){wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetConfig:wpiePluginSettings.wpieLocalizeText.wpieGetConfigText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=jQuery(this).val();wpiePluginSettings.importData.activeFile=e,void 0===wpiePluginSettings.importData[e]&&(wpiePluginSettings.importData[e]={}),wpiePluginSettings.importData[e].activeSheet="",wpiePluginSettings.importData[e].activeFormat=jQuery(this).closest(".wpie_upload_section_wrapper").find(".wpie_text_format_list:checked").val(),jQuery(".wpie_text_format_list_wrapper").hide(),jQuery(".wpie_excel_sheets_wrapper").hide(),jQuery(".wpie_element_tag_wrapper").html(""),wpiePluginSettings.importData[e].node_list=[],wpieValidateUploadedFile(!0,",")}),jQuery(document).on("click",".wpie_layout_tag_wrapper",function(){if(!jQuery(this).hasClass("wpie_active")){wpieSetProcessLoader({wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),jQuery(".wpie_element_nav_element").val(1),jQuery(".wpie_layout_tag_wrapper.wpie_active").removeClass("wpie_active"),jQuery(this).addClass("wpie_active");var e=jQuery(this).find(".wpie_layout_tag_name").html(),i="/"+e;jQuery(".wpie_xpath").val(i),wpieGetFilteredRecords(0,1,i,e,!0)}}),jQuery(document).on("click",".wpie_data_element_nav_next",function(){parseInt(jQuery(".wpie_element_nav_element").val())<parseInt(jQuery(".wpie_data_element_action_nav_total").html())&&(wpieSetProcessLoader({wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),wpieGotoRecord(parseInt(jQuery(".wpie_element_nav_element").val())+1))}),jQuery(document).on("click",".wpie_data_element_nav_prev",function(){if(1==parseInt(jQuery(".wpie_element_nav_element").val()))return!1;wpieSetProcessLoader({wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),wpieGotoRecord(parseInt(jQuery(".wpie_element_nav_element").val())-1)}),jQuery(document).on("blur",".wpie_element_nav_element",function(){wpieSetProcessLoader({wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText});var e=wpiePluginSettings.importData.activeFile,i=wpiePluginSettings.importData[e].count,t=parseInt(jQuery(this).val());(i<t||t<1)&&(t=1),wpieGotoRecord(t)}),jQuery(document).on("click",".wpie_tag.wpie_opening",function(){return jQuery(this).find(".wpie_layout_tag_icon").length&&(jQuery(this).hasClass("wpie_collapsed")?jQuery(this).removeClass("wpie_collapsed"):jQuery(this).addClass("wpie_collapsed")),!1}),jQuery(document).on("click",".wpie_save_add_rule_btn",function(){wpieShowLoader(),wpieAddNewImportRule()&&(jQuery(".wpie_element_list").val("").trigger("chosen:updated"),jQuery(".wpie_element_rule").val("").trigger("chosen:updated"),jQuery(".wpie_element_value").val("")),wpieHideLoader()}),jQuery(document).on("change",".wpie_import_file_processing",function(){"chunk"==jQuery(this).val()?jQuery(".wpie_iteration_process_wrapper").slideDown():jQuery(".wpie_iteration_process_wrapper").slideUp()}),jQuery(document).on("change",".wpie_item_cf_option",function(){"serialized"==jQuery(this).val()?(jQuery(this).closest("tr").find(".wpie_cf_serialized_data_btn").show(),jQuery(this).closest("tr").find(".wpie_cf_normal_data").hide()):(jQuery(this).closest("tr").find(".wpie_cf_serialized_data_btn").hide(),jQuery(this).closest("tr").find(".wpie_cf_normal_data").show())}),jQuery(document).on("click",".wpie_cf_serialized_data_btn",function(){wpieAddSerialyzeLayout(jQuery(this),!0)}),jQuery(document).on("click",".wpie_cf_serialized_close_btn",function(){jQuery(".wpie_cf_serialized_data").hide()}),jQuery(document).on("click",".wpie_cf_add_btn",function(){wpieAddNewCF(jQuery(this).closest("table"))}),jQuery(document).on("click",".wpie_cf_close_btn",function(){jQuery(this).closest(".wpie_cf_child_data").hide()}),jQuery(document).on("click",".wpie_cf_serialized_add_btn",function(){wpieAddNewSerializeCF(jQuery(this).closest(".wpie_cf_serialized_wrapper"))}),jQuery(document).on("click",".wpie_remove_cf_btn",function(){if(jQuery(this).closest("tbody").children("tr").length<=1){var e=jQuery(this).closest("table");jQuery(this).closest("tr").find(".wpie_cf_child_data").hide(),wpieAddNewCF(e)}jQuery(this).closest("tr").remove()}),jQuery(document).on("click",".wpie_trash_cf_serialized_btn_wrapper",function(){var e=jQuery(this).closest(".wpie_cf_serialized_wrapper");e.find(".wpie_cf_serialized_option_wrapper").length<=1&&wpieAddNewSerializeCF(e),jQuery(this).closest(".wpie_cf_serialized_option_wrapper").remove()}),jQuery(document).on("click",".wpie_rule_trash_btn",function(){jQuery(this).closest("tr").remove(),jQuery(".wpie_filter_data_rule").length>=1?jQuery(".wpie_filter_data_rule").last().find(".wpie_filter_data_rule_cond_data").html(""):jQuery(".wpie_apply_rule_wrapper").hide()}),jQuery(document).on("click",".wpie_apply_rule_btn",function(){var e=wpiePluginSettings.importData.activeFile,i=jQuery(".wpie_xpath").val(),t="[";t+=wpieXpathBuilder(jQuery(".wpie_filter_data_rule"),0),t+="]",wpieUpdateXpath(i=i.split("[")[0]+t,wpiePluginSettings.importData[e].root)}),jQuery(document).on("blur",".wpie_xpath",function(){var e=jQuery(this).val(),i=wpiePluginSettings.importData.activeFile;wpiePluginSettings.importData[i].xpath!=e&&(wpieSetProcessLoader({wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),wpiePluginSettings.importData[i].xpath=e,wpieGetFilteredRecords(0,1,wpiePluginSettings.importData[i].xpath,wpiePluginSettings.importData[i].root,!0))}),jQuery.fn.wpieInsertAtCaret=function(){if(!this.length)return this;var e,i=0,t=jQuery(".wpie_drag_element");t.length||(t=jQuery('<input type="text" class="wpie_drag_element" readonly="readonly" />')),t.appendTo(document.body).mousedown(function(e){if(!i){var p=e.pageX-t.offset().left,a=e.pageY-t.offset().top;p<4||a<4||t.width()-p<0||t.height()-a<0||(t.css("opacity",1),t.select(),i=!0,setTimeout(function(){i=!1},400))}}).mouseup(function(){t.css("opacity",0).css("width",e),t.blur()}),jQuery(document).mousemove(function(){0!=parseInt(t.css("opacity"))&&(setTimeout(function(){t.css("opacity",0)},50),setTimeout(function(){t.css("width",e)},500))}),this.each(function(){var i=jQuery(this),p="{"+i.attr("data_value")+"}";i.mouseover(function(a){t.val(p).offset({left:i.offset().left-2,top:i.offset().top-2}).width(e=i.width()+8).height(i.height())})}).eq(0).mouseover()},jQuery(document).on("click",".wpie_import_step_btn",function(){if(jQuery(this).hasClass("wpie_import_step3_btn")&&!1===wpieIsValidTime()||jQuery(this).hasClass("wpie_import_step6_btn"))return!1;jQuery(".wpie_import_step").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),wpieScrollTop()}),jQuery(document).on("click",".wpie_import_step3_back",function(){jQuery(".wpie_field_mapping_data_container").hide()}),jQuery(document).on("click",".wpie_import_step3_btn,.wpie_import_step5_back",function(){jQuery(".wpie_field_mapping_data_container").show()}),jQuery(document).on("click",".wpie_import_step6_btn",function(){if(!wpieValidateUpdateFields())return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.chooseDataUpdate),!1;wpieShowLoader();var e=wpiePluginSettings.importData.activeFile;jQuery(".wpie_import_total_count").html(wpiePluginSettings.importData[e].count),jQuery(".wpie_import_filename").html(wpiePluginSettings.importData[e].fileName),jQuery(".wpie_import_filesize").html(wpiePluginSettings.importData[e].fileSize),jQuery(".wpie_import_per_iteration").html(jQuery(".wpie_records_per_request").val()),jQuery(".wpie_import_update_criteria").html(jQuery(".wpie_existing_item_search_logic:checked").val());var i=jQuery(".wpie_handle_items:checked").val();jQuery(".wpie_import_item_selection_text").hide(),"existing"===i?(jQuery(".wpie_existing_item_update").show(),jQuery(".wpie_new_item_skip").show()):"new"===i?(jQuery(".wpie_existing_item_skip").show(),jQuery(".wpie_new_item_create").show()):(jQuery(".wpie_existing_item_update").show(),jQuery(".wpie_new_item_create").show()),jQuery(".wpie_update_item_data_container").removeClass("wpie_required"),jQuery(".wpie_import_step").hide(),jQuery(".wpie_field_mapping_data_container").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),wpieHideLoader(),wpieScrollTop()}),jQuery(document).on("change",".wpie_item_update_specific",function(){wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_item_update_all",function(){wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_item_update_field",function(){wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_item_update_price_stock_item,.wpie_item_update_product_price_stock",function(){wpieValidateUpdateFields()}),jQuery(document).on("click",".wpie_import_step3_btn",function(){if(!wpieValidateProcess())return!1;var e=wpiePluginSettings.importData.activeFile;if(0==wpiePluginSettings.importData[e].count)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieNoRecordsFoundText),!1;jQuery(".wpie_import_step").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),wpieScrollTop()}),jQuery(document).on("click",".wpie_import_step1_btn",function(){var e=!1,i=wpiePluginSettings.wpieLocalizeText.wpieChooseValidFileText,t=jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").val();if(jQuery(".wpie_upload_section_wrapper:visible .wpie_upload_file_list:checked").length?(wpiePluginSettings.importData.activeFile=t,void 0===wpiePluginSettings.importData[t]?e=!0:void 0===wpiePluginSettings.importData[t].fileName?e=!0:0==wpiePluginSettings.importData[t].count&&(e=!0,i=wpiePluginSettings.wpieLocalizeText.wpieNoRecordsText)):e=!0,e)return wpieSetErrorMsg(i),!1;jQuery(".wpie_import_step").hide(),jQuery("."+jQuery(this).attr("wpie_show")).show(),wpieScrollTop()}),jQuery(document).on("scroll",function(){if(jQuery(".wpie_field_mapping_data_wrapper").is(":visible")){var e=jQuery(".wpie_field_mapping_data_container").offset();if(jQuery(document).scrollTop()>parseInt(e.top-65)){var i=jQuery(".wpie_field_mapping_data_container").css("width");jQuery(".wpie_field_mapping_data_wrapper").css({width:i,top:"60px",position:"fixed"}),jQuery(".wpie_field_mapping_data_wrapper").find(".wpie_data_fields_container").css({"max-height":jQuery(window).height()-160+"px"})}else{i=jQuery(".wpie_field_mapping_data_container").css("width");jQuery(".wpie_field_mapping_data_wrapper").css({width:"",top:"",position:""}),jQuery(".wpie_field_mapping_data_wrapper").find(".wpie_data_fields_container").css({"max-height":""})}}}),jQuery(document).on("click",".wpie_import_btn",function(){if(!1===wpieIsData())return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieInvalidLicense),!1;wpieInitImport("import")}),jQuery(document).on("click",".wpie_import_action_pause_btn",function(){(jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportPausedText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportPartiallyText),wpiePluginSettings.importData.processStatus="pause",1==wpiePluginSettings.importData.processing)?wpieSetProcessLoader({wpieProcessingNotice:wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText}):(jQuery(".wpie_import_action_resume_btn").show(),jQuery(".wpie_import_action_pause_btn").hide())}),jQuery(document).on("click",".wpie_import_action_stop_btn",function(){(wpiePluginSettings.importData.processStatus="stop",jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportStoppedText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportPartiallyText),1==wpiePluginSettings.importData.processing)?wpieSetProcessLoader({wpieProcessingNotice:wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText}):jQuery(".wpie_import_action_container").hide()}),jQuery(document).on("click",".wpie_import_action_resume_btn",function(){wpiePluginSettings.importData.processStatus="processing",jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText),wpiePluginSettings.importData.importInterval=setInterval(function(){jQuery(".wpie_import_time_elapsed").html(wpieElapsedTimeString(wpiePluginSettings.importData.importIntervalSec++))},1e3),jQuery(this).hide(),jQuery(".wpie_import_action_pause_btn").show(),wpieImportData()}),jQuery(document).on("click",".wpie_field_mapping_container_title",function(){jQuery(this).hasClass("wpie_active")?jQuery(this).removeClass("wpie_active"):jQuery(this).addClass("wpie_active"),jQuery(this).parent().find(".wpie_field_mapping_container_data").slideToggle()}),jQuery(document).on("click",".wpie_save_template_btn",function(){wpieSaveTemplate(0)}),jQuery(document).on("click",".wpie_update_template_btn",function(){var e=jQuery(".wpie_template_list").val();if(""==e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.selectSettingText),!1;wpieSaveTemplate(e)}),jQuery(document).on("click",".wpie_update_item_all_action",function(){jQuery(".wpie_item_update_field").length==jQuery(".wpie_item_update_field:checked").length?jQuery(".wpie_item_update_field").prop("checked",!1):jQuery(".wpie_item_update_field").prop("checked",!0),wpieValidateUpdateFields()}),jQuery(document).on("change",".wpie_template_list",function(){if(""!=jQuery(this).val()){var e={wpieChangeTemplates:wpiePluginSettings.wpieLocalizeText.wpieUpdateSettingsText,wpieGetTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieGetSettingsText};jQuery(".wpie_update_template_btn_wrapper").show(),jQuery(".wpie_setting_list").val("").trigger("chosen:updated"),wpieSetProcessLoader(e),wpieImportGetTemplateData(jQuery(this).val())}else jQuery(".wpie_update_template_btn_wrapper").hide()}),jQuery(document).on("change",".wpie_setting_list",function(){if(""!=jQuery(this).val()){var e={wpieChangeTemplates:wpiePluginSettings.wpieLocalizeText.wpieUpdateSettingsText,wpieGetTemplatesText:wpiePluginSettings.wpieLocalizeText.wpieGetSettingsText};jQuery(".wpie_update_template_btn_wrapper").hide(),jQuery(".wpie_template_list").val("").trigger("chosen:updated"),wpieSetProcessLoader(e),wpieImportGetTemplateData(jQuery(this).val())}}),jQuery(document).on("click",".wpie_file_option_btn",function(){var e=jQuery(".wpie_csv_delimiter").val();if(""==e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.enterCsvDelimiterText),!1;wpieSetProcessLoader({wpieValidateUpload:wpiePluginSettings.wpieLocalizeText.wpieParingUploadFileText,wpieGetFields:wpiePluginSettings.wpieLocalizeText.wpieGetFieldsText,wpieGetRecords:wpiePluginSettings.wpieLocalizeText.wpieGetRecordsText}),wpieValidateUploadedFile(!0,e)}),jQuery(document).on("change",".wpie_item_image_option",function(){"media_library"==jQuery(this).val()?jQuery(".wpie_image_media_option_data").slideUp():jQuery(".wpie_image_media_option_data").slideDown()}),jQuery(document).on("click",".wpie_import_step5_btn",function(){jQuery(".wpie_update_item_data_container").removeClass("wpie_required")}),jQuery(document).on("click",".wpie_existing_file_btn",function(){var e=jQuery(".wpie_upload_existing_file").val();if(""==e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieChooseValidFileText),!1;wpieSetProcessLoader({wpieSetExistingFileText:wpiePluginSettings.wpieLocalizeText.wpieSetExistingFileText});var i={action:"wpie_import_set_existing_file",wpie_import_id:wpiePluginSettings.wpieImportId,file_name:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"GET",data:i,dataType:"json",async:!0,success:function(i){if(wpieUpdateProcessLoader("wpieSetExistingFileText"),"error"==i.status)return wpieSetErrorMsg(i.message),!1;jQuery(".wpie_final_existing_file").val(e),wpieSetFileData(i)},error:function(e,i){wpieHandleAjaxError(e,i)}})}),jQuery(document).on("click",".wpie_pre_import_btn .wpie_import_bg_process_btn",function(){wpieInitImport("bg")}),jQuery(document).on("click",".wpie_import_processing_btn .wpie_import_bg_process_btn",function(){(wpiePluginSettings.importData.processStatus="bg",jQuery(".wpie_import_process_text_header").text(wpiePluginSettings.wpieLocalizeText.wpieImportBGText),jQuery(".wpie_import_process_text_notice").text(wpiePluginSettings.wpieLocalizeText.wpieImportBGNoticeText),1==wpiePluginSettings.importData.processing)?wpieSetProcessLoader({wpieProcessingNotice:wpiePluginSettings.wpieLocalizeText.wpieImportProcessingNoticeText}):(jQuery(".wpie_import_action_container").hide(),wpieChangeStatus("bg"))}),jQuery(document).on("click",".wpie_save_scheduled_btn",function(){wpieSetProcessLoader({wpieSetScheduleExport:wpiePluginSettings.wpieLocalizeText.wpieSetScheduleExportText});var e=wpiePluginSettings.importData.activeFile,i=1;jQuery(".wpie_import_type.wpie_active").hasClass("wpie_update_item")&&(i=0);var t=wpiePluginSettings.wpieImportId,p=wpiePluginSettings.importData[e].xpath,a=wpiePluginSettings.importData[e].root,r=jQuery(".wpie_import_frm").serialize();jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:"action=wpie_save_import_scheduled&wpie_import_id="+t+"&wpieSecurity="+wpiePluginSettings.wpieSecurity+"&bg=0&xpath="+p+"&root="+a+"&is_new_items="+i+"&"+r,dataType:"json",async:!0,success:function(e){return"error"==e.status?(wpieSetErrorMsg(e.message),!1):(wpieUpdateProcessLoader("wpieSetScheduleExport"),new bootstrap.Modal(jQuery(".wpie_save_schedule_status_notify"),{backdrop:"static",keyboard:!1}).show(),!1)},error:function(e,i){wpieHandleAjaxError(e,i)}})}),jQuery(document).on("click",".wpie_url_upload_btn",function(){var e=jQuery(".wpie_file_upload_url").val();if(""==e)return wpieSetErrorMsg(wpiePluginSettings.wpieLocalizeText.wpieInvalidURLText),!1;wpieSetProcessLoader({wpieUploadFromURLText:wpiePluginSettings.wpieLocalizeText.wpieUploadFromURLText});var i={action:"wpie_import_upload_file_from_url",wpie_import_id:wpiePluginSettings.wpieImportId,file_url:e,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:i,dataType:"json",async:!0,success:function(i){if(wpieUpdateProcessLoader("wpieUploadFromURLText"),"error"==i.status)return wpieSetErrorMsg(i.message),!1;jQuery(".wpie_upload_final_file_url").val(e),wpieSetFileData(i)},error:function(e,i){wpieUpdateProcessLoader("wpieUploadFromURLText"),wpieHandleAjaxError(e,i)}})}),jQuery(document).on("change",".wpie_item_dropdown_as_specified",function(){"as_specified"==jQuery(this).val()?jQuery(".wpie_item_as_specified_wrapper").show():jQuery(".wpie_item_as_specified_wrapper").hide()}),jQuery(document).on("click",".wpie_ftp_upload_btn",function(){var e=jQuery(".wpie_ftp_hostname").val(),i=jQuery(".wpie_ftp_host_port").val(),t=jQuery(".wpie_ftp_host_username").val(),p=jQuery(".wpie_ftp_host_password").val(),a=jQuery(".wpie_ftp_host_path").val(),r=jQuery(".wpie_connection_type:checked").val(),n="";if(""===e?n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostNameText:""==t?n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostUsernameText:""==p?n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostPasswordText:""==a&&(n=wpiePluginSettings.wpieLocalizeText.wpieInvalidHostPathText),""!==n)return wpieSetErrorMsg(n),!1;var o={host:e,port:i,username:t,password:p,path:a,connection_type:r};jQuery(".wpie_ftp_details").val(JSON.stringify(o)),wpieSetProcessLoader({wpieUploadFromFTPText:wpiePluginSettings.wpieLocalizeText.wpieUploadFromFTPText});var s={action:"wpie_import_upload_file_from_ftp",wpie_import_id:wpiePluginSettings.wpieImportId,host:e,port:i,username:t,password:p,path:a,connection_type:r,wpieSecurity:wpiePluginSettings.wpieSecurity};jQuery.ajax({url:wpiePluginSettings.wpieAjaxURL,type:"POST",data:s,dataType:"json",async:!0,success:function(e){if(wpieUpdateProcessLoader("wpieUploadFromFTPText"),"error"==e.status)return wpieSetErrorMsg(e.message),!1;wpieSetFileData(e)},error:function(e,i){wpieHandleAjaxError(e,i)}})}),jQuery(document).on("change",".wpie_item_attribute_source",function(){"as_specified"==jQuery(this).val()?jQuery(".wpie_attribute_search_existing_data").show():jQuery(".wpie_attribute_search_existing_data").hide()}),jQuery(document).on("click",".wpie_show_more_data",function(){var e=jQuery(this).parent().find(".wpie_tag_content_text"),i=jQuery(this).parent().find(".wpie_tag_content_full_text");jQuery(this).hasClass("wpie_show_less")?(e.css("display","inline"),i.hide(),jQuery(this).removeClass("wpie_show_less").text(wpiePluginSettings.wpieLocalizeText.showMoreText)):(e.hide(),i.css("display","inline"),jQuery(this).addClass("wpie_show_less").text(wpiePluginSettings.wpieLocalizeText.showLessText))}),jQuery(document).on("click",".wpie_inner_section_label",function(){var e=jQuery(this).find(".wpie_inner_section_icon");e.hasClass("fa-chevron-down")?(e.removeClass("fa-chevron-down"),e.addClass("fa-chevron-up")):(e.addClass("fa-chevron-down"),e.removeClass("fa-chevron-up")),jQuery(this).parent().find(".wpie_inner_section_container").slideToggle()});