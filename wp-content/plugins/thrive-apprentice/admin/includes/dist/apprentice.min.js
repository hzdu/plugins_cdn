!function(e){var t={};function s(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=278)}([function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}!function(t){Backbone.View.prototype.tvaClearError=function(){return this.$(".tvd-invalid").removeClass("tvd-invalid"),this.$("select").trigger("tvaclear"),this},Backbone.View.prototype.tvaShowErrors=function(e){if(e=e||this.model){var s=e instanceof Backbone.Model?e.validationError:e,i=this,n=t();return t.isArray(s)?_.each(s,(function(e){r(e)})):r(s),n.not(".tvd-no-focus").first().focus(),this.scrollFirstError(n.first()),this}function r(e){if("string"==typeof e)return TVE_Dash.err(e);n=n.add(i.$("[data-field="+e.field+"]").addClass("tvd-invalid").each((function(){var s=t(this);s.is("select")?s.trigger("tvderror",e.message):s.next("label").attr("data-error",e.message)})))}},Backbone.View.prototype.scrollFirstError=function(e){if(!(this instanceof TVE_Dash.views.Modal&&e.length))return this;var t=e.offset().top,s=this.$_content.offset().top,i=this.$_content.outerHeight();if(t>=s&&t<i+s-50)return this;var n=this.$_content.scrollTop();this.$_content.animate({scrollTop:n+t-s-40},200,"swing")};var i=s(3);e.exports=Backbone.View.extend({zClipCopiedClass:"tva-copied",$$childViews:[],initialize:function(e){e&&e.template&&(this.template=e.template),this.afterInitialize(e)},events:{"click .click":"_call","mousedown .mousedown":"_call","mouseover .mouseover":"_call","mouseenter .mouseenter":"_call","change .change":"_call","input .input":"_call"},_call:function(e){var t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)},getRenderParams:function(){return{model:this.model}},render:function(){var e=this;return"string"==typeof this.template&&(this.template=TVE_Dash.tpl(this.template)),"function"==typeof this.template&&this.$el.html(this.template(this.getRenderParams())),setTimeout((function(){return e.bindZclip()}),200),this.afterRender(),this},openModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(_.isObject(e)&&(e.prototype instanceof i||e.prototype instanceof TVE_Dash.views.ModalSteps||e.prototype instanceof TVE_Dash.views.Modal))return t=n(n({},{"max-width":"calc(100% - 40px)",width:"850px",in_duration:200,out_duration:300,className:"tvd-modal tva-modal-create",dismissible:!0}),t),TVE_Dash.modal(e,t);console.warn("Invalid type of modal view")},changeView:function(e){TVA.Router.navigate(e,{trigger:!0})},bindZclip:function(){var e=this;this.$el.find(".tva-zclip").each((function(s,i){var n=t(i),r=n.prev().on("click",(function(e){this.select(),e.preventDefault(),e.stopPropagation()}));try{n.zclip({path:TVE_Dash_Const.dash_url+"/js/util/jquery.zclip.1.1.1/ZeroClipboard.swf",copy:function(){return n.prev().val()},afterCopy:function(){r[0].select(),n.removeClass(e.zClipCopiedClass).addClass(e.zClipCopiedClass),setTimeout((function(){n.removeClass(e.zClipCopiedClass)}),2e3)}})}catch(e){}}))},afterRender:t.noop,afterInsert:t.noop,afterInitialize:t.noop,addChild:function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return Array.isArray(t[0])&&(t=t[0]),this.$$childViews=this.$$childViews.concat(t),this},destroy:function(){return this.stopListening(),this.undelegateEvents(),this.$el.removeData().off(),this.$$childViews.filter((function(e){return e})).forEach((function(e){"function"==typeof(null==e?void 0:e.destroy)&&e.destroy()})),this}})}(jQuery)},function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}e.exports=s(0).extend({ensureData:function(){return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){e()})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,s=arguments;return new Promise((function(n,r){var o=e.apply(t,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))})();var e}})},function(e,t){var s;s=jQuery,Backbone.emulateHTTP=!0,e.exports=Backbone.Model.extend({sync:function(e,t,s){var i=s.beforeSend;return s.beforeSend=function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce),"function"==typeof i&&i.apply(this,arguments)},this.saveState(),Backbone.Model.prototype.sync.apply(this,arguments)},validation_error:function(e,t){return{field:e,message:t=TVE_Dash.escapeHTML(t)}},getValidationError:function(){return this.validationError&&this.validationError[0]?this.validationError[0].message:""},saveState:function(){return this.__saved_state={},jQuery.extend(!0,this.__saved_state,this.attributes),this},restoreState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.__saved_state?(this.set(this.__saved_state,{silent:e}),this):this},deepGet:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.attributes;if(!e)return t;for(var i=e.split("."),n=s;i.length>1;){var r=i.shift();if(void 0===(n=n instanceof Backbone.Model?n.get(r):n[r]))return t}return void 0===n[i[0]]?t:n[i[0]]},deepSet:function(e,t,i){if(!e.includes("."))return this.set(e,t,i),this;for(var n=e.split("."),r=n.shift(),o=r,a=s.extend(!0,{},this.get(r)||{}),c=a;n.length>1;)a=a[r=n.shift()]||(a[r]={});return a[n[0]]=t,this.set(o,c,i),this},deepUnset:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.split("."),i=this.attributes;s.length>1;){var n=s.shift();if(void 0===(i=i instanceof Backbone.Model?i.get(n):i[n]))break}return void 0!==i&&void 0!==i[s[0]]&&(delete i[s[0]],t&&this.trigger("change")),this},toDeepJSON:function(){var e=s.extend(!0,{},this.attributes);return _.each(_.keys(e),(function(t){e[t]&&(_.isFunction(e[t].toDeepJSON)?e[t]=e[t].toDeepJSON():_.isFunction(e[t].toJSON)&&(e[t]=e[t].toJSON()))})),e},deepClone:function(){return new this.constructor(this.toDeepJSON())}})},function(e,t,s){var i;i=jQuery,e.exports=TVE_Dash.views.Modal.extend({zClipCopiedClass:"tva-copied",template:"",currentStep:0,previouslyStep:0,stepSelector:".tva-modal-step",events:{"click .click":"_call","input .input":"_call","keyup .keyup":"_call","change .change":"_call"},_call:function(e){var t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)},afterRender:function(){return(this.$steps=this.$el.find(this.stepSelector).hide()).length&&this.gotoStep(0),this.bindZclip(),this.dom(),this},bindZclip:function(){var e=this,t=s(1);setTimeout((function(){return t.prototype.bindZclip.call(e,null)}),200)},gotoStep:function(e){var t;return null!==(t=this.stepCss)&&void 0!==t&&t[e]&&this.$el.animate(this.stepCss[e],100),this.$currentStep=this.$steps.hide().eq(e).show(),this.previouslyStep=this.currentStep,this.currentStep=e,"function"==typeof this["afterStep".concat(e,"Loaded")]&&this["afterStep".concat(e,"Loaded")](),this},goToPreviouslyStep:function(){return this.$steps.length&&this.gotoStep(this.previouslyStep),this},jumpToStep:function(e,t){var s=parseInt(t.getAttribute("data-step"));return this.$steps.length&&this.allowJumpToStep(s)&&this.gotoStep(s),this},allowJumpToStep:function(e){return!0},getCurrentStep:function(){return i(this.$steps[this.currentStep])},dom:i.noop})},function(e,t){function s(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var i;i=jQuery,e.exports=Backbone.Collection.extend({sync:function(e,t,s){return s.beforeSend=function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)},Backbone.Collection.prototype.sync.apply(this,arguments)},replace:function(e){var t=this.findWhere({id:e.get("id")});if(!t)return!1;var s=this.indexOf(t);return this.remove(t),this.add(e,{at:s}),!0},updateModels:function(e){this.each((function(t){t.set(e)}))},findById:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ID",i=this.findWhere(s({},t,parseInt(e)));return i||(i=new this.model),i},fetchOnce:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.$$fetched){var s=i.Deferred();e=s.promise(),s.resolve(this.toJSON())}else this.$$fetched=!0,this.trigger("fetch"),e=this.fetch(t);return e}})},function(e,t,s){e.exports=s(2).extend({defaults:function(){return{preview_url:"",title:"",edit_url:"",value:""}},initialize:function(){var e="search";parseInt(this.get("value"))&&(e="normal"),this.attributes.state=e},url:function(){return"search"===this.get("state")?"".concat(TVA.routes.settings_v2,"/core-page/update"):"".concat(TVA.routes.settings_v2,"/core-page/").concat(this.get("state"))},validate:function(e){var t=[];if("create"===e.state&&!e.title)return t.push(this.validation_error("title","")),t},previewUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.get("preview_url");return 0===Object.keys(e).length?t:"".concat(t).concat(t.includes("?")?"&":"?").concat(jQuery.param(e))}})},function(e,t,s){var i;i=jQuery,e.exports=s(1).extend({initialize:function(e){var t=this;i.extend(!0,this,{templates:{},callbacks:{}},e),e.states_views_path||console.error("required argument states_views_path missing"),this.states_views_path=e.states_views_path,this.listenTo(this.model,"change:state",this.render),this.listenTo(this.model,"sync",(function(e){var s=e.get("name"),i=e.toJSON();TVA.settings[s]&&Object.keys(TVA.settings[s]).forEach((function(e){Object.keys(i).indexOf(e)&&(TVA.settings[s][e]=i[e])})),"checkout_page"===s&&TVA.access_integrations.forEach((function(e){["sendowl_product","sendowl_bundle"].includes(e.slug)&&(e.allow=i.value?1:0)})),t.model.trigger("value-changed")}))},render:function(){this._view instanceof Backbone.View&&(this._view.undelegateEvents(),this._view.stopListening(),this._view.$el.empty(),delete this._view);try{var e=this.model.get("state"),t=s(295)(this.states_views_path+e+".js"),i={el:this.el,model:this.model,labels:this.labels&&this.labels[e]?this.labels[e]:{},settings:this.settings&&this.settings[e]?this.settings[e]:{},callbacks:this.callbacks};this.templates[e]&&(i.template=this.templates[e]),this._view=new t(i),this._view.render()}catch(e){console.error(this.states_views_path+this.model.get("state")+".js is not a valid Backbone view"),console.log(e)}return this.afterRender(),this},afterRender:i.noop})},function(e,t,s){var i=s(4),n=s(83),r=s(85),o=s(86);e.exports=i.extend({model:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(e.post_type){case"tva_module":return new n(e,t);case"tva_chapter":return new r(e,t);case"tva_lesson":return new o(e,t);default:return new Backbone.Model(e,t)}},save:function(){var e=[];this.each((function(t){e.push(t.toJSON())}));var t=new a(e);return t.save.apply(t,arguments)},getIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.findItem(e),s=null;return t instanceof Backbone.Model&&t.collection instanceof Backbone.Collection&&(s=t.collection.indexOf(t)),s},updateChildrenCommentStatus:function(e,t){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=new a({});"boolean"==typeof t&&(t=t?"open":"closed"),n.updateChildrenCommentStatus(e,t,i,this.findItemsIDsByOptions()).success((function(e){e.update&&s.findItemsByOptions().forEach((function(e){return e.set("comment_status",t)}))})).error((function(){console.warn("Invalid Payload when updating the children comments status")}))},getType:function(){var e="content";if(0===this.length)return e;var t=this.first();if(!(t instanceof Backbone.Model))return e;switch(t.getType()){case"module":e="modules";break;case"chapter":e="chapters";break;case"lesson":e="lessons"}return e},getSingularType:function(){return this.first()instanceof Backbone.Model?this.first().getType():"content"},findItem:function(e){var t=this;if(e=parseInt(e),isNaN(e))return null;var s=this.findWhere({id:e});return s instanceof Backbone.Model||this.some((function(i){return!!i.get("structure").length&&(s=t.findItem.call(i.get("structure"),e))})),s},countChildren:function(e){if(e===parseInt(this.at(0).get("post_parent")))return this.length;var t=this.findItem(e);return t&&t.get("structure")&&t.get("structure").length||0},findItemsByOptions:function(e){var t=this,s=this.where(e);return this.forEach((function(i){if(i.get("structure").length){i.get("structure")instanceof t.constructor||i.set("structure",new t.constructor(i.get("structure")));var n=t.findItemsByOptions.call(i.get("structure"),e);s=s.concat(n)}})),s},findItems:function(e){var t=this,s=[];return this.each((function(i){e(i)&&s.push(i),i.get("structure").length&&(i.get("structure")instanceof t.constructor||i.set("structure",new t.constructor(i.get("structure"))),s=s.concat(i.get("structure").findItems(e)))})),s},findItemsIDsByOptions:function(e){return _.map(this.findItemsByOptions(e),(function(e){return e.get("ID")}))},getOrderForNewItem:function(){var e=this.pluck("order");return 0===e.length&&e.push(-1),parseInt(_.last(e))+1},comparator:function(e,t){return parseInt(e.get("order"))-parseInt(t.get("order"))}});var a=s(2).extend({url:function(){return"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/structure")},updateChildrenCommentStatus:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return wp.apiRequest({type:"POST",url:"".concat(this.url(),"/update_children_comment_status"),data:{parent_id:e,parent_type:s,current_value:t,ids:i}})}})},,,function(e,t,s){var i;i=jQuery,e.exports=s(0).extend({afterInitialize:function(e){i.extend(!0,this,e)},cancel:function(){this.remove()},confirm:function(){this.remove()}})},function(e,t){var s;s=jQuery,e.exports={getIframe:function(){return s("iframe#tva_frame").contents()},iframeLoaded:function(){this.getIframe().find('a, input[type="submit"]').on("click",(function(e){e.preventDefault()}))},addImageLogo:function(){s("<img />",{class:"tva-img-logo tva-resize-img"}).appendTo(this.getIframe().find(".lg"))},getLogo:function(){return this.getIframe().find(".lg img")},changeLogo:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.getLogo().attr(e).css(t)},changeText:function(e,t){this.getIframe().find(e).text(t)},changeAttr:function(e,t,s){this.getIframe().find(e).attr(t,s)},styleIframeElements:function(e,t,s){var i={};i[t]=s,this.getIframe().find(e).css(i)},addFontToHead:function(e){this.getIframe().find("#tva_google_font").remove(),this.getIframe().find("head").append('<link rel="stylesheet" id="tva_google_font" href="'.concat(e,'" type="text/css" media="all">'))},changeMainColorCallback:function(e,t){this.styleIframeElements(".tva_".concat(e),"color",t),this.styleIframeElements(".tva_".concat(e),"fill",t),this.styleIframeElements(".tva_".concat(e,"_bg, header.tva-header ul.menu > li.h-cta"),"background-color",t),this.styleIframeElements(".tva-sidebar-container ul a","color",t),this.styleIframeElements(".tva_text_logo_size, a.lg","color",t),this.getIframe().find(".tva-cm-redesigned-breadcrumbs ul li a").hover((function(){s(this).css("color",t)}),(function(){s(this).css("color","#666666")}))},collapse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=window.inner_jQuery(this.getIframe());t.find(".tva-cm-container .tve-chapters-wrapper, .tva-cm-container .tve-lessons-wrapper").slideDown(),t.find(".tva-cm-container").tva_collapsible(s.extend({collapse_modules:0,collapse_chapters:0},e))}}},function(e,t,s){e.exports=s(2).extend({defaults:{key:"",value:null},validate:function(e){if(!e.key||null===e.value||"string"!=typeof e.key)return this.validation_error("invalid_payload","The payload is invalid")},url:function(){return TVA.routes.settings_v2},setValue:function(e){var t=this.get("key");return t&&(TVA.settings[t].value=e,this.set("value",e)),this}})},function(e,t,s){var i,n,r,o;i=jQuery,n=s(11),r=s(0),o=s(12),e.exports=r.extend({events:function(){return _.extend(r.prototype.events,{"click .tva-settings-card-title":"toggleSettingsCard"})},initialize:function(){r.prototype.initialize.apply(this,arguments),this.render(),TVE_Dash.materialize(this.$el)},changeModelTemplateValue:function(e,t){this.model.get("template")[e]=t},sliderInput:function(e,t){var s=i(t),r=t.getAttribute("name"),o=t.getAttribute("data-css-prop"),a=t.getAttribute("type"),c="".concat(t.value,"px"),l=s.closest(".tva-card");0===l.length&&(l=s.closest(".tva-sidebar-wrapper")),l.find("range"===a?"#tva_".concat(r,"_input"):"#tva_".concat(r)).val(t.value),n.styleIframeElements(".tva_".concat(r),o,c),this.changeModelTemplateValue(r,parseInt(c))},checkboxInput:function(e,t){var s=t.getAttribute("name");this.changeModelTemplateValue(s,Number(t.checked)),n.collapse(this.model.get("template"))},changeText:function(e,t){var s=t.getAttribute("name");n.changeText(".tva_".concat(s),t.value),this.changeModelTemplateValue(s,t.value)},changeAttribute:function(e,t){var s=t.getAttribute("name"),i=t.getAttribute("data-attr-name");n.changeAttr(".tva_".concat(s),i,t.value),this.changeModelTemplateValue(s,t.value)},modifySettingsView:function(e,t){var s=this;this.save().always((function(){s.changeView("#".concat(t.getAttribute("data-state")))}))},toggleSettingsCard:function(e){return i(e.currentTarget).closest(".tva-settings-card").siblings().removeClass("open").end().toggleClass("open"),!1},save:function(e){return TVE_Dash.showLoader(),new o({key:"template",value:this.model.get("template")}).save().success((function(){e&&TVE_Dash.hideLoader()})).error((function(){TVE_Dash.hideLoader()}))}})},function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}var n,r,o;n=jQuery,r=s(42),o=s(41),e.exports=s(1).extend({productId:null,initialize:function(e){(e=e||{}).id&&(this.productId=parseInt(e.id)||null),this.model=TVA.products.get(this.productId),this.model&&this.afterInitialize(e),this.initOptions=e,this.backTermID=this.getBackLTerm(),this.hasBackLink=!1!==this.backTermID},ensureData:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.productId&&!t.model?(TVA.keepLoader=!0,TVA.Utils.pageLoader(!0),t.model=new o({id:t.productId}),t.model.fetch().done((function(){t.afterInitialize(t.initOptions),e(),TVA.Utils.pageLoader(!1),TVA.products.cacheModel(t.model)}))):e()})));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,s=arguments;return new Promise((function(n,r){var o=e.apply(t,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))})()},getBackLTerm:function(){var e=Backbone.history.getFragment().split("/");return!!(Array.isArray(e)&&4===e.length&&parseInt(e[3])>0)&&parseInt(e[3])},getBackLink:function(){if(!this.hasBackLink)return"";var e=TVA.courses.findWhere({id:this.backTermID});return'<a class="tva-back tva-back-button" href="#courses/'.concat(this.backTermID,'/access">Back to editing course: ').concat(e.get("name"),"</a>")},afterRender:function(){this.$subMenu=n("#tva-app .tva-submenu"),this.subMenu=new r({el:this.$subMenu,collection:new Backbone.Collection}),this.subMenu.menuItem=new Backbone.Model({label:"Product",items:new Backbone.Collection});var e=this.hasBackLink?"/".concat(this.backTermID):"";this.subMenu.collection.reset([{slug:"content",route:"products/".concat(this.productId,"/content").concat(e),icon:"icon-p-box",label:TVA.t.product_menu.content,selected:"content"===TVA.Router.subOption,items:[]},{slug:"product-purchase",route:"products/".concat(this.productId,"/rules").concat(e),icon:"icon-p-requirements",label:TVA.t.product_menu.requirements,selected:"rules"===TVA.Router.subOption,items:[]},{slug:"drip",route:"products/".concat(this.productId,"/drip").concat(e),icon:"drip-main",label:TVA.t.product_menu.drip,selected:"drip"===TVA.Router.subOption,items:[]},{slug:"product-restricted-content",route:"products/".concat(this.productId,"/restricted-content").concat(e),icon:"icon-p-restricted",label:TVA.t.product_menu.restriction,selected:"restricted-content"===TVA.Router.subOption,hidden:!TVA.visualEditingEnabled,items:[]}])}})},function(e,t,s){var i=s(195),n=s(21),r=s(176);e.exports=i.extend({collection:TVA.labels,afterInitialize:function(){i.prototype.afterInitialize.apply(this,arguments),this.settings=s(219)},newModel:function(){return new n},newItemView:function(e){var t=new r({model:e,parent:this});return e.get("ID")<0&&t.$el.hide(),t},_renderContextItems:function(e,t,s,i,n){var r=this;_.each(t,(function(t,o){var a=new i({settings:r.settings,parent:r,defaultTitle:s[o],contextTitle:t,type:o,class:o.replace(/_/g,"-"),model:n(o)});r.addChild(a),e.append(a.render().$el)}))}})},function(e,t){jQuery,e.exports=TVE_Dash.views.Modal.extend({events:{"click .click":"_call","input .input":"_call"},_call:function(e){var t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)}})},function(e,t,s){var i=s(0);e.exports=i.extend({render:function(){return i.prototype.render.apply(this,arguments),this.model.get("id")&&this.$("h3.tvd-modal-title").text("Edit ".concat(this.model.getType())),this.$("select").select2(),this}})},function(e,t,s){var i=s(13);e.exports=i.extend({template:TVE_Dash.tpl("design/index"),initialize:function(e){this.available_settings=e.available_settings,i.prototype.initialize.apply(this,arguments)},render:function(){return this.$el.empty().html(this.template({template:this.model.get("template"),available_settings:this.available_settings})),this}})},function(e,t,s){var i,n;i=jQuery,n=s(71),e.exports=n.extend({className:"tva-flex tva-label-user-switch tva-align-center tva-label-row",template:TVE_Dash.tpl("labels/user-context-item"),afterInitialize:function(e){i.extend(this,e),n.prototype.afterInitialize.call(this,e)},spectrumOptions:function(){return{containerClassName:"tva-label-spectrum"}},afterRender:function(){TVE_Dash.materialize(this.$el),this.$("select").data("select2").$dropdown.addClass("tva-context-dropdown")},toggleLoader:function(){this.$el.tvaToggleLoader(20,!!this.model.get("loading"),{background:"",position:"right",padding:"0 20px 0 0"})},labelDisplayChanged:function(e){this.model.persist({opt:e.currentTarget.value},{showSuccess:!1})}})},function(e,t,s){var i;i=jQuery,e.exports=s(16).extend({afterInitialize:function(e){i.extend(!0,this,e)},confirm:function(){this.close()},afterOpen:function(){this.$('[data-fn="confirm"]').focus()}})},function(e,t,s){var i=s(40);e.exports=i.extend({savedMessage:TVA.t.label_saved,defaults:function(){return{title:"New Label",color:"#58a545",label_color:"#58a545"}},url:function(){return this.urlWithId(TVA.routes.labels)},persist:function(e){return e.color&&(e.label_color=e.color),i.prototype.persist.apply(this,arguments)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r=s(23),o=s(52),a=s(54),c=s(0).extend({template:TVE_Dash.tpl("products/partials/product-form"),afterInitialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.editMode=e.editMode||!1,this.formArgs=e.formArgs||{},this.setModel=e.setModel,this.formType=e.formType},afterRender:function(){this.$formWrapper=this.$(".tva-product-course-form"),this.$btn=this.$(".tva-list-action").hide(),this.renderForm()},renderForm:function(){var e,t=this;switch(this.form&&this.form.destroy(),this.formType){case"courses":e=r;break;case"content":e=o;break;default:throw new Error("Invalid item type: "+this.formType)}this.form=e.renderTo(this.$formWrapper,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({preselected:this.getPreselectedContent()},this.formArgs)),this.$btn.show().toggleClass("tva-disabled",!this.form.hasSelection()),this.form.on("selection-changed",(function(e){t.$btn.toggleClass("tva-disabled",!e)})),this.$("select").each((function(){var e=jQuery(this);e.data("select2")&&e.select2("destroy")})).select2({width:"100%",dropdownParent:this.$(".tva-product-course-form")})},addToProduct:function(){if(this.form&&this.form.hasSelection()){var e=this.form.getData(),t=this.setModel.getRules().findWhere({content_type:e.content_type,content:e.content,field:e.field,operator:e.operator});if(t&&Array.isArray(t.get("value"))){var s=_.uniq(this.editMode?e.value:t.get("value").concat(e.value),!1,(function(e){return Number(e.id)}));t.set({value:s}),t.hasChanged("value")||this.setModel.getRules().trigger("reset")}else this.setModel.getRules().add(new TD_SETS.Models.Rule(e));this.$btn.hide(),this.$("button").removeClass("tva-tab-active tva-tab-inactive"),this.form.destroy().remove(),TVA.customers.reset(),this.trigger("rule-added")}return this.destroy().remove(),!1},getPreselectedContent:function(){var e={};return this.setModel.getRules().each((function(t){e[r.ruleKey(t)]=Array.from(t.get("value")).map((function(e){return e.id}))})),e}});e.exports=s(0).extend({template:TVE_Dash.tpl("products/partials/add-form"),afterInitialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setModel=t.setModel,this.autoSave=!!t.autoSave,this.listenTo(this.setModel.getRules(),"add change reset",this.renderRules),this.listenTo(this.setModel.getRules(),"add remove",(function(){return TVA.$eventBus.trigger("products_changed")})),this.listenTo(this.setModel.getRules(),"edit-rule",(function(t){var s=t.model,i=t.$el;i.html(new c({editMode:!0,setModel:e.setModel,formType:"term"===s.get("content_type")&&"tva_courses"===s.get("content")?"courses":"content",formArgs:{ruleModelArgs:s.toJSON(),filter_type:s.get("field"),existingValues:s.getValues()}}).render().$el),e.toggleRules(!0),i.removeClass("tva-disabled")})),this.autoSave&&parseInt(this.setModel.get("ID"))>0?(this.setModel.allowEmptyRules=!0,this.listenTo(this.setModel.getRules(),"add change",(function(){e.$rulesWrapper.tvaToggleLoader(),e.setModel.save({return_one:1}).done((function(){return e.$rulesWrapper.tvaToggleLoader(!1)}))}))):this.listenTo(this.setModel.getRules(),"add change",(function(t){e.$rulesWrapper.tvaToggleLoader(),t.normalize().then((function(s){t.set({content_label:s.content_label},{silent:!0}),e.renderRules(),e.$rulesWrapper.tvaToggleLoader(!1)}))}))},afterRender:function(){this.$rulesWrapper=this.$(".tva-add-product-rules-wrapper"),this.renderRules()},renderRules:function(){var e=this;this.$rulesWrapper.empty().removeClass("tva-disabled"),this.ruleViews&&this.ruleViews.forEach((function(e){return e.destroy()})),this.ruleViews=[];var t=0;this.setModel.getRules().each((function(s){if(0!==s.get("value").length||-1===s.get("field")){var i=new a({model:s,setModel:e.setModel,collection:e.setModel.getRules()});e.ruleViews.push(i),e.$rulesWrapper.append(i.render().$el),t++}})),this.addChild(this.ruleViews),this.autoSave&&0===t&&this.$rulesWrapper.html('<div class="tva-text-light tva-text-center"><em>This product does not protect anything! Add some content to it</em></div>')},addClicked:function(e){this.closeForm(),jQuery(e.currentTarget).removeClass("tva-tab-inactive").addClass("tva-tab-active").siblings().addClass("tva-tab-inactive").removeClass("tva-tab-active"),this.$(".product-form-wrapper").html(new c({setModel:this.setModel,formType:e.currentTarget.dataset.type,formArgs:{}}).render().$el),this.toggleRules(!0)},toggleRules:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Array.isArray(this.ruleViews)&&this.ruleViews.forEach((function(t){return t.$el.toggleClass("tva-disabled",e)}))},closeForm:function(){this.render()}})},function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function n(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var o=e.apply(t,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))}}function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var c=s(2),l=new(s(24)),u=s(0).extend({template:TVE_Dash.tpl("products/partials/add-courses"),afterInitialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=jQuery.extend(!0,{},t),this.state=new c(o({filter_type:"title",search:"",selected_ids:[],selected_data:[]},t)),this.listenTo(this.state,"change:filter_type",(function(){e.state.set("search",""),e.state.set("selected_ids",[],{silent:!0}),e.state.set("selected_data",[],{silent:!0}),e.dom.$selectAllLabel.hide(),"author"===e.state.get("filter_type")?(e.dom.$list.html(""),e.fetchSuggestions("",1)):e.renderItems(!0)}))},afterRender:function(){this.dom={$search:this.$(".tva-form-search-input"),$selectAllLabel:this.$(".tva-select-all"),$selectAll:this.$(".tva-select-all input"),$list:this.$("#tva-form-item-list"),get $labels(){return this.$list.find("label").filter(":visible")},get $checkboxes(){return this.$labels.find('input[type="checkbox"]')},get $enabledCheckboxes(){return this.$labels.not(".tva-disabled").find('input[type="checkbox"]')},get selectedIds(){var e=[];return this.$checkboxes.filter(":checked").each((function(t,s){return e.push(s.value)})),e.map(Number)},get selectedData(){var e=[];return this.$checkboxes.filter(":checked").each((function(t,s){return e.push({id:parseInt(s.value),text:s.getAttribute("data-text")})})),e}},TVE_Dash.data_binder(this,this.state),this.renderItems(!0)},getData:function(){return{content_type:"term",content:"tva_courses",field:this.state.get("filter_type"),operator:"===",value:this.state.get("selected_data")}},onFilterInput:function(e){var t=this;this.state.set("search",e.currentTarget.value.trim(),{silent:!0}),clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){"author"===t.state.get("filter_type")?(t.dom.$list.html(""),t.fetchSuggestions(t.state.get("search"),1)):t.renderItems()}),100)},onSelectionChanged:function(){this.dom.$selectAll.prop("checked",this.allSelected()),this.storeSelection()},hasSelection:function(){return!!this.state.get("selected_ids").length},hasSelectAll:function(){return["title"].includes(this.state.get("filter_type"))},toggleSelectAll:function(e){this.dom.$enabledCheckboxes.prop("checked",!!e.currentTarget.checked),this.storeSelection()},storeSelection:function(){this.state.set("selected_ids",this.dom.selectedIds,{silent:!0}),this.state.set("selected_data",this.dom.selectedData,{silent:!0}),this.trigger("selection-changed",this.state.get("selected_ids").length)},allSelected:function(){return this.dom.$checkboxes.length===this.dom.$checkboxes.filter(":checked").length},onSearch:function(e){var t="html",s="Getting results...";1!==e&&(t="append",s="Getting more results..."),this.$(".tva-searching-text").remove(),this.dom.$list[t]('<div class="tva-text-center tva-searching-text tva-form-text p-10"><em>'.concat(s,"</em></div>"))},fetchSuggestions:function(){var e=arguments,t=this;return n(regeneratorRuntime.mark((function s(){var i,n,r;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:i=e.length>0&&void 0!==e[0]?e[0]:"",n=e.length>1&&void 0!==e[1]?e[1]:1,r=new Backbone.Model({content_type:"term",content:"tva_courses",field:t.state.get("filter_type"),operator:"==="}),t.listenTo(r,"searching",t.onSearch),l.fetch(r,i,n).then((function(e){t.state.set({suggestion_results:e},{silent:!0}),t.renderItems(!0)}));case 5:case"end":return s.stop()}}),s)})))()},renderItems:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t="",s=this.state.get("search").toLowerCase(),i=this.state.get("selected_ids"),n=u.ruleKey(this.getData()),r=(this.state.get("preselected")[n]||[]).map(Number),o=(this.state.get("existingValues")||[]).map(Number),a=this.getNormalizedItems();if(a.forEach((function(e){if(!s||e.name.toLowerCase().includes(s)){var n=r.includes(Number(e.id));t+=u.checkboxTemplate(e,n||i.includes(Number(e.id)),n&&!o.includes(parseInt(e.id)))}})),t?this.dom.$list.html(t):this.dom.$list.html(u.noResultsTemplate()),e){this.dom.$selectAllLabel[t&&this.hasSelectAll()?"show":"hide"]();var c=r.length&&r.length===a.length;this.dom.$selectAllLabel.toggleClass("tva-disabled",!!c&&0===o.length),this.dom.$selectAll.prop("checked",!!c)}},getNormalizedItems:function(){var e;switch(this.state.get("filter_type")){case"title":e=TVA.courses.map((function(e){return{id:e.get("id"),name:e.get("name")}}));break;case"topic":e=TVA.topics.map((function(e){return{id:e.get("ID"),name:e.get("title")}}));break;case"label":e=TVA.labels.map((function(e){return{id:e.get("ID"),name:e.get("title")}}));break;case"difficulty":e=TVA.levels;break;case"author":var t=this.state.get("suggestion_results")||null;null===t&&(this.fetchSuggestions(),t=[]),e=t.map((function(e){return{id:e.id,name:e.text}}));break;default:throw new Error("Invalid filter_type: "+this.state.get("filter_type"))}return e}},{renderTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e=jQuery(e);var s=new this(t);return e.html(s.render().$el),s},checkboxTemplate:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.text=e.text||e.name,"<label".concat(s?' class="tva-disabled"':"","><input").concat(t?" checked":"",' class="change" data-fn="onSelectionChanged" type="checkbox" data-text="').concat(_.escape(e.text),'" value="').concat(e.id,'"><span>').concat(_.escape(e.text),"</span></label>")},noResultsTemplate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=1===e?"No results found. Try modifying the search criteria":"No more results found";return'<div class="tva-text-center tva-searching-text tva-form-text p-10"><em>'.concat(t,"</em></div>")},ruleKey:function(e){return e instanceof Backbone.Model&&(e=e.toJSON()),[e.content_type,e.content,e.field].join("-")}});e.exports=u},function(e,t){function s(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function i(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function r(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function o(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data={},this.allFetched={}}var t,s,n,a,c;return t=e,(s=[{key:"hasMore",value:function(e,t){var s=e.toJSON(),i=[s.content_type,s.content,s.field,s.operator].join("|")+t.trim();return!this.allFetched[i]}},{key:"fetch",value:(a=regeneratorRuntime.mark((function e(t){var s,n,r=this,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=o.length>1&&void 0!==o[1]?o[1]:"",n=o.length>2&&void 0!==o[2]?o[2]:1,e.abrupt("return",new Promise((function(e,o){var a=t.toJSON(),c=[a.content_type,a.content,a.field,a.operator,n].join("|")+s.trim(),l=[a.content_type,a.content,a.field,a.operator].join("|")+s.trim();void 0===r.data[c]?(t.trigger("searching",n),jQuery.ajax({url:TD_SETS.routes.base,type:"GET",dataType:"json",data:i(i({},a),{},{_wpnonce:TD_SETS.nonce,query_string:s,paged:1,page:n})}).done((function(s){r.allFetched[l]=!s.length,r.data[c]=s,t.trigger("searching-done",s,n),e(s)})).fail((function(e){return o(e)}))):(e(r.data[c]),t.trigger("searching-done",r.data[c],n))})));case 3:case"end":return e.stop()}}),e)})),c=function(){var e=this,t=arguments;return new Promise((function(s,i){var n=a.apply(e,t);function o(e){r(n,s,i,o,c,"next",e)}function c(e){r(n,s,i,o,c,"throw",e)}o(void 0)}))},function(e){return c.apply(this,arguments)})}])&&o(t.prototype,s),n&&o(t,n),e}();e.exports=a},function(e,t,s){var i=s(0),n=s(20);e.exports=i.extend({className:"tva-product",template:TVE_Dash.tpl("products/list-item"),backTerm:!1,settings:{allowDrag:{selector:".tva-drag-handle",value:!0},showCustomersNumber:{selector:".tva-product-no",value:!0},showTooltipDot:{selector:".tva-tooltip-dot",value:!0}},afterInitialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.keys(this.settings).forEach((function(s){void 0!==t[s]&&(e.settings[s].value=t[s])})),this.backTerm=t.backTerm||!1},afterRender:function(){var e=this;this.$el.attr("data-id",this.model.get("id")),this.$(".tva-product-info").html(this.getProductInfo()),Object.keys(this.settings).forEach((function(t){e.settings[t].value||e.$(e.settings[t].selector).css("visibility","hidden")})),this.settings.showTooltipDot.value||this.$(this.settings.showTooltipDot.selector).remove()},getProductInfo:function(){var e=[];return this.model.getDefaultSet()?(this.model.getDefaultSet().getRules().each((function(t){if(-1===t.get("field"))e.push(t.get("content_label").plural);else if(Array.isArray(t.get("value")))if("title"===t.get("field")){if(0===t.get("value").length)return;e.push("".concat(t.get("value").length," ").concat(1===t.get("value").length?t.get("content_label").singular:t.get("content_label").plural))}else if("author"===t.get("field")){var s=t.get("value").map((function(e){return e.text})),i="archive"===t.get("content_type")?"of":"by";e.push("".concat(t.get("content_label").plural," ").concat(i," ").concat(t.get("field"),": ").concat(s.join(", ")))}else{var n=t.get("value").map((function(e){return e.text}));e.push("".concat(t.get("content_label").plural," with ").concat(t.get("field"),": ").concat(n.join(", ")))}})),e.join(" + ")):"No content set found!"},editProduct:function(){jQuery("html, body").animate({scrollTop:0},0),this.changeView("products/".concat(this.model.get("id"),"/content").concat(this.backTerm?"/"+this.backTerm:""))},deleteProduct:function(){var e=this.model,t=this.collection;this.openModal(n,{template:TVE_Dash.tpl(0===e.get("customers_count")?"modals/products/delete-no-customers":"modals/products/delete-with-customers"),width:"560px",model:e,confirm:function(){var s=this;TVE_Dash.showLoader(),TD_SETS.sets.remove(e.getDefaultSet()),e.destroy({success:function(){t.changeTotal(-1),TVA.customers.reset()}}).always((function(){s.close()}))}})}})},function(e,t,s){var i,n,r;i=jQuery,n=s(79),r=s(0),e.exports=r.extend({className:"tva-restrictions-rule",template:TVE_Dash.tpl("courses/integration"),rules:null,rule:null,$label:null,$items:null,$status:null,$clearButton:null,initialize:function(e){var t=this;i.extend(!0,this,e),this.rule=this.rules.findWhere({integration:this.model.get("slug")}),this.rule||(this.rule=new n({integration:this.model.get("slug")}),this.rules.add(this.rule.resetItems(void 0))),this.listenTo(this.rule.getItems(),"update",(function(){t.renderLabel(),t.renderStatus(),t.toggleClearSelection()})),this.listenTo(this.rule.getItems(),"reset",(function(){t.renderLabel(),t.renderStatus(),t.toggleClearSelection()}))},afterRender:function(){this.$label=this.$(".tva-course-integration-label, .tva-rule-label"),this.$rulesItem=this.$(".tva-rule-items"),this.$items=this.$(".tva-course-integration-items-wrapper"),this.$status=this.$(".tva-integration-status"),this.$clearButton=this.$(".tva-rule-items-clear"),this.model.get("allow")?this.renderItems(this.model.getItems()):this.renderRestricted(),this.renderLabel(),this.renderStatus(),this.toggleClearSelection()},toggleClearSelection:function(){this.rule&&this.$clearButton.toggleClass("tva-disabled",!this.rule.getItems().length)},renderStatus:function(){var e=0===this.rule.getItems().length?TVA.t.not_set:"&nbsp;";this.$status.html(e)},renderLabel:function(){this.rule.getItems().length>0&&this.model.get("allow")?this.$label.html("".concat(this.model.getText()," - ").concat(this.rule.getItemsToString(this.model))):(this.$label.first().html(""),this.$label.eq(1).html(this.model.getText()))},renderItems:function(e){var t=this,s=TVE_Dash.tpl("courses/integration-item"),n=this.$items.find(".tva-rule-items-wrapper").empty();e.each((function(e){var r;n.append(((r=i(s({id:"".concat(t.model.get("slug"),"-").concat(e.getId()),integration:t.model,model:e}))).find("input").prop("checked",t.rule.contains(e)),r))}))},renderRestricted:function(){var e=TVE_Dash.tpl("courses/restrict-integration/".concat(this.model.get("slug")));this.$rulesItem.html(e())},toggleItem:function(e,t){var s=this.model.getItems().findWhere({id:"wordpress"===this.model.get("slug")?t.dataset.id:parseInt(t.dataset.id)});t.checked?(this.rule.getItems().add(s),this.rule.collection.trigger("add")):(this.rule.getItems().remove(s),this.rule.collection.trigger("remove"))},toggleItemsList:function(e,t){var s=i(t);this.$items.toggle(!this.$items.is(":visible")),this.$label.first().toggle(),s.find("span").toggleClass("i-visible",this.$items.is(":visible"))},clearSelectedItems:function(){this.rule.getItems().reset(null),this.rule.collection.trigger("remove"),this.renderItems(this.model.getItems())}})},function(e,t,s){var i,n,r;i=jQuery,n=s(0),r=s(11),e.exports=n.extend({template:TVE_Dash.tpl("design/fonts/safe"),fonts:[],selectors:["body a","body p","body h1","body h2","body h3","body h4","body h5","body span","body strong"],initialize:function(e){n.prototype.initialize.apply(this,arguments),this.fonts=e.fonts,this.render();var t=this.$(".tva-fonts-select");this.fonts.forEach((function(s){var n=i("<option/>"),r={value:s.family};e.selected===s.family&&(r.selected=!0),n.attr(r).text(s.family),t.append(n)}))},changeFont:function(e,t){this.model.get("template").font_family=t.value,this.selectors.forEach((function(e){r.styleIframeElements(e,"font-family",t.value)}))},removeEventsFromView:function(){this.undelegateEvents(),this.$el.removeData().unbind()}})},function(e,t,s){e.exports=s(3).extend({template:"",serviceOptions:[],courses:[],selectedServiceOptions:{},productItemTpl:TVE_Dash.tpl("modals/customer/product-item"),afterInitialize:function(){this.courses=[]},save:function(){var e=this;this.model.isValid()?this.model.hasServices()||this.model.get("ID")?(TVE_Dash.showLoader(),this.model.save(null,{success:function(t,s){TVE_Dash.success(s.message),e.collection instanceof Backbone.Collection&&e.collection.fetch()},error:function(e,t){TVE_Dash.err(t.responseJSON.message)},complete:function(t){200===t.status&&e.close(),TVE_Dash.hideLoader()}})):TVE_Dash.err("Please select some services"):TVE_Dash.err(this.model.getValidationError())},checkboxClick:function(e,t){var s=t.dataset.id;this.courses.indexOf(s)>=0?this.courses.splice(this.courses.indexOf(s),1):this.courses.push(s)},dom:function(){var e=this;this.serviceOptions=[],this.$(".tva-service-options").each((function(t,s){e.serviceOptions.push(s.getAttribute("data-option"))})),this.reset(),this.serviceOptions.forEach((function(t){e.updateServiceOptionCounter(t)}))},notifyUser:function(e,t){this.model.set("notify",Number(t.checked))},reset:function(){var e=this;this.selectedServiceOptions=this.model.get("services"),this.serviceOptions.forEach((function(t){Array.isArray(e.selectedServiceOptions[t])&&e.selectedServiceOptions[t].length>0&&e.updateCheckboxStatus(e.selectedServiceOptions[t],t)}))},updateServiceOptionCounter:function(e){var t=this.$('.tva-option-card[data-option="'.concat(e,'"]:not(.disabled)')),s=t.find("input:checkbox:checked").length,i="<span>No access</span>";s>0&&(i="".concat(t.find("input:checkbox:checked").length," ").concat(t.attr("data-option-label"))),t.find(".tva-product-counter").html(i),t.find(".tva-option-toggle span").html(t.attr("data-".concat(s>0?"have":"no","-options-action-label")))},updateCheckboxStatus:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Array.isArray(t)&&t.forEach((function(t){var i=e.$("#tva-".concat(s,"-").concat(t));i.length&&(i[0].checked=!0)}))},toggleOptions:function(e,t){var s=t.getAttribute("data-option");this.$el.find(".tva-service-options").filter('[data-option="'.concat(s,'"]')).slideToggle("fast").closest(".tva-option-card").toggleClass("active")},toggleTable:function(e,t){t.closest("table").classList.toggle("b-hidden")},selectOption:function(e,t){var s=t.closest(".tva-option-card").getAttribute("data-option"),i=t.getAttribute("data-service-type"),n=parseInt(t.value);Array.isArray(this.selectedServiceOptions[i])||(this.selectedServiceOptions[i]=[]),t.checked?this.selectedServiceOptions[i].push(n):this.selectedServiceOptions[i]=this.selectedServiceOptions[i].filter((function(e){return parseInt(e)!==n})),this.updateServiceOptionCounter(s),this.model.set("services",this.selectedServiceOptions)}})},function(e,t,s){var i=s(1),n=s(182);e.exports=i.extend({className:"tva-customer-edit",template:TVE_Dash.tpl("customers/base-student"),editCustomer:function(){var e=this;TVE_Dash.showLoader(),this.model.getPurchasedItems().then((function(){var t;e.model.getAccessCourses(),TVA.products.getAll(),TVE_Dash.hideLoader(),t=e.model,e.openModal(n,{model:t,width:"1180px",top:"40px",className:"tvd-modal tvd-modal-big tva-modal-edit-customer"})}))},loginAsCustomer:function(e){var t=this.id,s=e.currentTarget.dataset.nonce;TVA.Utils.confirmation({title:TVA.t.login_as_user_title,description:TVA.t.login_as_user_description,yes:TVA.t.login_as_user_confirm,yesClass:"tva-modal-btn-green",no:TVA.t.login_as_user_cancel,noClass:"tva-modal-btn-gray"}).then((function(){wp.apiRequest({url:"".concat(TVA.routes.customer,"/").concat(t,"/login_as_customer"),method:"POST",data:{nonce:s}}).success((function(e){window.location.replace(e.courses_url)})).error((function(){return TVE_Dash.err("Unauthorized user.")}))}))}})},function(e,t,s){var i=s(1);e.exports=i.extend({className:"tva-student-lesson-item",template:TVE_Dash.tpl("customers/overview/lesson"),initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.lesson=e.lesson,this.contentStatuses=e.contentStatuses,this.completed=!!e.lessonsCompleted&&e.lessonsCompleted[this.lesson.get("id")],this.itemsBypassed=e.itemsBypassed,this.locked=e.locked,this.campaignType=e.campaignType?e.campaignType:null,this.courseLocked=e.courseLocked?e.courseLocked:null,this.moduleLocked=e.moduleLocked?e.moduleLocked:null,this.prepareLockedData(),this.prepareStatusData()},prepareLockedData:function(){var e=this.lesson.get("ID");this.itemsBypassed&&this.itemsBypassed[e]?this.locked=!1:this.locked&&this.locked.locked_lessons&&this.locked.locked_lessons[e]?this.locked=this.locked.locked_lessons[e]:this.locked=!1},prepareStatusData:function(){var e=this.lesson.get("ID"),t=this.contentStatuses&&this.contentStatuses[e]?this.contentStatuses[e]:null;t&&(this.lessonComplete=t.tva_lesson_complete?t.tva_lesson_complete:"",this.lessonStart=t.tva_lesson_start?t.tva_lesson_start:"")}})},,,,,function(e,t){var s=TD_SETS.Views.List;e.exports=s.extend({template:"products/content-sets/list",formView:null,afterInitialize:function(){s.prototype.afterInitialize.call(this),this.listenTo(this.collection,"reset",_.bind(this.goToListView,this)),this.listenTo(this.collection,"edit-set",_.bind(this.renderFormView,this)),this.listenTo(this.collection,"cancel-edit-set",_.bind(this.goToListView,this))},afterRender:function(){s.prototype.afterRender.call(this),this.$saveButton=this.$("button"),this.updateSelectedSets()},filterSets:function(){s.prototype.filterSets.apply(this,arguments),this.updateSelectedSets()},updateSelectedSets:function(){var e=this;this.product.get("sets").each((function(t){var s=t.get("ID");e.itemViews[s]&&e.itemViews[s].setChecked()}))},addSet:function(){this.renderFormView(new TD_SETS.Models.Set({}))},goToFormView:function(){this.modal.gotoStep(1)},goToListView:function(){this.formView&&this.formView.destroy().remove(),this.updateSelectedSets(),this.modal.gotoStep(0)},renderFormView:function(e){this.formView&&this.formView.destroy().remove(),this.formView=new TD_SETS.Views.Form({model:e,collection:this.collection}),this.modal.$formContainer.html(this.formView.render().$el),this.goToFormView()},renderItem:function(e){var t=new TD_SETS.Views.Item({model:e,product:this.product,collection:this.collection});this.$list.append(t.render().$el),this.itemViews[e.get("ID")]=t},saveAndClose:function(){var e=this;this.$saveButton.addClass("disabled"),TVE_Dash.showLoader(),this.product.saveSets().done((function(){e.$saveButton.removeClass("disabled"),TVE_Dash.hideLoader(),e.modal.close()}))}})},function(e,t){var s=TD_SETS.Views.Item;e.exports=s.extend({template:"products/content-sets/item",afterRender:function(){s.prototype.afterRender.call(this),this.$checkbox=this.$('input[type="checkbox"]')},edit:function(){this.collection.trigger("edit-set",this.model)},setChecked:function(){this.$checkbox.prop("checked",!0)},isChecked:function(){return this.$checkbox.is(":checked")},checkboxCheck:function(e,t){t.checked?this.product.get("sets").add(this.model):this.product.get("sets").remove(this.model)}})},function(e,t){var s=TD_SETS.Views.Form;e.exports=s.extend({template:"products/content-sets/form",back:function(){this.collection.trigger("cancel-edit-set",this.model)}})},function(e,t,s){function i(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=s(266),a=s(40),c=s(124),l=s(282),u=s(267),d=s(2),h=s(7),p=s(204),m=s(205);e.exports=d.extend({idAttribute:"id",defaults:{topic:0,level:0,label:-1,message:"",description:"",allows_comments:"open"===TVA.settings.comment_status.value,products:[],last_edit_date:""},initialize:function(e){var t=this,s=arguments;if(this.on("tva.structure.status.changed tva.structure.modified",_.debounce((function(){t.get("fetched")?t.getDripCampaigns().massApplySettings(t):t.fetch().done((function(){return t.getDripCampaigns().massApplySettings(t)})),t.refreshLastEditDate()}),400)),this.set("author",new Backbone.Model(e&&e.author||TVA.defaultAuthor)),"object"!==r(e)){var i=parseInt(e);if(isNaN(i))return void this.set({video:new c({options:[],source:"",type:"youtube"}),allows_comments:"open"===TVA.settings.comment_status.value,has_video:!1,excluded:0,protect_overview:0,rules:new o,order:TVA.courses.newItemOrder(),overview_post:new Backbone.Model,has_certificate:0,has_completed_post:0,certificate:new p,completed_post:new m});this.set("id",i),this.fetch({success:function(){t.set("fetched",!0,{silent:!0}),t.fetchedWithSuccess.apply(t,s),t.saveState()},error:function(){t.fetchedWithError.apply(t,s)}})}else this.set("rules",new o(e.rules||[])),this.set("overview_post",new Backbone.Model(e.overview_post||{})),this.set("certificate",new p(e.certificate||{})),this.set("completed_post",new m(e.completed_post||{}))},refreshLastEditDate:function(){var e=this;wp.apiRequest({url:"".concat(this.url(),"/refreshLastEditDate")}).done((function(t){e.set({last_edit_date:t},{silent:!0})}))},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+"/courses/".concat(this.get("id")?this.get("id"):"")},parse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.video=this.get("video")instanceof c?this.get("video"):new c(e.video),e.author=this.get("author")instanceof Backbone.Model?this.get("author").set(e.author||{}):new Backbone.Model(e.author||{}),e.rules=new o(JSON.parse(JSON.stringify(e.rules||[]))),this.get("overview_post")instanceof Backbone.Model?e.overview_post=this.get("overview_post").set(e.overview_post||{}):e.overview_post=new Backbone.Model(e.overview_post||{}),this.get("certificate")instanceof d?e.certificate=this.get("certificate").set(e.certificate||{}):e.certificate=new p(e.certificate||{}),this.get("completed_post")instanceof d?e.completed_post=this.get("completed_post").set(e.completed_post||{}):e.completed_post=new m(e.completed_post||{}),e},fetchedWithSuccess:function(){this.trigger("tva.course.fetch.success",this)},fetchedWithError:function(){this.trigger("tva.course.fetch.error",this)},validate:function(e){var t=[];if(e.name||t.push(this.validation_error("name",TVA.t.InvalidName)),e.id&&!e.slug&&(TVE_Dash.err(TVA.t.InvalidSlug),t.push(this.validation_error("slug",TVA.t.InvalidSlug))),e.has_video&&e.video instanceof c){var s=e.video.validate(e.video.attributes);s&&(e.video.trigger("invalid",e.video,s),t=[].concat(i(t),i(s)))}if(t.length)return t},hasSendOwlIntegration:function(){var e=this.get("rules");return e instanceof o?e.hasIntegration("sendowl_product")||e.hasIntegration("sendowl_bundle"):!!Array.isArray(e)&&e.filter((function(e){return["sendowl_product","sendowl_bundle"].includes(e.integration)})).length},getTopic:function(){return new a(TVA.topics.findById(this.get("topic")).toJSON())},getCountedLessons:function(){return TVA.Utils._n(this.get("count_lessons"),"Lesson")},recountLessons:function(){var e=this.get("structure");e&&e instanceof Backbone.Collection&&(this.set("count_lessons",e.findItemsByOptions({post_type:"tva_lesson"}).length,{silent:!0}),this.saveState())},hasModules:function(){var e,t=this.get("structure");return!!t&&(!!(e=t instanceof Backbone.Collection?t.at(0):t[0])&&(e instanceof Backbone.Model?"module"===e.getType():"tva_module"===e.post_type))},getRestrictionSummary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not_logged";return TVA.accessRestriction.options[this.getAccessRestrictionSettings(e).option].replace("(deprecated)","").trim()},getAccessRestrictionSettings:function(e){var t=this.deepGet("access_restrictions.".concat(e),!1);if(!1===t||!t.option){var s=this.get("message");t={option:s?"message":"inherit"},s&&(t.message=this.get("message"))}return t},restoreState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.__saved_state?(delete this.__saved_state.last_edit_date,this.set(this.__saved_state,{silent:e}),this):this},getModulesAndLessons:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=this.getStructure(),i=function(e){return!t||"publish"===e.get("post_status")},n=s.findItems((function(e){return i(e)&&["module","lesson"].includes(e.getType())}));if(e){var r=n;n=[];var o=!1;r.forEach((function(e){"module"===e.getType()?(o=!0,e.set("lessons",t?e.getPublishedLessons():e.getLessons()),n.push(e)):o||n.push(e)}))}return n},getLessons:function(){return this.get("structure").findItemsByOptions({post_type:"tva_lesson"})},hasPublishedContent:function(){return!!this.getModulesAndLessons(!1,!0).length},getDripCampaigns:function(){var e=this;return this.dripCampaigns||(this.dripCampaigns=new l(this.get("drip_campaigns")),this.dripCampaigns.each((function(t){return t.set("course_id",e.get("id"),{silent:!0})})),this.dripCampaigns.course=this),this.dripCampaigns},fetchProducts:function(){var e=this;return new Promise((function(t){wp.apiRequest({url:"".concat(e.url(),"/products")}).done((function(t){e.set({products:t}||[],{silent:!0})})).always((function(){return t()}))}))},getProducts:function(){return this.productsCollection||(this.productsCollection=new u(this.get("products"),{total:this.get("products").length})),this.productsCollection},hasContentId:function(e){return!!this.getModulesAndLessons().some((function(t){return t.get("ID")===e}))},getStructure:function(){var e=this.get("structure");return e instanceof h||(e=new h(e)),e}})},function(e,t){var s=Backbone.Model.extend({getId:function(){return this.get("id")},getName:function(){return this.get("name")}}),i=Backbone.Collection.extend({model:s});e.exports={itemsCollection:i,model:Backbone.Model.extend({initialize:function(e){var t=[];e.items&&(e.items instanceof i?t=e.items:Array.isArray(e.items)&&(t=new i(e.items))),this.set("items",t)},getItems:function(){return this.get("items")},getText:function(){var e="T: Give access if user has any of the following:",t=TVA.t.integrations[this.get("slug")];return t&&(e=t.rule_text),e}})}},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(2).extend({savedMessage:TVA.t.topic_saved,idAttribute:"ID",defaults:function(){return{title:"New Topic",icon:"",color:"#00c1ef",checked:1,default_icon:TVA.defaults.course_topic_icon,overview_icon_color:"#ffffff",layout_icon_color:"#000000",icon_type:"svg_icon",svg_icon:'<svg class="tva-icon" viewBox="0 0 576 512" data-id="icon-file-signature-light"><path d="M560.83 135.96l-24.79-24.79c-20.23-20.24-53-20.26-73.26 0L384 189.72v-57.75c0-12.7-5.1-25-14.1-33.99L286.02 14.1c-9-9-21.2-14.1-33.89-14.1H47.99C21.5.1 0 21.6 0 48.09v415.92C0 490.5 21.5 512 47.99 512h288.02c26.49 0 47.99-21.5 47.99-47.99v-80.54c6.29-4.68 12.62-9.35 18.18-14.95l158.64-159.3c9.79-9.78 15.17-22.79 15.17-36.63s-5.38-26.84-15.16-36.63zM256.03 32.59c2.8.7 5.3 2.1 7.4 4.2l83.88 83.88c2.1 2.1 3.5 4.6 4.2 7.4h-95.48V32.59zm95.98 431.42c0 8.8-7.2 16-16 16H47.99c-8.8 0-16-7.2-16-16V48.09c0-8.8 7.2-16.09 16-16.09h176.04v104.07c0 13.3 10.7 23.93 24 23.93h103.98v61.53l-48.51 48.24c-30.14 29.96-47.42 71.51-47.47 114-3.93-.29-7.47-2.42-9.36-6.27-11.97-23.86-46.25-30.34-66-14.17l-13.88-41.62c-3.28-9.81-12.44-16.41-22.78-16.41s-19.5 6.59-22.78 16.41L103 376.36c-1.5 4.58-5.78 7.64-10.59 7.64H80c-8.84 0-16 7.16-16 16s7.16 16 16 16h12.41c18.62 0 35.09-11.88 40.97-29.53L144 354.58l16.81 50.48c4.54 13.51 23.14 14.83 29.5 2.08l7.66-15.33c4.01-8.07 15.8-8.59 20.22.34C225.44 406.61 239.9 415.7 256 416h32c22.05-.01 43.95-4.9 64.01-13.6v61.61zm27.48-118.05A129.012 129.012 0 0 1 288 384v-.03c0-34.35 13.7-67.29 38.06-91.51l120.55-119.87 52.8 52.8-119.92 120.57zM538.2 186.6l-21.19 21.19-52.8-52.8 21.2-21.19c7.73-7.73 20.27-7.74 28.01 0l24.79 24.79c7.72 7.73 7.72 20.27-.01 28.01z"></path></svg>'}},url:function(){return this.urlWithId(TVA.routes.topics)},getPreviewImage:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=this.get("icon_type"),i=this.get(s);switch(s){case"svg_icon":e=o(i);break;case"icon":e=o('<div class="tva-icon-image" style="background-image: url(\''.concat(i,"');\"></div>"))}return t&&e.filter("svg,.tva-custom-icon").css({color:this.get("".concat(t,"_icon_color"))}),e[0].outerHTML},persist:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{loader:!0,showSuccess:!0};return this.set(n({},e),{silent:!0}),this.hasChanged()?(s.loader?this.set("loading",!0):this.trigger("change"),this.save().always((function(){t.set({editing:!1,loading:!1,id:t.get("ID")}),s.showSuccess&&TVE_Dash.success(t.savedMessage)}))):o.Deferred()},isDeletable:function(){return 0!==parseInt(this.get("ID"))},urlWithId:function(e){var t=this.get("ID");return e+(void 0!==t?"/"+t:"")}})},function(e,t,s){var i=s(266),n=s(4),r=s(2),o=s(286);e.exports=r.extend({idAttribute:"id",defaults:{name:""},initialize:function(e){var t;e=e||{},this.get("id")||this.set({order:TVA.products.newItemOrder()||0}),e.sets instanceof Backbone.Collection&&(e.sets=e.sets.toJSON()),e.rules instanceof Backbone.Collection&&(e.rules=e.rules.toJSON()),this.set({rules:new i(e.rules||[]),sets:new TD_SETS.Collections.Sets(e.sets||[])});var s=null===(t=this.get("access_restrictions"))||void 0===t?void 0:t.custom;s instanceof Backbone.Collection&&(s=s.toJSON()),this.get("access_restrictions")&&(this.get("access_restrictions").custom=new o(s||[]),this.get("access_restrictions").custom.invoke("set",{course_id:this.get("id"),scope:"custom"}))},parse:function(){var e,t,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(s.sets instanceof Backbone.Collection&&(s.sets=s.sets.toJSON()),s.rules instanceof Backbone.Collection&&(s.rules=s.rules.toJSON()),s.sets=new TD_SETS.Collections.Sets(JSON.parse(JSON.stringify(s.sets||[]))),s.rules=new i(JSON.parse(JSON.stringify(s.rules||[]))),s.order=parseInt(s.order),s.customers_count=parseInt(s.customers_count),s.access_restrictions)&&(void 0!==this.get("access_restrictions")&&(null===(e=this.get("access_restrictions"))||void 0===e?void 0:e.custom)instanceof Backbone.Collection?(null===(t=this.get("access_restrictions"))||void 0===t?void 0:t.custom)instanceof Backbone.Collection&&(s.access_restrictions.custom=this.get("access_restrictions").custom):(s.access_restrictions.custom=new o(s.access_restrictions.custom||[]),s.access_restrictions.custom.invoke("set",{course_id:s.id,scope:"custom"})));return s},url:function(){var e=this.get("id");return"".concat(TVA.routes.products,"/").concat(e||"")},getRestrictionSummary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"not_logged";return TVA.accessRestriction.options[this.getAccessRestrictionSettings(e).option].replace("(deprecated)","").trim()},getAccessRestrictionSettings:function(e){var t=this.deepGet("access_restrictions.".concat(e),!1);if(!1===t||!t.option){var s=this.get("message");t={option:s?"message":"inherit"},s&&(t.message=this.get("message"))}return t},getDefaultSet:function(){return this.get("sets").length||this.get("sets").add(new TD_SETS.Models.Set),this.get("sets").first()},saveSets:function(){return this.save({wait:!0},{url:"".concat(this.url(),"/sets")})},fetchCourses:function(){var e=this;return new Promise((function(t,s){var i=new n;i.url="".concat(TVA.routes.products,"/").concat(e.get("id"),"/courses"),TVE_Dash.showLoader(),i.fetch({success:function(s){e.set("courses",s),t(s),TVE_Dash.hideLoader()},error:function(){s()}})}))},getContent:function(){var e=[];return this.getDefaultSet()?(this.getDefaultSet().getRules().each((function(t){t.get("value").forEach((function(t){e.push(t.id)}))})),e):[]},assignDripCampaign:function(e,t){var s=new r({campaign_id:e,course_id:t});s.url="".concat(this.url(),"/assign-campaign"),s.save({},{patch:!0})},validateIdentifier:function(){var e=this.get("identifier");return""===e||e&&e.trim().length>3?null:TVA.t.invalid_identifier}})},function(e,t,s){var i,n,r;i=jQuery,n=s(89),r=s(139),e.exports=s(0).extend({menuItem:null,className:"tva-submenu",titleClassName:"tva-submenu-title",afterInitialize:function(){this.listenTo(this.collection,"reset",this.render)},render:function(){var e=this;this.$el.empty().append('<div class="fixed-inner" />'),this.$(".fixed-inner").append(i('<h3 class="'.concat(this.titleClassName,'">').concat(this.menuItem.get("label"),"</h3>"))),this.menuItem instanceof Backbone.Model&&this.menuItem.get("sections")instanceof Backbone.Collection&&this.menuItem.get("sections").each((function(t){e.$(".fixed-inner").append(e.renderSection(t))}));var t=i();return this.collection.each((function(s){if(!s.get("hidden")){var i=e.renderItem(s);s.get("section")?e.$('.tva-submenu-section[data-slug="'.concat(s.get("section"),'"]')).append(i):t=t.add(i)}})),this.$el.toggle(!!t.length),this.$(".tva-submenu-title").after(t),this.$(".tva-submenu-section").hasClass("tva-submenu-simple")||this.$(".tva-submenu-section-title").on("click",(function(t){var s=i(t.currentTarget).parent();s.toggleClass("tva-collapsed"),e.menuItem.get("sections").findWhere({slug:s.data("slug")}).set("expanded",!s.hasClass("tva-collapsed"))})),this},renderItem:function(e){return e.get("items").length?new r({model:e}).render().$el:new n({model:e}).render().$el},renderSection:function(e){return i('<div class="tva-submenu-section '.concat(e.get("expanded")||e.get("simple")?"":"tva-collapsed").concat(e.get("simple")?"tva-submenu-simple":"",'" data-slug="').concat(e.get("slug"),'"><div class="tva-submenu-section-title">').concat(e.get("label"),"</div></div>"))}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r,o,a,c,l;r=jQuery,o=s(0),a=s(81),c=s(211),l=s(6),e.exports=o.extend({className:"tva-restricted-content",template:TVE_Dash.tpl("access-restriction/content-restriction"),title:"",autoSave:!1,availableOptions:Object.keys(TVA.accessRestriction.options),afterInitialize:function(e){var t=this;if(e.scope=e.scope||"not_logged",r.extend(this,e),e.settings instanceof a)this.model=e.settings;else{var s=e.course?e.course.get("id"):"";!s&&e.course_id&&(s=e.course_id),this.model=new a(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({scope:e.scope,course_id:s,custom_id:e.custom_id},e.settings))}switch(this.customPageModel=new c(this.model.deepGet("redirect_custom.post",void 0)),this.listenTo(this.model,"change",(function(){(t.model.changed.option||"message"!==t.model.get("option"))&&t.render()})),this.listenTo(this.customPageModel,"change:value",(function(){t.model.deepSet("redirect_custom.post_id",t.customPageModel.get("value"),{silent:!0}),t.model.deepSet("redirect_custom.title",t.customPageModel.get("title"),{silent:!0}),t.model.deepSet("redirect_custom.custom_link",t.customPageModel.get("custom_link"),{silent:!0}),t.persist(!0)})),this.scope){case"not_logged":this.global_settings?this.availableOptions=this.availableOptions.filter((function(e){return!["message","inherit"].includes(e)})):this.availableOptions=this.availableOptions.filter((function(e){return"show_login_form"!==e})),this.title=TVA.t.access_not_logged;break;case"not_purchased":this.global_settings?this.availableOptions=this.availableOptions.filter((function(e){return!["show_login_form","message","inherit","redirect_login"].includes(e)})):this.availableOptions=this.availableOptions.filter((function(e){return!["show_login_form","redirect_login"].includes(e)})),this.title=TVA.t.access_not_purchased;break;case"locked":this.global_settings?this.availableOptions=this.availableOptions.filter((function(e){return!["show_login_form","redirect_login","message","inherit"].includes(e)})):this.availableOptions=this.availableOptions.filter((function(e){return!["show_login_form","redirect_login","message"].includes(e)})),this.title=TVA.t.access_locked;break;case"custom":this.availableOptions=this.availableOptions.filter((function(e){return!["show_login_form","redirect_login","inherit","message"].includes(e)})),this.title=TVA.t.access_custom}e.title&&(this.title=e.title),r(window).off("storage.tva_settings").on("storage.tva_settings",(function(){var e=localStorage.getItem("tva-login-page-id");null!==e&&(TVA.settings.login_page.value=e?Number(e):0,t.render())}))},afterRender:function(){this.$loader=this.$(".tva-loader"),"redirect_custom"===this.model.get("option")&&this.addChild(new l({el:this.$(".tva-custom-redirect"),model:this.customPageModel,states_views_path:"./page-states/",labels:{search:{title:"Search for a page to use"},normal:{title:""},delete:{title:"Are you sure you want to remove this page?"}}}).render()),"message"===this.model.get("option")&&(this.model.ensureDefaultMessage(),TVA.Utils.renderMCE("tva-restriction-".concat(this.scope),this.model,"message",!0)),TVE_Dash.materialize(this.$el)},options:function(){return _.pick(TVA.accessRestriction.options,this.availableOptions)},fieldChanged:function(e){var t=e.currentTarget.dataset.field,s=e.currentTarget.dataset.value||e.currentTarget.value;"checkbox"===e.currentTarget.type&&(s=e.currentTarget.checked),this.model.deepSet(t,s),this.persist(!0)},persist:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t&&!this.autoSave){this.$loader.tvaToggleLoader(20,!0,{position:"top-right",background:"transparent"}),this.model.ensureDataExists(this.model.get("custom_id")).then((function(){return e.$loader.tvaToggleLoader(!1)}));var i=r.Deferred();return i.resolve(),i.promise()}s&&this.$loader.tvaToggleLoader(20,!0);var n="content"===this.model.get("option")&&!this.model.deepGet("content.post.preview_url");return this.model.save(null,{silent:!n}).done((function(t){return e.trigger("model.sync",e,t)})).always((function(){e.$loader.tvaToggleLoader(!1)})).fail((function(e){return TVE_Dash.err("Something went wrong: "+e.responseText)}))},hasLoginRegistrationPage:function(){return!!TVA.settings.login_page.value}})},function(e,t,s){function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r,o,a,c,l,u,d,h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,e),this.instance=t}var t,s,r;return t=e,(s=[{key:"setInstance",value:function(e){this.instance=e}},{key:"setDate",value:function(){var e;null===(e=this.instance)||void 0===e||e.setDate.apply(this.instance,arguments)}}])&&n(t.prototype,s),r&&n(t,r),e}();r=jQuery,a=window.React,c=window.ReactDOM,l=window.wp.components.DateTimePicker,u=window.wp.date.__experimentalGetSettings||window.wp.date.getSettings,d=window.wp.compose.withState,e.exports=o=s(0).extend({initialize:function(e){this.options=e||{}},render:function(){var e=this,t=document.createElement("div");t.setAttribute("id","tva-datepicker"),this.$el.html(t);var s=this.model,i=this.options,n=i.prop,r=i.dateFormat,o=i.silent,h=i.onChange;r=r||"Y-MM-DD HH:mm";var p=s.get(n);p||(p=new Date);var m=d({date:p})((function(t){var i=t.date,c=t.setState,d=u();e.setDate=function(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t=window.moment(t).format(r),c({date:t}),e.model.set(n,t,s)};var p={currentDate:i,is12Hour:void 0!==e.options.is12HourTime?e.options.is12HourTime:/a(?!\\)/i.test(d.formats.time.toLowerCase().replace(/\\\\/g,"").split("").reverse().join("")),active:e.options.active,__nextRemoveHelpButton:!0,__nextRemoveResetButton:!0,onChange:function(e){e||(e=window.moment().format(r)),c({date:e}),"function"==typeof h&&h(e),s.set(n,window.moment(e).format(r),{silent:o})}};return"function"==typeof e.options.isInvalidDate&&(p.isInvalidDate=e.options.isInvalidDate),a.createElement(l,p)}));return c.render(a.createElement(m),this.$el[0]),this}},{extractDatePart:function(e,t){return e.split(" ")["time"===t?1:0]},renderInline:function(e,t){var s=new o(t);return s.render().$el.appendTo(e),new h(s)},renderPopup:function(e,t){var s=this;e.text()||e.text("Click to set a date / time"),t.active&&e.text(this.extractDatePart(e.text(),t.active));var i=new h;return e.off("click.tva-datepicker").on("click.tva-datepicker",(function(){var n=e.data("tva-datepicker");r(".tva-datepicker-popup").hide();var a=t.el=r('<div class="tva-datepicker-popup tva-drip-datetime"></div>');if(e.parent().css({position:"relative",zIndex:9e5}).append(a),n||(n=new o(t),e.data("tva-datepicker",n),i.setInstance(n)),n.$el.toggle(),!n.rendered){if(n.rendered=!0,n.render(),n.$el.find(".components-datetime__date").last().after('<div style="flex: 1 0 auto" class="tva-flex tva-flex-end"><button type="button" class="components-button components-datetime__time-button components-datetime__button-done is-primary">Done</button></div>'),t.active&&n.model.on("change:".concat(t.prop),(function(i){e.text(s.extractDatePart(i.get(t.prop),t.active))})),n.$el.on("click",".components-datetime__button-done",(function(){n.$el.hide(),t.silent&&n.model.trigger("change")})),t.active)switch(t.active){case"date":n.$el.find(".components-datetime__time").hide();break;case"time":n.$el.addClass("tva-drip-time").find(".components-datetime__date").hide()}e.parents(".tvd-modal-content,body").first().off("click.tva-datepicker-close").on("click.tva-datepicker-close",(function(e){e.target.closest(".tva-datepicker-popup,.tva-popup-datepicker")||n.$el.find(".components-datetime__button-done").trigger("click")}))}return!1})),i}})},function(e,t,s){var i,n;i=jQuery,n=s(0),e.exports=n.extend({template:TVE_Dash.tpl("image-upload"),prop:"url",events:{"click .removeImage":function(){this.model.set(this.prop,"")},"click .uploadImage":function(){TVA.Utils.wpMedia({},this.model,this.prop)}},initialize:function(e){var t=this;i.extend(!0,this,e),this.listenTo(this.model,"change:".concat(this.prop),(function(e){t.setImage(e.get(t.prop))}))},render:function(){return this.$el.html(this.template()),this.setImage(this.model.get(this.prop)),this},setImage:function(e){this.$("p").toggle(!e),this.$el.css("background-image","url('".concat(e||"","')")).toggleClass("w-img",!!e)}})},function(e,t,s){var i,n,r,o;i=jQuery,n=s(0),r=s(7),o=s(150),e.exports=n.extend({className:"tva-box tva-collapsed tva-course-item",numberInList:0,childrenItemsSelector:"",connectWith:!1,expanded:null,initialize:function(e){i.extend(!0,this,e),this.$el.addClass(this.model.get("post_type")),this.$el.toggleClass("tva-collapsed",!this.expanded.has(this.model.get("id"))),this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"expand",this.expand),this.listenTo(this.model,"render",this.render)},afterRender:function(){this.$el.attr({"data-id":this.model.get("ID"),"data-type":this.model.getType(),"data-parent-id":this.model.get("post_parent")}),this.model.get("structure")instanceof r&&this.renderStructure(this.model.get("structure"),this.getItemsList())},editItemTitle:function(e,t){var s=this,n=i(t).closest(".tva-title-holder");n.prepend(new o({model:new Backbone.Model({title:this.model.get("post_title")}),titleTextHolder:n.find(".tva-items-tab-title"),save:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";s.model.set("post_title",e);var t=s.model.get("structure");s.model.save().done((function(){s.model.set({structure:t},{silent:!0})}))}}).render().$el),e.stopPropagation()},copyID:function(){return TVE_Dash.copyToClipboard(this.model.get("ID"),"Copied to Clipboard"),!1},renderStructure:function(e,t){},getItemsList:function(){return this.$(".tva-".concat(this.model.get("structure").getType(),"-list"))},expand:function(){this.$el.removeClass("tva-collapsed"),this.expanded.add(this.model.get("id"))},getFreemiumLabel:function(){return{free:TVA.t.free_for_all,"free-for-logged":TVA.t.free_for_logged}[this.model.get("freemium")]}})},function(e,t,s){var i,n,r,o;i=jQuery,n=s(46),r=s(10),o=s(86),e.exports=n.extend({template:TVE_Dash.tpl("courses/lesson"),className:"tva-box tva-course-item",afterRender:function(){var e=this;n.prototype.afterRender.apply(this,arguments),this.model.newly_added&&!this.className.includes("tva-highlight-lesson")&&(this.$el.addClass("tva-highlight-lesson"),setTimeout((function(){e.$el.removeClass("tva-highlight-lesson"),e.model.newly_added=!1}),2e3))},deleteItem:function(e,t){var s=this;e.stopPropagation();var n=new r({template:TVE_Dash.tpl("courses/delete-lesson"),className:"tva-delete-simple",confirm:function(){var e;s.model.get("post_parent")>0&&(e=s.model.getHighestParent()),s.model.destroy(),e&&e.collection.trigger("destroy",new Backbone.Model),s.course.trigger("tva.structure.status.changed")},cancel:function(){this.$el.siblings(".tva_lesson-right").removeClass("tvd-hide"),this.remove()}}).render();i(t).parents(".tva-course-item.tva_lesson").first().append(n.$el).find(".tva_lesson-right").addClass("tvd-hide")},duplicateItem:function(e,t){var s=this;e.stopPropagation();var i=parseInt(t.dataset.id),n=this.course.get("structure"),r=n.findItem(i).get("order");wp.apiRequest({url:"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v2,"/lessons/duplicate"),type:"POST",data:{id:i}}).done((function(e){var t=new o(e);t.newly_added=!0,0===e.post_parent?s.shiftStructure(n,r,t):s.shiftStructure(n.findItem(e.post_parent).get("structure"),r,t),s.course.trigger("tva.structure.modified",t)})).fail((function(e){TVE_Dash.err(e.responseJSON.message)}))},shiftStructure:function(e,t,s){e.forEach((function(e){var s=e.get("order");s>t&&e.set("order",s+1)})),e.add(s)}})},function(e,t,s){e.exports=s(17).extend({template:TVE_Dash.tpl("courses/forms/chapter"),afterRender:function(){TVE_Dash.data_binder(this)}})},function(e,t,s){var i,n,r,o;i=jQuery,n=s(45),r=s(94),o=s(17),e.exports=o.extend({template:TVE_Dash.tpl("courses/forms/lesson"),$types:null,afterInitialize:function(){this.listenTo(this.model,"change:lesson_type",(function(e,t){this.toggleOptions(t)}))},afterRender:function(){var e,t;this.$types=this.$("#tva-lesson-type"),(e=this.$types,t=TVA.lessonTypes,t.forEach((function(t){var s=i("<option/>").val(t).text("".concat(TVE_Dash.upperFirst(t)," lesson"));e.append(s)})),e).val(this.model.get("lesson_type")),this.$("#tva-comment-status").val(this.model.get("comment_status")),this.$("#tva-freemium").val(this.model.get("freemium")),this.toggleOptions(this.model.get("lesson_type")),new n({el:this.$("#tva-lesson-image"),model:this.model,prop:"cover_image"}).render(),TVE_Dash.data_binder(this),new r({types:["youtube","vimeo","wistia","custom"],model:this.model.get("video"),el:this.$("#tva-lesson-video-options")}).render(),new r({types:["soundcloud","custom"],model:this.model.get("audio"),el:this.$("#tva-lesson-audio-options")}).render()},toggleOptions:function(e){this.$("#tva-lesson-options >").hide(),this.$("#tva-lesson-".concat(e,"-options")).show()}})},function(e,t,s){var i=s(45);e.exports=s(17).extend({template:TVE_Dash.tpl("courses/forms/module"),afterRender:function(){this.$("#tva-comment-status").val(this.model.get("comment_status")),this.$("#tva-freemium").val(this.model.get("freemium")),TVE_Dash.data_binder(this),new i({el:this.$("#tva-module-image"),model:this.model,prop:"cover_image"}).render()}})},function(e,t,s){var i=s(0),n=s(98),r=s(41),o=s(25);e.exports=i.extend({template:TVE_Dash.tpl("products/course-tab"),templateNoProducts:TVE_Dash.tpl("products/course-tab-no-items"),tooltipKey:"access-restrictions-product",afterInitialize:function(){var e=this;this.listenTo(this.collection,"total-changed",(function(){e.model.fetchProducts().then((function(){e.collection.reset(e.model.get("products"),{silent:!0}),e.render(),e.tabModel&&e.tabModel.set({counter:e.collection.length}),e.trigger("refresh-tab-title"),TVA.products.resetFilters().fetch({reset:!0})}))})),this.listenTo(this.collection,"add destroy",this.renderRules)},onActivate:function(){this.render()},afterRender:function(){var e=this;return this.$productsList=this.$(".tva-products-wrapper"),this.$tooltip=this.$(".tva-product-info-tooltip"),this.renderRules(),0!==this.collection.length&&this.$tooltip.length&&!TVA.Utils.isTooltipViewed(this.tooltipKey)&&requestAnimationFrame((function(){return e.showTooltip()})),this},renderRules:function(){0!==this.collection.length?(this.$productsList.empty(),this.childItemViews&&this.childItemViews.forEach((function(e){return e.destroy()})),this.childItemViews=[],this.collection.each(this.renderOne,this),this.addChild(this.childItemViews)):this.$el.html(this.templateNoProducts())},renderOne:function(e){var t=new o({model:e,backTerm:this.model.get("id"),collection:this.collection,allowDrag:!1,showCustomersNumber:!1,showTooltipDot:!1});this.$productsList.append(t.render().$el),this.childItemViews.push(t)},addNewProduct:function(e,t){this.openModal(n,{collection:TVA.products,productModel:new r({name:this.model.get("name")}),screen:t.getAttribute("data-screen"),setModel:new TD_SETS.Models.Set({post_title:this.model.get("name"),post_content:[{content_label:{singular:"Course",plural:"Courses"},content_type:"term",content:"tva_courses",field:"title",operator:"===",value:[{id:parseInt(this.model.get("id")),text:this.model.get("name")}]}]}),width:"760px",className:"tvd-modal tva-new-product-modal"})},toggleCourseOverview:function(e,t){this.model.set({protect_overview:Number(t.checked)},{silent:!0}),this.model.save()},linkToRules:function(){jQuery("html, body").animate({scrollTop:0},0),this.changeView("products/".concat(this.collection.first().get("id"),"/rules"))},showTooltip:function(){this.$tooltip.addClass("tva-visible")},hideTooltip:function(){var e=this;return this.$tooltip.addClass("tva-out"),setTimeout((function(){return e.$tooltip.removeClass("tva-visible tva-out")}),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function a(e){return function(){var t=this,s=arguments;return new Promise((function(i,n){var r=e.apply(t,s);function a(e){o(r,i,n,a,c,"next",e)}function c(e){o(r,i,n,a,c,"throw",e)}a(void 0)}))}}var c=TD_SETS.Views.Rule,l=s(23),u=new(s(24)),d=TD_SETS.Models.Rule.extend({orderSteps:["content","field","value"],currentPage:1,currentSearch:"",defaults:function(){return{content_type:"",content:"",field:"",operator:"===",value:""}},fetchSuggestions:function(){var e=arguments,t=this;return a(regeneratorRuntime.mark((function s(){var i,n;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return i=e.length>0&&void 0!==e[0]?e[0]:"",n=e.length>1&&void 0!==e[1]?e[1]:1,t.currentPage=n,t.currentSearch=i,s.abrupt("return",u.fetch(t,i,n));case 5:case"end":return s.stop()}}),s)})))()},loadNextPage:function(){var e=this;return a(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.fetchSuggestions(e.currentSearch,e.currentPage+1));case 1:case"end":return t.stop()}}),t)})))()},hasMoreContent:function(){return u.hasMore(this,this.currentSearch)}}),h=["tva_lesson","tva_module","tva_courses","published_date"],p=c.extend({template:TVE_Dash.tpl("products/partials/add-content"),selected:[],afterInitialize:function(e){var t=this;e.contentSet=this.contentSet=e.contentSet||new TD_SETS.Models.Set,e.model=this.model=new d(e.ruleModelArgs||{}),e.collection=this.collection=e.contentSet.getRules(),c.prototype.afterInitialize.apply(this,arguments),this.listenTo(this.model,"searching",this.onSearch),this.listenTo(this.model,"searching-done",this.renderResults),this.listenTo(this.model,"change:content_type change:content",(function(){return t.$list.html("")})),this.listenTo(this.model,"change:content_type change:content",this.onSelectionChanged),this.preselected=e.preselected,this.existingValues=e.existingValues||[]},afterRender:function(){c.prototype.afterRender.call(this),this.$list=this.$("#tva-form-item-list").on("scroll",_.debounce(this.onScroll.bind(this),100,!1))},getStepOptions:function(e){var t,s=(null===(t=c.prototype.getStepOptions.call(this,e))||void 0===t?void 0:t.filter((function(e){return!h.includes(e.value)})))||[];return"field"===e&&(s=s.filter((function(e){return!["-1"].includes(e.value)})),("archive"===this.model.get("content_type")||"term"===this.model.get("content_type")&&"category"===this.model.get("content"))&&((s=s.slice(0,1)).push({value:"title",label:"Category"}),s.push({value:"author",label:"Author"}))),s},getStepView:function(e){return"value"===e&&this.model.get("field")!==TD_SETS.fields.published_date?s(53):c.prototype.getStepView.apply(this,arguments)},onSearch:function(e){var t="html",s="Getting results...";1!==e&&(t="append",s="Getting more results..."),this.$(".tva-searching-text").remove(),this.$list[t]('<div class="tva-text-center tva-searching-text tva-form-text p-10"><em>'.concat(s,"</em></div>"))},renderResults:function(e,t){var s=this;this.$(".tva-searching-text").remove();var i="",n=this.selected.map((function(e){return e.id})),r=this.preselected[l.ruleKey(this.model)]||[];e.forEach((function(e){var t=r.includes(e.id);i+=l.checkboxTemplate(e,t||n.includes(Number(e.id)),t&&!s.existingValues.includes(parseInt(e.id)))}));var o=1===t?"html":"append";i?this.$list[o](i):this.$list[o](l.noResultsTemplate(t))},onSelectionChanged:function(){this.selected=Array.from(this.$list.find("input:checked").map((function(e,t){return{id:Number(t.value),text:t.dataset.text}}))),this.trigger("selection-changed",this.hasSelection())},hasSelection:function(){return!!this.selected.length||this.forceCompleteSteps()},onScroll:function(e){var t=this;return a(regeneratorRuntime.mark((function s(){var i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(i=e.currentTarget,!(!t.loadingNextPage&&t.model.hasMoreContent()&&i.scrollTop>=i.scrollHeight-i.offsetHeight-50)){s.next=6;break}return t.loadingNextPage=!0,s.next=5,t.model.loadNextPage();case 5:t.loadingNextPage=!1;case 6:case"end":return s.stop()}}),s)})))()},getData:function(){return jQuery.extend(!0,{},n(n({},this.model.toJSON()),{},{value:this.selected}))}},{renderTo:l.renderTo});e.exports=p},function(e,t){e.exports=TD_SETS.Views.Controls.Base.extend({className:"tvd-content-set-rule-step tva-filter-search ml-50",template:TVE_Dash.tpl("products/content-sets/controls/search-input"),afterInitialize:function(){TD_SETS.Views.Controls.Base.prototype.afterInitialize.apply(this,arguments),this.listenTo(this.ruleModel,"searching",this.toggleLoader.bind(this,!0)),this.listenTo(this.ruleModel,"searching-done",this.toggleLoader.bind(this,!1))},afterRender:function(){var e=this;this.$iconWrapper=this.$(".tva-search-icon"),requestAnimationFrame((function(){return e.ruleModel.fetchSuggestions("")}))},onFilterInput:function(e){var t=this;clearTimeout(this.inputTimeout);var s=e.currentTarget.value;this.inputTimeout=setTimeout((function(){t.ruleModel.fetchSuggestions(s,1)}),200)},toggleLoader:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$iconWrapper.tvaToggleLoader(16,e,{position:"left-center",background:"#fff",fadeDuration:300})}})},function(e,t,s){var i=s(10);e.exports=s(0).extend({className:"tva-rule-item-wrapper",template:TVE_Dash.tpl("products/partials/rule-item"),afterInitialize:function(e){this.setModel=e.setModel},afterRender:function(){var e=this;switch(this.deleteWarning="",this.dataVal="",this.$type=this.$(".tva-rule-item-content-type"),this.$data=this.$(".tva-rule-item-content-data"),this.$icon=this.$(".tva-rule-item-content-icon"),this.$type.html("".concat(1===this.model.get("value").length?this.model.get("content_label").singular:this.model.get("content_label").plural)),this.model.get("content_type")){case"term":switch(this.model.get("content")){case"tva_courses":this.$icon.html(TVA.Utils.icon("book_light"))}break;case"post":switch(this.model.get("content")){case"page":this.$icon.html(TVA.Utils.icon("file-alt_light"));break;case"post":this.$icon.html(TVA.Utils.icon("feather_light"));break;case"product":this.$type.html("".concat(1===this.model.get("value").length?"WooCommerce product":"WooCommerce products")),this.$icon.html(TVA.Utils.icon("hand-holding-box_light"))}break;case"tvd_blog_page":case"tvd_search_result_page":break;case"archive":this.$type.append(" of");break;default:this.$type.html("Custom content")}switch(this.model.get("field").toString()){case"title":this.$type.append(":");break;case"-1":break;case"author":"archive"!==this.model.get("content_type")&&this.$type.html("".concat(this.model.get("content_label").plural," by")),this.$type.append(" ".concat(this.model.get("field"),":"));break;case"category":this.$type.html("".concat(this.model.get("content_label").plural," with  ").concat(this.model.get("field"),":"));break;case"topic":case"tag":case"difficulty":this.$type.html("".concat(this.model.get("content_label").plural," with ").concat(this.model.get("field"),":"));break;default:this.$type.append(" with ".concat(this.model.get("field"),":"))}this.deleteWarning+="".concat(this.$type.html()," "),this.model.get("value").forEach((function(t){e.deleteWarning+="".concat(t.text,", "),"tva_courses"===e.model.get("content")&&"title"===e.model.get("field")?e.dataVal+='<div data-id="'.concat(t.id,'">').concat(t.text,"</div>"):e.dataVal+='<span data-id="'.concat(t.id,'">').concat(t.text,"</span>, ")})),"tva_courses"===this.model.get("content")&&"title"===this.model.get("field")&&this.$data.addClass("tva-flex tva-flex-column"),this.$data.html(this.dataVal.replace(/,\s*$/,""))},delete:function(){var e=this,t=this;this.$el.append(new i({template:TVE_Dash.tpl("products/partials/delete-rule"),className:"tva-delete-simple",afterRender:function(){this.$(".tva-content-details").html(t.deleteWarning.replace(/,\s*$/,""))},confirm:function(){e.$el.tvaToggleLoader(),e.collection.remove(e.model),TVA.customers.reset(),e.setModel.get("ID")?e.setModel.save({return_one:1}).done((function(){return e.destroy().remove()})):e.destroy().remove()}}).render().$el)},edit:function(){this.setModel.getRules().trigger("edit-rule",this)}})},function(e,t,s){var i,n,r;i=jQuery,n=s(3),r=["inherit","message","content","redirect_login","redirect_custom"],e.exports=n.extend({template:TVE_Dash.tpl("modals/course-access-restriction"),title:TVA.t.access_restriction_edit,sourceModel:null,saving:!1,afterRender:function(){this.contentRestriction.model&&(this.sourceModel=this.contentRestriction.model.deepClone()),this.$(".tva-content-restriction").html(this.contentRestriction.render().$el)},afterOpen:function(){this.$el.css("overflow","visible")},onClose:function(){this.sourceModel&&!1===this.saving&&(this.contentRestriction.model.deepSet("option",this.sourceModel.get("option")),this.sourceModel.save()),this.saving=!1},save:function(){var e=this,t=this.contentRestriction.model.validateOptions();if(!0!==t)return TVE_Dash.err(t);this.showLoader(),this.saving=!0,this.contentRestriction.model.save().done((function(t){var s=i.extend(!0,{},e.contentRestriction.model.attributes);r.forEach((function(e){s.option!==e&&delete s[e]})),"redirect_custom"===s.option&&(s.redirect_custom.post=e.contentRestriction.customPageModel.attributes),"custom"!==s.scope&&(s.course_id=e.course.id,e.course.deepSet("access_restrictions.".concat(s.scope),s)),e.contentRestriction.trigger("model.sync",e,t),e.accessTab.render(),e.close(),TVE_Dash.success(TVA.t.SuccessSettings)})).fail((function(e){return TVE_Dash.err("Something went wrong: "+e.responseText)})).always((function(){return e.hideLoader()}))}})},function(e,t,s){var i,n;i=jQuery,n=s(82),e.exports=s(0).extend({template:TVE_Dash.tpl("pagination"),noItemTemplate:TVE_Dash.tpl("noItems"),initialize:function(e){if(!(e&&e.collection&&e.collection instanceof n))throw Error("pagination collection has to be provided for this view");i.extend(!0,this,e),this.listenTo(this.collection,"fetched",this.render),this.listenTo(this.collection,"fetching",this.fetching)},render:function(){if(0===this.collection.length)return this.$el.html(this.noItemTemplate());var e=this.collection.pageInfo();this.$el.html(e.totalPages>1?this.template(e):"")},previousPage:function(){this.collection.prev()},nextPage:function(){this.collection.next()},fetching:function(){this.$el.html("Loading...")}})},function(e,t,s){var i=s(0);e.exports=i.extend({template:TVE_Dash.tpl("design/preview"),initialize:function(){i.prototype.initialize.apply(this,arguments),this.render()},render:function(){var e=this.getPreviewBaseUrl().replace(/^https?\:/i,"");return e+=-1===e.indexOf("?")?"?":"&",e+="tpl=".concat(this.model.get("template").ID,"&"),e+=this.model.get("advanced")?"tva_advanced=1&":"",this.$el.html(this.template({url:e})),this},getPreviewBaseUrl:function(){return"design-legacy/index"===Backbone.history.getFragment()?TVA.indexPageModel.get("preview_url"):TVA.Utils.getPreviewUrl()}})},function(e,t,s){var i,n,r,o;i=jQuery,n=s(11),r=s(13),o={safe:s(27),google:s(59)},TVA.Utils.FontManager=s(60),e.exports=r.extend({template:TVE_Dash.tpl("design/template"),templateData:{},fontOptions:{safe:TVA.t.design_tab.fonts.safe,google:TVA.t.design_tab.fonts.google},initialize:function(){var e=this;TVA.design.fonts.google=TVA.Utils.FontManager.get_google_fonts(),this.frame=wp.media({title:"Select or Upload Your Logo",button:{text:"Use this logo"},multiple:!1,library:{type:"image"}}),this.frame.on("select",(function(){var t=e.frame.state().get("selection").first().toJSON();0===n.getLogo().length&&n.addImageLogo(),n.changeLogo({src:t.url},{width:"".concat(e.model.get("template").logo_size||300,"px"),"max-width":"600px","max-height":"300px"}),e.model.get("template").logo_type=!1,e.model.get("template").logo_url=t.url,e.render(),e.$(".tva-logo-image").closest(".tva-settings-card").find(".tva-settings-card-title").trigger("click"),TVE_Dash.materialize(e.$el)})),r.prototype.initialize.apply(this,arguments)},render:function(){var e=this;this.$el.empty().html(this.template({model:this.model})),this.templateData=this.model.get("template"),Object.keys(this.fontOptions).forEach((function(t){var s=i("<option/>"),n={value:t};e.templateData.font_source===t&&(n.selected=!0),s.attr(n).text(e.fontOptions[t]),e.$("#tva-fonts-source").append(s)})),this.renderFonts(null,{value:this.templateData.font_source}),this.$(".tva-logo-text")[this.templateData.logo_type?"show":"hide"](),this.$(".tva-logo-image")[this.templateData.logo_type?"hide":"show"](),this.$(".tva-logo-input, .tva-change-logo-button")[this.templateData.logo_type?"hide":"show"]();var t=this.$("#tva-main-color-select").attr("name");return this.$("#tva-main-color-select").spectrum({type:"component",showPalette:!1,showAlpha:!1,allowEmpty:!1,chooseText:"Apply",change:function(s){e.model.get("template")[t]=s?s.toHexString():""},move:function(e){var s=e?e.toHexString():"";n.changeMainColorCallback(t,s)},cancel:function(e){var s=e?e.toHexString():"";n.changeMainColorCallback(t,s)}}),this.$("#tva-main-color-select").on("input",(function(s){/^#([0-9A-F]{3}){1,2}$/i.test(s.target.value)&&(e.model.get("template")[t]=s.target.value)})),this},renderFonts:function(e,t){var s=t.value;o[s]&&(this.fontView instanceof Backbone.View&&this.fontView.removeEventsFromView(),this.fontView=new o[s]({el:this.$("#tva-fonts"),fonts:TVA.design.fonts[s],model:this.model,selected:this.templateData.font_family}),e&&this.fontView instanceof Backbone.View&&(this.model.get("template").font_source=s,this.fontView.$(".tva-fonts-select").trigger("change"),TVE_Dash.materialize(this.fontView.$el)))},changeLogo:function(){this.frame.open()},changeLogoType:function(e,t){this.model.get("template").logo_type=t.checked,this.model.get("template").logo_url="",n.getIframe().find(".lg").empty(),this.$(".tva-logo-image input, #tva-logo-text").val(""),this.$(".tva-logo-input, .tva-change-logo-button").toggle(!t.checked),this.$(".tva-logo-text").toggle(t.checked),this.$(".tva-logo-image").toggle(!t.checked),t.checked&&(this.model.get("template").logo_size=50,this.$("#tva_logo_size_input,#tva_logo_size").val(this.model.get("template").logo_size))},sliderInput:function(e,t){r.prototype.sliderInput.apply(this,arguments);var s=t.getAttribute("name");"logo_size"===s&&(n.styleIframeElements(".tva-img-logo","width","".concat(t.value,"px")),this.model.get("template").logo_type&&n.styleIframeElements(".header-logo > a,.header-logo > a > .tva_text_logo_size","font-size","".concat(t.value,"px")))},changeLogoText:function(e,t){n.changeText(".lg",t.value),n.styleIframeElements(".lg","font-size","".concat(this.model.get("template").logo_size,"px")),n.styleIframeElements(".lg","color",this.model.get("template").main_color),this.model.get("template").logo_url=t.value}})},function(e,t,s){var i,n,r;i=jQuery,n=s(27),r=s(11),e.exports=n.extend({template:TVE_Dash.tpl("design/fonts/google"),variants:{bold:[],regular:[]},afterRender:function(){this.$regular=this.$("#tva-regular-select").empty(),this.$bold=this.$("#tva-bold-select").empty(),this.$charset=this.$("#tva-charset-select").empty();var e=this.model.get("template").font_family;return this.renderVariants(e),this.renderCharset(e),this},renderVariants:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.variants.bold=[],this.variants.regular=[];var s=this._getFontObj(t);s&&Array.isArray(s.variants)&&s.variants.forEach((function(t){-1===t.indexOf("italic")&&("bold"===t||/^-?\d+$/.test(t)&&parseInt(t)>400?e.variants.bold.push(t):e.variants.regular.push(t))})),Object.keys(this.variants).forEach((function(t){if(0===e.variants[t].length)e["$"+t].parent().hide();else{e["$"+t].empty().parent().show();var s=e.model.get("template")["font_".concat(t)];e.variants[t].forEach((function(n){var r=i("<option/>"),o={value:n};s===n&&(o.selected=!0),r.attr(o).text(n),e["$"+t].append(r)}))}}))},renderCharset:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=this._getFontObj(t);if(s&&Array.isArray(s.subsets)&&s.subsets.length){this.$charset.empty().parent().show();var n=this.model.get("template").font_charset;s.subsets.forEach((function(t){var s=i("<option/>"),r={value:t};n===t&&(r.selected=!0),s.attr(r).text(t),e.$charset.append(s)}))}else this.$charset.parent().hide()},changeFont:function(e,t){n.prototype.changeFont.apply(this,arguments),this.renderVariants(t.value),this.renderCharset(t.value),this.model.get("template").font_regular=this.$regular.val(),this.model.get("template").font_bold=this.$bold.val(),this.model.get("template").font_charset=this.$charset.val(),this._applyFont(),TVE_Dash.materialize(this.$el)},changeFontProperty:function(e,t){this.model.get("template")[t.getAttribute("data-template-font-prop")]=t.value,this._applyFont()},_applyFont:function(){var e={family:this.model.get("template").font_family,variants:[this.model.get("template").font_regular,this.model.get("template").font_bold],subset:this.model.get("template").font_charset};this.model.get("template").font_url=TVA.Utils.FontManager.generate_link(e),r.addFontToHead(this.model.get("template").font_url)},_getFontObj:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.fonts.find((function(t){return t.family===e}))||null}})},function(e,t){var s;s=jQuery,e.exports={_api:"https://www.googleapis.com/webfonts/v1/webfonts",_key:"AIzaSyDJhU1bXm2YTz_c4VpWZrAyspOS37Nn-kI",generate_link:function(e){var t=[];return t.push("//fonts.googleapis.com/css?family="),t.push(e.family.replace(/ /g,"+")),t.push(":"),t.push(e.variants.join(",")),t.push("&subset="),t.push(e.subset),t.join("")},get_google_fonts:function(){var e=TVA.Utils.LocalStorage.get("ta_google_fonts");return e&&e.length||(s.ajax({method:"GET",url:this._api,dataType:"json",async:!1,cache:!0,data:{key:this._key}}).done((function(t){e=t.items||[]})).fail((function(){e=[]})),TVA.Utils.LocalStorage.set("ta_google_fonts",e)),e}}},function(e,t,s){!function(){function t(e){return e.getAttribute("name")}var i=s(13),n=s(11);e.exports=i.extend({template:TVE_Dash.tpl("design/advanced"),initialize:function(e){var t=this;this.available_settings=e.available_settings,i.prototype.initialize.apply(this,arguments),TVA.design.$el.on("tva_iframe_loaded",(function(){n.collapse(t.model.get("template"))}))},render:function(){return this.$el.empty().html(this.template({template:this.model.get("template"),available_settings:this.available_settings})),this.addColorPickers(),this},addColorPickers:function(){var e=this;this.$("#tva-headline-color, #tva-paragraph-color, #tva-course-title-color").spectrum({type:"component",showPalette:!1,showAlpha:!1,allowEmpty:!1,chooseText:"Apply",change:function(s){var i=t(this);e.model.get("template")[i]=s?s.toHexString():""},move:function(e){var s=e?e.toHexString():"",i=t(this).replace("_color","");n.styleIframeElements(".tva_".concat(i),"color",s)},cancel:function(e){var s=e?e.toHexString():"",i=t(this).replace("_color","");n.styleIframeElements(".tva_".concat(i),"color",s)}})}})}(jQuery)},function(e,t,s){e.exports=s(0).extend({template:TVE_Dash.tpl("design/new/skin-filters"),afterInitialize:function(){this.listenTo(this.model,"tva_dash:filter",this.render),this.listenTo(this.model,"tva_dash:filterByModel",this.filterByModel)},before_render:function(){this.counter=0},after_render:function(){this.$filterTitle=this.$(".templates-title"),this.$counter=this.$(".templates-counter")},toggleDropdown:function(){this.$(".ttd-dropdown-w-count").toggleClass("ttd-dwc-selected")},mainFilter:function(e){var t=e.currentTarget.dataset.template;this.toggleDropdown(),this.model.setOptions({title:t,template:t})},filterByModel:function(e){var t={title:"",template:""};e.isHomepage()?t.title=t.template="homepage":e.isLesson()?t.title=t.template="lesson":e.isModule()?t.title=t.template="module":e.isCourse()?t.title=t.template="course":e.isCompleted()&&(t.title=t.template="course_completed"),this.model.setOptions(t)}})},function(e,t,s){var i=s(87);e.exports=s(0).extend({template:TVE_Dash.tpl("design/new/skin-template-item"),className:"theme-template",afterInitialize:function(e){var t=this;this.optionsTooltip=e.optionsTooltip,this.filterModel=e.filterModel,this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change",this.render),this.el.addEventListener("mouseleave",(function(){return t.el.classList.remove("tooltip-open")}))},afterRender:function(){this.$el.css("order",this.model.getOrder()).attr("data-primary",this.model.primary()).attr("data-secondary",this.model.secondary())},delete:function(){var e=this;TVA.Utils.confirmation(TVA.t.skin_template_delete_confirmation).then((function(){e.model.destroy()}))},reset:function(){var e=this;TVA.Utils.confirmation(TVA.t.skin_template_reset_confirmation).then((function(){e.model.save({action:"reset_template"},{wait:!0,success:function(){TVE_Dash.success("Template has been <b>reset</b> to default.")}})}))},editTitle:function(){var e=this;this.$(".template-name").tvaInlineEdit().one("change",(function(t,s){e.model.save({post_title:s,action:"update_fields",fields:{post_title:s}},{wait:!0,success:function(){return e.render()&&TVE_Dash.success("Title <b>changed</b> successfully!")},error:function(){return TVE_Dash.err("Error saving the title!","error")}})})),this.$el.removeClass("tooltip-open")},makeDefault:function(){var e=this;if(1===parseInt(this.model.meta("default")))return!1;this.model.meta("default",1),this.model.save({action:"make_default"},{wait:!0,success:function(){e.collection.forEach((function(t){e.model.get("ID")!==t.get("ID")&&e.model.primary()===t.primary()&&e.model.secondary()===t.secondary()&&e.model.format()===t.format()&&(t.meta("default",0),t.trigger("change",t))})),e.render(),TVE_Dash.success("The template is now <b>default</b> !")},error:function(){TVE_Dash.err("Error making template default!")}})},duplicate:function(){var e=this,t=new i({meta_input:{primary_template:this.model.primary(),secondary_template:this.model.secondary(),format:this.model.format(),default:0},thumbnail:this.model.get("thumbnail"),post_title:"Copy of ".concat(this.model.get("post_title"))});t.skin_id=this.model.collection.skin_id,t.save({inherit_from:this.model.get("ID")},{wait:!0,success:function(s,i){e.filterModel.trigger("tva_dash:filterByModel",t),e.model.collection.reset(i),TVE_Dash.success("Template <b>duplicated</b> successfully!")},error:function(){TVE_Dash.err("Error creating template!")}})},showOptionsTooltip:function(){this.optionsTooltip.$(".ttd-template-preview-url").toggleClass("tva-hide",!this.model.canPreview()),this.optionsTooltip.$('.ttd-tooltip-row[data-fn="delete"]').toggleClass("default",!this.model.canDelete()),this.optionsTooltip.$('.ttd-tooltip-row[data-fn="makeDefault"]').toggleClass("default",!this.model.canMakeDefault()),this.optionsTooltip.$(".ttd-template-preview-url").attr("href",this.model.get("preview_url")),this.$el.append(this.optionsTooltip.$el.css({bottom:70})),this.$el.toggleClass("tooltip-open")}})},function(e,t,s){var i;i=jQuery,e.exports=s(0).extend({template:"design/wizard/sidebar",stepTemplate:"design/wizard/sidebar/steps",afterInitialize:function(e){this.skin=e.skin,this.model.on("change",this.render.bind(this))},afterRender:function(){var e=this;this.$dom={},this.model.sections.forEach((function(t){return e.$dom[t.id]=e.$("#wizard-section-".concat(t.id))})),this.renderSteps(),this.$(".scrollbar-inner").scrollbar()},toggleCollapse:function(e,t){t.closest(".collapsible").classList.toggle("collapse"),i(t).next(".section-steps").slideToggle(200)},renderSteps:function(){var e=this,t=1,s=TVE_Dash.tpl(this.stepTemplate);this.model.sections.forEach((function(i){var n=e.model.getSteps(i.id);e.$dom[i.id].html(s({view:e,steps:n,baseIndex:t})),t+=n.length}))},stepClick:function(e){this.model.gotoStep(e.currentTarget.dataset.step),TVA.wizardView.hideTooltip()},restart:function(){return this.model.isNew=function(){return!1},TVE_Dash.showLoader(),this.model.destroy().then((function(){return location.reload()})),!1}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a;o=s(0),a=s(172),e.exports=o.extend({template:"design/wizard/top",structureModals:[],events:function(){return n(n({},o.prototype.events),{},{"mousedown .ttd-wizard-selector *":function(){return!1}})},previousClick:function(e){e.isDefaultPrevented()||(this.parent.hideTooltip(!0),this.model.previous())},render:function(){return this.model.hasTopBar()?o.prototype.render.apply(this,arguments):(this.$el.html(""),this)},openTemplatesModal:function(){this.openModal(a,{model:this.model,className:"tvd-modal tvd-modal-templates"})},selectorClick:function(){return this.openTemplatesModal(),!1}})},function(e,t,s){var i;i=s(0),e.exports=i.extend({template:TVE_Dash.tpl("design/wizard/list-section"),afterInitialize:function(e){this.title=e.title,this.items=e.items,this.view=e.view},render:function(){var e=this,t="";_.each(this.items,(function(s){t+=e.view.item({model:e.view.model,item:s,itemClass:e.view.itemClass.replace(".","")})}));var s=this.template({title:this.title,sectionContent:t});return this.$el.html(s),this}})},function(e,t,s){var i,n,r;i=jQuery,r=s(0).extend({template:"design/wizard/overlay-logo",beforeMainRender:function(e){this.wizard=e.model,this.logos=e.model.deepGet("settings.logo",{}),this.logoDark=this.logos.dark,this.logoLight=this.logos.light,this.model.set({attachment_light_id:this.logoLight.attachment_id,light_src:this.logoLight.src,attachment_dark_id:this.logoDark.attachment_id,dark_src:this.logoDark.src},{silent:!0})},afterInitialize:function(){var e=this;this.model=new Backbone.Model({attachment_id:"",src:""}),(n=n||wp.media({title:"Select or upload an image",button:{text:"Use this image"},library:{type:"image"}})).on("select",(function(){var t=n.state().get("selection").first().toJSON(),s=e.model.get("opened");e.$(".logo-"+s).css("background-image","url("+t.url+")"),"light"!==s&&"default"!==s||e.model.set({attachment_light_id:t.id,light_src:t.url},{silent:!0}),"dark"!==s&&"default"!==s||e.model.set({attachment_dark_id:t.id,dark_src:t.url},{silent:!0}),"default"===s&&(e.logoDark.attachment_id=e.logoLight.attachment_id=e.model.get("attachment_dark_id"),e.logoDark.src=e.logoLight.src=e.model.get("dark_src"),e.wizard.setStepData({dark_id:e.model.get("attachment_dark_id")},!0),e.wizard.setStepData({light_id:e.model.get("attachment_dark_id")},!0),e.render())})),this.listenTo(this.model,"change:src",this.render)},getRenderParams:function(){return this.model.set({attachment_id:this.logoDark.attachment_id||"",src:this.logoDark.src||""},{silent:!0}),{model:this.model}},afterRender:function(){var e=this,t=this;this.$(".logo-light, .logo-dark").hover((function(){i(this).children().toggle()})),""===this.logos.tva_logo_tooltip&&setTimeout((function(){e.$(".ttb-mega-tooltip").addClass("ttb-tooltip-visible")}),100),this.$(".ttb-mega-tooltip-acknowledge").click((function(){t.logos.tva_logo_tooltip=1,i(this).parent().parent().hide(),wp.apiRequest({type:"post",url:"".concat(TVA.routes.settings_v2,"/user-meta"),data:{meta_key:"tva_logo_tooltip",meta_value:1}})}));var s=this.logos.preview_url.src.replace(/\\/g,"/");this.$(".logo-default").css("background-image",'url("'+s+'")'),parseInt(this.logoDark.attachment_id)&&this.$(".logo-button").css("background-image","url("+this.logoDark.src+")"),parseInt(this.logoLight.attachment_id)&&this.$(".logo-light").css("background-image","url("+this.logoLight.src+")")},openMedia:function(e){var t=e.currentTarget.classList;t.contains("logo-light")?this.model.set("opened","light"):t.contains("logo-default")||t.contains("upload-logo-text")?this.model.set("opened","default"):this.model.set("opened","dark"),n.open()},loaderTarget:function(){return this.$(".logo-button")},nextStep:function(){return this.parent.loading(),this.logoDark.attachment_id=this.model.get("attachment_dark_id")?this.model.get("attachment_dark_id"):this.model.get("attachment_id"),this.logoDark.src=this.model.get("dark_src")?this.model.get("dark_src"):this.model.get("src"),this.logoLight.attachment_id=this.model.get("attachment_light_id")?this.model.get("attachment_light_id"):this.model.get("attachment_id"),this.logoLight.src=this.model.get("light_src")?this.model.get("light_src"):this.model.get("src"),this.wizard.setStepData({1:this.logoDark},!0),this.wizard.setStepData({2:this.logoLight},!0).completeStep(!1),!1}}),e.exports=new r},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r,o=s(12),a=s(0).extend({template:"design/wizard/overlay-color",shareColor:0,beforeMainRender:function(e){this.wizard=e.model,this.shareColor=parseInt(this.wizard.get("share_color")),this.data=this.wizard.globals.colors},afterRender:function(){var e=this,t={preferredFormat:"hex",showInput:!0,alpha_input:!0,showAlpha:!0,allowAlpha:!0,cancelText:"CANCEL",chooseText:"APPLY",saveOnApply:!1,appendTo:"#wizard-spectrum-container",showPalette:!1,change:this.change.bind(this)};(r=this.$("#ttd-skin-color-picker").spectrum(function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({},t))).on("hue.changed.spectrum",(function(e,t){})),r.on("show.spectrum",(function(){e.$(".sp-picker-container .tva-share-color-cp-warning").remove(),e.shareColor&&e.$(".sp-picker-container").prepend('<div class="tva-share-color-cp-warning">This color is linked to Thrive Theme Builder. Changing it here will also change the brand color of your theme.</div>')})),this.toggleShareColorSign(this.shareColor),this.shareColor&&this.$(".sp-colorize").css("background-color",this.getThemeHSLColorCode())},change:function(e){if(e){var t=e.toHsl(),s={h:parseInt(t.h),s:Number(Math.round(parseFloat(t.s)+"e2")+"e-2"),l:Number(Math.round(parseFloat(t.l)+"e2")+"e-2"),a:t.a};this.data.hsl_code=s,this.shareColor&&(document.documentElement.style.setProperty("--tcb-theme-main-master-h",t.h),document.documentElement.style.setProperty("--tcb-theme-main-master-s","".concat(parseInt(100*t.s),"%")),document.documentElement.style.setProperty("--tcb-theme-main-master-l","".concat(parseInt(100*t.l),"%")),document.documentElement.style.setProperty("--tcb-theme-main-master-a",t.a))}},shareThemeColor:function(e,t){if(new o({key:"share_ttb_color",value:Number(t.checked)}).save(),this.toggleShareColorSign(t.checked),this.shareColor=Number(t.checked),t.checked){var s=getComputedStyle(document.documentElement),i=parseInt(s.getPropertyValue("--tcb-theme-main-master-h")),n=parseInt(s.getPropertyValue("--tcb-theme-main-master-s")),r=parseInt(s.getPropertyValue("--tcb-theme-main-master-l")),a=s.getPropertyValue("--tcb-theme-main-master-a"),c="hsl(".concat(i,",").concat(n,"%,").concat(r,"%)");this.$(".sp-colorize").css("background-color",c),this.$("#ttd-skin-color-picker").spectrum("set",c),this.data.hsl_code={h:i,s:Number(n/100),l:Number(r/100),a:a}}},getThemeHSLColorCode:function(){var e=getComputedStyle(document.documentElement),t=parseInt(e.getPropertyValue("--tcb-theme-main-master-h")),s=parseInt(e.getPropertyValue("--tcb-theme-main-master-s")),i=parseInt(e.getPropertyValue("--tcb-theme-main-master-l"));return"hsl(".concat(t,",").concat(s,"%,").concat(i,"%)")},toggleShareColorSign:function(e){this.$(".sp-colorize-container").toggleClass("tva-shared-brand-color",!!e)},clickNext:function(){return this.parent.loading(),this.wizard.setStepData({save_data:this.data},!0).completeStep(!1),!1}});e.exports=new a},function(e,t,s){function i(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var r=s(0).extend({id:"#ttd-wizard-menu",className:"ttd-wizard-menu ttd-d-flex",template:TVE_Dash.tpl("design/wizard/menu"),afterInitialize:function(){this.menus=[].concat(i(TVA.menus),[{id:-1,name:"I will choose later...",extra_class:" choose-later"}])},readSelectedMenus:function(){var e={id:0,name:"Choose a WordPress menu"},t=this.model.deepGet("settings.menu")||{};this.activeMenus={header:_.find(this.menus,(function(e){return e.id===parseInt(t.header)}))||e,footer:_.find(this.menus,(function(e){return e.id===parseInt(t.footer)}))||e}},beforeMainRender:function(e){this.model=e.model,this.readSelectedMenus()},toggleDropdown:function(e){e.currentTarget.classList.toggle("dropdown-visible")},selectItem:function(e){var t=e.currentTarget;this.$('.selected-menu[data-target="'.concat(t.dataset.target,'"]')).attr("data-id",t.dataset.id).html(t.innerHTML),this.activeMenus[t.dataset.target]={id:t.dataset.id,name:t.innerHTML}},finishMenu:function(e){return"1"===e.currentTarget.dataset.templates&&(this.activeMenus.header.id=this.activeMenus.footer.id=0),this.parent.loading(),this.model.setStepData({header:this.activeMenus.header.id||0,footer:this.activeMenus.footer.id||0}),this.model.completeStep(!1),!1}});e.exports=new r},function(e,t,s){!function(t){function i(e){this.trigger("change",e.target.value)}e.exports=s(0).extend({className:"tva-search-elem",template:TVE_Dash.tpl("search-elem"),events:{"keyup input":_.debounce((function(){i.apply(this,arguments)}),400),"click .tva-close":function(e){var s=t(e.target).closest(".tva-search-elem");s.find(".tva-close").removeClass("tva-close"),s.find("input").val("").trigger("keyup")},"input #tva-search":function(e){t(e.target).siblings().toggleClass("tva-close",e.target.value.trim().length>0)}},initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e},afterRender:function(){this.options.placeholder&&this.$("input").attr("placeholder",this.options.placeholder),this.options.value&&this.options.value.trim().length>0&&this.$("input").val(this.options.value).siblings().toggleClass("tva-close",!0)},getValue:function(){return this.$("input").val()}})}(jQuery)},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a,c,l;o=jQuery,a=s(1),c=s(97),l=a.extend({className:"tva-topic-item tva-flex tva-align-center mb-20",template:TVE_Dash.tpl("topics/item"),deletedMessage:TVA.t.topic_deleted,parent:null,defaultTitle:null,events:n(n({},a.prototype.events),{},{"change .tva-title-events":"onTitleChange","blur .tva-title-events":"onTitleBlur","keyup .tva-title-events":"onTitleKeyup"}),afterInitialize:function(e){this.parent=e.parent,this.model.on("change",this.render.bind(this))},spectrum:function(e){var t=this.model,s=this.parent,i=o(e.currentTarget.parentNode).find('input[data-field="'.concat(e.currentTarget.dataset.field,'"]')).spectrum(n({containerClassName:"tva-color-picker",showPalette:!1,allowEmpty:!1,showInitial:!1,showButtons:!0,chooseText:"Apply",cancelText:"Cancel",showInput:!0,preferredFormat:"hex",hide:function(e){e=e.toString(),s.$el.removeClass("tva-disabled"),e!==t.get(this.dataset.field)&&t.persist(r({},this.dataset.field,e.toString()))},show:function(){s.$el.addClass("tva-disabled")}},this.spectrumOptions()));return requestAnimationFrame((function(){return i.spectrum("show")})),!1},spectrumOptions:function(){return{}},render:function(){return a.prototype.render.apply(this,arguments),this.$(".tva-title-events").select().focus(),this.toggleLoader(),this},editing:function(){this.model.set("editing",!0)},onTitleChange:function(e){0===this.model.get("ID")&&(this.defaultTitle=TVA.t.label_default_text);var t=e.currentTarget,s=t.value.trim()||this.defaultTitle;if(!s)return t.classList.add("tva-error"),t.focus(),!1;this.preventBlur=!0,s!==this.model.get("title")?this.model.persist({title:s},n({loader:!0,showSuccess:!0},this.saveOptions()||{})):this.model.set("editing",!1)},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0,this.model.set("editing",!1))},onTitleBlur:function(){this.preventBlur?delete this.preventBlur:this.model.set("editing",!1)},openIconPicker:function(){return this.openModal(c,{topic_title:this.model.get("title"),model:this.model,"max-width":"865px","max-height":"80vh",width:"auto",in_duration:200,out_duration:300,className:"tva-default-modal-style tvd-modal"}),!1},openImagePicker:function(){var e=this;return l.initMedia().then((function(t){e.model.persist({icon:t.url,icon_type:"icon"})})),!1},getConfirmationModal:function(){return s(110)},openDeleteConfirmation:function(){var e=this;return this.openModal(this.getConfirmationModal()).then((function(){e.model.set("loading",!0);var t=e.model.clone();e.beforeDelete(t),t.destroy().done((function(){return TVE_Dash.success(e.deletedMessage)})).always((function(){return e.model.collection.remove(e.model)}))})),!1},beforeDelete:function(e){TVA.courses.where({topic:e.get("ID")}).forEach((function(e){e.set("topic",0,{silent:!0}),e.saveState()}))},toggleLoader:function(){this.$el.tvaToggleLoader(30,!!this.model.get("loading"),{background:"#eaefef"})},saveOptions:function(){}},{initMedia:function(){var e=l.mediaFrame||(l.mediaFrame=wp.media({title:"Select or upload an image",button:{text:"Use this image"},library:{type:"image"},multiple:!1}));return e.open(),new Promise((function(t){e.off("select").on("select",(function(){return t(e.state().get("selection").first().toJSON())}))}))}}),e.exports=l},function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function r(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var a=s(185),c=s(7),l=s(88),u=s(73),d=s(29),h=s(30),p=s(20);e.exports=d.extend({className:"tva-customer-edit",courseStructureTemplate:TVE_Dash.tpl("customers/course-structure"),selected:[],events:r(r({},d.prototype.events),{},{"change #tva-check-all":"toggleSelectAll","change .tva-section-select":"onItemSelect"}),ensureData:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(TVA.customers instanceof Backbone.Collection&&0!==TVA.customers.length&&(s=TVA.customers.findWhere({ID:t.studentID}))instanceof Backbone.Model&&s.get("courses")instanceof Backbone.Collection&&(t.model=s,t.setUpCourseData(),t.setUpListeners()),t.model instanceof Backbone.Model){e.next=3;break}return e.abrupt("return",new Promise((function(e){wp.apiRequest({url:TVA.routes.customer+"/".concat(t.studentID,"/course_data/").concat(t.courseID)}).done((function(e){t.model=new l(e),s instanceof Backbone.Model?s=t.model.clone():(s=t.model,TVA.customers.add(s)),t.setUpCourseData(),t.setUpListeners()})).always(e)})));case 3:case"end":return e.stop()}}),e)})),function(){var t=this,s=arguments;return new Promise((function(n,r){var o=e.apply(t,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))})()},setUpListeners:function(){var e=this;this.model.on("change",this.render.bind(this)),this.courseModel.on("item_bypass_set",(function(t){e.model.deepSet("items_bypassed.".concat(e.courseID),t.items_bypassed),e.itemsBypassed=t.items_bypassed,t.locked_items&&(e.model.deepSet("locked_status.".concat(e.courseID),t.locked_items),e.locked=t.locked_items),e.render()}))},setUpCourseData:function(){this.courseModel=this.model.get("courses").findWhere({id:this.courseID}),this.courseProgress=this.model.getCourseProgress(this.courseID),this.itemsBypassed=this.model.getCourseData("items_bypassed",this.courseID),this.locked=this.model.getCourseData("locked_status",this.courseID)},initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.studentID=parseInt(e.id)||null,this.courseID=parseInt(e.subID)||null,this.currentModuleIndex=0,TVE_Dash.showLoader()},afterRender:function(){var e=this,t=this.$(".tva-cc-container");this.$(".tva-back-courses").show(),this.$(".tva-back-students").hide(),"function"==typeof this.courseStructureTemplate&&(t.html(this.courseStructureTemplate(this.getRenderParams())),this.$structureContainer=this.$(".tva-cc-container-inner"),this.$structureContainer.empty(),_.each(this.courseModel.getModulesAndLessons(!0),(function(t){"module"===t.getType()?e.$structureContainer.append(e.renderModule(t)):"lesson"===t.getType()&&e.$structureContainer.append(e.renderLesson(t))}))),this.$massActions=this.$(".tva-mass-action").hide(),this.locked.course_locked&&this.$(".tva-cc-container").addClass("tva-mass-actions-hidden"),TVE_Dash.hideLoader()},toggleSelectAll:function(e){this.$("input.tva-section-select").prop("checked",e.currentTarget.checked),this.onSelectionChange()},onItemSelect:function(e){var t=e.currentTarget,s=this.$(t.closest(".tva-customer-card"));s.find("input.tva-section-select").not(t).prop("checked",t.checked),t.checked||s.parents(".tva-customer-card").find(".tva-c-course-grid-top input.tva-section-select").prop("checked",!1),this.onSelectionChange()},onSelectionChange:function(){var e=this;this.selected=[],this.$("input.tva-section-select:checked").each((function(t,s){return e.selected.push(s.dataset.itemId)})),this.$("#tva-check-all").prop("checked",this.selected.length&&this.selected.length===this.$("input.tva-section-select").length),this.selected.length?this.$massActions.fadeIn(100):this.$massActions.fadeOut(100)},massAction:function(e){var t=this;if(this.selected&&this.selected.length){var s=e.currentTarget.dataset.action;switch(s){case"complete":case"reset":case"unlock":default:this.openModal(p,{template:TVE_Dash.tpl("modals/bulk-".concat(s)),className:"tvd-modal tva-sl-bulk",width:"550px",confirm:function(){this.close(),requestAnimationFrame((function(){wp.apiRequest({type:"POST",url:"".concat(TVA.routes.customer,"/bulk_edit"),data:{course_id:t.courseModel.get("id"),student_id:t.studentID,items_ids:t.selected,action:s}}).done((function(e){t.model.set(e,{silent:!0}),t.setUpCourseData(),t.render(),TVE_Dash.success("Action completed successfully!")}))}))}})}}},renderModule:function(e){return this.currentModuleIndex++,new u({model:this.model,module:e,index:this.currentModuleIndex,contentStatuses:this.model.getCourseData("modules_and_lessons_status",this.courseID),lessonsCompleted:this.model.getCourseData("lessons_completed",this.courseID),itemsBypassed:this.itemsBypassed,locked:this.locked,progress:this.model.getModuleProgress(this.courseID,e.get("ID"))}).render().$el},renderLesson:function(e){return new h({model:this.model,lesson:e,contentStatuses:this.model.getCourseData("modules_and_lessons_status",this.courseID),lessonsCompleted:this.model.getCourseData("lessons_completed",this.courseID),itemsBypassed:this.itemsBypassed,locked:this.locked,courseLocked:this.locked?this.locked.course_locked:""}).render().$el},unlockItem:function(e){var t=parseInt(e.currentTarget.dataset.id),s=new c(this.courseModel.get("structure"),{total:this.courseModel.get("structure").length}).findItem(t);this.openModal(a,{className:"tvd-modal tva-sl-unlock",courseModel:this.courseModel,model:s,studentID:this.studentID,itemsBypassed:this.itemsBypassed,width:"550px"})}})},function(e,t,s){var i=s(1),n=s(30);e.exports=i.extend({className:"tva-student-module-item",template:TVE_Dash.tpl("customers/overview/module"),initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.currentModuleIndex=parseInt(e.index)||null,this.module=e.module,this.contentStatuses=e.contentStatuses,this.lessonsCompleted=e.lessonsCompleted,this.itemsBypassed=e.itemsBypassed,this.progress=e.progress,this.campaignType=e.locked.campaign_type,this.courseLocked=e.locked.course_locked,this.lockedContents=e.locked[this.module.get("id")],this.locked=this.lockedContents&&this.lockedContents.module_locked?this.lockedContents.module_locked:null,this.prepareStatuses()},prepareStatuses:function(){var e=this.module.get("ID"),t=this.contentStatuses&&this.contentStatuses[e]?this.contentStatuses[e]:null;this.itemsBypassed&&this.itemsBypassed[e]&&(this.locked=!1),t&&(this.moduleFinish=t.tva_module_finish?t.tva_module_finish:"",this.moduleStart=t.tva_module_start?t.tva_module_start:"")},afterRender:function(){var e=this.$(".tva-c-course-elems");_.each(this.module.get("lessons"),(function(t){e.append(this.renderLesson(t))}),this)},renderLesson:function(e){return new n({model:this.model,lesson:e,contentStatuses:this.contentStatuses,lessonsCompleted:this.lessonsCompleted,itemsBypassed:this.itemsBypassed,locked:this.lockedContents,campaignType:this.locked?this.campaignType:"",courseLocked:this.locked?this.courseLocked:"",moduleLocked:this.locked}).render().$el}})},function(e,t,s){e.exports=s(0).extend({template:TVE_Dash.tpl("customers/courses-item"),afterInitialize:function(e){e=e||{};var t=this.model.get("id");this.progress=e.studentModel.getCourseProgress(t),this.enrolled=e.studentModel.getCourseData("enrollment_dates",t),this.activity=e.studentModel.getCourseData("activity",t),this.locked=e.studentModel.isCourseLocked(t)}})},function(e,t,s){var i=s(0);e.exports=i.extend({className:"tva-student",template:TVE_Dash.tpl("customers/item"),viewUser:function(e){this.changeView("students/".concat(e.currentTarget.dataset.id,"/courses"))}})},,,function(e,t,s){var i=s(38);e.exports=s(82).extend({model:i,limit:1e4,url:function(){return this.getUrl("".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v2,"/courses"),jQuery.param({offset:this.offset,limit:this.limit,filter:this._filter}))},getSendOwlItems:function(){var e=[];return this.each((function(t){t.hasSendOwlIntegration()&&e.push(t)})),e},newItemOrder:function(){return 0===this.length?0:parseInt(this.first().get("order"))+1},comparator:function(e,t){return parseInt(t.get("order"))-parseInt(e.get("order"))}})},function(e,t,s){var i=s(39),n=s(39);e.exports=i.model.extend({resetItems:function(e){return this.set("items",e instanceof Backbone.Collection?e:new Backbone.Collection),this},contains:function(e){return e instanceof Backbone.Model&&this.getItems().findWhere({id:e.getId()})instanceof Backbone.Model},getItemsToString:function(e){var t=[];return e instanceof n.model?this.get("items").each((function(s){var i=s.get("id"),n=e.get("items").findWhere({id:i});n instanceof Backbone.Model&&t.push(n.getName())})):t=this.get("items").pluck("name"),0===t.length&&t.push(TVA.t.NoProducts),t=t.join(", ")}})},function(e,t,s){function i(){var e=function(e,t){t||(t=e.slice(0));return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}([" "]);return i=function(){return e},e}var n=s(2).extend({scheduleType:"specific",defaults:function(){return jQuery.extend(!0,{},{id:"datetime",occurrence:"after",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return TVE_Dash.sprintf(TVA.t.trigger_datetime_label,this.get("occurrence"),this.deepGet("schedule.datetime"))},canEdit:function(){return this.canRemove()},canRemove:function(){return!0},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:this.deepGet("schedule.datetime","").split(i()).shift(),tooltip:this.getLabel()}},icon:function(){return"drip-calendar"}});e.exports=n},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r;r=jQuery,e.exports=s(2).extend({defaults:function(){return function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({course_id:"",scope:"",conditions:{products:[],roles:[]}},r.extend(!0,{},TVA.accessRestriction.defaults))},url:function(){var e={scope:this.get("scope"),course:this.get("course_id")};return"undefined"!==this.get("id")&&(e.id=this.get("id")),TVA.Utils.buildUrl(TVA.routes.access_restriction,e)},ensureDataExists:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new Promise((function(s){"content"!==e.get("option")||e._dataEnsured||(e._dataEnsured=!0,wp.apiRequest({type:"POST",url:"".concat(TVA.routes.access_restriction,"/ensure-data"),data:{course:e.get("course_id"),scope:e.get("scope"),content:e.get("content"),option:"content",custom_id:t}}).done((function(t){e.deepSet("content.post",t.content.post),e.deepSet("content.post_id",t.content.post_id)})).always((function(){return s()}))),s()}))},validateOptions:function(){return"redirect_custom"!==this.get("option")||this.deepGet("redirect_custom.title")?!("content"===this.get("option")&&!this.deepGet("content.title"))||TVA.t.EmptyTitle:TVA.t.RedirectPageRequired},validateConditions:function(){if(!this.get("conditions"))return!1;var e=this.get("index");return Object.values(this.get("conditions")).forEach((function(t){t.length&&e--})),0===e},isDuplicatedTitle:function(e){var t=this,s=!1;return e.length&&e.each((function(e){e.get("custom_id")!==t.get("custom_id")&&e.get("title")===t.get("title")&&(s=!0)})),s},validateCustomSettings:function(e){return this.validateConditions()?this.get("title")?!this.isDuplicatedTitle(e)||TVA.t.access_rule_invalid_name:TVA.t.EmptyTitle:1===this.get("index")?TVA.t.access_rule_conditions_empty:TVA.t.access_rule_conditions_invalid},ensureDefaultMessage:function(){this.get("message")||this.set("message",TVA.t.AccessRestrictionMessage[this.get("scope")])},getConditionCount:function(){return Object.entries(this.get("conditions")).filter((function(e){return e[1].length>0})).length}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}e.exports=s(4).extend({offset:0,limit:parseInt(TVA.items_per_page),total:0,currentPage:1,_filter:{},fetchOptions:{},addFilter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.resetPagination(),"string"==typeof e&&(e=r({},e,t)),this._filter=n(n({},this._filter),e),this.fetch(this.fetchOptions)},getFilter:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0===e?this._filter:void 0===this._filter[e]?t:this._filter[e]},resetPagination:function(){return this.currentPage=1,this.offset=0,this},hasFilters:function(){var e=this._filter;return e.topic&&-1===parseInt(e.topic)&&delete e.topic,Object.keys(e).length>0},resetFilters:function(){return this._filter={},this},initialize:function(e,t){if(!t||void 0===t.total)throw new Error("This collection cannot be initialized without total count of items");this.total=parseInt(t.total)},fetch:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.trigger("fetching"),t.success=function(){e.trigger("fetched",e),!e.length&&e.currentPage>1&&e.prev()},Backbone.Collection.prototype.fetch.call(this,t)},parse:function(e){return e&&void 0!==e.total&&(this.total=e.total),e&&e.items},next:function(){return this.currentPage++,this.offset=(this.currentPage-1)*this.limit,this.fetch(this.fetchOptions),this},prev:function(){return this.currentPage--,this.offset=(this.currentPage-1)*this.limit,this.fetch(this.fetchOptions),this},pageInfo:function(){return{currentPage:this.currentPage,totalPages:Math.ceil(this.total/this.limit),page:this.currentPage,prev:this.offset>0,next:this.currentPage*this.limit<this.total}},getUrl:function(e,t){return"".concat(e).concat(e.includes("?")?"&":"?").concat(t)}})},function(e,t,s){var i=s(84);e.exports=i.extend({defaults:{comment_status:"closed",post_excerpt:"",post_type:"tva_module",order:0,post_status:"draft",freemium:"inherit"},validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];if(e.post_title||t.push(this.validation_error("post_title",TVA.t.EmptyTitle)),t.length)return t},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+"/modules/".concat(this.get("id")?this.get("id"):"")},getPrevious:function(){if(this.isFirst())return null;var e=this.collection.indexOf(this);return this.collection.at(e-1)},getLastLesson:function(){var e=this.getLessons();return _.last(e)},getPreviousLesson:function(){var e=this.getPrevious();return e instanceof i?e.getLastLesson():null}})},function(e,t,s){var i=s(2);e.exports=i.extend({initialize:function(e){!e.structure||e.structure instanceof Backbone.Collection||this.set("structure",new this.collection.constructor(e.structure),{silent:!0})},getType:function(){return this.get("post_type").replace("tva_","")},isFree:function(){return["free-for-logged","free"].includes(this.get("freemium"))},isPublished:function(){return"publish"===this.get("post_status")},getParent:function(){return this.get("post_parent")?this.collection.parent:null},getParents:function(){var e=this.getParent();if(!e)return[];var t=[];do{t.push(e),e=e.getParent()}while(e);return t},getLessons:function(){return this.get("structure").findItemsByOptions({post_type:"tva_lesson"})},getPublishedLessons:function(){return this.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"publish"})},getModule:function(){var e=this.getHighestParent();return"module"===e.getType()?e:null},getHighestParent:function(){for(var e=this;e.get("post_parent")>0&&e.collection&&e.collection.parent;)e=e.collection.parent;return e},set:function(){return"structure"===arguments[0]&&arguments[1]instanceof Backbone.Collection&&(arguments[1].parent=this),i.prototype.set.apply(this,arguments)},getCountSummary:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tva-empty",t=this.get("structure");if(!t.length)return'<span class="'.concat(e,'">(').concat(TVA.t.empty,")</span>");var s=[],i=0;return"chapter"===t.at(0).getType()?(s.push(TVA.Utils._n(t.length,TVA.t.chapter)),t.each((function(e){e.get("structure")&&(i+=e.get("structure").length)}))):i=t.length,i&&s.push(TVA.Utils._n(i,TVA.t.lesson)),"(".concat(s.join(", "),")")},expand:function(){this.trigger("expand",this),this.get("post_parent")&&this.getParent().expand()},destroy:function(){var e=this;return this.get("post_parent")&&this.getParents().forEach((function(t){var s=t.getPublishedLessons().filter((function(t){return t!==e&&t.getParent()!==e})).length>0;t.set("post_status",s?"publish":"draft",{silent:!0})})),i.prototype.destroy.apply(this,arguments)},isFirst:function(){return this.collection instanceof Backbone.Collection&&this.collection.at(0).get("ID")===this.get("ID")}})},function(e,t,s){var i=s(84);e.exports=i.extend({defaults:{post_type:"tva_chapter"},validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];if((!e.post_title||e.post_title.length<=0)&&t.push(this.validation_error("post_title",TVA.t.EmptyTitle)),t.length)return t},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+"/chapters/".concat(this.get("id")?this.get("id"):"")}})},function(e,t,s){function i(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var r=s(84),o=s(124),a=s(203);e.exports=r.extend({defaults:{comment_status:"closed",post_excerpt:"",post_type:"tva_lesson",order:0,cover_image:"",lesson_type:"text",freemium:"inherit"},initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.set({video:new o(e.video),audio:new a(e.audio)})},validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[],s=e.audio.validate(e.audio.attributes),n=e.video.validate(e.video.attributes);if(e.post_title||t.push(this.validation_error("post_title",TVA.t.EmptyTitle)),"audio"===e.lesson_type&&s&&s.length&&(e.audio.trigger("invalid",e.audio,s),t=[].concat(i(t),i(s))),"video"===e.lesson_type&&n&&n.length&&(e.video.trigger("invalid",e.video,n),t=[].concat(i(t),i(n))),t.length)return t},parse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.video=new o(e.video),e.audio=new a(e.audio),e},url:function(){return TVA.apiSettings.root+TVA.apiSettings.v2+"/lessons/".concat(this.get("id")?this.get("id"):"")},getResourceCount:function(){var e=parseInt(this.get("resource_count"));return isNaN(e)?0:e},formatResourceCount:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.getResourceCount();return t?e+TVA.Utils._n(t,"resource_singular","resource_plural"):""},getPrevious:function(e){var t=this;if(this.isFirst(e))return null;var s=e.getLessons(),i=s.findIndex((function(e){return e.get("ID")===t.get("ID")}));return s[i-1]},isFirst:function(e){var t=this;return 0===e.getLessons().findIndex((function(e){return e.get("ID")===t.get("ID")}))}})},function(e,t,s){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=s(2);e.exports=n.extend({idAttribute:"ID",urlRoot:TVA.routes.templates,labels:{tva_lesson:"Lesson",tva_module:"Module",tva_courses:"Course Overview",home:"School homepage",tva_no_access:"Restricted Course",tva_post_no_access:"Restricted Site Content",tva_course_completed:"Course Completion",tva_post_certificate_validation:"Certificate Verification"},defaults:function(){return{post_title:"",thumbnail:"",edit_url:"",preview_url:"",meta_input:{primary_template:"",secondary_template:"",format:""}}},url:function(){return TVA.Utils.buildUrl(n.prototype.url.apply(this,arguments),{tva_skin_id:this.skin_id||this.collection.skin_id})},getThumbnailUrl:function(){return this.hasThumbnail()?"".concat(this.get("thumbnail").url,"?_=").concat((new Date).getTime()):""},hasThumbnail:function(){return"object"===i(this.get("thumbnail"))},getThumbnailCss:function(){return"background: linear-gradient(rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0) 80%, rgb(255, 255, 255) 100%), url( ".concat(this.getThumbnailUrl()," ) top center no-repeat;")},meta:function(e,t){var s=this.get("meta_input");return void 0!==t&&(s[e]=t,this.set("meta_input",s)),s[e]},primary:function(){return this.meta("primary_template")},secondary:function(){return this.meta("secondary_template")},format:function(){var e=this.meta("format");return void 0===e||0===e.length?"standard":e},isDefault:function(){return 1===parseInt(this.meta("default"))},isSingular:function(){return"singular"===this.primary()},isHomepage:function(){return"home"===this.primary()},isArchive:function(){return"archive"===this.primary()},isLesson:function(){return"tva_lesson"===this.secondary()},isVideoLesson:function(){return this.isLesson()&&"video"===this.format()},isAudioLesson:function(){return this.isLesson()&&"audio"===this.format()},isModule:function(){return"tva_module"===this.secondary()},isNoAccess:function(){return"tva_no_access"===this.secondary()},isCompleted:function(){return"tva_course_completed"===this.secondary()},isPostNoAccess:function(){return"tva_post_no_access"===this.secondary()},isCourse:function(){return"tva_courses"===this.secondary()},isCertificateValidation:function(){return"tva_post_certificate_validation"===this.secondary()},canPreview:function(){return!this.isNoAccess()&&!this.isPostNoAccess()},canDelete:function(){return!this.isDefault()},canMakeDefault:function(){return!this.isDefault()},setDefault:function(){this.canMakeDefault()&&(this.collection.filterByType(this.primary(),this.secondary()).forEach((function(e){return e.meta("default",0)})),this.meta("default",1))},getContentType:function(){var e="";return this.isSingular()?this.isLesson()?(e="Lesson",this.isVideoLesson()?e="Video Lesson":this.isAudioLesson()&&(e="Audio Lesson")):this.isModule()?e="Module":this.isNoAccess()?e="Restricted lessons, modules and overview page":this.isPostNoAccess()?e="Restricted pages and posts":this.isCompleted()?e="Course Completion":this.isCertificateValidation()&&(e="Certificate Verification"):this.isHomepage()?e="Homepage":this.isArchive()&&this.isCourse()&&(e="Course Overview"),e},getDefaultLabel:function(){var e="",t="";return this.isSingular()||this.isArchive()?(e=this.secondary(),this.isLesson()&&(this.isVideoLesson()?t="Video ":this.isAudioLesson()&&(t="Audio "))):this.isHomepage()&&(e=this.primary()),"Default ".concat(t).concat(this.labels[e])},icon:function(){var e=["ta"];return this.isSingular()?this.isLesson()?(e.push("lesson"),this.isVideoLesson()?e.push("video"):this.isAudioLesson()&&e.push("audio")):this.isModule()?e.push("module"):this.isNoAccess()||this.isPostNoAccess()?e.push("no-access"):this.isCompleted()&&e.push("certificates"):this.isHomepage()?e.push("homepage"):this.isArchive()&&this.isCourse()&&e.push("overview"),e.length>1?'<svg class="tva-icon"><use xlink:href="#'.concat(e.join("-"),'"></use></svg>'):""},extraItemClass:function(){var e="";return this.isSingular()&&(this.isNoAccess()||this.isPostNoAccess())?e="tva-red-dark":this.isCertificateValidation()?e="tva-certificate-validation":this.isHomepage()&&(e="tva-blue-dark")," ".concat(e)},createTemplate:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"standard";return this.set({post_title:e}),this.meta("primary_template",t),this.meta("secondary_template",s),this.isLesson()||(i="standard"),this.meta("format",i),this},isJustAdded:function(){return this.get("just_added")},getOrder:function(){var e=0;return this.isDefault()?e+=13:e-=1,this.isLesson()?(e+=8,this.isAudioLesson()?e-=2:this.isVideoLesson()&&(e-=1)):this.isModule()?e+=5:this.isCourse()||this.isCompleted()?e+=4:this.isHomepage()&&(e+=3),-1*e}})},function(e,t,s){var i=s(78);e.exports=s(136).extend({defaults:{display_name:"",user_email:"",user_login:"",services:{},notify:0,edit_url:"",lessons_completed:[],items_bypassed:[],locked_status:[],courses_progress:[],user_registered:"",modules_and_lessons_status:[],last_seen:"",enrollment_dates:[],activity:[]},initialize:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!Array.isArray(t.courses)||t.courses instanceof Backbone.Collection||this.set("courses",new i(t.courses,{total:null===(e=t.courses)||void 0===e?void 0:e.length}),{silent:!0})},getCourseData:function(e,t){return this.get(e)&&this.get(e)[t]?this.get(e)[t]:null},getCourseProgress:function(e){return this.get("courses_progress")[e]?this.get("courses_progress")[e].progress:0},getModuleProgress:function(e,t){if(this.get("courses_progress")[e]){var s=this.get("courses_progress")[e];if(s.modules[t])return s.modules[t]}return 0},isCourseLocked:function(e){return!!this.get("locked_status")[e]&&this.get("locked_status")[e].course_locked}})},function(e,t,s){jQuery,e.exports=s(0).extend({className:"tva-submenu-item",tagName:"div",template:TVE_Dash.tpl("submenu-item"),selectedClass:"active",events:{click:function(e){e.stopPropagation();var t=e.currentTarget.dataset.route;TVA.Router.navigate(t,{trigger:!0})}},initialize:function(){this.model.off("change:selected").on("change:selected",_.bind(this.onChangeSelected,this))},render:function(){return this.$el.html(this.template({model:this.model})),this.model.get("disabled")?this.$el.hide():this.model.get("route")?this.$el.attr("data-route",this.model.get("route")):this.model.get("href")&&this.$el.attr("onmousedown","window.open('".concat(this.model.get("href"),"')")),!0===this.model.get("selected")&&this.$el.addClass(this.selectedClass),this},onChangeSelected:function(e,t){this.$el.toggleClass(this.selectedClass,t)}})},function(e,t,s){var i=s(141),n=s(0).extend({initialize:function(){var e=this;TVA.migrate_access&&1===parseInt(TVA.migrate_access.should_migrate)&&this.fetchProducts().then((function(t){t&&1===parseInt(t.open_modal)&&e.openModal(i,{model:new Backbone.Model({items:t.items,spinnerURL:t.spinner_url}),no_close:!0,className:"tvd-modal",dismissible:!1})})).catch((function(e){TVE_Dash.err("Error during the migration process. Please contact Thrive Support!"),console.error(e)}))},fetchProducts:function(){return new Promise((function(e,t){wp.apiRequest({url:TVA.migrate_access.route,type:"GET"}).done((function(t){e(t)})).fail((function(e){return t(e)}))}))}},{getInstance:function(){return new n}});e.exports=n},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r,o,a,c,l,u,d,h,p,m,g,f,v,b,y,w,T;r=jQuery,o=s(38),a=s(92),c=s(214),l=s(143),u=s(144),d=s(7),h=s(1),p=s(2),m=s(93),g=s(145),f=s(21),v=a.extend({renderThumbs:!0,label:TVA.t.label,initialize:function(e){var t=new c(TVA.labels.toJSON());return t.idAttribute="ID",this.collection=t,a.prototype.initialize.call(this,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({collection:t},e))}}),b=a.extend({renderThumbs:!0,label:TVA.t.topic}),y=a.extend({renderThumbs:!0,label:TVA.t.author,initialize:function(){a.prototype.initialize.apply(this,arguments),this.on("tva.display.list",this.renderSearchInput),this.listenTo(this.model,"change:avatar_url",this.render)},renderSearchInput:function(e){var t=this,s=r('<input type="text"/>').attr("placeholder",TVA.t.search_uses);e.empty().append(s),requestAnimationFrame((function(){return s.focus()})),new l(s,{url:TVA.apiSettings.root+TVA.apiSettings.v1+"/courses/search_users/",type:"POST",renderItem:function(e,t){return r("<li class='tvd-truncate'/>").append("<span class='tva-ps-result-title'>"+t.name+"</span><span class='tva-ps-result-email ml-5'> ("+t.email+")</span>").appendTo(e)},select:function(e,s){var i=s.item;i.biography_type="wordpress_bio";var n=new Backbone.Model(i);t.collection.push(n),t.collection.setSelected(n),t.model=n,t.listenTo(t.model,"change:avatar_url",t.render),t.render(),t.displayList(),t.trigger("tva.course.author.changed",n)}})}}),w=a.extend({label:TVA.t.difficulty}),T=[],e.exports=h.extend({className:"tva-course-form",$dropdowns:null,labelDropdown:null,template:TVE_Dash.tpl("courses/form"),selectedIndex:0,initialize:function(e){var t=this;if(this.$el.on("click",(function(){t.closeDropdowns()})),e&&!e.model&&e.id){var s=TVA.courses.findWhere({id:parseInt(e.id)});if(s&&s.get("fetched"))return this.model=s,this.listenTo(this.model,"tva.structure.status.changed",this.onStructureStatusChanged),this.listenTo(this.model,"tva.course.permalink.modified",this.onPermalinkChanged),this.renderForm();TVA.lazyLoading?TVA.keepLoader=!0:TVE_Dash.showLoader(),this.model=new o(parseInt(e.id)),this.listenTo(this.model,"tva.course.fetch.success",(function(){t.renderForm()})),this.listenTo(this.model,"tva.course.fetch.error",(function(){t.$el.html("course could not be loaded"),TVE_Dash.hideLoader()})),this.listenTo(this.model,"tva.structure.status.changed",this.onStructureStatusChanged),this.listenTo(this.model,"tva.course.permalink.modified",this.onPermalinkChanged)}r.extend(!0,this,e)},destroy:function(){this.model.restoreState(!0),h.prototype.destroy.apply(this,arguments)},render:function(){return this.afterRender(),this},constructLabelDropdown:function(){return new v({add_item:{str:{title:TVA.t.addNewLabel,save:TVA.t.saveLabel},inputTemplate:TVE_Dash.tpl("labels/add-inline"),spectrum:function(e){var t=this,s=e.currentTarget,i=r(s).find("input").spectrum({containerClassName:"tva-color-picker",showPalette:!1,allowEmpty:!1,showInitial:!1,showButtons:!0,chooseText:"Apply",cancelText:"Cancel",showInput:!0,preferredFormat:"hex",hide:function(e){s.style.setProperty("--thumb-color",e.toString()),t.focusInput()}});return requestAnimationFrame((function(){return i.spectrum("show")})),!1},getModelForSave:function(){var e=this.$(".tva-colorpicker").val();return new f({title:this.$input.val(),label_color:e,color:e})},afterSave:function(e){TVA.labels.push(e)},addToCollection:function(e){this.dropdown.collection.push(e)}}})},handleLabel:function(){return this.labelDropdown||(this.labelDropdown=this.constructLabelDropdown(),this.labelDropdown.on("tva.dropdown.item.selected",this.onLabelChange.bind(this))),this.labelDropdown.collection.setSelectedId(this.model.get("label")),this.$("#tva-course-label").append(this.labelDropdown.render().$el),this.labelDropdown},onLabelChange:function(e){this.model.set({label:parseInt(e.get("ID"))},{silent:!0}),this.model.get("id")&&this.model.save()},renderForm:function(){TVA.courses.replace(this.model),this.$el.html(this.template({model:this.model})),this.renderHeader(),TVE_Dash.data_binder(this),this.$dropdowns=this.$("#tva-course-dropdowns"),T.push(this.handleTopics()),T.push(this.handleAuthor()),T.push(this.handleLevels()),T.push(this.handleLabel()),this.addChild(T),this.renderTabs(),TVE_Dash.hideLoader(),TVA.$app.tvaToggleLoader(!1),r("html, body").animate({scrollTop:0},300)},renderHeader:function(){new g({model:this.model,el:this.$(".course-form-header")}).render()},closeDropdowns:function(){T.forEach((function(e){e.closeSelect()}))},handleAuthor:function(){var e=this,t=new y({collection:new c([this.model.get("author").set("selected",!0)])});return t.on("tva.course.author.changed",(function(s){if(e.model.set("author",s),e.model.get("id")){t.$el.tvaToggleLoader();var i=e.model.get("structure");e.model.save(null,{success:function(){e.model.set("structure",i),t.closeSelect()}}).done((function(){t.$el.tvaToggleLoader(),TVE_Dash.success(TVA.t.author_saved)}))}})),t.on("tva.before.display.list",this.closeDropdowns),this.$dropdowns.append(t.render().$el),t},handleLevels:function(){var e,t,s,i=this,n=new w({add_item:{str:{title:TVA.t.addDifficultyLevel,save:TVA.t.saveLevel,err:TVA.t.EmptyName},getModelForSave:function(){var e=new p({name:this.$input.val()});return e.url="".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/levels"),e},afterSave:function(e){TVA.levels.push(e)},addToCollection:function(e){this.dropdown.collection.add(e)}},deletable:!0,editable:!0,collection:(e=parseInt(this.model.get("level")),t=new c(TVA.levels),s=t.findWhere({id:e}),s||(s=t.first()),t.setSelected(s),t),deleteItem:function(e,t){var s=this;e.stopPropagation();var i=parseInt(t.dataset.id);if(isNaN(i))return this;var n=this.collection.findWhere({id:i});if(!(n instanceof p))return this;if(n.url="".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/levels/").concat(i),1===this.collection.length)return TVE_Dash.err(TVA.t.lastItemDelete);var r=this.$(".".concat(this.listItemCssClass,'[data-id="').concat(n.get("id"),'"]')).tvaToggleLoader();n.destroy({success:function(e){TVA.levels.splice(TVA.levels.findIndex((function(e){return e.id===i})),1),e.get("selected")&&s.selectItem(s.collection.first(),!0),r.remove(),TVE_Dash.success(TVA.t.level_deleted)}})}});return n.on("tva.dropdown.item.selected",(function(e,t,s){if(parseInt(e.get("id"))!==parseInt(i.model.get("level"))&&(i.model.set("level",parseInt(e.get("id"))),i.model.get("id"))){n.$el.tvaToggleLoader();var r=i.model.get("structure");i.model.save(null,{success:function(){return i.model.set("structure",r)}}).done((function(){n.$el.tvaToggleLoader(!1),s||TVE_Dash.success(TVA.t.level_saved)}))}})),n.on("tva.before.display.list",this.closeDropdowns),this.$dropdowns.append(n.render().$el),n},handleTopics:function(){var e,t,s=this,i=new b({add_item:{str:{title:TVA.t.addNewTopic},template:_.template('<div><a class="tva-add-topic" href="#courses/topics">'.concat(TVA.Utils.icon("plus-circle")+TVA.t.addNewTopic,"</a></div>"))},collection:(e=parseInt(this.model.get("topic")),t=new c(TVA.topics.toJSON()),t.setSelectedId(e),t)});return i.on("tva.dropdown.item.selected",(function(e){if(parseInt(s.model.get("topic"))!==parseInt(e.get("id"))&&(s.model.set("topic",parseInt(e.get("id"))),s.model.get("id"))){i.$el.tvaToggleLoader();var t=s.model.get("structure");s.model.save(null,{success:function(){return s.model.set("structure",t)}}).done((function(){TVE_Dash.success(TVA.t.topic_saved),i.$el.tvaToggleLoader()}))}})),i.on("tva.before.display.list",this.closeDropdowns),this.$dropdowns.append(i.render().$el),i},editTitle:function(e,t){var s=this,i=r(t).hide(),n=i.prev().hide(),o=i.next().show(),a=o.find("label"),c=o.find("> input").val(this.model.get("name")).focus().select(),l=this.model.get("structure");function u(){var e=this;this.model.get("id")&&this.saveCourse(null,null,{success:function(t){TVE_Dash.hideLoader(),n.html(t.get("name")).show(),o.hide(),i.css({display:"inline-block"}),a.text(""),e.model.set("structure",l)}})}c.off("keyup").on("keyup",(function(e){13===e.which&&u.call(s)})).off("blur").on("blur",_.bind(u,this))},renderTabs:function(){var e=this;this.model.get("structure")instanceof d||this.model.set("structure",new d(this.model.get("structure")));var t=[{slug:"details",name:TVA.t.courseDetails,icon:"info-circle_light",view:new(s(146))({model:this.model})},{slug:"new",name:TVA.t.content,icon:"list_light",view:new(s(148))({model:this.model,collection:this.model.get("structure")})},{slug:"access",name:TVA.t.accessRestrictions,counter:this.model.getProducts().length,icon:"lock-alt_light",view:new(s(51))({model:this.model,collection:this.model.getProducts()})},{slug:"drip",name:TVA.t.drip,icon:"drip-main",view:new(s(158))({model:this.model,collection:this.model.getDripCampaigns()})},{slug:"completion",name:TVA.t.courseCompletion,icon:"certificates",view:new(s(165))({model:this.model})}],i=Backbone.history.getFragment().split("/");3===i.length&&i[2]&&t.some((function(t,s){return!!i[2].startsWith(t.slug)&&(e.selectedIndex=s,!0)}));var n=new u({course:this.model,selectedIndex:this.selectedIndex||0,collection:new Backbone.Collection(t)});n.on("tab.selected.index",(function(s){var i=t[s];e.$('[data-fn="saveCourse"]').parents(".tva-course-save").css({display:["access","drip","new","completion"].includes(i.slug)?"none":""})})),this.$el.append(n.render().$el),this.addChild(n)},saveCourse:function(e,t){var s=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.model.isValid())return!1;var n=this.model.changedAttributes();!1!==n&&Object.keys(n).includes("allows_comments")&&this.model.get("structure").updateChildrenCommentStatus(this.model.get("id"),this.model.get("allows_comments"),"course"),TVE_Dash.showLoader();var o=this.model.get("structure");this.model.get("is_private")||this.model.get("rules").resetRules();var a={success:function(){TVE_Dash.hideLoader(),s.$("#tva-course-preview").attr("href",s.model.get("preview_url")),s.model.set("structure",o),TVE_Dash.success(TVA.t.courseSaved)},error:function(e,t){if(TVE_Dash.hideLoader(),t&&t.responseJSON&&403===t.responseJSON.data.status)return TVE_Dash.err(TVA.t.courseNotSavedSessionExpired);var s="";t&&t.responseJSON&&(s=t.responseJSON.message),TVE_Dash.err("".concat(TVA.t.courseNotSaved," ").concat(s))}};return this.model.save(null,r.extend(a,i))},changeStatus:function(e,t){var s=this,i=t.dataset.status;if("future"!==i){var n=this.model.get("structure");this.model.set("status",i),TVE_Dash.showLoader(),this.model.save(null,{success:function(){s.model.set("structure",n),TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t["course_".concat(i)])}})}else this.openModal(m,{model:this.model,width:"400px",className:"tvd-modal tva-schedule-modal",statusProp:"status"})},onStructureStatusChanged:function(){var e=this;if(0===this.model.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"publish"}).length){TVE_Dash.showLoader();var t=this.model.get("structure");this.model.set("status","draft").save(null,{success:function(){e.model.set("structure",t),TVE_Dash.hideLoader()}})}TVA.$eventBus.trigger("courses_changed")},onAuthorChanged:function(e){var t=T[1],s=e instanceof Backbone.Model?e:this.model.get("author");t instanceof Backbone.View&&void 0!==t.model.get("avatar_url")&&(t.model.set(s.toJSON(),{silent:!0}),t.render())},onPermalinkChanged:function(e){this.$("#tva-course-preview").attr("href",e),TVA.$eventBus.trigger("courses_changed")}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a,c,l;o=jQuery,a=s(214),c=s(0),l=c.extend({template:TVE_Dash.tpl("select/add-item"),inputTemplate:_.template('<input type="text" placeholder="<#= this.str.title #>" class="">',TVE_Dash.templateSettings),str:{title:"Add new item",save:"Save",err:"Required field missing"},events:n(n({},c.prototype.events),{},{'keyup input[type="text"]':"onKeyup"}),initialize:function(e){this.state=new Backbone.Model({step:"default"}),o.extend(!0,this,e),this.listenTo(this.state,"change",this.render.bind(this))},onKeyup:function(e){switch(e.which){case 13:this.save();break;case 27:this.reset()}},afterRender:function(){this.$input=this.$("input").filter(":visible").not(".tva-dropdown-thumb input"),this.focusInput()},focusInput:function(){var e=this;requestAnimationFrame((function(){return e.$input.focus()}))},renderInput:function(){return this.inputTemplate({})},showInput:function(){return this.state.set("step","input"),!1},reset:function(){this.$input.val("").removeClass("tvd-validate tvd-invalid"),this.state.set("step","default")},save:function(){var e=this;if(!this.$input.val().trim())return this.$input.addClass("tvd-validate tvd-invalid"),TVE_Dash.err(this.str.err),this.focusInput(),!1;this.$input.removeClass("tvd-validate tvd-invalid");var t=this.getModelForSave();return this.$el.tvaToggleLoader(),t.save().done((function(s){!s.id&&s.ID&&(s.id=s.ID),e.addToCollection(s),e.dropdown.closeSelect(),e.$el.tvaToggleLoader(!1),"function"==typeof e.afterSave&&e.afterSave(s,t),e.dropdown.selectItem(e.dropdown.collection.findWhere({id:s.id}))})),!1},addToCollection:function(e){this.dropdown.collection.unshift(e)},destroy:function(){this.$(".tva-colorpicker").each((function(){var e=o(this);e.data("spectrum.id")&&e.spectrum("destroy")})),c.prototype.destroy.call(this)}}),e.exports=c.extend({thumbCssClass:"tva-dropdown-thumb",listCssClass:"tva-dropdown-list",listItemCssClass:"tva-dropdown-list-item",className:"tva-dropdown",template:TVE_Dash.tpl("select"),label:null,$thumb:null,renderThumbs:!1,deletable:!1,events:function(){return n(n({},c.prototype.events),{},{click:function(e){var t=o(e.target).closest("."+this.listItemCssClass);if(t.length){var s=parseInt(t.attr("data-id"));return this.selectItem(this.collection.findWhere(r({},this.collection.idAttribute,s)))}if("INPUT"===e.target.tagName.toUpperCase())return e.stopPropagation();e.target.closest("."+this.listCssClass)||(this.displayList(),e.stopPropagation())}})},initialize:function(e){var t=this;if(o.extend(!0,this,e),!e||!e.collection)throw new Error("collection has to be provided for this select view");if(!(e.collection instanceof a))throw new Error("collection has to inherit from specific select collection");this.model=this.collection.getSelectedItem(),this.collection.on("selectionchange",(function(e){return t.model=e}))},render:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.model)return console.error("No selected item to be rendered"),this;var s=o(this.template({model:this.model}));return!0===t&&(e=this.$(".tva-dropdown-items")).length?e.replaceWith(s.filter(".tva-dropdown-items")):this.$el.html(s),this.renderThumbs&&this.renderThumb(this.$el,this.model),this},getLabel:function(){return this.label},renderThumb:function(e,t){var s=o("<div/>").css("background-color",t.get("color")).addClass(this.thumbCssClass);return"icon"===t.get("icon_type")?s.css({"background-image":"url("+t.get("icon")+")"}):"svg_icon"===t.get("icon_type")?s.html(t.get("svg_icon")):t.get("url")?s.css({"background-image":"url("+t.get("url")+")"}):t.get("avatar_url")&&s.css({"background-image":"url("+t.get("avatar_url")+")"}),t.get("class")&&s.addClass(t.get("class")),s[0].style.setProperty("--thumb-color",t.get("color")),e.prepend(s),this},displayList:function(){var e=this;if(this.$("."+this.listCssClass).length)return this.closeSelect();this.trigger("tva.before.display.list");var t=o('<div class="tva-items-holder"></div>');return this.collection.each((function(s){var i=o("<div/>").addClass(e.listItemCssClass);e.renderThumbs&&e.renderThumb(i,s),i.append(o("<div/>").html(s.get("title")||s.get("name"))),i.attr("data-id",s.get(e.collection.idAttribute)),e.editable&&(i.append('<span class="tva-difficulty-edit tva-hide pl-10 click" data-fn="editItem">'.concat(TVA.Utils.icon("pencil-custom"),"</span>")),i.append('<div style="display: none;">\n\t\t\t\t\t\t\t\t\t\t<input class="m-0" id="tva-level-'+s.get("id")+'-name" type="text" data-bind="name">\n\t\t\t\t\t\t\t\t\t\t<label for="tva-course-'+s.get("id")+'-name"></label>\n\t\t\t\t\t\t\t\t\t</div>'),i.hover((function(){var e=o(this).find(".tva-difficulty-edit");e&&e.removeClass("tva-hide")})),i.mouseleave((function(){var e=o(this).find(".tva-difficulty-edit");e&&e.addClass("tva-hide")}))),e.deletable&&0!==parseInt(s.get("id"))&&i.append('<span class="tva-difficulty-delete click" data-fn="deleteItem" data-id="'.concat(s.get("id"),'">').concat(TVA.Utils.icon("trash-1"),"</span>")),t.append(i)})),this.$el.append(t.wrap('<div class="'.concat(this.listCssClass,'"></div>')).parent()),this.add_item&&(this.add_item.dropdown=this,this.addItemView=new l(this.add_item),this.addChild(this.addItemView),t.after(this.addItemView.render().$el)),this.trigger("tva.display.list",t,this),this},selectItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.model=e,this.collection.setSelected(this.model),this.render(t),this.trigger("tva.dropdown.item.selected",this.model,this.collection,t),this},closeSelect:function(){return this.addItemView&&this.addItemView.destroy(),this.$(".".concat(this.listCssClass)).remove()},editItem:function(e,t){var s=this;e.stopPropagation();var i=o(t).hide(),n=i.prev().hide(),r=i.next().show().find("> input").val(n.text()).focus().select();r.off("keyup blur click").on("keyup",(function(e){13===e.which&&s.saveName.call({self:s,value:r.val().trim(),id:r[0].id.match(/\d+/)[0]})})).on("click",(function(e){e.stopPropagation()})).on("blur",(function(){s.saveName.call({self:s,value:r.val().trim(),id:r[0].id.match(/\d+/)[0]})}))},saveName:function(){var e=this;if(this.value&&"string"==typeof this.value){var t=this.self.collection.models.find((function(t){return t.get("id")===parseInt(e.id)}));t.set("name",this.value),t.url="".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/levels/").concat(this.id),t.save(),this.self.render(),TVE_Dash.success(TVA.t.level_saved)}else TVE_Dash.err(TVA.t.EmptyName)},deleteItem:o.noop})},function(e,t,s){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=s(44),r=["tva_lesson","tva_chapter","tva_module"],o=!1;e.exports=s(3).extend({template:TVE_Dash.tpl("modals/schedule"),_itemName:"",beforeInitialize:function(){var e=void 0!==i(this.model.get("post_type"))?this.model.get("post_type"):"";this._prop="publish_date",this._itemName="",r.includes(e)?this._itemName=e.replace("tva_",""):"tva_courses"===this.model.get("taxonomy")?this._itemName="course":this._itemName="items"},afterMaterialize:function(){this.openDatepicker()},openDatepicker:function(){if(!0!==o){o=!0,new n({el:this.$("#tva-datepicker"),model:this.model,prop:this._prop,isInvalidDate:function(e){return!window.wp.date.isInTheFuture(e)}}).render();var e=window.wp.date.__experimentalGetSettings().timezone.offset,t=window.moment().utc().add(e,"hours").format("YYYY-MM-DD HH:mm:ss");e>0&&(e="+".concat(e)),this.$(".components-datetime__time").after(TVE_Dash.tpl("modals/date-info")({offset:e,local:t})),this.$(".components-datetime__buttons").hide()}else this.$("#tva-datepicker").show()},save:function(){var e=this,t=new Date(this.model.get(this._prop).replace(/-/g,"/"));t.setMinutes(t.getMinutes()-1);var s=("0"+t.getDate()).slice(-2),i=("0"+(t.getMonth()+1)).slice(-2),n=(t.getHours()<10?"0":"")+t.getHours(),r=(t.getMinutes()<10?"0":"")+t.getMinutes();if(!window.wp.date.isInTheFuture(t.getFullYear()+"-"+i+"-"+s+" "+n+":"+r+":00"))return TVE_Dash.err(TVA.t.schedule_past_date);if("function"==typeof this.saveSchedule)return this.saveSchedule();this._prop.length||this.close();this.model.set(this.statusProp,"future");var o=this.courseModel instanceof Backbone.Model?this.courseModel:this.model;if(this.model.get("post_status"))return TVE_Dash.showLoader(),this.close(),TVE_Dash.success(TVA.t["success_scheduled_".concat(this._itemName)]),o.trigger("tva.item.status.changed",{id:this.model.get("id"),status:"future"});var a=this.model.get("structure"),c=this.model.save(null,{success:function(){e.model.set("structure",a),o.trigger("tva.structure.status.changed")}});c&&(TVE_Dash.showLoader(),c.always((function(){TVE_Dash.hideLoader(),e.close(),TVE_Dash.success(TVA.t["success_scheduled_".concat(e._itemName)])})))},onClose:function(){o=!1}})},function(e,t,s){var i,n;i=jQuery,n=s(0),e.exports=n.extend({template:TVE_Dash.tpl("courses/media/settings"),$options:null,$types:null,types:[],afterInitialize:function(e){var t=this;i.extend(this,e),this.listenTo(this.model,"change:type",(function(){t.model.set("source",""),t.model.set("options",[]),t.renderOptions(),TVE_Dash.data_binder(t)}))},render:function(){var e=this;return this.$el.html(this.template({model:this.model})),this.$types=this.$("#tva-media-types"),this.types.forEach((function(t){e.$types.append(i("<option/>").val(t).text(TVE_Dash.upperFirst(t)))})),this.$types.val(this.model.get("type")),this.$types.select2(),this.$options=this.$("#tva-media-options"),this.renderOptions(),TVE_Dash.data_binder(this),this},renderOptions:function(){var e=this,t="",s=this.model.get("type").toLowerCase();switch(s){case"youtube":case"vimeo":case"wistia":case"custom":t="courses/media/"+s;break;default:t="courses/media/default"}var i=TVE_Dash.tpl(t);this.$options.html(i({model:this.model})),Object.keys(this.model.get("options")).forEach((function(t){e.$('input:checkbox[data-prop="'+t+'"]').prop("checked",1===e.model.get("options")[t])}))},toggleMediaOption:function(e,t){var s=t.dataset.prop;return!!s&&(0===this.model.get("options").length&&this.model.set("options",{}),e.currentTarget.checked?this.model.get("options")[s]=1:delete this.model.get("options")[s])}})},function(e,t,s){var i=s(46),n=s(47),r=s(7);e.exports=i.extend({template:TVE_Dash.tpl("courses/chapter"),renderStructure:function(e,t){var s=this;e.each((function(e,i){e.get("structure")instanceof r||e.set("structure",new r(e.get("structure")));var o={model:e,numberInList:i+1,expanded:s.expanded,course:s.course},a=new n(o);t.append(a.render().$el),s.addChild(a)}));var i=this.$("> .tva-cm-box .tva-cm-status"),o=this.model.get("structure").findItemsByOptions({post_status:"draft"}),a=this.model.get("structure").findItemsByOptions({post_status:"future"});this.model.isPublished()&&(o.length||a.length)?i.attr("data-tooltip",TVE_Dash.sprintf(TVA.t.ContentNotPublished,TVA.t.Chapter)).addClass("yellow"):"publish"===this.model.get("post_status")?i.attr("data-tooltip",TVA.t.ChapterPublished):i.attr("data-tooltip",TVA.t.ChapterNotPublished)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=TVE_Dash.views.ModalSteps,a=s(85);e.exports=o.extend({template:TVE_Dash.tpl("courses/grouping/chapter"),parent:null,course:null,structure:null,orphans:[],selectedItems:[],events:function(){return n(n({},o.prototype.events),{},{"click .tvd-modal-save":"save"})},initialize:function(e){this.setup(e),o.prototype.initialize.call(this,e),this.setupOrphans()},setupOrphans:function(){var e=this;this.selectedItems.some((function(t){var s=t.getParent(),i=null;return s?"module"===s.getType()&&(i=s.get("structure")):i=e.structure,i&&(e.orphans=i.filter((function(t){return!e.selectedItems.includes(t)}))),!!i}))},prepareSelection:function(e){return e},setup:function(e){this.parent=e.parent,this.course=this.parent.model,this.structure=this.parent.collection,this.selectedItems=this.prepareSelection(e.parent.selected)},getNewItemParent:function(){var e=this.selectedItems[0].getModule();return e?e.get("ID"):0},getNewItemOrder:function(){var e=this.selectedItems[0].getModule();return this.structure.countChildren(e?e.get("ID"):0)},afterRender:function(){o.prototype.afterRender.call(this);var e=this.getNewItemParent(),t=this.getNewItemOrder();if(this.orphans.length){var s=t;this.orphans[0].get("order")<this.selectedItems[0].get("order")?t++:s=t+1,this.orphanItemForm=new Backbone.View({model:this.newModel(s,e,this.orphans.map((function(e){return e.get("ID")}))),el:this.$(".tva-orphans-form")[0]}),TVE_Dash.data_binder(this.orphanItemForm)}this.itemForm=new Backbone.View({model:this.newModel(t,e,this.selectedItems.map((function(e){return e.get("ID")}))),el:this.$(".tva-chapter-form")[0]}),TVE_Dash.data_binder(this.itemForm)},beforeNext:function(){switch(this.currentStep){case 1:if(this.orphans.length&&!this.orphanItemForm.model.isValid())return!1}},newModel:function(e,t,s){return new a({post_parent:t,type:"chapter",order:e,course_id:this.course.get("id"),item_ids:s})},url:function(){return"".concat(TVA.routes.chapters,"/group_as_chapter")},successMessage:function(){return TVA.t.success_chapter_group},save:function(){var e=this;if(!this.itemForm.model.isValid())return!1;var t=[];this.orphans.length&&t.push(this.orphanItemForm.model.toJSON()),t.push(this.itemForm.model.toJSON()),this.showLoader(),wp.apiRequest({url:this.url(),type:"post",data:{course_id:this.course.get("id"),items:t}}).done((function(t){e.structure.reset(t),e.close(),TVE_Dash.success(e.successMessage())}))}})},function(e,t){var s,i;s=jQuery,i=TVE_Dash.views.IconModal.extend({afterInitialize:function(){this.selected=this.model.get("icon").match(/^([a-z0-9-_])*$/g)?this.model.get("icon"):""},saveIcon:function(){var e=s(this.selectedIcon);this.downloadIcon(e)},afterSave:function(e){"function"==typeof this.saveCallback?this.saveCallback(e.icon[0].outerHTML):this.model.persist({icon_type:"svg_icon",svg_icon:e.icon[0].outerHTML,icon:e.icon[0].id.replace("icon-","")}),this.close()}}),e.exports=i},function(e,t,s){var i=s(41),n=s(22);e.exports=s(3).extend({template:TVE_Dash.tpl("modals/products/add"),afterInitialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.editRedirect=e.screen&&"list"===e.screen,this.courseRedirect=e.screen&&"course"===e.screen,this.productModel=e.productModel||new i,this.setModel=e.setModel||new TD_SETS.Models.Set,this.setModel.allowEmptyRules=!0},afterRender:function(){this.$formWrapper=this.$(".tva-product-details"),this.$name=this.$("#product_name").val(this.productModel.get("name")),this.formSection&&this.formSection.destroy(),this.formSection=new n({setModel:this.setModel}),this.$formWrapper.html(this.formSection.render().$el),this.productModel.get("name").trim().length&&this.$name.val(this.productModel.get("name").trim())},getTitle:function(){return this.$name.val().trim()},createProduct:function(){var e=this,t=this.getTitle();if(0===t.length)return this.$name.addClass("tvd-validate tvd-invalid").focus(),void TVE_Dash.err(TVA.t.productNameRequired);this.setModel.set({post_title:t},{silent:!0}),this.productModel.set({name:t},{silent:!0}),this.setModel.isValid()?(this.productModel.get("sets").add(this.setModel),TVE_Dash.showLoader(),this.productModel.save(null,{success:function(){if(e.collection.add(e.productModel),e.collection.changeTotal(1),e.editRedirect)TVA.Router.navigate("#products/".concat(e.productModel.get("id"),"/content"),{trigger:!0});else if(e.courseRedirect){var t=parseInt(Backbone.history.getFragment().split("/")[1]);setTimeout((function(){return TVA.courses.findWhere({id:t}).set("fetched",!1)})),TVA.Router.navigate("#products/".concat(e.productModel.get("id"),"/content/").concat(t),{trigger:!0})}},error:function(e,t){t&&t.responseJSON?TVE_Dash.err(t.responseJSON.message):TVE_Dash.err("Something went wrong with adding new product")}}).always((function(){e.close(),TVE_Dash.hideLoader()}))):TVE_Dash.err(this.setModel.getValidationError())}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(0),a=s(44),c=o.extend({className:"tva-drip-schedule",templates:{repeating:TVE_Dash.tpl("drip/schedule/repeating"),non_repeating:TVE_Dash.tpl("drip/schedule/non-repeating"),specific:TVE_Dash.tpl("drip/schedule/specific")},options:{},afterInitialize:function(e){var t=this;if(!e.type||!this.templates[e.type])throw new Error("Missing or invalid `type` field in schedule view constructor");Array.isArray(e.schedule)&&_.isEmpty(e.schedule)&&delete e.schedule,this.type=e.type,this.template=this.templates[e.type],e.schedule=jQuery.extend({},TVA.drip.schedule_defaults[e.type],e.schedule||{}),this.options=jQuery.extend(!0,{},e.options||{}),this.model=new Backbone.Model,this.setData(e.schedule,{silent:!0}),this.listenTo(this.model,"change",(function(){t.render(),t.trigger("model-change")}))},afterRender:function(){var e=this;if(this.$el.off().on("change","[data-field]",(function(t){var s={},i=t.currentTarget;if("number"===i.type){""===i.value.trim()&&(i.value=i.min||1);var o=parseInt(i.value);i.min&&o<parseInt(i.min)&&(i.value=i.min),i.max&&o>parseInt(i.max)&&(i.value=i.max),String(o)!==i.value&&(i.value=o),s.silent=!0}void 0!==t.currentTarget.dataset.silent&&(s.silent=!0);var a=r({},i.dataset.field,i.value);"interval"===i.dataset.field&&(a=n(n({},TVA.drip.schedule_defaults[e.type]),{},{interval:i.value})),e.model.set(a,s)})),this.model.changed.interval&&this.model.previous("interval_number")){var t=parseInt(this.model.previous("interval_number"));"days"===this.model.get("interval")&&t>5&&(t=1),this.model.set("interval_number",t)}if(this.type===c.TYPE_SPECIFIC)var s=a.renderPopup(this.$(".tva-popup-datepicker"),{model:this.model,prop:"datetime",silent:!0,active:"date",static:!0,isInvalidDate:function(e){return wp.date.format("d-m-Y",e)!==wp.date.format("d-m-Y")&&!wp.date.isInTheFuture(e)},onChange:function(e){i.setDate(e,{silent:!0})}}),i=a.renderInline(this.$(".tva-popup-timepicker"),{model:this.model,prop:"datetime",is12HourTime:!1,silent:!0,onChange:function(e){s.setDate(e,{silent:!0})}});TVA.Utils.bindModalSelect2(this.$("select"))},getData:function(){return n({type:this.type},this.model.toJSON())},setData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.model.set(e,t),this},renderDropdown:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i='<select data-field="'.concat(e,'"').concat((" "+s).trim(),">"),n=this.model.get(e);return t.forEach((function(e){var t=e.value,s=e.label;i+='<option value="'.concat(_.escape(t),'"').concat(String(n)===String(t)?" selected":"",">").concat(_.escape(s),"</option>")})),i+="</select>"},getIntervalNumber:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.model.get("interval_number");return e&&isNaN(parseInt(t))&&(t="1",this.model.set("interval_number",t,{silent:!0})),t}},{TYPE_SPECIFIC:"specific",TYPE_NON_REPEATING:"non_repeating",TYPE_REPEATING:"repeating",renderTo:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=new c({type:t,schedule:s,options:i});return jQuery(e).html(n.render().$el),n}});e.exports=c},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(0),a=s(99);e.exports=o.extend({className:"tva-inline-datetime",template:TVE_Dash.tpl("drip/triggers/datetime"),afterRender:function(){var e=this.$(".tva-trigger-schedule");e.length&&(this.schedule=a.renderTo(e,this.model.scheduleType,this.model.get("schedule"),{hideLabel:!0}),this.addChild(this.schedule)),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select"))},getData:function(){var e;return n(n({},this.model.toJSON()),{},{schedule:(null===(e=this.schedule)||void 0===e?void 0:e.getData())||{}})}})},function(e,t,s){var i=s(100);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/purchase")})},function(e,t,s){e.exports=s(3).extend({template:TVE_Dash.tpl("modals/api-key"),afterInitialize:function(){var e=this;this.listenTo(this.model,"change:key",(function(t){e.$("#tva-token-key").val(t.get("key"))}))},changeFiled:function(e,t){var s={};s[t.getAttribute("data-field")]="checkbox"===t.type?Number(t.checked):t.value,this.model.set(s)},save:function(){var e=this,t=!!this.model.get("id");this.model.isValid()?(TVE_Dash.showLoader(),this.model.save(null,{success:function(s){!1===t?(e.collection.add(e.model),TVE_Dash.success(TVE_Dash.sprintf(TVA.t.token_name_saved,s.get("name")))):TVE_Dash.success(TVE_Dash.sprintf(TVA.t.token_name_saved,s.get("name")))},error:function(e,t){TVE_Dash.err(t.responseJSON.message)},complete:function(t){200===t.status&&e.close(),TVE_Dash.hideLoader()}})):TVE_Dash.err(this.model.getValidationError())}})},function(e,t,s){var i,n,r;i=jQuery,n=s(26),r=s(79),e.exports=n.extend({template:TVE_Dash.tpl("courses/integration-thrivecart"),$checkboxRule:null,initialize:function(e){i.extend(!0,this,e),this.listenTo(this.rules,"update",this.renderLabel),this.listenTo(this.rules,"update",this.renderStatus)},afterRender:function(){n.prototype.afterRender.apply(this,arguments),this.$checkboxRule=this.$("#tva-thrivecart-checkbox-rule").prop("checked",this.rules.findWhere({integration:this.model.get("slug")}))},renderLabel:function(){this.rules.findWhere({integration:this.model.get("slug")})?this.$label.html(this.model.getText()):(this.$label.first().html(""),this.$label.eq(1).html(this.model.getText()))},renderStatus:function(){},toggleRule:function(e,t){if(t.checked&&!this.rules.findWhere({integration:this.model.get("slug")})){var s=new r({integration:this.model.get("slug")});s.resetItems(void 0),this.rules.add(s)}else this.rules.remove(this.rules.findWhere({integration:this.model.get("slug")}))}})},function(e,t,s){var i;jQuery,i=s(26),e.exports=i.extend({template:TVE_Dash.tpl("courses/integration-woocommerce"),renderStatus:function(){var e=this.model.get("allow")?"&nbsp;":TVA.t.not_set;this.$status.html(e)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(6),a=s(3),c=new(s(298));e.exports=a.extend({stepCss:{0:{width:"630px"}},template:"modals/skins/cloud",filterText:"",afterInitialize:function(){var e=this;c.$$fetched||_.delay(this.showLoader.bind(this),100),c.fetchOnce().then(this.hideLoader.bind(this)),this.show_first_step&&(0===TVA.indexPageModel.previewUrl().length&&TVA.indexPageModel.set({state:"create"},{silent:!0}),this.listenTo(TVA.indexPageModel,"change",(function(t){t.get("value")||(TVA.settings.wizard.value=0,e.model.set("value",0),e.model.save())})))},getName:function(){return this.$nameInput.val()},dom:function(){var e;this.$nameInput=this.$("#tva-add-skin-name"),this.show_first_step?(new o({el:this.$(".tva-course-states-container"),model:TVA.indexPageModel,states_views_path:"./page-states-cloud/",labels:{search:{title:"Set your courses page"},normal:{title:"Course page"},delete:{title:"Are you sure you want to remove this course page?"}},afterRender:function(){this.$(".tva-edit-page-with-tar,.tva-view-page").remove()}}).render(),e=TVA.settings.index_page.value?1:0):e=2,this.gotoStep(e)},createSkin:function(){var e=this,t=this.getName();if(0===t.trim().length)return TVE_Dash.err(TVA.t.InvalidName),!1;if(TVA.skins.getByName(t))return TVE_Dash.err(TVA.t.skin_invalid_name.replace("{name}","<strong>".concat(t,"</strong>"))),!1;this.showLoader();var s={always:!0};return wp.apiRequest({url:c.url()+"/"+c.first().get("id"),data:n({skin_scope:"tva",skin_name:t},this.skin_download_params||{})}).then((function(i){i.just_added=1,i.name=t,"function"==typeof e.download_callback?e.download_callback.call(e,i,s):(e.trigger("cloud-skin-downloaded",i),TVE_Dash.success(TVA.t.skin_imported.replace("{name}","<strong>".concat(i.name,"</strong>")))),e.close()})).always((function(){s.always&&e.hideLoader()})).fail((function(e){var t;return TVE_Dash.err((null===(t=e.responseJSON)||void 0===t?void 0:t.message)||e.responseText,3e3)})),!1},allowJumpToStep:function(e){var t=1!==this.currentStep||2!==e||!!TVA.indexPageModel.get("value");return t||TVE_Dash.err("You need to define a page where all your courses will reside."),t},afterStep2Loaded:function(){this.$nameInput.focus()}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a;o=jQuery,a=s(1),e.exports=a.extend({template:TVE_Dash.tpl("design/new/skin-item"),className:"tva-skin-item-screen",afterInitialize:function(e){var t=this;this.model=TVA.skins.findWhere({term_id:parseInt(e.id)}),this.model||(console.warn("Invalid skin ID"),this.template=o.noop),this.listenTo(TVA.skins,"sync",(function(){t.skip_render_one||(t.model=TVA.skins.findWhere({term_id:parseInt(e.id)}),t.render()),delete t.skip_render_one})),o(window).one("typographyloaded",(function(e){t.$(".ttd-typography-content").css("height",25+e.detail.frame_height+"px")})).off("message.typography").on("message.typography",(function(e){var s,i=e.originalEvent;i.isTrusted&&"ttb-typography-saved"===(null===(s=i.data)||void 0===s?void 0:s.action)&&t.reloadTypographyPreview()}))},afterRender:function(){this.$(".tva-skin-item-active-label").html(this.model.isActive()?'<span class="tva-published">Published</span>':'<span class="tva-unpublished">Not published</span>'),this.$(".tva-skin-not-publish-display").toggle(!this.model.isActive());var e=this.$(".ttd-typography-block").tvaToggleLoader(20,!0);this.$typographyFrame=this.$("iframe").on("load",(function(){return e.tvaToggleLoader(!1)})).on("preload",(function(){return e.tvaToggleLoader(20,!0)}))},rename:function(){var e=this;this.$(".tva-skin-name").tvaInlineEdit({validation_fn:function(e){return!TVA.skins.getByName(e)||(TVE_Dash.err(TVA.t.skin_invalid_name.replace("{name}","<strong>".concat(e,"</strong>"))),!1)}}).one("change",(function(t,s){e.model.set("name",s),e.model.save(null,{silent:!0})}))},back:function(){this.changeView("design")},publish:function(){var e=this;TVA.Utils.confirmation(n(n({},TVA.t.skin_publish_confirmation),{},{title:TVA.t.skin_publish_confirmation.title.replace("{title}","<strong>".concat(this.model.get("name"),"</strong>")),yesClass:"tva-modal-btn-blue"})).then((function(){TVA.skins.setDefaultSkin(e.model).then((function(){TVE_Dash.success(TVA.t.skin_published.replace("{name}","<strong>".concat(e.model.get("name"),"</strong>")),3e3)}))}))},reloadTypographyPreview:function(){this.$typographyFrame.trigger("preload").attr("src",this.$typographyFrame.attr("src"))},changeInheritTypography:function(e){this.skip_render_one=!0,this.model.set({inherit_typography:e.currentTarget.checked},{silent:!0}),this.model.patch("inherit-typography",{value:e.currentTarget.checked?1:0}),this.$(".ttd-typography-block").toggle(!this.model.inheritTypography())},toggleTypography:function(){var e=this.$(".ttd-typography-block").toggleClass("ttd-block-expand").hasClass("ttd-block-expand");this.$(".height-toggle .text").html(e?"COLLAPSE":"EXPAND")},resetTypography:function(){var e=this;TVA.Utils.confirmation(TVA.t.typography_reset_confirmation).then((function(){e.$typographyFrame.trigger("preload"),e.model.patch("reset-typography").then((function(){e.reloadTypographyPreview(),TVE_Dash.success(TVA.t.typography_reset_done)}))}))}})},function(e,t,s){var i,n,r,o,a,c,l,u;i=jQuery,n=s(1),r=s(171),o=s(63),a=s(87),c=s(62),l=s(218),u=s(0).extend({tagName:"div",className:"tcb-template-options-tooltip",template:"design/new/options-tooltip"}),e.exports=n.extend({skin_id:null,filterModel:null,template:TVE_Dash.tpl("design/new/skin-item-templates"),afterInitialize:function(e){this.skin_id=parseInt(e.id),this.model=TVA.skins.findWhere({term_id:this.skin_id}),this.filterModel=new l({}),this.optionsTooltip=(new u).render(),this.model||(console.warn("Invalid skin ID"),this.template=i.noop),this.listenTo(this.model.get("templates"),"reset remove",this.render),this.listenTo(this.filterModel,"tva_dash:filter",this.renderTemplates)},afterRender:function(){this.$list=this.$(".ttd-templates-inner"),this.$settings=this.$(".ttd-settings-container"),this.renderTemplates(),this.$(".ttd-settings-container").prepend(new c({model:this.filterModel}).render().$el)},renderTemplates:function(){var e=this;this.$list.empty();var t=this.model.get("templates").filterItems(this.filterModel.get("template"));this.filterModel.setOptions({counter:t.length},!0),t.forEach((function(t){var s=new o({model:t,filterModel:e.filterModel,collection:e.model.get("templates"),optionsTooltip:e.optionsTooltip});if(e.$list.append(s.render().$el),t.isJustAdded()){if(!TVA.Utils.is_in_viewport(s.el)){var i=s.el.getBoundingClientRect().top-60;window.scrollTo({top:i,behavior:"smooth"})}s.$el.addClass("ttd-just-added"),setTimeout((function(){return s.$el.removeClass("ttd-just-added")}),5e3),t.set("just_added",0)}}))},addTemplate:function(){this.openModal(r,{width:"808px",top:"10%",model:new a,filterModel:this.filterModel,collection:this.model.get("templates"),skin_id:this.skin_id,className:"tvd-modal tva-skin-template-modal"})},back:function(){TVA.Router.navigate("#design/".concat(this.skin_id),{trigger:!0})}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(1),a=s(64),c=s(65);e.exports=o.extend({template:"design/wizard",className:"ta-wizard-container p-0",id:"tva-wizard",popupCoords:{top:0,left:"50%"},render:function(){var e=this;return TVE_Dash.showLoader(),this.model.$$fetched?o.prototype.render.apply(this,arguments):(this.model.fetch().then((function(){e.model.setOriginalData(),e.model.loadStepTemplates()})).fail((function(e){return TVE_Dash.err(e.responseJSON.message||"Something went wrong")})).always((function(){return e.render()})),this)},afterInitialize:function(e){var t=this;this.model=TVA.skins.getWizard(e.id),this.model.on("ajax-done",(function(e){["school","course","module","lesson"].includes(e)&&t.skin.refreshTemplates()})),this.skin=TVA.skins.get(e.id),this.id="tva-wizard",this.$el.attr("id","tva-wizard"),window.TVA.wizardView=this,this.top=new c({model:this.model,skin:this.skin}),this.sidebar=new a({model:this.model,skin:this.skin}),this.addChild(this.sidebar,this.top),this.top.parent=this,this.model.on("step-change",this.onStepChange.bind(this)),this.model.on("finished",(function(){t.loadPreview()})),this.model.on("templates-loaded",(function(e){var s=t.model.get("active");if(e.length){var i=t.model.getPreviewTemplateId(),n=t.model.getPreviewTemplateSource();t.previewTemplate({id:i||e[0].id,source:n||e[0].source,previewedStep:s},!1)}})),TVA.$eventBus.off("page_keyup.wizard").on("page_keyup.wizard",this.onKeyup.bind(this))},afterRender:function(){this.$dom={wrapper:this.$(".ttd-wizard-content"),frame:this.$("#wizard-frame"),container:this.$(".ttd-wizard-frame-container"),welcome:this.$(".ttd-wizard-welcome"),overlay:this.$(".ttd-wizard-frame-overlay"),nav:this.$(".ttd-template-nav")},this.top.setElement(this.$("#ttd-wizard-top")),this.top.render(),this.sidebar.setElement(this.$("#tva-wizard-sidebar")),this.sidebar.render(),this.loadPreview()},start:function(){return this.model.start(),!1},onStepChange:function(e,t){this.$dom.wrapper.removeClass((function(e,t){return t.split(" ").filter((function(e){return 0===e.indexOf("step-")})).join(" ")})).addClass("step-".concat(e.id)),t&&t.id!==e.id&&this.$dom.overlay.empty(),this.loadPreview()},loadPreview:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.model.getFrameURL(),s=this.$dom.frame.attr("src");s&&(s=s.replace(/(\\?|&)_=(\d+)/,"",t)),t&&s!==t?(t=TVA.Utils.buildUrl(t,{_:String((new Date).getTime())}),this.$dom.nav.hide(),this.loading(),this.$dom.frame.attr("src",t).one("load",(function(){setTimeout(e.loading.bind(e,!1),300)}))):this.buildOverlay()},buildOverlay:function(){if(this.iframeData){setTimeout((function(){return TVE_Dash.hideLoader()}),300),this.top.render(),this.$dom.overlay.empty();var e=this.getStepOverlay();e instanceof Backbone.View?("function"==typeof e.beforeMainRender&&e.beforeMainRender(this),e.setElement(this.$dom.overlay),e.parent=this,e.render()):this.$dom.overlay.html(e).toggle(!!e),!this.model.isStepCompleted()&&this.model.getPreviewTemplateId()?this.$dom.nav.show().filter(".btn-prev").toggleClass("disabled",!this.model.hasAdjacentTemplate("prev")).end().filter(".btn-next").toggleClass("disabled",!this.model.hasAdjacentTemplate("next")):this.$dom.nav.hide(),this.showTooltip(),this.contentClass()}},loading:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?TVE_Dash.showLoader(!0):TVE_Dash.hideLoader()},getStepOverlay:function(){var e;if(this.$dom.overlay.removeAttr("style"),this.model.isStarted())if(this.model.isFinished())e="design/wizard/overlay-finished";else{var t=this.model.getCurrentStep();t||(t=this.model.getNextAvailableStep(),this.model.set({active:t.id,activeIndex:this.model.getNextAvailableStepIndex()},{silent:!0}));var i=t.id;e="";var n="calc(50% + ".concat(this.iframeData.headerHeight/2,"px)"),r="".concat(this.iframeData.scrollWidth||0,"px");switch(this.popupCoords.top="".concat(this.iframeData.headerHeight+50,"px"),i){case"logo":e=s(67);break;case"color":e=s(68);break;case"header":this.$dom.overlay.css("margin-top",this.iframeData.headerHeight),n="".concat(this.iframeData.headerHeight/2,"px");break;case"footer":this.$dom.overlay.css("bottom",this.iframeData.footerHeight+"px"),n="calc(100% - ".concat(this.iframeData.footerHeight/2,"px)"),this.popupCoords.top="calc(100% - ".concat(this.iframeData.footerHeight+250,"px)");break;case"menu":e=s(69);break;case"sidebar":r="calc(100% - ".concat(this.iframeData.sidebarWidth,"px - ").concat(this.iframeData.scrollWidth||0,"px)")}this.$dom.nav.css({top:n}).filter(".btn-next").css({right:r})}else e="design/wizard/overlay-welcome";return!e||e instanceof Backbone.View||(e=TVE_Dash.tpl(e)({view:this,data:this.iframeData,skin:this.skin,wizard:this.model})),e},clickSaveTemplate:function(){return this.saveTemplate(),!1},saveTemplate:function(){var e;this.hideTooltip();var t=Number(this.model.getPreviewTemplateId()),s=this.skin.getTemplates().get(t);s&&s.setDefault(),null!==(e=this.model.getCurrentStep())&&void 0!==e&&e.delayNextStep&&TVE_Dash.showLoader(),this.model.completeStep()},onNavigationArrowClick:function(e,t){var s=t.dataset.direction;this.displayAdjacentTemplate(s)},displayAdjacentTemplate:function(e){return this.model.hasAdjacentTemplate(e)&&this.previewTemplate({id:this.model.getAdjacentTemplateId(e),source:this.model.getAdjacentTemplateSource(e)}),!1},onKeyup:function(e){switch(e.which){case 37:this.displayAdjacentTemplate("prev");break;case 39:this.displayAdjacentTemplate("next")}},hideTooltip:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.$("#ttd-step-tooltip");e?(t.addClass("ttd-out"),setTimeout((function(){return t.removeClass("ttd-visible ttd-out")}),1e3)):t.removeClass("ttd-visible")},showTooltip:function(){this.hideTooltip();var e=this.model.getPopupMessage();if(!(this.lastHoveredElement&&this.lastHoveredElement.closest("#template-selector"))&&e&&!TVA.Utils.isTooltipViewed("wizard-select")){var t=this.top.$(".selector-btn");this.$("#ttd-step-tooltip").addClass("ttd-visible").css({right:"".concat((t.outerWidth()||0)+15,"px")}).find(".tt-message").html(e)}},tooltipNeverShow:function(){return this.hideTooltip(!0),TVA.Utils.saveTooltips("wizard-select"),!1},dismissTooltipOnMouseenter:function(){this.hideTooltip(!0)},previewTemplate:function(e){var t=this,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=function(){var s=!0;return e.previewedStep&&(s=e.previewedStep===t.model.get("active")),s};if(!this.templateLoading&&i()){if(void 0===this.iframeAPI)return setTimeout(this.previewTemplate.bind(this,e,s),200);var n=this.model.getStepKey("previewMode");this.templateLoading=!0,this.$(".template-loading").addClass("ttd-loading"),"iframe"!==n?this.iframeAPI.getPreviewElement().addClass("ttb-loading"):TVE_Dash.showLoader(),this.model.selectTemplate(e).then((function(r){if(delete t.templateLoading,s&&t.hideTooltip(),i()&&"iframe"!==n){if(void 0===t.iframeAPI)return setTimeout(t.previewTemplate.bind(t,e,s),200);t.iframeAPI.inlinePreview(r)}}))}},contentClass:function(){var e=this.model.get("active");this.model.isFinished()&&(e="finished"),this.$dom.wrapper.removeClass((function(e,t){return t.split(" ").filter((function(e){return e.startsWith("step-")||e.startsWith("home--")})).join(" ")})).addClass("step-".concat(e||"welcome").concat(""))},publishSkin:function(){var e=this;TVA.Utils.confirmation(n(n({},TVA.t.skin_publish_confirmation),{},{title:TVA.t.skin_publish_confirmation.title.replace("{title}","<strong>".concat(this.skin.get("name"),"</strong>")),yesClass:"tva-modal-btn-blue"})).then((function(){TVA.skins.setDefaultSkin(e.skin).then((function(){TVE_Dash.success(TVA.t.skin_published.replace("{name}","<strong>".concat(e.skin.get("name"),"</strong>")),3e3),TVA.Router.navigate("#design/".concat(e.skin.get("term_id"),"/skin-templates"),{trigger:!0})}))}))},recordMouseOver:function(e){this.lastHoveredElement=e.target},gotoCourses:function(){jQuery('[data-route="#courses"]').trigger("click")}})},function(e,t,s){var i=s(19);e.exports=i.extend({template:TVE_Dash.tpl("labels/button-label"),afterRender:function(){}})},function(e,t,s){var i=s(3);e.exports=i.extend({template:TVE_Dash.tpl("modals/topics/confirm-delete"),open:function(){var e=this;return i.prototype.open.apply(this,arguments),new Promise((function(t){e.$$promiseResolver=t}))},performDelete:function(){return this.close(),requestAnimationFrame(this.$$promiseResolver),!1}})},function(e,t,s){var i;i=jQuery,e.exports=s(1).extend({template:TVE_Dash.tpl("access-restriction/states/normal"),labels:{title:""},settings:{edit_with_tar:!0},afterInitialize:function(e){this.settings.edit_with_tar=!0,i.extend(!0,this,e),"custom_link"===this.model.get("category")&&(this.settings.edit_with_tar=!1)},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels,settings:this.settings})),this.afterRender(),this},removePage:function(){this.model.set("state","delete")}})},function(e,t,s){var i,n;i=jQuery,n=s(143),e.exports=s(1).extend({template:TVE_Dash.tpl("access-restriction/states/search"),labels:{title:"",text:TVA.t.search},afterInitialize:function(e){i.extend(!0,this,e),this.href=""},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels})),this.initPostSearch(),this.afterRender(),this},getFullUrl:function(e){return e&&!/^(?:[a-z]+:|#|\?|\.|\/)/.test(e)&&(e="//"+e),e},initPostSearch:function(){var e,t=this;new n(this.$("#tva-search-base-page"),{url:TVA.Utils.buildUrl("".concat(TVA.routes.settings,"/search_pages/"),(null===(e=this.settings)||void 0===e?void 0:e.ajaxData)||{}),renderItem:function(e,t){return i('<li class="tva-selected-post">').append('<span class="tva-ps-result-title">'.concat(t.label,'</span><span class="tva-ps-result-email"> (').concat(t.type,")</span>")).appendTo(e)},select:function(e,s){if("Link"===s.item.type)TVE_Dash.err("Please choose a local page to redirect to");else{TVE_Dash.showLoader(),t.model.set("value",s.item.id);var i=t.model.save();i&&(i.done((function(){t.model.set("state","normal")})),i.always((function(){TVE_Dash.hideLoader()})))}}})},createPage:function(){this.model.set("state","create")}})},function(e,t,s){var i=s(10);e.exports=s(1).extend({template:TVE_Dash.tpl("products/single/content-item"),afterInitialize:function(e){this.product=e.product},afterRender:function(){this.$contentItem=this.$(".tva-product")},removeContentSet:function(){var e=this,t=new i({template:TVE_Dash.tpl("products/content-sets/delete"),className:"tva-delete-simple",confirm:function(){TVE_Dash.showLoader(),e.product.get("sets").remove(e.model),e.product.saveSets().done((function(){TVE_Dash.hideLoader(),e.remove()}))}});this.$contentItem.append(t.render().$el)}})},function(e,t,s){var i,n=s(14),r=s(22);e.exports=n.extend({template:TVE_Dash.tpl("products/single/content"),tooltipKey:"product-more-settings",afterInitialize:function(){i&&i.destroy(),i=new r({setModel:this.model.getDefaultSet(),autoSave:!0})},afterRender:function(){var e=this;n.prototype.afterRender.call(this),this.$formWrapper=this.$(".tva-product-details"),this.$productName=this.$(".tva-product-name"),this.$tooltip=this.$(".tva-product-info-tooltip"),this.$formWrapper.html(i.render().$el),this.$tooltip.length&&!TVA.Utils.isTooltipViewed(this.tooltipKey)&&requestAnimationFrame((function(){return e.showTooltip()}))},renameProduct:function(){var e=this,t=this.model.get("id");this.$productName.unbind(),this.$productName.tvaInlineEdit({validation_fn:function(e){return"string"==typeof e&&0!==e.trim().length&&(!TVA.products.getByName(e,t)||(TVE_Dash.err(TVA.t.product_invalid_name.replace("{name}","<strong>".concat(e,"</strong>"))),!1))}}).one("change",(function(t,s){e.model.set({name:s},{silent:!0}),e.model.save(null,{silent:!0}),e.$(".tva-product-subheading").text(s)}))},showTooltip:function(){this.$tooltip.addClass("tva-visible")},hideTooltip:function(){var e=this;return this.$tooltip.addClass("tva-out"),setTimeout((function(){return e.$tooltip.removeClass("tva-visible tva-out")}),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},function(e,t,s){var i,n;i=jQuery,n=s(14),e.exports=n.extend({template:TVE_Dash.tpl("products/single/drip"),template_empty:TVE_Dash.tpl("products/single/drip-empty"),course_template:TVE_Dash.tpl("products/single/drip-course-item"),className:"tva-product-drip",afterRender:function(){n.prototype.afterRender.apply(this,arguments),this.model.fetchCourses().then(_.bind(this.renderCourses,this))},renderCourses:function(e){var t=this;0!==e.length?(this.$("#tva-drip-courses-list").addClass("tva-visible"),e.each((function(e){var s=i(t.course_template({course:e})),n=s.find("select");_.each(e.get("drip_campaigns"),(function(e){n.append('<option value="'.concat(e.id,'">').concat(e.post_title,"</option>"))})),n.val(e.get("selected_campaign")||"0"),n.length&&(n.select2(),n.data("select2").$dropdown.addClass("tva-no-border-select")),t.$("#tva-drip-courses-list").append(s)}))):this.$(".tva-drip-courses-empty").html(this.template_empty({product:this.model}))},setCampaign:function(e){var t=parseInt(e.currentTarget.dataset.courseId),s=parseInt(e.currentTarget.value);this.model.get("courses").findWhere({id:t}).set("selected_campaign",s),this.model.assignDripCampaign(s,t),TVA.customers.resetIndividualStudentViews()}})},function(e,t,s){var i=s(55),n=s(186),r=s(81),o=s(43),a=s(14),c=s(10),l=s(2);e.exports=a.extend({template:TVE_Dash.tpl("products/single/restricted-content"),className:"tva-product-restricted-content",dragHandleSelector:".tva-drag-handle",afterInitialize:function(){this.listenTo(this.model.get("access_restrictions").custom,"add settings_changed",this.render)},afterRender:function(){a.prototype.afterRender.call(this),this.$itemsWrapper=this.$("#tva-restriction-wrapper"),this.$itemsWrapper.sortable({items:"> .tva-restriction-card",handle:this.dragHandleSelector,placeholder:"tva-drag-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:this.updateOrderNumbers.bind(this)})},updateOrderNumbers:function(){var e=this.$itemsWrapper.sortable("option","items"),t=this.$itemsWrapper.find(e),s=this.model.get("access_restrictions").custom;t.each((function(e,t){s.findWhere({custom_id:parseInt(t.dataset.id)}).set("order",e)})),s.sort(),this.model.save()},openRestrictionsModal:function(e){var t=this.model.get("access_restrictions")[e.currentTarget.dataset.scope];t.course_id=this.model.get("id"),e.currentTarget.dataset.id&&(t=this.model.get("access_restrictions").custom.findWhere({custom_id:parseInt(e.currentTarget.dataset.id)})),this.openModal(i,{accessTab:this,course:this.model,width:"670px",top:"40px",title:TVA.t.rule_behaviour_edit,className:"tvd-modal tvd-modal-small",contentRestriction:new o({scope:e.currentTarget.dataset.scope,autoSave:!1,settings:t})})},renderRestrictionSummary:function(){var e=this;this.$(".product-restriction-summary").each((function(t,s){if(s.dataset.id){var i=e.model.get("access_restrictions").custom.findWhere({custom_id:parseInt(s.dataset.id)});s.textContent=e.getCustomRestrictionSummary(i.get("option"))}else s.textContent=e.model.getRestrictionSummary(s.dataset.scope)}))},getCustomRestrictionSummary:function(e){return TVA.accessRestriction.options[e].replace("(deprecated)","").trim()},openRuleModal:function(e){var t=this.model.get("access_restrictions");t=e.currentTarget.dataset.id?t.custom.findWhere({custom_id:parseInt(e.currentTarget.dataset.id)}):new l(t[e.currentTarget.dataset.scope]),this.openModal(n,{width:"670px",top:"40px",className:"tvd-modal tva-access-rules",title:TVA.t.edit_access_rule_conditions,scope:e.currentTarget.dataset.scope,model:t.deepClone(),originalModel:t,singleStep:!0,settingsCollection:this.model.get("access_restrictions").custom})},addRule:function(){this.openModal(n,{width:"670px",top:"40px",className:"tvd-modal tva-access-rules",title:TVA.t.add_access_rule,model:new r({scope:"custom",course_id:this.model.get("id"),currentStep:0,custom_id:-1}),settingsCollection:this.model.get("access_restrictions").custom})},deleteAccessRule:function(e){var t=this.model.get("access_restrictions").custom.findWhere({custom_id:parseInt(e.currentTarget.dataset.id)});if(t){t.set("id",t.get("custom_id"));var s=this.$(e.currentTarget).parents(".tva-restriction-card"),i=new c({template:TVE_Dash.tpl("products/partials/remove-rule"),className:"tva-delete-simple",confirm:function(){t.destroy(),TVE_Dash.success(TVA.t.skin_deleted.replace("{name}","<strong>".concat(t.get("title"),"</strong>"))),s.remove()}});s.append(i.render().$el)}else TVE_Dash.err(TVA.t.something_went_wrong)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(26),a=s(103),c=s(104),l=s(14);e.exports=l.extend({template:TVE_Dash.tpl("products/single/rules"),className:"tva-purchase-req",$integrationsWrapper:null,$rulesCountMessage:null,events:n(n({},l.prototype.events),{},{"change #tva-product-identifier":"onIdentifierChange"}),saving:!1,afterInitialize:function(){this.listenTo(this.model.get("rules"),"add",this.renderRulesCount),this.listenTo(this.model.get("rules"),"remove",this.renderRulesCount),this.listenTo(this.model,"sync",this.afterRender)},afterRender:function(){if(l.prototype.afterRender.apply(this,arguments),this.$integrationsWrapper=this.$("#tva-course-integrations-wrapper"),this.$rulesCountMessage=this.$("#tva-rules-count-message"),!this.model)throw"Undefined model";this.model.get("identifier")||this.$(".tva-input-delete-x").hide(),this.renderIntegrations(TVA.access_integrations),TVE_Dash.data_binder(this)},renderIntegrations:function(e){var t=this;this.$integrationsWrapper.empty(),e instanceof Backbone.Collection&&(e.each((function(e){var s={model:e,rules:t.model.get("rules")},i=function(){var t;switch(e.get("slug")){case"woocommerce":t=new c(s);break;case"thrivecart":t=new a(s);break;default:t=new o(s)}return t}();t.$integrationsWrapper.append(i.render().$el)})),this.renderRulesCount())},renderRulesCount:function(){var e=this.model.get("rules").filter((function(e){return e.getItems().length||"thrivecart"===e.get("integration")}));0===e.length?this.$rulesCountMessage.text(TVA.t.noAccessRulesSet):1===e.length?this.$rulesCountMessage.text(TVA.t.oneAccessRuleSet):this.$rulesCountMessage.text(TVE_Dash.sprintf(TVA.t.accessRulesSet,e.length))},onIdentifierChange:function(){var e=this,t=this.model.validateIdentifier();return t?(TVE_Dash.err(t),this.model.set("identifier",""),null):(this.saving=!0,""!==this.model.get("identifier")?wp.apiRequest({type:"PUT",url:"".concat(this.model.url(),"/identifier"),data:{identifier:this.model.get("identifier")}}).success((function(){e.$(".tva-input-delete-x").show(),TVE_Dash.success(TVA.t.identifier_saved)})).error((function(t){e.model.set("identifier",t.responseJSON.old_identifier),TVE_Dash.err(t.responseJSON.error_messages)})).always((function(){return e.saving=!1})):void this.deleteIdentifier())},deleteIdentifier:function(){return this.model.set("identifier",""),this.$(".tva-input-delete-x").hide(),wp.apiRequest({type:"DELETE",url:"".concat(this.model.url(),"/identifier")}).success((function(){TVE_Dash.success(TVA.t.identifier_deleted)})).error((function(e){return TVE_Dash.err(e.responseJSON)}))},saveRules:function(){this.saving||(TVE_Dash.showLoader(),this.model.save(null,{success:function(){TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t.SuccessfulSave),TVA.customers.reset()},error:function(e,t){if(TVE_Dash.hideLoader(),t&&t.responseJSON&&403===t.responseJSON.data.status)return TVE_Dash.err(TVA.t.courseNotSavedSessionExpired);var s="";t&&t.responseJSON&&(s=t.responseJSON.message),TVE_Dash.err("".concat(TVA.t.courseNotSaved," ").concat(s))}}))}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}var a=s(29),c=s(74),l=s(78),u=s(88);e.exports=a.extend({className:"tva-customer-edit",coursesTemplate:TVE_Dash.tpl("customers/courses"),noCoursesTemplate:TVE_Dash.tpl("customers/no-courses"),ensureData:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(TVA.customers instanceof Backbone.Collection&&0!==TVA.customers.length&&(s=TVA.customers.findWhere({ID:t.studentID}))instanceof u&&s.get("courses")instanceof Backbone.Collection&&s.get("courses").length&&(t.model=s,t.setUpListeners()),t.model instanceof Backbone.Model){e.next=3;break}return e.abrupt("return",new Promise((function(e){wp.apiRequest({url:TVA.routes.customer+"/".concat(t.studentID,"/courses_data")}).done((function(e){s instanceof u?(e.courses=new l(e.courses,{total:e.courses.length}),delete e.courses_count,delete e.enrolled,s.set(e),t.model=s):(s=t.model=new u(e),TVA.customers.add(s)),t.setUpListeners()})).always(e)})));case 3:case"end":return e.stop()}}),e)})),function(){var t=this,s=arguments;return new Promise((function(i,n){var r=e.apply(t,s);function a(e){o(r,i,n,a,c,"next",e)}function c(e){o(r,i,n,a,c,"throw",e)}a(void 0)}))})()},setUpListeners:function(){var e=this;this.model.on("access_changed",(function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&TVE_Dash.showLoader(!0),e.model.getCoursesData().success((function(t){t.courses=new l(t.courses,{total:t.courses.length}),delete t.courses_count,delete t.enrolled,e.model.set(n(n({},t),{},{courses_count:t.courses.length})),e.afterRender()}))}))},initialize:function(e){(e=e||{}).id&&(this.studentID=parseInt(e.id)||null,TVE_Dash.showLoader())},afterRender:function(){var e=this.$(".tva-cc-container"),t=this.model.get("courses");this.$(".tva-back-courses").hide(),this.$(".tva-back-students").show(),"function"==typeof this.coursesTemplate&&(e.html(this.coursesTemplate(this.getRenderParams())),t instanceof l&&t.length>0?this.renderCourses():e.html(this.noCoursesTemplate())),TVE_Dash.hideLoader()},renderCourses:function(){var e=this;this.$coursesContainer=this.$(".tva-cc-container-inner").empty(),this.model.get("courses").each((function(t){var s=new c({model:t,studentModel:e.model});e.$coursesContainer.append(s.render().$el)}))},viewCourse:function(e){var t=parseInt(e.currentTarget.dataset.id);"publish"===this.model.get("courses").get(t).get("status")&&this.changeView("students/".concat(this.studentID,"/courses/").concat(t))}})},,,,,function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a;o=jQuery,a=s(0),e.exports=a.extend({template:"utils/inline-edit",className:"tva-inline-edit tva-flex",required:!0,events:function(){return n(n({},a.prototype.events),{},{"change .tva-title-events":"onTitleChange","blur .tva-title-events":"onTitleBlur","keyup .tva-title-events":"onTitleKeyup"})},afterInitialize:function(e){if(o.extend(!0,this,e),!this.$element)throw new Error("$element is expected");this.model=new Backbone.Model({text:(this.text||this.$element.text()).trim(),editing:!0}),e.validation_fn&&"function"==typeof e.validation_fn&&(this.validation=e.validation_fn),this.listenTo(this.model,"change",this.render)},validation:function(){return!0},afterRender:function(){var e=this;this.$input=this.$("input"),requestAnimationFrame((function(){e.$input.select().focus()}))},editing:function(){this.model.set("editing",!0)},onTitleChange:function(e){var t=e.currentTarget,s=t.value.trim();return s&&this.validation(s)?(this.preventBlur=!0,s===this.model.get("text")?(this.model.set("editing",!1),!1):(this.model.set({text:s,editing:!1}),this.$element.trigger("change",[s]),!1)):(t.classList.add("tva-error"),t.focus(),!1)},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0,this.model.set("editing",!1))},onTitleBlur:function(){this.preventBlur?delete this.preventBlur:this.model.set("editing",!1)}})},function(e,t,s){e.exports=s(125).extend({defaults:{options:[],source:"",type:"youtube"},getRegexes:function(e){var t=[];switch(e){case"youtube":t.push("youtube"),t.push("(youtu.be)");break;case"vimeo":t.push("vimeo");break;case"wistia":t.push("wistia");break;case"custom":t.push(".");break;default:t.push(e)}return t}})},function(e,t,s){e.exports=s(2).extend({defaults:{options:[],source:"",type:""},initialize:function(e){e&&e.source&&"string"==typeof e.source&&(e.source=_.unescape(e.source),this.set({source:e.source},{silent:!0}))},getRegexes:function(e){var t=[];return"custom"===e?t.push("."):t.push("w+"),t},validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];if(e.source||t.push(this.validation_error("source","custom"===e.type?TVA.t.NoEmbedCode:TVA.t.NoURL)),"custom"!==e.type)try{var s=new URL(e.source),i=s.hostname,n=this.getRegexes(e.type),r=!1;n.forEach((function(e){r=r||null!==i.match(e)})),r||t.push(this.validation_error("source",TVA.t.invalidDomainUrl))}catch(e){t.push(this.validation_error("source",TVA.t.NoURL))}if(t.length)return t},valid_bind_source:function(e){return"custom"!==this.get("type")||(this.set("source",_.escape(e)),!1)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var s=[],i=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(s.push(o.value),!t||s.length!==t);i=!0);}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}return s}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var c=s(2),l=s(199),u=c.extend({defaults:function(){return jQuery.extend(!0,{},{post_title:"",type:"",content_type:"tva_lesson",trigger:"",lock_from:"",lock_from_id:"",schedule_type:"",schedule:{},unlock_date:window.moment().add(7,"days").format("Y-MM-DD 12:00"),unlock:{},display_locked:!0,force_unlock_order:!1})},isValid:function(){return void 0===this.validate()},validate:function(){var e=void 0!==this.collection?this.collection.course:TVA.courses.findWhere({id:this.get("course_id")}),t=[],s=this.get("id");if(0!==e.dripCampaigns.where({post_title:this.get("post_title").trim()}).filter((function(e){return e.get("id")!==s})).length&&t.push({field:"post_title",message:TVA.t.drip_campaign_name_taken}),this.get("post_title").trim()||t.push({field:"post_title",message:"Campaign name is required"}),this.isRepeating()&&!this.get("lock_from")&&t.push({field:"lock_from",message:"Choose a module / course"}),t.length)return t},getTypeLabel:function(){var e=u.getTemplateInfo(u.getTypeForCampaign(this))||{};return e.details_label||e.label||"Custom"},getIcon:function(){var e=u.getTypeForCampaign(this),t="drip-campaign-".concat(e);return"automator"===e&&(t="drip-automator"),TVA.Utils.icon(t)},getUnlockSettingsForContentId:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=parseInt(e);var s=jQuery.extend(!0,{},this.deepGet("unlock.".concat(e),!1));return t&&(s=new l(s||{},{campaign:this})),s},setUnlockSettingsForContentId:function(e,t){var s,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=parseInt(e),t.inherit_from||null!==(s=t.triggers)&&void 0!==s&&s.length||"inherited"!==t.visibility||"inherited"!==t.forced_unlock?this.deepSet("unlock.".concat(e),jQuery.extend(!0,{},t),i):this.unsetUnlockConditionsForContentId(e)},unsetUnlockConditionsForContentId:function(e){return this.deepUnset("unlock.".concat(e))},getUnlockSummaryForContentId:function(e){var t;e=parseInt(e);var s=this.collection.course.get("structure").models[0],i=[];if(void 0!==s.get("lessons")){var n=s.get("lessons")[0];i=[s.id,n.id]}else i="tva_chapter"===s.get("post_type")?[s.get("structure").first().get("id")]:[s.id];var r=this.getUnlockSettingsForContentId(e,!0);if(!(null!==(t=r.get("triggers"))&&void 0!==t&&t.length||r.hasInherited()))return r.isForcedUnlockOn()&&!i.includes(e)?{locked:!1,forced_unlock:!0}:{locked:!1};var o=r.getSummary();return i.includes(e)&&(o.forced_unlock=!1),o},applySettings:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.getModulesAndLessons(),n=this.isRepeating(),r=this.isAutomator(),o=function(e){return e=parseInt(e),i.some((function(t){return t.get("ID")===e}))},a=parseInt(this.get("lock_from")),c=i[a];if(c&&c.get("post_type")!==this.get("content_type")){var l=parseInt(this.get("lock_from_id")),u=_.findIndex(i,(function(e){return e.get("ID")===l}));-1!==u&&(this.set("lock_from",u,{silent:!0}),a=u)}var d=!1;s?this.set("unlock",{},{silent:!0}):Object.keys(this.attributes.unlock).forEach((function(e){if(o(e)){var s=t.getUnlockSettingsForContentId(e,!0).removeTrigger("scheduled");t.setUnlockSettingsForContentId(e,s.toJSON(),{silent:!0})}else delete t.attributes.unlock[e]}));var h=1;return i.forEach((function(e,s){if((r||n)&&d&&e.get("post_type")===t.get("content_type")){var i=t.getUnlockSettingsForContentId(e.get("ID"),!0),o={id:n?"scheduled":"automator",schedule:{}};i.addTrigger(o,"first"),n&&i.set("content_index",h++),t.setUnlockSettingsForContentId(e.get("ID"),i.toJSON())}"module"===e.getType()&&t.ensureInheritedSettings(e),s===a&&(d=!0)})),this},ensureInheritedSettings:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t||"module"!==t.getType())return this;var s=this.getUnlockSettingsForContentId(t.get("ID"),!0),i=!!s.get("triggers").length;return t.getLessons().forEach((function(s){var n=e.getUnlockSettingsForContentId(s.get("ID"),!0);i?n.setInheritFrom(t.get("ID")):n.unsetInheritFrom(),e.setUnlockSettingsForContentId(s.get("ID"),n.toJSON())})),this},url:function(){return TVA.routes.campaigns+"/".concat(this.get("id")||"")},prepopulate:function(){var e=this,t={};_.some(u.typeScheduleMap,(function(s,i){if(e.get("type")===s){var r=o(i.split("+"),2),a=r[0],c=r[1];return t={schedule_type:a,trigger:c,schedule:n({},TVA.drip.schedule_defaults[a])},!0}return!1})),"day-of-week"===this.get("type")&&(t=n(n({},t),{},{schedule_type:"repeating",trigger:"purchase",schedule:{interval:"months",interval_number:"1",monthly_type:"day",monthly_day_order:"first",weekday:"1"}})),t&&this.set(t)},prefillLockFrom:function(e){var t=this,s=!1;switch(this.get("content_type")){case"tva_lesson":case"tva_module":s=_.findIndex(e.getModulesAndLessons(),(function(e){return e.get("post_type")===t.get("content_type")}))}!1!==s&&s>-1&&this.set("lock_from",String(s),{silent:!0})},updateTemplateType:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.set("type",u.getTypeForCampaign(this),e),this},determineType:function(){return u.getTypeForCampaign(this)},isEvergreen:function(){return["first-lesson","purchase"].includes(this.get("trigger"))},isRepeating:function(){return"repeating"===this.get("schedule_type")},isAutomator:function(){return"automator"===this.get("schedule_type")},getRepeatingIntervalNumber:function(){return this.isRepeating()?this.deepGet("schedule.interval_number"):0},getRepeatingIntervalName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this.isRepeating())return"-";var s=this.getRepeatingIntervalNumber();if(["weekday","weekend"].includes(s))return TVA.Utils._n(e||1,s,s+"s",!1);var i=this.deepGet("schedule.interval"),n=this.deepGet("schedule.weekday"),r=i.replace(/s$/,""),o="";if(t)switch(i){case"weeks":n>=0&&(o+=" "+TVA.t.drip_campaign_settings.on_a+" "+TVA.drip.weekdays[n])}return TVA.Utils._n(e||parseInt(s),r,i,!1)+o},getScheduleDetails:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:TVA.t.drip_campaign_settings.content_unlocked;if(this.isRepeating()){var i="",n=this.getRepeatingIntervalNumber();"weekday"===n?i=TVA.t.drip_campaign_settings.on_weekdays:"weekend"===n?i=TVA.t.drip_campaign_settings.on_weekends:(i=TVA.t.drip_campaign_settings.every+" ",1!==(n=parseInt(n))&&(i+=n+" "),i+=this.getRepeatingIntervalName(n,t)),e=s+" "+i}else e=TVA.t.drip_campaign_settings.content_unlocked_custom;return e},getScheduleSummary:function(){return this.isAutomator()?TVA.t.drip_campaign_settings.automator_unlock:this.isRepeating()?this.getScheduleDetails(!1,TVA.t.drip_campaign_settings.unlock):TVA.t.drip_campaign_settings.at_custom_intervals},getTriggerSummary:function(){var e;return null===(e=u.getTriggerInfo(this.get("trigger")))||void 0===e?void 0:e.summary},ensureValidSettings:function(e){if(""!==this.get("lock_from")){var t={},s=e.getModulesAndLessons();if(this.get("lock_from_id")&&!this.isRepeating()){var i=parseInt(this.get("lock_from_id")),n=-1;s.some((function(e,t){return e.get("ID")===i&&(n=t,!0)})),-1===n?(t.lock_from_id="",t.lock_from=""):t.lock_from=String(n)}this.set(t,{silent:!0})}},getLongDescription:function(){var e=u.getTypeForCampaign(this);return u.getTemplateInfo(e).longdesc},getModalTitle:function(){var e=u.getTypeForCampaign(this);return u.getTemplateInfo(e).label},getTriggerIcon:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tva-main-color tva-s-icon mr-15",t=this.get("trigger"),s="drip-trigger-".concat(t);return"datetime"===t&&(s="drip-calendar"),TVA.Utils.icon(s,"ta-",e)},getScheduleIcon:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"tva-main-color tva-s-icon mr-15",s=this.get("schedule_type");switch(s){case"repeating":e="drip-icon-repeat";break;case"non_repeating":default:e="drip-icon-non-repeat"}return TVA.Utils.icon(e,"ta-",t)},getUnlockedLabel:function(){return TVA.t["drip_".concat("datetime"===this.get("trigger")?"day_zero":"unlocked")]},getUnlockedTooltip:function(){switch(this.get("trigger")){case"datetime":return TVA.t.drip_campaign_settings.content_unlocked_on+" "+this.get("unlock_date");case"purchase":return TVA.t.drip_campaign_settings.content_unlocked_on_purchase;case"first-lesson":return TVA.t.drip_campaign_settings.content_unlocked_on_first_access;default:return""}}},{typeScheduleMap:{"repeating+datetime":"scheduled-repeating","repeating+purchase":"evergreen-repeating","repeating+first-lesson":"evergreen-repeating","non_repeating+datetime":"live-launch","automator+datetime":"automator","automator+purchase":"automator","automator+first-lesson":"automator","non_repeating+first-lesson":"sequential","+":"custom"},getTypeForCampaign:function(e){var t="".concat(e.get("schedule_type"),"+").concat(e.get("trigger")),s=e.isRepeating(),i="weeks"===e.deepGet("schedule.interval"),n="months"===e.deepGet("schedule.interval"),r=i&&"-1"!==e.deepGet("schedule.weekday")||n&&"any"!==e.deepGet("schedule.monthly_type");return s&&r?"day-of-week":u.typeScheduleMap[t]||"custom"},getTemplateInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"custom",s=!1,i={};return TVA.drip.campaign_types.some((function(n){return n.type===e?(s=n,!0):(n.type===t&&(i=n),!1)})),s||i},getTriggerInfo:function(e){return _.findWhere(TVA.drip.content_triggers,{id:e})}});e.exports=u},function(e,t,s){function i(e,t,s){return(i=n()?Reflect.construct:function(e,t,s){var i=[null];i.push.apply(i,t);var n=new(Function.bind.apply(e,i));return s&&r(n,s.prototype),n}).apply(null,arguments)}function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var c=s(80),l=s(128),u=s(200),d=s(129),h=s(130),p=s(131),m=s(201),g=s(284);e.exports=function(e){var t=Array.prototype.slice.call(arguments,0);switch(e.id){case"datetime":return i(c,o(t));case"purchase":return i(l,o(t));case"first-lesson":return i(u,o(t));case"scheduled":return i(d,o(t));case"campaign":return i(h,o(t));case"automator":return i(p,o(t));case"course-content":return i(m,o(t));case"tqb_result":return i(g,o(t));default:throw new Error("unknown trigger type: "+e.id)}}},function(e,t,s){var i=s(80).extend({scheduleType:"non_repeating",defaults:function(){return jQuery.extend(!0,{},{id:"purchase",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return this.getInterval()+" "+TVA.t.drip_after_purchase},getInterval:function(){var e=this.deepGet("schedule.interval"),t=this.deepGet("schedule.interval_number");return TVA.Utils._n(parseInt(t),e.replace(/s$/,""),e,!0)},getSummary:function(){var e=this.getInterval();return{id:this.get("id"),icon:this.icon(),text:"+".concat(e),tooltip:this.getLabel()}},icon:function(){return"shopping-cart_light"}});e.exports=i},function(e,t,s){var i=s(80).extend({getCampaign:function(){return this.collection.campaign},getUnlockSettings:function(){return this.collection.unlockSettings},defaults:function(){return jQuery.extend(!0,{},{id:"scheduled",schedule:{}})},getLabel:function(){return this.getCampaign().getScheduleDetails()},canRemove:function(){return!1},getSummary:function(){var e=this.getUnlockSettings().get("content_index"),t=this.getCampaign().getRepeatingIntervalNumber();["weekday","weekend"].includes(t)&&(t=1);var s=(e||1)*t;return{id:this.get("id"),icon:this.icon(),text:"+".concat(s," ").concat(this.getCampaign().getRepeatingIntervalName(s)),tooltip:this.getLabel()}},icon:function(){return"drip-icon-repeat"}});e.exports=i},function(e,t,s){var i=s(129).extend({scheduleType:"non_repeating",defaults:function(){return jQuery.extend(!0,{},{id:"campaign",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return this.getInterval()+" "+TVA.t.drip_after_campaign_start},canRemove:function(){return!0},getInterval:function(){var e=this.deepGet("schedule.interval"),t=this.deepGet("schedule.interval_number");return TVA.Utils._n(parseInt(t),e.replace(/s$/,""),e,!0)},getSummary:function(){var e=this.getInterval();return{id:this.get("id"),icon:this.icon(),text:"+".concat(e),tooltip:this.getLabel()}},icon:function(){return"drip-time-after"}});e.exports=i},function(e,t,s){var i=_.findWhere(TVA.drip.content_triggers,{id:"automator"}),n=s(130).extend({scheduleType:"automator",defaults:function(){return jQuery.extend(!0,{},{id:"automator",schedule:{}})},getLabel:function(){return i.name},canRemove:function(){return!0},canEdit:function(){return!1},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:i.summary,tooltip:this.getLabel()}},icon:function(){return"drip-automator"}});e.exports=n},function(e,t,s){var i,n;i=jQuery,n=s(202),e.exports=s(0).extend({template:TVE_Dash.tpl("utils/slider-input"),className:"tva-grid tva-grid-columns-4-1 tva-grid-column-gap-15 tva-align-center",afterInitialize:function(e){i.extend(!0,this,e),this.model&&this.model instanceof Backbone.Model||(this.model=new n(this.model||{}))},sliderInput:function(e,t){this.$("input").val(t.value),this.change(t.value)},change:i.noop})},function(e,t,s){var i;i=jQuery,e.exports=s(0).extend({template:_.template(""),className:"tva-grid tva-grid-row-gap-5",inputs:[],afterInitialize:function(e){i.extend(!0,this,e),this.inputs=this.inputs||[]},afterRender:function(){var e=this;this.inputs.forEach((function(t){var s="tva_checkbox_group_".concat(t.value),i=t.checked?"checked":"";e.$el.append('<div><input type="checkbox" id="'.concat(s,'" value="').concat(t.value,'" class="change" data-fn="checkboxChanged" ').concat(i,'/><label class="normal-label" style="cursor: pointer;" for="').concat(s,'">').concat(t.label,"</label></div>"))}))},checkboxChanged:function(){var e=[];this.$("input").each((function(t,s){s.checked&&e.push(s.value)})),this.change(e)},change:i.noop})},function(e,t,s){var i,n,r;i=jQuery,n=s(135),r=s(290),e.exports=s(1).extend({template:TVE_Dash.tpl("home"),className:"tva-home-content",afterInitialize:function(){var e=this;this.icon=[],this.color=[],this.collection=new r(TVA.courses.toJSON(),{total:TVA.courses.total}),this.courseArray=this.collection.models.slice(0,7),this.courseArray.forEach((function(t){var s=TVA.topics.findWhere({id:t.get("topic")});"svg_icon"===s.get("icon_type")?e.icon[t.get("topic")]=s.get("svg_icon"):e.icon[t.get("topic")]="<img src="+s.get("icon")+">"}))},afterRender:function(){var e=this;this.$(".tva-course-topic").each((function(t,s){var n=e.courseArray[t],r=TVA.topics.findWhere({id:n.get("topic")});i(s).css("background-color",r.get("color"))})),this.$(".tva-home-course-status").each((function(t){e.$(".tva-custom-tooltip")[t].innerText="Unpublished";var s=e.courseArray[t];"publish"===s.get("status")&&(i(e.$(".tva-home-course-status")[t]).removeClass("unpublished"),e.$(".tva-custom-tooltip")[t].innerText="Published"),"future"===s.get("status")&&(i(e.$(".tva-home-course-status")[t]).toggleClass("unpublished scheduled"),e.$(".tva-custom-tooltip")[t].innerText="Scheduled")}))},helpModal:function(){this.openModal(n,{className:"tvd-modal modal-help-corner"})}})},function(e,t,s){e.exports=s(3).extend({template:TVE_Dash.tpl("modals/help-corner")})},function(e,t,s){var i=s(4);e.exports=s(2).extend({idAttribute:"ID",defaults:{display_name:"",user_email:"",user_login:"",services:{},notify:0,edit_url:""},initialize:function(){this.set("services",{})},url:function(){var e=TVA.routes.customer;return this.get("ID")&&(e+="/".concat(this.get("ID"))),e},validate:function(e){var t=[];if(e.user_login||t.push(this.validation_error("user_login",TVA.t.MissingUserLogin)),e.user_email||t.push(this.validation_error("user_email",TVA.t.MissingEmail)),TVA.Utils.isEmail(e.user_email)||t.push(this.validation_error("user_email",TVA.t.InvalidCustomerEmail)),t.length)return t},hasServices:function(){for(var e=this.get("services"),t=!1,s=0,i=Object.keys(e);s<i.length;s++){var n=i[s];if(Array.isArray(e[n])&&e[n].length>0){t=!0;break}}return t},removeServices:function(){this.set("services",{})},getPurchasedItems:function(){var e=this;return new Promise((function(t){if(e.get("purchasedItems")instanceof Backbone.Collection)return t(e.get("purchasedItems"));var s=new i;s.url=e.url()+"/purchased-items",s.fetch({success:function(s){s instanceof Backbone.Collection&&e.set("purchasedItems",s),t(e.get("purchasedItems"))}})}))},getAccessCourses:function(){var e=this;return new Promise((function(t){if(e.get("courses")instanceof Backbone.Collection)return t(e.get("courses"));var s=new i;s.url="".concat(e.url(),"/products"),s.fetch({success:function(s){return s instanceof i&&e.set("courses",s),t(e.get("courses"))}})}))},getCoursesData:function(){return wp.apiRequest({url:"".concat(TVA.routes.customer,"/").concat(this.id,"/courses_data")})}})},function(e,t,s){var i,n,r;i=jQuery,n=s(138),r=s(42),e.exports=s(0).extend({collection:null,className:"tva-menu",submenuView:null,afterInitialize:function(){var e=this;this.listenTo(TVA.indexPageModel,"sync",(function(t){e.collection.findWhere({slug:"course-homepage"}).set({href:t.get("preview_url"),disabled:0===t.get("preview_url").length?"You need to have defined a course page":0})}))},render:function(){return this.$body=i("body"),this.$el.append('<div class="fixed-inner" />'),this.collection.each(this.renderMenuItem,this),this.submenuView=new r({collection:new Backbone.Collection}),this},renderMenuItem:function(e){if(!e.get("hidden")){var t=new n({model:e});this.$(".fixed-inner").append(t.render().$el)}}})},function(e,t,s){e.exports=s(0).extend({model:null,collection:null,className:"tva-menu-item",template:TVE_Dash.tpl("menu-item"),selectedClass:"tva-menu-item-selected",disabledClass:"tva-menu-item-disabled",events:{click:function(e){var t=e.currentTarget.dataset.route;if(0!==this.model.get("items").length){var s=this.model.get("items").first();t=s?s.get("slug"):t}t&&this.changeView(t)}},tagName:function(){return this.model.has("href")?"a":"div"},initialize:function(){this.listenTo(this.model,"change:selected",this.onChangeSelected),this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template({model:this.model})).removeClass("".concat(this.disabledClass," tvd-tooltipped")).removeAttr("data-position data-tooltip data-route href target"),this.model.get("disabled")?this.$el.addClass("".concat(this.disabledClass," tvd-tooltipped")).attr({"data-position":"right","data-tooltip":this.model.get("disabled")}):this.model.has("route")?this.$el.attr("data-route",this.model.get("route")):this.model.has("href")&&this.$el.attr({href:this.model.get("href"),target:"_blank"}),"#home"===this.$el.attr("data-route")&&this.$el.addClass("tva-logo"),this},onChangeSelected:function(e,t){this.$el.toggleClass(this.selectedClass,t)}})},function(e,t,s){var i,n;i=jQuery,n=s(89),e.exports=s(0).extend({className:"tva-submenu-dropdown",tagName:"div",template:TVE_Dash.tpl("submenu-dropdown"),selectedClass:"tva-submenu-item-selected",collapsedClass:"tva-collapsed",events:{click:function(e){this.onDropdownOpen();var t=e.currentTarget.dataset.route;TVA.Router.navigate(t,{trigger:!0})}},initialize:function(){this.model.off("change:selected").on("change:selected",_.bind(this.onChangeSelected,this)),this.model.off("change:collapsed").on("change:collapsed",_.bind(this.onDropdownOpen,this))},render:function(){var e=this;this.$el.html(this.template({model:this.model})),this.model.get("disabled")?this.$el.hide():this.model.get("route")?this.$el.attr("data-route",this.model.get("route")):this.model.get("href")&&this.$el.attr("onmousedown","window.open('".concat(this.model.get("href"),"')")),!0===this.model.get("selected")&&this.$el.addClass(this.selectedClass),!0===this.model.get("collapsed")&&this.$el.addClass(this.collapsedClass);var t=i();return this.model.get("items").forEach((function(s){s.set("tag-name","div");var i=e.renderItem(s);t=t.add(i)})),this.$el.append(t),this},onChangeSelected:function(e,t){this.$el.toggleClass(this.selectedClass,t)},onDropdownOpen:function(e,t){this.$el.toggleClass(this.collapsedClass,t)},renderItem:function(e){return e.set("parentModel",this.model),new n({model:e,parentModel:this.model}).render().$el}})},function(e,t,s){var i=s(90);e.exports=s(0).extend({afterInitialize:function(e){this.reportScope=e.scope},afterRender:function(){TVA.migrate_access&&1===parseInt(TVA.migrate_access.should_migrate)&&i.getInstance()},afterInsert:function(){window.thriveReportsInit(this.el,this.reportScope)},toggleShowMore:function(e){e.target.closest(".apprentice-info").classList.toggle("expanded")},dismissWelcomeNotification:function(e){e.target.closest(".apprentice-intro").remove(),TVA.Utils.saveTooltips("reports-dismiss-welcome-notification")}})},function(e,t,s){var i,n;i=jQuery,n=s(3).extend({template:"modals/access-migration",productsMigrated:{},products:null,afterInitialize:function(){this.products=this.model.get("items"),this.spinnerURL=this.model.get("spinnerURL")},dom:function(){var e=this;this.$statusWrapper=this.$("#tva-access-migrate-products"),!Array.isArray(this.products)||Array.isArray(this.products)&&0===this.products.length?this.checkMigrationDone():this.products.forEach((function(t){e.productsMigrated[t.term.term_id]=0;var s=i('<div data-id="'.concat(t.term.term_id,'" class="mb-5 tva-flex tva-flex-row tva-access-migrate-product"><div class="mr-10"><img width="20px" height="20px" class="tve-lazy-img" src="').concat(e.spinnerURL,'"/></div><div>').concat(t.term.name,"</div></div>"));e.$statusWrapper.append(s)}))},afterStep1Loaded:function(){this.migrate()},migrate:function(){var e=this;Array.isArray(this.products)&&this.products.forEach((function(t){e.migrateAccessForProduct(t.term.term_id).then((function(){i("div[data-id='".concat(t.term.term_id,"']")).find("img").replaceWith('<i style="color: green;" class="tvd-icon-check tvd-left"></i>'),e.checkMigrationDone()})).catch((function(e){TVE_Dash.err("Error during the migration process. Please contact Thrive Support!"),console.error(e)}))}))},migrateAccessForProduct:function(e){var t=this;return new Promise((function(s,i){wp.apiRequest({url:TVA.migrate_access.route,type:"POST",data:{id:e}}).done((function(i){delete t.productsMigrated[e],s(i)})).fail((function(e){return i(e)}))}))},checkMigrationDone:function(){0===Object.keys(this.productsMigrated).length&&(TVE_Dash.success("Migration done! Loading data..."),TVE_Dash.showLoader(),setTimeout((function(){location.reload()}),2e3))}}),e.exports=n},function(e,t,s){var i,n=s(0),r=s(2);i=jQuery,e.exports=n.extend({template:TVE_Dash.tpl("products/access-rules/access-rule-condition"),className:"tva-rule-container tva-relative",productItemTpl:TVE_Dash.tpl("modals/customer/product-item"),userRoles:TVA.access_integrations.findWhere({slug:"wordpress"}).get("items"),products:TVA.products,defaults:["not_logged","not_purchased","locked"],afterInitialize:function(e){TVA.products.getAll(),this.ruleModel=e.ruleModel,this.parentWrapper=e.parentWrapper,this.disabled=this.defaults.includes(this.model.get("scope"))?"disabled":""},afterRender:function(){var e=this;if(!this.disabled){this.$el.find("select").val(this.model.get("type"));var t=this.$el.find(".tva-condition-checkbox-list").empty();this.model.get("type")&&("products"===this.model.get("type")?this.products:this.userRoles).each((function(s){var i="";e.model.get("selected")&&(i=e.model.get("selected").includes(s.get("id"))?"checked":""),t.append(e.productItemTpl({model:new r({id:s.get("id"),name:s.get("name"),checked:i})}))}))}setTimeout((function(){TVE_Dash.materialize(e.$el),e.handleOptions()}),0)},fieldChanged:function(e){var t=this,s=e.currentTarget.dataset.value||e.currentTarget.value,n=this.$el.find(".tva-condition-checkbox-list").empty();this.$el.find(".tva-delete-condition-wrapper a").attr("data-type",s),"products"===s?(this.products.each((function(e){return n.append(t.productItemTpl({model:e}))})),0===this.model.get("index")&&this.ruleModel.deepSet("conditions.roles",[])):"roles"===s&&(this.userRoles.each((function(e){return n.append(t.productItemTpl({model:e}))})),0===this.model.get("index")&&this.ruleModel.deepSet("conditions.products",[])),this.parentWrapper.find("select").each((function(t,n){n.isSameNode(e.currentTarget)||(i(n).find('option[value="'.concat(s,'"]')).attr("disabled","disabled"),i(n).select2())})),this.handleOptions()},handleOptions:function(){var e=this,t=this.ruleModel.get("conditions");t&&Object.keys(t).forEach((function(s){t[s].length&&e.parentWrapper.find('option[value="'.concat(s,'"]')).prop("disabled","disabled")}))}})},function(e,t){var s;s=jQuery,e.exports=function(e,t){if(e.length){(t=t||{}).no_value_callback=t.no_value_callback||jQuery.noop,t.change_callback=t.change_callback||jQuery.noop;var i={url:"".concat(TVA.routes.settings,"/search_pages/"),type:"POST",appendTo:e.parent(),minLength:2,delay:200,change:function(s,i){i.item||e.data("value-filled")||n()||(e.val(""),t.no_value_callback.apply(e,arguments)),e.data("value-filled",null),n()&&t.change_callback.apply(e,arguments)}};(t=s.extend(!0,i,t)).source||(t.source=t.url),s.ajaxSetup({headers:{"X-WP-Nonce":TVA.apiSettings.nonce}}),e.autocomplete(t).data("ui-autocomplete")._renderItem=t.renderItem||function(e,i){var n="";return t.collection&&t.collection.length&&t.collection.findWhere({id:i.id})&&(n="tva-selected-post"),s('<li class="'.concat(n,'">')).append('<span class="tva-ps-result-title">'.concat(i.label,'</span><span class="tva-ps-result-email"> (').concat(i.type,")</span>")).appendTo(e)},e.on("blur",(function(){s.trim(this.value).length||t.no_value_callback.apply(e,arguments)}))}function n(){var t;return!!(t=e.data("allow-regex"))&&e.val().match(new RegExp(t))}}},function(e,t,s){var i;i=jQuery,e.exports=s(0).extend({$tabs:null,className:"tva-tabs",selectedIndex:0,contentViews:[],selectedTabCssClass:"tva-tab-selected",tabUlClass:"tva-tabs-ul",selectedContentCssClass:"tva-tab-content-selected",events:{"click ul.tva-tabs-ul>li":function(e){var t=parseInt(i(e.currentTarget).data("index"));this.selectTab(t)}},initialize:function(e){i.extend(!0,this,e),this.contentViews=[]},updateNames:function(){var e=this.$tabs.find(".tva-tab-title");this.collection.each((function(t,s){e[s]&&(e[s].textContent=t.get("name"))}))},render:function(){var e=this;return this.$tabs=i("<ul/>"),this.$tabs.addClass(this.tabUlClass),this.$el.append(this.$tabs),this.collection.each((function(t,s){var n=i("<li>").html(e.getTabTitleHTML(t)).data("index",s);e.$tabs.append(n);var r=t.get("view");r.tabModel=t,r.on("refresh-tab-title",(function(){n.html(e.getTabTitleHTML(t))})),e.contentViews.push(r),e.$tabs.after(r.render().$el.hide())})),this.selectTab(this.selectedIndex),this.addChild(this.contentViews),this},getTabTitleHTML:function(e){var t='<span class="tva-tab-icon">'.concat(TVA.Utils.icon(e.get("icon")),'</span><span class="tva-tab-title">').concat(e.get("name"),"</span>");return e.get("counter")&&(t+='&nbsp;<span class="tva-tab-counter">'.concat(e.get("counter"),"</span>")),t},selectTab:function(e){var t=this;if(0===e||this.course.get("id")||(e=0,TVE_Dash.warning(TVA.t.saveCourseBefore)),e=parseInt(e),isNaN(e)&&(e=0),e>this.contentViews.length)throw new Error("there are not so many tabs to select index: "+e);this.selectedIndex=e,this.$tabs.find("li").removeClass(this.selectedTabCssClass),this.$tabs.find("li").eq(this.selectedIndex).addClass(this.selectedTabCssClass),this.contentViews.forEach((function(e,s){var i=s===t.selectedIndex?"show":"hide";e.$el[i]();var n=s===t.selectedIndex?"addClass":"removeClass";e.$el[n](t.selectedContentCssClass),s===t.selectedIndex&&("function"==typeof e.onActivate&&e.onActivate(),e.bindZclip())})),this.trigger("tab.selected.index",this.selectedIndex)},getSelected:function(){return this.$tabs.find("li.".concat(this.selectedTabCssClass))},changeIcon:function(e,t){e.find(".tva-tab-icon").html(t)}})},function(e,t,s){var i;jQuery,i=s(7),e.exports=s(0).extend({template:TVE_Dash.tpl("courses/header"),afterInitialize:function(){this.listenTo(this.model,"change:status",this.render),this.listenTo(this.model,"tva.structure.status.changed",this.render)},afterRender:function(){TVE_Dash.data_binder(this),this.$publishOptions=this.$(".tva-options-drop-ul"),this.$publishIcon=this.$(".ta-angle-down"),this.$publishButton=this.$("#tva-course-publish"),this.$courseDate=this.$(".tva-course-date"),this.$tooltip=this.$(".tvd-c-tooltip"),this.model.get("structure")instanceof i||this.model.set("structure",new i(this.model.get("structure"))),this.handleAvailableOptions()},handleAvailableOptions:function(){var e=this.model.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"publish"}).length,t=this.model.get("structure").findItemsByOptions({post_type:"tva_lesson",post_status:"future"}).length,s=this.model.get("status");e?(this.$publishOptions.show(),this.$publishIcon.show(),this.$tooltip.hide()):(this.$publishOptions.hide(),this.$publishIcon.hide(),this.$tooltip.show()),"future"===this.model.get("status")&&(e||t?this.$courseDate.show():this.$courseDate.hide()),e&&"draft"===s?this.$publishButton.removeAttr("disabled").removeClass("tva-btn-green disabled").addClass("tva-btn-red").find("span").text(TVA.t.publish):e&&"publish"===s?this.$publishButton.removeAttr("disabled").removeClass("tva-btn-red disabled").attr("data-fn","changeStatus").attr("data-status","draft").addClass("tva-btn-green").find("span").text(TVA.t.unpublish):(e||t)&&"future"===s?this.$publishButton.removeAttr("disabled").removeClass("tva-btn-red disabled").addClass("tva-btn-yellow").find("span").text(TVA.t.scheduled):e>0?this.$publishButton.removeAttr("disabled").removeClass("tva-btn-red disabled").addClass("tva-btn-red").find("span").text(TVA.t.publish):this.$publishButton.attr("disabled","disabled").removeClass("tva-btn-green tva-btn-red").find("span").text(TVA.t.publish)}})},function(e,t,s){!function(t){var i=s(0),n=s(45),r=s(94),o=s(147);function a(){this.model.get("overview_post").get("post_id")||this.$("#tva-course-description").html(TVE_Dash.tpl("courses/no-course-overview")())}function c(){return!1===this.model.get("has_video")?this.$videoSettings.empty().hide():new r({types:["youtube","vimeo","wistia","custom"],model:this.model.get("video"),el:this.$videoSettings}).render().$el.show()}e.exports=i.extend({$videoSettings:null,$authorSettings:null,$authorAvatar:null,$authorCustomBioWrapper:null,$courseImage:null,template:TVE_Dash.tpl("courses/details-tab"),events:function(){return t.extend(i.prototype.events,{})},initialize:function(){var e=this;this.listenTo(this.model,"change:has_video",_.bind(c,this)),this.listenTo(this.model,"change:author",(function(){return e.changeAuthorBio(e.model.get("author").get("biography_type"),!0)})),this.listenTo(this.model,"change:author",(function(){e.authorImage&&(e.authorImage.destroy(),delete e.authorImage),e.handleAuthorAvatar(e.$authorAvatar)}))},initCustomBioTinyMCE:function(){var e=this;TVA.Utils.renderMCE("tva-course-author-description",this.model.get("author"),"custom_biography").then((function(t){t&&"function"==typeof t.setContent&&(e.authorMCE=t)}))},render:function(){i.prototype.render.apply(this,arguments),this.initCustomBioTinyMCE(),this.$videoSettings=this.$("#tva-course-video-settings"),this.$authorSettings=this.$("#tva-author-settings"),this.$authorCustomBioWrapper=this.$("#tva-course-author-description-wrapper"),this.$authorAvatar=this.$("#tva-author-avatar"),this.$courseImage=this.$("#tva-course-image"),new n({model:this.model,el:this.$courseImage,template:TVE_Dash.tpl("courses/cover-image"),prop:"cover_image"}).render(),this.authorImage=this.handleAuthorAvatar(this.$authorAvatar),this.model.get("author")&&"custom_bio"===this.model.get("author").get("biography_type")&&(this.$("#tva-course-author-bio").val("custom_bio"),this.$authorCustomBioWrapper.show());var e=new o({model:this.model});return this.addChild(e),this.$("#tva-course-details-slug").append(e.render().$el),TVE_Dash.data_binder(this),c.apply(this),a.apply(this),this},handleAuthorAvatar:function(e){if(!this.authorImage)return this.imageView&&(this.imageView.destroy(),delete this.imageView),this.imageView=new n({model:this.model.get("author"),el:e,prop:"avatar_url"}),this.imageView.render();this.authorImage.setImage(this.model.get("author").get("avatar_url"))},onAuthorDropdownChange:function(e,t){this.changeAuthorBio(t.value),e.stopPropagation()},changeAuthorBio:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.model.get("author").set("biography_type",e);var s="custom_bio"===e?"show":"hide";this.$authorCustomBioWrapper[s](),"hide"===s&&t&&(this.$authorCustomBioWrapper.val("").trigger("change"),this.authorMCE&&"function"==typeof this.authorMCE.setContent&&this.authorMCE.setContent("")),this.$("#tva-course-author-bio").val(e),this.initCustomBioTinyMCE()}})}(jQuery)},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;jQuery,o=s(0),e.exports=o.extend({className:"tva-course-slug-label",template:TVE_Dash.tpl("courses/permalink"),events:n(n({},o.prototype.events),{},{"change #tva-course-slug":"onTitleChange","keyup #tva-course-slug":"onTitleKeyup"}),successMessage:TVA.t.permalink_updated,render:function(){return this.$el.html(this.template({model:this.model})),this.afterRender(),this},afterRender:function(){this.model.get("id")||this.$el.find(".tva-zclip").attr("disabled","disabled").html("")},onTitleChange:function(e){var t=this,s=e.currentTarget,i=s.value.trim();if(i!==this.model.get("slug")){if(this.model.set({slug:i},{silent:!0}),s.classList.remove("tva-error"),!i)return s.classList.add("tva-error"),s.focus(),TVE_Dash.err(TVA.t.InvalidSlug),!1;var n=this.model.url;this.model.url=function(){return"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v2,"/courses/permalink")},this.model.save(null,{success:function(){t.model.saveState(),t.render(),t.model.trigger("tva.course.permalink.modified",t.model.get("preview_url")),o.prototype.bindZclip.call(t,null),TVE_Dash.success(t.successMessage)},error:function(e,t){TVE_Dash.err(t.responseJSON.message)}}),this.model.url=n}},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0)}})},function(e,t,s){!function(t){var i=s(0),n=s(149),r=s(95),o=s(47),a=s(7),c=s(20),l=s(93),u={chapterGroup:s(96),moduleGroup:s(151),move:s(152),resources:s(153)};function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"draft",s=this.collection.findItem(e),i=window.moment,n={post_status:t,post_date:i().utc().format(),post_date_gmt:i().utc().format()},r=this.collection.findItem(s.get("post_parent"));return"future"===t&&(n=null),new Promise((function(e,i){s.save(n,{patch:!0,success:function(){if("publish"===t&&r&&"draft"===r.get("post_status"))return e(r.get("id"));var s=0;if("draft"===t&&r){s=r.get("structure").where({post_status:"future"}).length;var n=r.get("structure").where({post_status:"draft"}).length;if(r.get("structure").length-s===n)return e(r.get("id"))}i()},error:function(){i()}})}))}e.exports=i.extend({template:TVE_Dash.tpl("courses/items-tab"),$addItemButton:null,selected:[],expanded:null,events:function(){return t.extend(i.prototype.events,{"click .tva-course-item":"toggleItem","change .tva-section-select":"onItemSelect","change #tva-check-all":"toggleSelectAll"})},initialize:function(){var e=this;this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"destroy",this.render),this.expanded=new Set,this.listenTo(this.model,"tva.structure.modified",(function(){e.render()})),this.listenTo(this.model,"tva.item.status.changed",(function(t){e.onItemStatusChanged(t.id,t.status)})),this.listenTo(this.model,"structure.rendered",(function(){e.model.recountLessons()}))},afterRender:function(){var e=this;this.$selectAll=this.$("#tva-check-all"),this.$massActions=this.$(".tva-mass-action").hide(),this.$massActionsWrapper=this.$(".tva-mass-actions"),this.$addItemButton=this.$("#tva-add-item").append(this.updateAddItemButton(this.collection.getType())),this.$massActionsWrapper[this.collection.length>=1?"show":"hide"]();var s=this.$(".tva-course-items-wrapper"),i=!1,n=this;function r(e,t){t.placeholder.css({height:t.item.outerHeight()})}function o(){!1===i&&t(this).find("> .tva-course-item").length>1&&c.apply(this,arguments)}function c(){var e=t(this).find("> .tva-course-item"),s=new a;return e.each((function(e,t){s.push(new Backbone.Model({id:parseInt(t.dataset.id),order:parseInt(e),parent:parseInt(t.dataset.parentId)}))})),s.save(null,{success:function(e,t){n.collection.reset(t),i=!1,n.model.trigger("tva.structure.modified")},error:function(){TVE_Dash.err("Something went wrong!")}})}this.renderCourseStructure(this.collection,s.addClass("tva-".concat(this.collection.getType(),"-list"))),this.$(".tva-modules-list").sortable({items:".tva_module",handle:".tva-drag-handle",placeholder:"tva-drag-placeholder",over:r,stop:o});var l={items:".tva_chapter",connectWith:".tva-chapters-list",handle:".tva-drag-handle",placeholder:"tva-drag-placeholder",over:r,stop:o,remove:function(){var e=t(this),s=e.find("> .tva-course-item"),n=e.parent();if(0===s.length&&n.is(".tva_module")){var r=t("<div/>").addClass("tva-course-items-wrapper tva-lessons-list").sortable(u);n.append(r)}s.length&&(i=!0,c.apply(this,arguments))},receive:function(e,s){var r=t(this),o=r.parent(),a=r.find("> .tva_chapter");o.is(".tva_module")&&1===a.length&&o.find("> .tva-lessons-list").sortable("destroy").remove(),s.item.attr("data-parent-id",o.data("id")),n.expandItems(o),i=!0,c.apply(this,arguments)}};this.$(".tva-chapters-list").sortable(l);var u={items:".tva_lesson",connectWith:".tva-lessons-list",handle:".tva-drag-handle",placeholder:"tva-drag-placeholder",over:r,start:function(){t(document).find(".tvd-material-tooltip").hide()},stop:o,remove:function(){var e=t(this),s=e.parent(),n=e.find("> .tva-course-item");if(0===n.length&&s.is(".tva_module")){var r=t("<div/>").addClass("tva-course-items-wrapper tva-chapters-list").sortable(l);s.append(r)}n.length&&(i=!0,c.apply(this,arguments))},receive:function(e,s){var r=t(this),o=r.find("> .tva-course-item"),a=r.parent();a.is(".tva_module")&&1===o.length&&a.find("> .tva-chapters-list").sortable("destroy").remove(),s.item.attr("data-parent-id",a.data("id")),n.expandItems(a.add(a.parents(".tva-course-item"))),i=!0,c.apply(this,arguments)}};this.$(".tva-lessons-list").sortable(u),this.$(".tva_module").droppable({accept:".tva_chapter, .tva_lesson",tolerance:"touch",over:function(s,i){var n=t(s.target),r=t(i.draggable);r.parents(".tva_module").data("id")!==n.data("id")&&(n.removeClass("tva-collapsed"),n.find(".tva_chapter").removeClass("tva-collapsed"),r.is(".tva_chapter")?(e.$(".tva-chapters-list").css({"min-height":r.height()}),e.$(".tva-chapters-list").sortable("refresh")):r.is(".tva_lesson")&&(e.$(".tva-lessons-list").css({"min-height":r.height()}),e.$(".tva-lessons-list").sortable("refresh")))}}),this.$(".tva_chapter").droppable({accept:".tva_lesson",over:function(s,i){var n=t(s.target),r=t(i.draggable);r.parents(".tva_chapter").data("id")!==n.data("id")&&(n.removeClass("tva-collapsed"),n.find(".tva-lessons-list").css({"min-height":r.outerHeight()}),e.$(".tva-lessons-list").sortable("refresh"))}}),this.model.trigger("structure.rendered")},expandItems:function(e){var t=this;e.each((function(e,s){t.expanded.add(parseInt(s.dataset.id)),s.classList.remove("tva-collapsed")}))},toggleItem:function(e){this.$("input").trigger("blur");var s=t(e.currentTarget);if(s.is(".tva_lesson")||"INPUT"===e.target.tagName)return e.stopPropagation();var i=parseInt(e.currentTarget.dataset.id);s.toggleClass("tva-collapsed"),s.hasClass("tva-collapsed")?this.expanded.delete(i):this.expanded.add(i),e.stopPropagation()},renderCourseStructure:function(e,t){var s=this;this.$$childViews.forEach((function(e){return e.destroy()})),this.$$childViews=[],e.each((function(e,i){var c;e.get("structure")instanceof a||e.set("structure",new a(e.get("structure")));var l={model:e,numberInList:i+1,expanded:s.expanded,course:s.model};switch(e.get("post_type")){case"tva_module":c=new n(l);break;case"tva_chapter":c=new r(l);break;case"tva_lesson":c=new o(l);break;default:c=new Backbone.View}t.append(c.render().$el),s.addChild(c)}))},updateAddItemButton:function(e){var t="";switch(e){case"modules":t=TVA.t.AddModule;break;case"chapters":t=TVA.t.AddChapter;break;case"lessons":t=TVA.t.AddLesson;break;default:t=TVA.t.AddContent}return t},openAddItemModal:function(e,t){var i="content",n=0,r=this.collection,o=null,a=parseInt(t.dataset.postParent),c=parseInt(t.dataset.id);if(t.dataset.type&&(i=t.dataset.type),!isNaN(a)&&a&&(r=(n=this.collection.findItem(a)).get("structure")),!isNaN(c)&&c&&(o=this.collection.findItem(c)),!o&&-1!==["lesson","module","chapter"].indexOf(i)){var l=s(215)("./".concat(i)),u=this.model.get("allows_comments")?"open":"closed";o=new l({course_id:this.model.get("id"),post_parent:n?n.get("id"):n,comment_status:n?n.get("comment_status"):u,order:r.getOrderForNewItem()})}this.openModal(s(157),{course:this.model,model:o,structure:r}),e.stopPropagation()},deleteItem:function(e,t){e.stopPropagation();var s=this.collection.findItem(parseInt(t.dataset.id)),i=this.model;s instanceof Backbone.Model&&this.openModal(c,{template:TVE_Dash.tpl("modals/delete-".concat(s.getType())),confirm:function(){var e;s.get("post_parent")>0&&(e=s.getHighestParent()),s.destroy(),e&&e.collection.trigger("destroy",new Backbone.Model),i.trigger("tva.structure.status.changed"),this.close()}})},updateItemStatus:function(e,t){var s=t.dataset.status;if(-1===TVA.postAcceptedStatuses.indexOf(s))s="publish";else if("future"===s)return this.openModal(l,{model:this.collection.findItem(t.dataset.id),courseModel:this.model,width:"400px",className:"tvd-modal tva-schedule-modal",statusProp:"post_status"});return this.onItemStatusChanged(parseInt(t.dataset.id),s)},onItemStatusChanged:function(e,t){var s=this;TVE_Dash.showLoader(),d.call(this,parseInt(e),t).then((function(e){return d.call(s,e,t)})).then((function(e){return d.call(s,e,t)})).catch((function(){s.model.trigger("tva.structure.status.changed"),s.render(),TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t["success_item_".concat(t)])}))},onItemSelect:function(e){var s=e.currentTarget,i=t(s.closest(".tva-course-item"));i.find("input.tva-section-select").not(s).prop("checked",s.checked),s.checked||i.parents(".tva-course-item").find("> .tva-cm-box input.tva-section-select").prop("checked",!1),this.onSelectionChange()},toggleSelectAll:function(e){this.$("input.tva-section-select").prop("checked",e.currentTarget.checked),this.onSelectionChange()},onSelectionChange:function(){var e=this;if(this.selected=[],this.$("input.tva-section-select:checked").each((function(t,s){return e.selected.push(e.collection.findItem(s.dataset.itemId))})),this.$selectAll.prop("checked",this.selected.length&&this.selected.length===this.$("input.tva-section-select").length),this.selected.length){this.$massActions.filter('[data-fn="massAction"]').fadeIn(100);var t,s,i=this.selected.filter((function(e){return"module"===e.getType()})),n=this.selected.filter((function(e){return"chapter"===e.getType()})),r=this.selected.filter((function(e){return"lesson"===e.getType()})),o=this.selected.filter((function(e){return"future"===e.get("post_status")})),a=this.selected[0].getHighestParent(),c=o.length===r.length,l=r.every((function(e){return e===e.getHighestParent()||e.getHighestParent()===a})),u=!1,d=!1,h=!1;0===i.length&&(0===i.length&&0===n.length&&l&&(u=!0),0===n.length&&r.length?d=!0:n.length&&(d=(d=n.every((function(e){return e.get("structure").every((function(e){return r.includes(e)}))})))&&r.every((function(e){return n.includes(e.getParent())})))),!(h=u||d)&&i.length&&(h=this.selected.every((function(e){return i.includes(e.getModule())}))),t=s=r.length>0,this.$massActions.filter(".chapter-group")[u?"fadeIn":"fadeOut"](100),this.$massActions.filter(".module-group")[d?"fadeIn":"fadeOut"](100),this.$massActions.filter(".mass-move")[h?"fadeIn":"fadeOut"](100),this.$massActions.filter(".publish-group")[t?"show":"hide"](),this.$massActions.filter(".unpublish-group")[s?"show":"hide"](),this.$massActions.filter(".reschedule-group")[c?"show":"hide"](),this.$massActions.filter(".schedule-group")[c?"hide":"show"]()}else this.$massActions.fadeOut(100)},massAction:function(e){var t=this;if(!this.selected||!this.selected.length)return!1;var s=e.currentTarget.dataset.action,i=TVA.t["success_items_".concat(s)],n={course_id:this.model.get("id"),items:["publish","unpublish"].includes(s)?this.getSelectedIdsForPublish():this.getSelectedIds(),action:s},r=function(){var e=t.$(".tva-course-items-wrapper").first().tvaToggleLoader(60);return wp.apiRequest({url:"".concat(TVA.routes.courses,"/bulk_action"),type:"post",data:n}).done((function(n){switch(s){case"publish":case"unpublish":n.forEach((function(e){var i=t.collection.findItem(e);i&&i.set("post_status","publish"===s?s:"draft")}))}e.tvaToggleLoader(!1),TVE_Dash.success(i),requestAnimationFrame(t.onSelectionChange.bind(t)),t.model.trigger("tva.structure.status.changed"),t.render()}))},o=this;switch(s){case"delete":this.openModal(c,{template:TVE_Dash.tpl("modals/delete-confirmation"),confirm:function(){this.close(),requestAnimationFrame((function(){r().done((function(e){o.model.get("structure").reset(e.structure),o.model.trigger("tva.structure.status.changed")}))}))}});break;case"schedule":this.openModal(l,{model:new Backbone.Model({publish_date:window.moment().format("Y-MM-DD HH:mm")}),width:"400px",className:"tvd-modal tva-schedule-modal",saveSchedule:function(){n.publish_date=this.model.get("publish_date"),this.close(),requestAnimationFrame((function(){r().done((function(e){o.model.get("structure").reset(e.structure),o.model.trigger("tva.structure.status.changed")}))}))}});break;default:r()}return!1},structureAction:function(e){this.openModal(u[e.currentTarget.dataset.action],{parent:this})},getSelectedIds:function(){return this.selected.map((function(e){return e.get("ID")}))},getSelectedIdsForPublish:function(){return this.selected.map((function(e){return("tva_lesson"===e.get("post_type")||e.get("structure").findItemsByOptions({post_type:"tva_lesson"}).length>0)&&e.get("ID")})).filter((function(e){return e}))},openResourcesModal:function(e,t){return this.openModal(u.resources,{parent:this,lessonID:t.dataset.id,lesson:this.model.get("structure").findItem(parseInt(t.dataset.id)),width:"1000px",top:"40px",dismissible:!1}),!1}})}(jQuery)},function(e,t,s){var i=s(46),n=s(95),r=s(47),o=s(7);e.exports=i.extend({template:TVE_Dash.tpl("courses/module"),afterRender:function(){if(i.prototype.afterRender.apply(this,arguments),this.model.get("structure")instanceof Backbone.Collection)switch(this.model.get("structure").getType()){case"chapters":this.$(".tva-add-lesson").remove(),this.$("> .tva-lessons-list").remove();break;case"lessons":this.$("> .tva-chapters-list").remove()}},editWithTar:function(e){e.stopPropagation()},renderStructure:function(e,t){var s=this;e.each((function(e,i){var a;e.get("structure")instanceof o||e.set("structure",new o(e.get("structure")));var c={model:e,numberInList:i+1,expanded:s.expanded,course:s.course};switch(e.get("post_type")){case"tva_chapter":a=new n(c);break;case"tva_lesson":a=new r(c);break;default:a=new Backbone.View}t.append(a.render().$el),s.addChild(a)}));var i=this.$("> .tva-cm-box .tva-cm-status"),a=this.model.get("structure").findItemsByOptions({post_status:"draft"}),c=this.model.get("structure").findItemsByOptions({post_status:"future"});this.model.isPublished()&&(a.length||c.length)?i.attr("data-tooltip",TVE_Dash.sprintf(TVA.t.ContentNotPublished,TVA.t.Module)).addClass("yellow"):"publish"===this.model.get("post_status")?i.attr("data-tooltip",TVA.t.ModulePublished):i.attr("data-tooltip",TVA.t.ModuleNotPublished)}})},function(e,t,s){var i,n;i=jQuery,n=s(0),e.exports=n.extend({template:TVE_Dash.tpl("utils/input-title"),events:function(){return i.extend(n.prototype.events,{"keyup input":"keyup","click input":function(e){return e.stopPropagation()},"blur input":"cancel"})},afterInitialize:function(e){this.$titleTextHolder=e.titleTextHolder,i.extend(!0,this,e)},afterRender:function(){var e=this;this.$input=this.$("input"),setTimeout((function(){e.$input.select().focus()}),0),this.$titleTextHolder.hide()},inputChanged:function(e,t){this.model.set("title",t.value.trim()),this.apply()},keyup:function(e){27===e.which&&this.cancel()},cancel:function(){this.$titleTextHolder.show(),this.destroy().remove()},apply:function(){_.isEmpty(this.model.get("title"))?TVE_Dash.err("This field can not be left empty"):(this.$titleTextHolder.html(this.model.get("title")+TVA.Utils.icon("pencil-custom")).show(),this.destroy().remove(),this.save(this.model.get("title")))},save:i.noop})},function(e,t,s){var i=s(96),n=s(83);e.exports=i.extend({template:TVE_Dash.tpl("courses/grouping/module"),prepareSelection:function(e){var t=e.filter((function(e){return"chapter"===e.getType()}));return t&&t.length&&(e=e.filter((function(e){return"chapter"===e.getType()}))),e},setupOrphans:function(){var e=this;this.selectedItems.some((function(t){var s=t.getParent(),i=null;return s&&("chapter"!==s.getType()||s.getParent())||(i=e.structure),i&&(e.orphans=i.filter((function(t){return!e.selectedItems.includes(t)}))),!!i}))},getNewItemParent:function(){return 0},getNewItemOrder:function(){var e=this.structure.findItemsByOptions({post_type:"tva_module"});return e&&e.length||0},newModel:function(e,t,s){return new n({post_parent:t,type:"module",order:e,course_id:this.course.get("id"),item_ids:s})},url:function(){return"".concat(TVA.routes.modules,"/group_as_module")},successMessage:function(){return TVA.t.success_module_group}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=TVE_Dash.views.ModalSteps,a=s(38),c=s(7);e.exports=o.extend({template:TVE_Dash.tpl("courses/move"),courses:[],selectionType:"module",state:null,events:function(){return n(n({},o.prototype.events),{},{"change .select-item":"selectionChanged","click .tvd-modal-save":"save"})},initialize:function(e){this.parent=e.parent,this.course=this.parent.model,this.structure=this.parent.collection,this.selectedItems=e.parent.selected;var t=this.selectedItems.filter((function(e){return"module"===e.getType()})),s=this.selectedItems.filter((function(e){return"chapter"===e.getType()}));t.length?this.selectionType="module":s.length?this.selectionType="chapter":this.selectionType="lesson",o.prototype.initialize.call(this,e),this.state=new Backbone.Model({coursesFetched:!1,selectedCourse:null,selectedModule:null,selectedChapter:null,canSave:!1}),this.listenTo(this.state,"change",this.render.bind(this))},afterRender:function(){this.state.get("coursesFetched")||this.fetchCourses()},fetchCourses:function(){var e=this;this.$(".tva-loader-courses").tvaToggleLoader(20,!0,{background:"",position:"outside-right"}),wp.apiRequest({url:"".concat(TVA.routes.courses,"/for-selection"),data:{selection_type:this.selectionType,exclude:[this.course.get("id")]}}).done((function(t){e.courses=t.map((function(e){return e.structure=new c(e.structure),new a(e)})).sort((function(e,t){var s=parseInt(e.order),i=parseInt(t.order);return s<i?-1:s>i?1:0})),e.state.set("coursesFetched",!0),1===e.courses.length&&e.selectCourse(e.courses[0].get("id")).checkValid()}))},selectionSummary:function(){var e=this.selectedItems.filter((function(e){return"module"===e.getType()}));if(e.length)return TVA.Utils._n(e.length,"module");var t=this.selectedItems.filter((function(e){return"chapter"===e.getType()}));return t.length?TVA.Utils._n(t.length,"chapter"):TVA.Utils._n(this.selectedItems.length,"lesson")},selectCourse:function(e){e=parseInt(e);var t,s,i=this.courses.filter((function(t){return e===t.get("id")}))[0];return this.state.set("selectedCourse",i,{silent:!0}),s=this.needsModuleSelection()&&1===(t=this.getAvailableModules()).length?t[0].get("ID"):0,this.selectModule(s),this},selectModule:function(e){var t,s,i=this.state.get("selectedCourse").get("structure").findItem(e);return this.state.set("selectedModule",i,{silent:!0}),s=this.needsChapterSelection()&&1===(t=this.getAvailableChapters()).length?t[0].get("ID"):0,this.selectChapter(s),this},selectChapter:function(e){return this.state.set("selectedChapter",this.state.get("selectedCourse").get("structure").findItem(e),{silent:!0}),this},selectionChanged:function(e){var t=TVA.Utils.ucFirst(e.currentTarget.getAttribute("name"));this["select".concat(t)](e.currentTarget.value),this.checkValid()},needsModuleSelection:function(){return!("module"===this.selectionType||!this.state.get("selectedCourse")||!this.state.get("selectedCourse").hasModules())&&!!this.getAvailableModules().length},needsChapterSelection:function(){var e=this.state.get("selectedCourse");if("lesson"!==this.selectionType||!e)return!1;var t=this.state.get("selectedModule");if(this.needsModuleSelection()&&!t)return!1;var s=t?t.get("structure"):e.get("structure");return!!s.length&&!s.every((function(e){return"lesson"===e.getType()}))},getAvailableModules:function(){var e=this.selectionType;return this.state.get("selectedCourse").get("structure").filter((function(t){return"module"===t.getType()&&(!t.get("structure").length||("lesson"===e||t.get("structure").every((function(t){return t.getType()===e}))))}),this)},getAvailableChapters:function(){return(this.state.get("selectedModule")||this.state.get("selectedCourse")).get("structure").filter((function(e){return"chapter"===e.getType()}))},selectedCourseId:function(){var e=this.state.get("selectedCourse");return e&&e.get("id")||0},selectedModuleId:function(){var e=this.state.get("selectedModule");return e&&e.get("ID")||0},selectedChapterId:function(){var e=this.state.get("selectedChapter");return e&&e.get("ID")||0},checkValid:function(){var e=this.state.get("selectedCourse")&&(this.state.get("selectedModule")||!this.needsModuleSelection())&&(this.state.get("selectedChapter")||!this.needsChapterSelection());this.state.set("canSave",e,{silent:!0}),this.state.trigger("change")},preparePostData:function(){var e=this,t=this.selectedItems[0].get("post_parent"),s=TVA.Utils.pluckFields(this.selectedItems,["ID","post_parent","course_id","post_type","post_status"]).map((function(s){return s.old_post_parent=t,s.course_id=e.selectedCourseId(),s.post_parent=e.selectedChapterId()||e.selectedModuleId()||0,s}));return{v:"2",action:"move",course_id:this.course.get("id"),high_level:this.selectionType,items:s}},save:function(){var e=this,t=this.preparePostData(),s=t.items.filter((function(e){return"tva_lesson"===e.post_type})).length,i=this.selectedCourseId();this.showLoader(),wp.apiRequest({url:"".concat(TVA.routes.courses,"/bulk_action"),type:"post",data:t}).done((function(t){e.course.get("structure").reset(t.structure),e.course.recountLessons(),e.parent.render();var n=TVA.courses.findWhere({id:i});n.set({count_lessons:n.get("count_lessons")+s,fetched:!1},{silent:!0}),n.saveState(),e.course.trigger("tva.structure.status.changed"),n.trigger("tva.structure.status.changed"),e.close(),TVE_Dash.success(TVA.t.items_moved)}))}})},function(e,t,s){var i,n,r,o,a;i=jQuery,n=s(16),r=s(296),o=s(154),a=s(155),e.exports=n.extend({$$children:[],template:"modals/courses/resources",initialCount:0,afterInitialize:function(){var e=this;this.collection=r.get(this.lessonID),this.listenTo(this.collection,"add",this.renderItems.bind(this)),this.listenTo(this.collection,"render",this.renderItems.bind(this)),this.listenTo(this.collection,"remove",this.renderItems.bind(this)),this.listenTo(this.collection,"fetch",this.showLoader.bind(this)),this.listenTo(this.collection,"sync",(function(){e.hideLoader(),e.renderItems()})),this.toRemove=[]},afterRender:function(){var e=this;this.showLoader(),this.collection.fetch().done((function(){e.collection.each((function(e){return e.set("expanded",!1,{silent:!0})})),e.initialCount=e.collection.length,e.renderItems()})),this.$el.addClass("tva-res-modal"),this.$(".scrollbar-inner").scrollbar(),this.$saveButton=this.$('button[data-fn="save"]')},renderItems:function(){var e=this,t=i(),s=this.collection.length;this.$$children.forEach((function(e){return e.destroy()})),this.$$children=[],this.collection.sort(),this.collection.each((function(s,i){s.$$index=i;var n=new a({model:s});t=t.add(n.render().$el),e.$$children.push(n),s.get("expanded")&&n.$el.addClass("tva-expanded")}));var n=this.$(".tva-resources").html(t).sortable({handle:".tva-drag-handle",stop:function(){n.sortable("destroy"),n.children().each((function(t,s){e.collection.at(Number(s.dataset.resourceIndex)).set("order",t,{silent:!0})})),e.collection.trigger("render")}});this.$(".tva-resources-start").toggle(0===s),this.$saveButton.toggleClass("tva-disabled",0===s&&0===this.initialCount)},beforeClose:function(){this.stopListening(),this.undelegateEvents(),this.collection.each((function(e){e.unset("delete_confirmation",{silent:!0}),e.unset("editing",{silent:!0})}))},addClicked:function(){var e=this;this.$(".tva-resources-start").hide();var t=new o({order:this.collection.length,title:"Resource "+this.collection.getAutoIncrement(),icon:o.icons.default,expanded:!0});return this.collection.each((function(e){return e.trigger("collapse")})),this.collection.add(t),requestAnimationFrame((function(){return TVE_Dash.materialize(e.$el)})),setTimeout((function(){var t=e.$(".tva-styled-scrollbar.scroll-content");t.animate({scrollTop:t[0].scrollTop+200},150)}),200),!1},removeClicked:function(e,t){var s=this.collection.at(Number(t.dataset.index));return s.get("delete_confirmation")?(s.get("id")&&this.toRemove.push(s.get("id")),this.collection.remove(s),this.collection.buildOrder(),!1):(s.set("delete_confirmation",!0),!1)},save:function(){var e=this,t=!0,s=!1,i=this.$(".tvd-modal-content");if(this.collection.each((function(n,r){!0!==n.validateConfig()&&(s||(s=!0,i.animate({scrollTop:i[0].scrollTop-i.offset().top+e.$$children[r].$el.offset().top},150)),t=!1)})),!t)return TVE_Dash.err(TVA.t.resources.fix_errors);this.showLoader(),r.save(this.collection,this.toRemove).fail((function(e){TVE_Dash.err("Something went wrong. Could not save resources"),console.error(e)})).done((function(){e.lesson.set("resource_count",e.collection.length),e.lesson.trigger("render"),TVE_Dash.success(TVA.t.resources.save_success),e.close()})).always(this.hideLoader.bind(this))}})},function(e,t,s){var i=s(2),n={txt:"text",odt:"text",pdf:"pdf",doc:"doc",docx:"doc",xls:"xls",xlsx:"xls",zip:"zip",tar:"zip",rar:"zip",gzip:"zip",ppt:"ppt",pptx:"ppt",pps:"ppt",ppsx:"ppt",mp4:"video",m4v:"video",mov:"video",wmv:"video",avi:"video",mpg:"video",ogv:"video","3gp":"video","3g2":"video",psd:"image",jpg:"image",jpeg:"image",png:"image",bmp:"image",gif:"image",ico:"image",mp3:"audio",m4a:"audio",ogg:"audio",wav:"audio"},r=i.extend({defaults:function(){return{title:"",content:"",type:"url",order:1e3,icon:r.icons.file,config:{}}},hasDefaultTitle:function(){return!!this.get("title").match(/^Resource (\d+)$/)},initialize:function(){this.on("change",this.onChange.bind(this))},onChange:function(){var e=Object.keys(this.changed),t=this.deepGet("config.url");t&&t!==TVA.Utils.ensureUrlProtocol(t)?this.deepSet("config.url",TVA.Utils.ensureUrlProtocol(t)):_.intersection(e,["config","type"]).length&&this.updateIcon(),this.hasError()&&!e.includes("error")&&this.validateConfig()},updateIcon:function(){var e="default",t=this.get("config")||{},s="";switch(this.get("type")){case"content":t.post&&(e=r.icons[t.post.post_type]?t.post.post_type:"page");break;case"url":(s=t.url||!1)&&(r.isExternalVideo(s)?(e="video",s=!1):this.getExtension(s)||(s=!1,e="url"));break;case"file":s=t.attachment&&t.attachment.url}s&&(e=n[this.getExtension(s)]||"default"),this.set({icon:e})},validateConfig:function(){var e,t=this.get("config")||{};switch(this.get("type")){case"url":e=!(!t.url||!t.url.trim())||{field:"config.url",message:TVA.t.resources.required_url_missing};break;case"file":e=!(!t.attachment||!t.attachment.id)||{field:"config.attachment",message:TVA.t.resources.required_file_missing};break;case"content":e=!(!t.post||!t.post.id)||{field:"config.post",message:TVA.t.resources.required_content_missing}}return!0!==e?this.set("error",e):this.set("error",!1),e},getIcon:function(){var e=this.get("icon");return e.startsWith("<")?e:r.icons[e]||r.icons.default},getSummaryIcon:function(){return r.admin_icons[this.get("type")]},getExtension:function(e){var t="";try{t=new URL(e).pathname}catch(s){t=e}return t.includes(".")?t.split(".").pop().toLowerCase():null},getSummary:function(){if(this.hasError())return this.deepGet("error.message");var e,t,s;switch(this.get("type")){case"url":t=(s=this.deepGet("config.url","").trim())?(e=this.getExtension(s))?TVA.t.resources.external_x_file.replace("{ext}",e):r.isExternalVideo(s)?TVA.t.resources.external_video_link:TVA.t.resources.external_link:TVA.t.resources.enter_url;break;case"file":var i=this.deepGet("config.attachment");t=i&&i.id?(e=this.getExtension(i.url))?TVA.t.resources.uploaded_x_file.replace("{ext}",e):TVA.t.resources.uploaded_link:TVA.t.resources.select_file;break;case"content":var n=this.deepGet("config.post");t=n&&n.id?TVA.t.resources.content_x.replace("{type}",n.type_label):TVA.t.resources.choose_content;break;default:t=""}return t},hasError:function(){return!!this.deepGet("error.field")}},{isExternalVideo:function(e){var t=e.toLowerCase();return["youtube.com","youtu.be","vimeo.com","vooplayer","wistia.com"].some((function(e){return t.includes(e)}))},admin_icons:{file:'<svg class="tva-icon" viewBox="0 0 12 13"><g fill="none" fill-rule="evenodd"><g fill="#B0BBC3" fill-rule="nonzero"><g><g><path d="M87.945 44.383c.594-.156 1.117-.461 1.57-.914l4.57-4.594c.063-.047.095-.11.095-.187 0-.079-.032-.149-.094-.211l-.399-.399c-.046-.047-.109-.07-.187-.07s-.148.023-.211.07l-4.57 4.594c-.469.469-1.028.703-1.676.703-.648 0-1.203-.23-1.664-.691-.461-.461-.692-1.016-.692-1.664 0-.649.227-1.207.68-1.676l5.274-5.274c.312-.297.683-.445 1.113-.445.43 0 .797.152 1.101.457.305.305.457.672.457 1.102 0 .43-.148.793-.445 1.09l-4.453 4.453c-.14.14-.316.21-.527.21-.211 0-.395-.074-.551-.222-.156-.149-.234-.328-.234-.54 0-.21.078-.386.234-.527l3.75-3.773c.062-.047.094-.11.094-.187 0-.079-.032-.149-.094-.211l-.399-.399c-.046-.047-.109-.07-.187-.07s-.14.023-.188.07l-3.773 3.774c-.375.375-.562.82-.562 1.336 0 .515.187.957.562 1.324.375.367.82.55 1.336.55.516 0 .96-.18 1.336-.539l4.43-4.453c.343-.343.578-.746.703-1.207.125-.46.125-.922 0-1.383-.125-.46-.36-.859-.703-1.195-.344-.336-.746-.566-1.207-.691-.461-.125-.922-.125-1.383 0-.461.125-.856.351-1.184.68l-5.273 5.296c-.453.438-.758.953-.914 1.547-.157.594-.157 1.192 0 1.793.156.602.46 1.121.914 1.559.437.453.957.758 1.558.914.602.156 1.2.156 1.793 0z" transform="translate(-5507 -180) translate(5384 78) translate(40 70)"/></g></g></g></g></svg>',url:'<svg class="tva-icon" viewBox="0 0 14 13"><g fill="none" fill-rule="evenodd"><g fill="#B0BBC3" fill-rule="nonzero"><g><path d="M130.32 249.5c.078 0 .149-.031.211-.094l6.516-6.515.047.047-.047 1.71c0 .094.031.176.094.247.062.07.14.105.234.105h.773c.094 0 .176-.031.246-.094.07-.062.106-.14.106-.234v-3.844c0-.094-.031-.172-.094-.234-.062-.063-.14-.094-.234-.094h-3.844c-.094 0-.172.035-.234.105-.063.07-.094.153-.094.247v.773c0 .094.035.172.105.234.07.063.153.094.247.094l1.71-.047.047.047-6.515 6.516c-.063.062-.094.133-.094.21 0 .079.031.141.094.188l.539.54c.047.062.11.093.187.093zm4.055 3c.312 0 .578-.11.797-.328.219-.219.328-.485.328-.797v-5.203c0-.125-.059-.211-.176-.258-.117-.047-.215-.023-.293.07l-.562.563c-.063.047-.094.11-.094.187v4.5c0 .032-.016.063-.047.094s-.062.047-.094.047h-7.968c-.032 0-.063-.016-.094-.047s-.047-.062-.047-.094v-7.968c0-.032.016-.063.047-.094s.062-.047.094-.047h7.078c.125 0 .21-.059.258-.176.046-.117.023-.215-.07-.293l-.563-.562c-.047-.063-.11-.094-.188-.094h-6.656c-.313 0-.578.11-.797.328-.219.219-.328.485-.328.797v8.25c0 .312.11.578.328.797.219.219.484.328.797.328h8.25z" transform="translate(-5509 -318) translate(5384 78)"/></g></g></g></svg>',content:'<svg class="tva-icon" viewBox="0 0 12 13"><g fill="none" fill-rule="evenodd"><g fill="#B0BBC3" fill-rule="nonzero"><g><g><path d="M90 326.5c.203 0 .383-.07.539-.21l5.25-5.25c.14-.157.211-.337.211-.54s-.07-.383-.211-.539l-5.25-5.25c-.156-.14-.336-.211-.539-.211s-.383.07-.54.211l-5.25 5.25c-.14.156-.21.336-.21.539s.07.383.21.54l5.25 5.25c.157.14.337.21.54.21zm0-1.29l-4.71-4.71 4.71-4.71 4.71 4.71-4.71 4.71zm-1.313-2.835c.047 0 .09-.02.13-.059.038-.039.058-.082.058-.128v-1.5h1.875v1.265c0 .047.02.09.059.129.039.04.082.059.128.059.047 0 .086-.016.118-.047l1.992-1.828c.031-.032.047-.078.047-.141 0-.062-.016-.11-.047-.14l-1.992-1.829c-.032-.031-.07-.047-.118-.047-.046 0-.09.02-.128.059-.04.039-.059.082-.059.129v1.266H88.5c-.203 0-.379.074-.527.222-.149.149-.223.324-.223.528v1.875c0 .046.02.09.059.128.039.04.082.059.128.059h.75z" transform="translate(-5508 -462) translate(5384 78) translate(40 70)"/></g></g></g></g></svg>'},icons:TVA.resourceIcons});e.exports=r},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(0),a=s(97),c=s(143);e.exports=o.extend({className:"tva-resource tva-draggable tva-flex tva-align-stretch",template:TVE_Dash.tpl("courses/resources/item"),events:n(n({},o.prototype.events),{},{"change .tva-title-events":"onTitleChange","blur .tva-title-events":"onTitleBlur","keyup .tva-title-events":"onTitleKeyup","change .model-field":"fieldChanged"}),afterInitialize:function(){var e=this;this.listenTo(this.model,"change",this.render.bind(this)),this.listenTo(this.model,"collapse",this.collapse),this.mediaFrame=wp.media({title:"Select or upload a file",button:{text:"Use this file"}}),this.mediaFrame.on("select",(function(){var t=e.mediaFrame.state().get("selection").first().toJSON();e.model.deepSet("config.attachment",{id:t.id,url:t.url,filename:t.filename,size:t.filesizeHumanReadable})}))},afterRender:function(){var e=this;this.$el.toggleClass("tva-has-error",this.model.hasError()),this.$el.attr("data-resource-index",this.model.$$index),requestAnimationFrame((function(){e.$(".tva-title-events").select().focus()})),"content"===this.model.get("type")&&(this.postSearch=new c(this.$(".tva-resource-autocomplete"),{url:TVA.Utils.buildUrl("".concat(TVA.routes.settings,"/search_pages/"),{post_type:"post,page"}),appendTo:"body",select:function(t,s){e.model.deepSet("config.post",{id:s.item.id,title:s.item.label,url:s.item.url,type_label:s.item.type,post_type:s.item.post_type})}})),this.model.get("delete_confirmation")&&requestAnimationFrame((function(){return e.$(".delete-final").trigger("focus")}))},editing:function(){return this.model.set("editing",!0),!1},onTitleChange:function(e){var t=e.currentTarget,s=t.value.trim();if(!s)return t.classList.add("tva-error"),t.focus(),!1;this.preventBlur=!0,s!==this.model.get("title")?this.model.set({title:s,editing:!1}):this.model.set("editing",!1)},onTitleKeyup:function(e){27===e.which&&(this.preventBlur=!0,this.model.set("editing",!1))},onTitleBlur:function(){this.preventBlur?delete this.preventBlur:this.model.set("editing",!1)},fieldChanged:function(e){var t=e.target.dataset.field,s={silent:!!Number(e.target.dataset.silent)};this.model.deepSet(t,e.target.value,s)},openIconPicker:function(){this.openModal(a,{topic_title:this.model.get("title"),model:this.model,"max-width":"865px","max-height":"80vh",width:"auto",in_duration:200,out_duration:300,className:"tva-default-modal-style tvd-modal",saveCallback:function(e){this.model.set({icon_changed:1,icon:e})}})},openFilePicker:function(){this.mediaFrame.open()},clearConfig:function(){this.model.set("config",{})},destroy:function(){return this.mediaFrame&&(this.mediaFrame.off("select"),delete this.mediaFrame),o.prototype.destroy.call(this)},collapse:function(){this.model.set("expanded",!1,{silent:!0}),this.$el.removeClass("tva-expanded")},toggleExpanded:function(){var e=this;return this.model.set("expanded",!this.model.get("expanded"),{silent:!0}),this.$el.toggleClass("tva-expanded",this.model.get("expanded")),requestAnimationFrame((function(){return TVE_Dash.materialize(e.$el)})),this.model.get("expanded")&&this.model.collection.each((function(t){t!==e.model&&t.trigger("collapse")})),this.$(".tva-res-info").toggleClass("click",!this.model.get("expanded")),!1},cancelDelete:function(){return this.model.unset("delete_confirmation"),!1}})},function(e,t,s){var i;i=jQuery,e.exports=s(2).extend({idAttribute:"id",defaults:{name:"",key:"",status:1},initialize:function(e){e&&e.key||this.generateKey()},generateKey:function(){var e=this;i.ajax({beforeSend:function(e){TVE_Dash.showLoader(),e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)},url:"".concat(this.url(),"/generate")}).success((function(t){delete t.id,e.set(t)})).always((function(){TVE_Dash.hideLoader()}))},validate:function(){var e=[];if(this.get("name")||e.push(this.validation_error("name",TVA.t.name_is_required)),e.length)return e},url:function(){var e=TVA.routes.token;return this.get("id")&&(e+="/".concat(this.get("id"))),e}})},function(e,t,s){var i,n,r;i=jQuery,n=s(3),r=s(7),e.exports=n.extend({template:TVE_Dash.tpl("modals/course-item"),stepSelector:".tvd-modal-step",events:i.extend(n.prototype.events,{"change #tva-parent-target":function(e){var t=isNaN(parseInt(e.currentTarget.value))?0:parseInt(e.currentTarget.value);if(!t)return this.structure=this.parentStructure,void this.model.set("post_parent",void 0);i(e.currentTarget).siblings("#tva-child-target").select2("destroy").remove();var s=this.parentStructure.findItem(t);this.__lastSelectedParent=s,this.model.set("post_parent",t),s&&s.get("structure")instanceof r&&(this.structure=s.get("structure"),this.model.set("order",this.structure.length))}}),afterInitialize:function(e){this.parentStructure=e.structure},afterRender:function(){n.prototype.afterRender.apply(this,arguments),this.model?this.decisionMaking():this.gotoStep(0)},renderForm:function(e){e instanceof Backbone.Model||(e=this.model),this.gotoStep(2);var t=new(s(270)("./".concat(e.getType())))({el:this.$("#tvd-form-modal-step").find(".tvd-modal-content"),model:e}).render();return this.input_focus(t.$el),this.model.get("id")&&this.model.isPublished()||this.$el.find(".tva-course-item-slug").siblings(".tva-zclip").attr("disabled","disabled").html(""),this},decisionMaking:function(){if(!this.model)return console.warn("a model has to be set in order to make decision for it");if("content"===this.structure.getType()||this.model.get("id"))return!this.model.get("post_parent")&&this.__lastSelectedParent&&this.model.set("post_parent",this.__lastSelectedParent.get("id")),this.renderForm(this.model);switch(this.model.getType()){case"lesson":switch(this.structure.getType()){case"lessons":return this.renderForm(this.model);case"chapters":case"modules":return this.model.getType()!==this.structure.getSingularType()&&this.model.set("post_parent",0),this.renderParentsDropDowns()}break;case"chapter":switch(this.structure.getType()){case"chapters":return this.renderForm(this.model);case"modules":return this.renderParentsDropDowns();case"lessons":this.model.set("merge_items",this.structure.pluck("id"));var e=this.structure.where({post_status:"publish"});return this.model.set("post_status",e.length>0?"publish":"draft"),this.renderWarning()}break;case"module":switch(this.structure.getType()){case"lessons":case"chapters":this.model.set("merge_items",this.structure.pluck("id"));var t=this.structure.where({post_status:"publish"});return this.model.set("post_status",t.length>0?"publish":"draft"),this.renderWarning();case"modules":return this.renderForm(this.model)}}return this},setModel:function(e,t){var i=t.dataset.type;if(!i)return this;var n=s(215)("./".concat(i));return this.model=new n({course_id:this.course.get("id"),order:this.structure.getSingularType()===i?this.structure.getOrderForNewItem():0,comment_status:this.course.get("allows_comments")?"open":"closed"}),this.decisionMaking()},renderWarning:function(){var e=this.$("#tva-moving-item-text");return e.text(TVE_Dash.sprintf(e.text(),[this.structure.getType(),this.model.getType(),this.structure.getType()])),this.gotoStep(3)},renderParentsDropDowns:function(){var e=this;switch(this.gotoStep(1),this.$parentsSelect=this.$("#tva-parent-target").empty(),this.$description=this.$("#tva-item-description"),this.structure.getType()){case"chapters":this.$description.text("In which chapter you would like to add your lesson"),this.$parentsSelect.append(i('<option value="">'.concat(TVA.t.SelectChapter,"</option>")));break;case"modules":this.$description.text(TVE_Dash.sprintf(TVA.t.WhichModule,this.model.getType())),this.$parentsSelect.append(i('<option value="">'.concat(TVA.t.SelectModule,"</option>")))}return this.structure.each((function(t){e.$parentsSelect.append(i('<option value="'.concat(t.get("id"),'">').concat(t.get("post_title"),"</option>")))})),this.$parentsSelect.select2(),this},setParent:function(){return this.model.get("post_parent")?this.decisionMaking():TVE_Dash.err(TVE_Dash.sprintf(TVA.t.PleaseSelect,"modules"===this.structure.getType()?TVA.t.Module:TVA.t.Chapter))},save:function(){var e=this,t=this.$el.find(".tva-course-item-slug"),s=this.model.get("post_name"),i=!this.model.get("id");if(t.removeClass("tva-error"),!s&&!i)return t.addClass("tva-error"),t.focus(),TVE_Dash.err(TVA.t.InvalidSlug),!1;this.model.get("merge_items")&&this.model.set("structure",new r(this.structure.toJSON()));var n=this.model.get("structure"),o=this.model.changedAttributes();n&&!1!==o&&Object.keys(o).includes("comment_status")&&n.updateChildrenCommentStatus(this.model.get("id"),this.model.get("comment_status"));var a=this.model.save(null,{success:function(t){t.set("structure",n),e.model.get("merge_items")?(e.structure.reset([e.model]),e.model.get("structure").each((function(e){e.set("post_parent",t.get("id"))}))):e.structure.add(t);var s=TVA.courses.findWhere({id:e.course.get("id")});s&&s.trigger("tva.structure.modified",t),i&&t.expand()}});a&&(TVE_Dash.showLoader(),a.always((function(){e.model.set("merge_items",!1),TVE_Dash.hideLoader(),e.close()})))}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(0),a=s(159),c=s(126),l=s(161);e.exports=o.extend({template:TVE_Dash.tpl("drip/course-tab"),afterInitialize:function(){this.listenTo(this.collection,"add remove render",this.render.bind(this))},onActivate:function(){var e=this;this.render();var t=Backbone.history.getFragment().split("/");if(t[2]){var s=t[2].split("-")[1];requestAnimationFrame((function(){e.$('[data-fn="clickEditCampaign"][data-id="'.concat(s||"nothing",'"]')).click()}))}},renameCampaign:function(e){var t=e.currentTarget.dataset.campaignId,s=this.collection.get(parseInt(t)),i=this.model.dripCampaigns;this.$(".tva-campaign-name").unbind(),this.$(".tva-campaign-name").tvaInlineEdit({validation_fn:function(e){return 0!==i.where({post_title:e}).length?TVE_Dash.err(TVA.t.drip_campaign_name_taken):!("string"!=typeof e||0===e.trim().length)}}).one("change",(function(e,t){s.set({post_title:t},{silent:!0}),s.save(null,{silent:!0})}))},openCampaignModal:function(e){var t,s=this,i=e.currentTarget.dataset.campaignId;i?((t=this.collection.get(parseInt(i))).ensureValidSettings(this.model),t.saveState()):t=new c({course_id:this.model.get("id")});var n=this.openModal(a,{model:t,course:this.model,className:"tvd-modal tva-drip-modal",width:"800px"});if(i&&e.currentTarget.dataset.step){var r=this.$("#tva-drip-force-unlock-order:checked").length>0,o=this.$("#tva-drip-display-locked:checked").length>0;n.form.$("#tva-drip-force-unlock-order").attr("checked",r),n.form.$("#tva-drip-display-locked").attr("checked",o),n.model.set("force_unlock_order",r),n.model.set("display_locked",o);var l=n.form.$(".tva-drip-settings-input:checked").length;l>0?(n.form.$(".tva-active-options").removeClass("hidden"),n.form.$(".tva-active-options")[0].innerText=l+" "+TVA.t.active,n.form.$(".tva-drip-campaign-behaviour").removeClass("hidden")):n.form.$(".tva-active-options").addClass("hidden"),n.gotoStep(parseInt(e.currentTarget.dataset.step))}return n.on("saved",(function(){i||(i=t.get("id"),s.collection.unshift(t)),s.editView(i),n.destroy()})),i&&n.on("canceled",(function(){return t.restoreState()})),!1},forceOrderChanged:function(e){var t=this,s=this.collection.get(parseInt(e.currentTarget.dataset.campaignId));s instanceof c&&(s.set("force_unlock_order",e.currentTarget.checked),s.save(),TVA.customers.resetIndividualStudentViews()),setTimeout((function(){t.editView(s.get("id"))}),200)},visibilityChanged:function(e){var t=this.collection.get(parseInt(e.currentTarget.dataset.campaignId));t.set("display_locked",e.currentTarget.checked),t.save(),TVA.customers.resetIndividualStudentViews()},listView:function(){this.$(".tva-view-state").hide().filter(".state-list").show()},editView:function(e){this.display.setCampaign(this.collection.get(parseInt(e))),this.$(".tva-view-state").hide().filter(".state-edit").show()},afterRender:function(){this.display&&this.display.destroy(),this.display=new l({course:this.model,parent:this}),this.addChild(this.display),this.$(".state-edit").html(this.display.render().$el)},clickEditCampaign:function(e){return this.editView(e.currentTarget.dataset.id),!1},deleteCampaign:function(e){var t=this.collection.get(parseInt(e.currentTarget.dataset.id));TVA.Utils.confirmation(n(n({},TVA.t.drip_delete_confirmation),{},{title:TVA.t.drip_delete_confirmation.title.replace("{title}","<strong>".concat(t.get("post_title"),"</strong>")),yesClass:"tva-modal-btn-blue"})).then((function(){t.destroy({success:function(){TVA.customers.resetIndividualStudentViews(),TVE_Dash.success(TVA.t.drip_deleted)},error:function(e){TVE_Dash.err(e.responseJSON.message)}})}))},openContentTab:function(){return jQuery(".tva-tabs-ul li:nth-child(2)").trigger("click"),!1}})},function(e,t,s){var i=s(3),n=s(160);e.exports=i.extend({template:TVE_Dash.tpl("drip/modals/campaign-settings"),infoTemplate:TVE_Dash.tpl("drip/campaign/info-text"),noMaterialize:!0,disableContainerClass:"tva-drip-container-disabled",afterInitialize:function(){var e=this;this.listenTo(this.model,"change:schedule_type change:trigger settings-changed",_.debounce((function(){e.toggleSaveBtn()})),50)},afterRender:function(){this.model.get("type")&&this.renderInfoBox(),i.prototype.afterRender.apply(this,arguments),this.form=new n({model:this.model,course:this.course}),this.$(".tva-drip-form").html(this.form.render().$el)},renderInfoBox:function(){var e=this;this.$(".tva-drip-info-text").html(this.infoTemplate({type:this.model.get("type"),longdesc:TVA.drip.campaign_types.find((function(t){return t.type===e.model.get("type")})).longdesc}))},typeSelected:function(){this.model.prepopulate(),this.model.prefillLockFrom(this.course),this.form.render(),this.gotoStep(1),this.renderInfoBox(),this.toggleSaveBtn()},selectType:function(e){this.$(".drip-campaign-type").removeClass("selected");var t=e.currentTarget;t.classList.add("selected");var s=TVA.drip.campaign_types.find((function(e){return e.type===t.dataset.type})).label;return s=this.course.dripCampaigns.getTitleFromLabel(s),this.model.set({type:t.dataset.type,post_title:s}),this.$('[data-step="0"] .tva-next-step').removeClass("tva-disabled"),this.renderInfoBox(),!1},saveClicked:function(){return this.model.get("id")?(this.$(".tva-drip-types-container").addClass(this.disableContainerClass),this.$(".tva-save-warn").fadeIn(100)):this.save(),!1},cancelSave:function(){return this.$(".tva-save-warn").fadeOut(50),this.$(".tva-drip-types-container").removeClass(this.disableContainerClass),!1},save:function(){var e=this;if(!this.canSaveCampaign())return!1;var t=this.model.validate();if(void 0!==t)return TVE_Dash.err(_.first(t).message);var s,i=this.course.getModulesAndLessons();this.model.set({schedule:this.form.getScheduleData(),lock_from_id:(null===(s=i[this.model.get("lock_from")])||void 0===s?void 0:s.get("ID"))||""},{silent:!0}),this.model.updateTemplateType({silent:!0}).applySettings(this.course,!0),TVA.customers.resetIndividualStudentViews();var n=this.model.save();return n&&(TVE_Dash.showLoader(),n.done((function(){e.__saved=!0,e.close(!1),e.trigger("saved")})).always((function(){return TVE_Dash.hideLoader()}))),n},onClose:function(){this.__saved||this.trigger("canceled")},canSaveCampaign:function(){return this.model.get("trigger")&&this.model.get("schedule_type")},toggleSaveBtn:function(){this.$(".tva-btn-save-campaign").toggleClass("tva-disabled",!this.canSaveCampaign())}})},function(e,t,s){var i=s(0),n=s(44),r=s(99);e.exports=i.extend({template:TVE_Dash.tpl("drip/campaign/form-general"),className:"tva-drip-form",dynamicConditions:["trigger","schedule_type"],afterInitialize:function(e){var t=this;this.course=e.course,this.listenTo(this.model,"change:content_type",(function(){t.model.set("lock_from","",{silent:!0}),t.model.prefillLockFrom(t.course),t.renderModulesAndLessonsDropdown()})),this.listenTo(this.model,"invalid",function(){requestAnimationFrame((function(){jQuery(".tvd-modal-content").prop("scrollTop",0)}),100)}.bind(this))},getContentTypeOptions:function(){var e=[],t=!1,s=!1;this.course.getModulesAndLessons().forEach((function(i){t||"lesson"!==i.getType()||(e.push('[value="'.concat(i.get("post_type"),'"]')),t=!0),s||"module"!==i.getType()||(e.push('[value="'.concat(i.get("post_type"),'"]')),s=!0)}));var i=this.$courseItemOptions.filter(e.join(",")||".not-found");return 1===i.length&&this.model.set("content_type",i.val(),{silent:!0}),i},afterRender:function(){this.$courseItemOptions=this.$courseItemOptions||this.$('[data-bind="content_type"] option'),this.$contentSelect=this.$(".tva-content-select"),this.$('[data-bind="content_type"]').html(this.getContentTypeOptions()),this.renderModulesAndLessonsDropdown(),this.renderAdvancedSettings(),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select")),this.handleDynamicFields();var e=window.datepickerApi=n.renderPopup(this.$(".tva-popup-datepicker"),{model:this.model,prop:"unlock_date",active:"date",isInvalidDate:function(e){return wp.date.format("d-m-Y",e)!==wp.date.format("d-m-Y")&&!wp.date.isInTheFuture(e)},onChange:function(e){t.setDate(e)}}),t=window.timepickerApi=n.renderInline(this.$(".tva-popup-timepicker"),{model:this.model,prop:"unlock_date",is12HourTime:!1,onChange:function(t){e.setDate(t)}})},handleDynamicFields:function(){var e=this,t=this.$(".tva-drip-dynamic").hide();_.each(this.dynamicConditions,(function(s){t.filter(".".concat(s,"-").concat(e.model.get(s))).show()})),this.schedule&&(this.schedule.destroy(),delete this.schedule),"repeating"===this.model.get("schedule_type")&&(this.schedule=r.renderTo(this.$(".tva-schedule-controls"),this.model.get("schedule_type"),this.model.get("schedule")),this.schedule.on("model-change",(function(){e.model.set("schedule",e.getScheduleData(),{silent:!0}),e.model.trigger("settings-changed")}))),this.model.trigger("settings-changed")},getScheduleData:function(){var e;return(null===(e=this.schedule)||void 0===e?void 0:e.getData())||{e:1}},renderModulesAndLessonsDropdown:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"index",s="",i=this.model.get("lock_from");""!==i&&(i=parseInt(i));var n=1,r=1,o=TVA.t["drip_choose_".concat(this.model.get("content_type"))];s+='<option value=""'.concat(""===i?" selected":""," disabled>").concat(o,"</option>"),this.course.getModulesAndLessons().forEach((function(o,a){if("tva_module"!==e.model.get("content_type")||"lesson"!==o.getType()){var c,l=i===o.get("ID")?" selected":"",u=e.model.get("content_type")!==o.get("post_type")?" disabled":"";c="lesson"===o.getType()?"&nbsp;&nbsp;&nbsp;&nbsp;L".concat(r++," &bull;"):"M".concat(n++," &bull;");var d="index"===t?a:o.get("ID");s+='<option value="'.concat(d,'"').concat(l+u,">").concat(c," ").concat(_.escape(o.get("post_title")),"</option>")}})),this.$contentSelect.html(s).trigger("change")},renderAdvancedSettings:function(){var e=this;"sequential"===this.model.get("type")&&(this.$(".tva-drip-campaign-behaviour").removeClass("hidden"),this.$("#tva-drip-force-unlock-order").attr("checked","checked"),this.$("#tva-drip-display-locked").attr("checked","checked"),this.$(".tva-active-options").removeClass("hidden"),this.$("#ta-arrow-up").removeClass("hidden"),this.$("#ta-arrow-down").addClass("hidden")),this.countActiveOptions(),this.$(".tva-advanced-settings-button").on("click",(function(){e.$(".tva-drip-campaign-behaviour").toggleClass("hidden"),e.$("#ta-arrow-up").toggle(),e.$("#ta-arrow-down").toggle()})),this.model.set("display_locked",this.$("#tva-drip-display-locked")[0].checked),this.model.set("force_unlock_order",this.$("#tva-drip-force-unlock-order")[0].checked),this.$(".tva-drip-settings-input").on("change",(function(){e.countActiveOptions()}))},countActiveOptions:function(){var e=this.$(".tva-drip-settings-input:checked").length;e>0?(this.$(".tva-active-options").removeClass("hidden"),this.$(".tva-active-options")[0].innerText=e+" "+TVA.t.active):this.$(".tva-active-options").addClass("hidden")},visibilityChanged:function(e){this.model.set("display_locked",e.currentTarget.checked)},forceOrderChanged:function(e){this.model.set("force_unlock_order",e.currentTarget.checked)}})},function(e,t,s){var i=s(0),n=s(162);e.exports=i.extend({template:TVE_Dash.tpl("drip/campaign/display"),className:"tva-relative",itemSummaryTemplate:TVE_Dash.tpl("drip/campaign/overview/unlock-summary"),afterInitialize:function(e){this.course=e.course,this.parentView=e.parent},setCampaign:function(e){this.model=this.campaign=e,this.render()},render:function(){var e=this;return this.model&&(this.currentModuleIndex=0,i.prototype.render.apply(this,arguments),this.tooltipKey="campaign_".concat(this.model.get("id"),"_unlock_conditions"),TVA.Utils.isTooltipViewed(this.tooltipKey)||0===this.course.getModulesAndLessons().length||(this.$tooltip=this.$(".tva-campaign-tooltip"),requestAnimationFrame((function(){return e.showTooltip()})))),this},getRenderParams:function(){return{model:this.model,publishedContent:this.course.getModulesAndLessons(!0)}},renderCourseItem:function(e){return"module"===e.getType()?(this.currentModuleIndex++,TVE_Dash.tpl("drip/campaign/overview/module")({view:this,module:e,currentModuleIndex:this.currentModuleIndex})):TVE_Dash.tpl("drip/campaign/overview/lesson")({view:this,lesson:e})},editUnlockSettings:function(e){var t=parseInt(e.currentTarget.dataset.contentId);return this.openModal(n,{post_id:t,campaign:this.campaign,course:this.course,className:"tvd-modal tva-drip-modal",width:"690px",openTrigger:!1,courseItem:this.course.get("structure").findItem(t)}).on("saved",this.render.bind(this)),!1},back:function(){this.parentView.render().listView()},renderUnlockSummary:function(e){var t,s=this.campaign.getUnlockSummaryForContentId(e);return this.itemSummaryTemplate({unlockedLabel:this.campaign.getUnlockedLabel(),unlockedTooltip:this.campaign.getUnlockedTooltip(),mainView:this,total:(null===(t=s.items)||void 0===t?void 0:t.length)||0,state:s,contentId:e})},showTooltip:function(){var e=this.$(".tva-drip-unlock-summary").first(),t=e.offset(),s=this.$el.offset();e.addClass("no-hover"),this.$tooltip.addClass("ttd-visible").css({position:"absolute",left:"".concat(parseInt(t.left-s.left-this.$tooltip.outerWidth(!0)/3),"px"),top:"".concat(parseInt(t.top-s.top-this.$tooltip.outerHeight(!0)-10),"px")})},hideTooltip:function(){var e=this;return this.$tooltip.addClass("ttd-out"),this.$(".tva-drip-unlock-summary").first().removeClass("no-hover"),setTimeout((function(){return e.$tooltip.removeClass("ttd-visible ttd-out")}),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(){var e=l(["drip-selected-"]);return o=function(){return e},e}function a(){var e=l([" "]);return a=function(){return e},e}function c(){var e=l([" "]);return c=function(){return e},e}function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var u=s(3),d=s(127),h=s(10);e.exports=u.extend({template:TVE_Dash.tpl("drip/modals/content-unlock-settings"),noMaterialize:!0,beforeInitialize:function(e){this.campaign=e.campaign,this.model=this.campaign.getUnlockSettingsForContentId(e.post_id,!0),this.collection=this.model.get("triggers"),this.post_id=e.post_id,this.listenTo(this.collection,"add remove",this.render.bind(this)),e.openTrigger&&(this.openTrigger=e.openTrigger)},afterRender:function(){var e=this;delete this.activeTrigger;var t="inherited"===this.model.get("forced_unlock")&&!0===this.campaign.get("force_unlock_order"),s=this.course,i=("yes"===this.model.get("forced_unlock")||t)&&!this.courseItem.isFirst(s),n=this.model.hasInherited()&&"tva_lesson"===this.courseItem.get("post_type");i&&!n?this.$(".tva-sequential-info-box").show():n&&this.$(".tva-inherited".concat(i?"-sequential":"","-info-box")).show(),this.courseItem.isFirst(s)?this.$("#tva-drip-forced-unlock-dropdown").hide():this.$("#tva-drip-forced-unlock-dropdown-disabled").hide(),this.renderAdvancedSettings(),this.$(".tva-drip-content-setting").on("change",(function(){e.updateInfoBoxes(n)})),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select").not(".select2-hidden-accessible"),{dropdownClass:"select2-unlock-condition"}),this.$dom={form:this.$(".tva-trigger-form"),settings:this.$(".tva-trigger-settings")},this.openTrigger&&(this.$('[data-fn="editTrigger"][data-id="'.concat(this.openTrigger,'"]')).trigger("click"),delete this.openTrigger),this.toggleSaveBtn()},toggleSaveBtn:function(){var e=!!this.activeTrigger;this.$('[data-fn="save"]').toggleClass("tva-disabled",e)},removeTrigger:function(e){var t=this,s=this.collection.at(parseInt(e.currentTarget.dataset.index));s.canRemove()&&jQuery(e.currentTarget).closest(".tva-content-trigger-item").append(new h({template:TVE_Dash.tpl("products/partials/remove-rule"),className:"tva-delete-simple",confirm:function(){t.collection.remove(s)}}).render().$el)},getAvailableTriggers:function(){var e=this;if(this.model.hasTrigger("automator"))return[];var t=[],s=this.campaign.get("trigger"),i=this.model.hasTrigger("scheduled"),n=this.model.getTriggerCount();return TVA.drip.content_triggers.forEach((function(r){i&&"campaign"===r.id||r.id===s||n&&"automator"===r.id||e.model.hasTrigger(r.id)||(r.icon=d(r).icon(),t.push(r))})),t},getAllTriggers:function(){return TVA.drip.content_triggers},addRule:function(e){this.$(".tva-new-trigger").removeClass("tva-hide"),this.$(".tva-drip-no-triggers").addClass("tva-hide"),e.currentTarget.classList.add("tva-hide")},editTrigger:function(e){this.activeTrigger=this.model.getTrigger(e.currentTarget.dataset.id),this.activeTrigger.canEdit()?(this.$(".tva-new-trigger").addClass("tva-hide"),jQuery(e.currentTarget).parents(".tva-content-trigger-item").addClass("edit-trigger").append(this.$dom.form),this.renderTriggerView(),e.currentTarget.parentNode.style.display="none"):delete this.activeTrigger},cancelTriggerEdit:function(){"course-content"===this.activeTrigger.get("id")&&(this.uneditedObjects=this.activeTrigger.get("uneditedObjects"),this.activeTrigger.set("objects",this.uneditedObjects)),this.render()},triggerSelected:function(e){this.$(".tva-new-trigger").append(this.$dom.form);var t=e.currentTarget.value,s={id:t};if(this.course&&"course-content"===t){var i=this.courseItem,n=null==i?void 0:i.getType();if(n&&(s.type=n),!1===this.courseItem.isFirst(this.course)){var r=this.courseItem.getPrevious(this.course);s.object_id=r.get("ID"),s.object_name=r.get("post_title")}}this.activeTrigger=d(s),this.$(".drip-select-icon").removeClass((function(e,t){return t.split(a()).filter((function(e){return e.startsWith(o())})).join(c())})).addClass("drip-selected-".concat(e.currentTarget.value)).html(TVA.Utils.icon(this.activeTrigger.icon())),this.renderTriggerView()},renderTriggerView:function(){var e,t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$dom.settings;this.triggerView&&this.triggerView.destroy();var r={},o=this.activeTrigger.get("id"),a=this.$(".tva-modal-btn-green");switch(o){case"datetime":e=s(100);break;case"purchase":case"campaign":e=s(101);break;case"first-lesson":e=s(163);break;case"course-content":e=s(164),r.itemIndex=this.itemIndex,r.postId=this.post_id,r.courseItem=this.courseItem,r.course=this.course,this.courseItem.isFirst(this.course)&&0===this.activeTrigger.get("objects").length&&a.addClass("disabled");break;default:e=TVA.drip.trigger_views[o]?TVA.drip.trigger_views[o]:s(0)}this.$(".tva-trigger-settings").on("change",(function(){void 0!==t.$("#tva-search-content").val()&&a.toggleClass("disabled",0===t.$("#tva-search-content").val().length)})),this.triggerView=new e(n({model:this.activeTrigger},r)),this.addChild(this.triggerView),i.html(this.triggerView.render().$el),this.$(".tva-trigger-buttons").show(),this.toggleSaveBtn()},saveTriggerData:function(){return this.activeTrigger&&this.activeTrigger.isValid()&&(this.activeTrigger.set(this.triggerView.getData?this.triggerView.getData():{}),this.model.addTrigger(this.activeTrigger,"last")),!1},save:function(){this.campaign.setUnlockSettingsForContentId(this.post_id,this.model.toJSON()),this.campaign.ensureInheritedSettings(this.course.getStructure().findItem(this.post_id)),this.campaign.save().done((function(){return TVE_Dash.success(TVA.t.drip_saved)})),TVA.customers.resetIndividualStudentViews(),this.close(),this.trigger("saved")},renderAdvancedSettings:function(){var e=this,t=[this.model.get("forced_unlock"),this.model.get("visibility")],s=t.filter((function(e){return"inherited"!==e})).length;s>0&&(this.$(".tva-active-options").removeClass("hidden"),this.$(".tva-active-options")[0].innerText=s+" "+TVA.t.active),this.$(".tva-drip-content-setting").on("change",(function(){t=[e.$(".tva-drip-content-setting")[0].value,e.$(".tva-drip-content-setting")[1].value],(s=t.filter((function(e){return"inherited"!==e})).length)>0?(e.$(".tva-active-options").removeClass("hidden"),e.$(".tva-active-options")[0].innerText=s+" "+TVA.t.active):e.$(".tva-active-options").addClass("hidden")})),this.$(".tva-advanced-settings-button").on("click",(function(){e.$(".tva-drip-content-settings").toggle(),e.$("#ta-arrow-up").toggle(),e.$("#ta-arrow-down").toggle()}))},updateInfoBoxes:function(e){var t="yes"===this.$(".tva-drip-content-setting")[0].value||"inherited"===this.$(".tva-drip-content-setting")[0].value&&!0===this.campaign.get("force_unlock_order");t&&!e?(this.$(".tva-sequential-info-box").show(),this.$(".tva-inherited-sequential-info-box").hide(),this.$(".tva-inherited-info-box").hide()):e?(this.$(".tva-inherited".concat(t?"-sequential":"","-info-box")).show(),this.$(".tva-inherited".concat(t?"":"-sequential","-info-box")).hide(),this.$(".tva-sequential-info-box").hide()):this.$(".tva-sequential-info-box").hide()}})},function(e,t,s){var i=s(101);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/first-lesson")})},function(e,t,s){var i=s(0);e.exports=i.extend({template:TVE_Dash.tpl("drip/triggers/course-content"),courseItem:null,$typesDropdown:null,$searchDropdown:null,tooltipKey:"drip-course-content-trigger-modules",afterInitialize:function(e){var t=this;void 0!==e.courseItem&&(this.courseItem=e.courseItem),void 0!==e.course&&(this.course=e.course),this.listenTo(this.model,"change:type",(function(){var e=t.$("#tva-search-content");e.hasClass("select2-hidden-accessible")&&e.select2("destroy"),e.show(),setTimeout((function(){TVA.Utils.bindModalSelect2(e,n(t.getSearchRoute()))}),0),void 0!==t.$tooltip&&t.$tooltip.removeClass("ttd-visible"),"module"!==t.model.get("type")||TVA.Utils.isTooltipViewed(t.tooltipKey)||(t.$tooltip=t.$(".tva-course-content-module-tooltip"),requestAnimationFrame((function(){return t.showTooltip()})))}))},showTooltip:function(){this.$tooltip.addClass("ttd-visible")},hideTooltip:function(){var e=this;return this.$tooltip.addClass("ttd-out"),setTimeout((function(){return e.$tooltip.removeClass("ttd-visible ttd-out")}),1e3),TVA.Utils.saveTooltips(this.tooltipKey),!1},afterRender:function(){var e=this;if(this.$typesDropdown=this.$("#tva-content-types"),_.each(TVA.content_types,(function(t){e.$typesDropdown.append('<option value="'+t.value+'">'+t.label+"</option>")})),this.$typesDropdown.val(this.model.get("type")),this.$searchDropdown=this.$("#tva-search-content"),TVA.Utils.bindModalSelect2(this.$typesDropdown),TVA.Utils.bindModalSelect2(this.$searchDropdown,n(this.getSearchRoute())),this.order=this.courseItem.get("order"),!1===this.courseItem.isFirst(this.course)&&0===this.model.get("objects").length){var t=this.courseItem.getPrevious(this.course);this.model.set("objects",[{id:t.get("ID"),type:t.getType(),text:t.get("post_title")}])}this.uneditedContentList=this.model.get("objects"),this.model.set("uneditedObjects",this.uneditedContentList),this.contentList=this.model.get("objects"),this.ids=[],this.model.get("objects").forEach((function(t){e.ids.push(t.id),e.$searchDropdown.append('<option value="'+t.id+'">'+t.text+"</option>")})),this.$searchDropdown.val(this.ids).trigger("change"),this.$("#tva-content-types").on("select2:select",(function(){e.$("#tva-search-content").val(null).trigger("change"),e.contentList=[],e.model.set("objects",e.contentList)})),this.$("#tva-search-content").on("select2:select",(function(t){var s=t.params.data;e.contentList.push({id:s.id,type:s.type,text:s.text}),e.model.set("objects",e.contentList)})),this.$("#tva-search-content").on("select2:unselect",(function(t){var s=parseInt(t.params.data.id);e.contentList=e.contentList.filter((function(e){return e.id!==s})),e.model.set("objects",e.contentList)})),"module"!==this.model.get("type")||TVA.Utils.isTooltipViewed(this.tooltipKey)||(this.$tooltip=this.$(".tva-course-content-module-tooltip"),requestAnimationFrame((function(){return e.showTooltip()}))),setTimeout((function(){TVE_Dash.data_binder(e)}),0)},getSearchRoute:function(){return"".concat(TVA.content_types[this.model.get("type")].route,"/?exclude=").concat(this.courseItem.get("ID"))}});var n=function(e){return{ajax:{transport:function(t,s){wp.apiRequest({url:"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v2).concat(e),data:t.data}).done((function(e){s({results:(null==e?void 0:e.items)||e})}))},data:function(e){return{search:e.term}},delay:250,cache:!0},templateResult:function(e){var t=e.text;return"string"==typeof e.label&&e.label.length>0&&(t="".concat(e.label).concat(e.type?" -":":"," ").concat(t)),t},escapeMarkup:function(e){return e},withSearch:!0,minimumResultsForSearch:1,multiple:!0,placeholder:"Search",dropdownClass:"select2-content-unlock"}}},function(e,t,s){var i=s(0),n=s(166),r=s(6),o=s(5),a=s(5).extend({completedPostModel:null,initialize:function(){var e=this,t="search-link";(parseInt(this.get("value"))||this.get("custom_link"))&&(t="normal"),this.attributes.state=t,this.on("change:custom_link",this.onChange.bind(this)),this.listenTo(this,"sync",(function(t){e.completedPostModel.set({preview_url:t.get("preview_url"),title:t.get("title"),extra_id:t.get("extra_id"),edit_url:t.get("edit_url")},{silent:!0})}))},setCompletedPostModel:function(e){this.completedPostModel=e},onChange:function(){var e=this;this.save().done((function(t){t.preview_url||(TVE_Dash.err("Invalid link"),e.set({state:"search-link",custom_link:""}))}))},url:function(){return"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/completed_post/custom-page")}}),c=i.extend({template:TVE_Dash.tpl("courses/completion/certificate-download-url"),className:"tva-download-link-label",afterRender:function(){this.$(".tva-certificate-download-url").val(this.model.get("download_url"))}}),l=i.extend({template:TVE_Dash.tpl("courses/completion/settings"),className:"tva-details-card",afterRender:function(){this.$title=this.$("#tva-completed-title"),this.$slug=this.$("#tva-completed-slug"),this.$checkbox=this.$("#tva-completed-allow-comments"),this.$title.val(this.model.get("title")),this.$slug.val(this.model.get("post_name")),this.$checkbox.prop("checked",parseInt(this.model.get("allow_comments"))),TVE_Dash.data_binder(this)},inputChanged:function(e,t){var s=t.getAttribute("type"),i={};"text"!==s||0!==t.value.trim().length?(i[t.getAttribute("data-field")]="text"===s?t.value.trim():Number(t.checked),this.model.set(i).save()):TVE_Dash.err("Field cannot be empty")}});e.exports=i.extend({template:TVE_Dash.tpl("courses/completion-tab"),completedSettings:null,itemStateCompletedView:null,afterInitialize:function(){var e=this;this.certificate=this.model.get("certificate"),this.completedPost=this.model.get("completed_post"),this.listenTo(this.model,"change:has_certificate",(function(){TVE_Dash.showLoader(),e.model.get("has_certificate")?e.certificate.save().done((function(t){parseInt(t.tpm_not_connected)?(TVA.tpm_connected=1,e.tpmNotConnected()):e.renderCertificatePDF(),e.model.save(null,{complete:function(){TVE_Dash.hideLoader()}})})):e.certificate.destroy().done((function(){e.certificate.unset("ID"),e.model.save(null,{complete:function(){TVE_Dash.hideLoader()}})}))})),this.listenTo(this.model,"change:has_completed_post",(function(){TVE_Dash.showLoader(),e.model.get("has_completed_post")?e.completedPost.save().done((function(){e.renderCourseCompleted(),e.model.save(null,{complete:function(){TVE_Dash.hideLoader()}})})):e.completedPost.destroy().done((function(){e.completedPost.unset("ID"),e.model.save(null,{complete:function(){TVE_Dash.hideLoader()}})}))})),this.listenTo(this.completedPost,"change:title",(function(t){e.$completedPostOptions.find("span.tva-login-name").html(t.get("title"))}))},tpmNotOK:function(){this.$("#tva-certificate-column").addClass("tva-disabled"),this.model.set({has_certificate:0},{silent:!0}),this.$certificateDropdown.hide(),this.$("#tva-certificate-button").prop("checked",!1)},tpmNotConnected:function(){this.tpmNotOK(),this.$tpmWarning.show()},tpmLicenseAccess:function(){this.tpmNotOK(),this.$tpmActiveLicenseWarning.show()},afterRender:function(){this.$completedSettingsWrapper=this.$(".tva-completed-settings"),this.$completedPostOptions=this.$(".tva-completed-post-options"),this.$completedTypeSelect=this.$("#tva-completed-post-type-select"),this.$completedDropdown=this.$(".tva-completed-post-dropdown"),this.$certificateDropdown=this.$(".tva-certificate-dropdown"),this.$tpmWarning=this.$("#tva-tpm-warning").hide(),this.$tpmActiveLicenseWarning=this.$("#tva-tpm-active-license-warning").hide(),TVA.tpm_connected?parseInt(TVA.tpm_access_ok)||this.tpmLicenseAccess():this.tpmNotConnected(),this.model.get("has_certificate")?this.renderCertificatePDF():this.$certificateDropdown.hide(),this.model.get("has_completed_post")?(this.$completedTypeSelect.val(this.completedPost.get("type")),this.renderCourseCompleted()):this.$completedDropdown.hide(),this.$completedTypeSelect.select2()},renderCertificatePDF:function(){this.$(".tva-certificate-download-url").html(new c({model:this.certificate}).render().$el),new r({el:this.$(".tva-certificate-edit-with-tar"),model:new o({preview_url:this.certificate.get("preview_url"),title:this.certificate.get("title"),edit_url:this.certificate.get("edit_url"),value:this.certificate.get("ID")}),afterRender:function(){this.$(".tva-page-option.click").remove()},states_views_path:"./page-states/"}).render()},renderCourseCompleted:function(){var e;if(null===(e=this.$("#tva-custom-page-warning"))||void 0===e||e["completed"===this.completedPost.get("type")?"hide":"show"](),this.$completedSettingsWrapper["completed"===this.completedPost.get("type")?"show":"hide"](),this.itemStateCompletedView instanceof Backbone.View&&this.itemStateCompletedView.destroy(),"completed"===this.completedPost.get("type"))this.itemStateCompletedView=new r({el:this.$completedPostOptions,model:new o({preview_url:this.completedPost.get("preview_url"),title:this.completedPost.get("title"),edit_url:this.completedPost.get("edit_url"),value:this.completedPost.get("ID")}),afterRender:function(){this.$(".tva-page-option.click").remove()},states_views_path:"./page-states/"}).render(),this.$completedSettingsWrapper.html(new l({model:this.completedPost}).render().$el);else{var t=this.completedPost.get("extra_id"),s=new a({name:"custom_redirect",course_id:this.completedPost.get("course_id"),preview_url:this.completedPost.get("preview_url")||"",title:this.completedPost.getTitle(),edit_url:this.completedPost.get("edit_url")||"",value:parseInt(t)?parseInt(t):0,category:!_.isNumber(t)&&"custom_link",custom_link:!_.isNumber(t)&&t});s.setCompletedPostModel(this.completedPost),this.itemStateCompletedView=new r({el:this.$completedPostOptions,model:s,states_views_path:"./page-states/"}).render()}},issueCompletionCertificate:function(e,t){var s=t.checked;s&&!sessionStorage.getItem("certificateTOS")?this.openModal(n,{model:this.model,className:"tvd-modal tva-certificates-tos-modal",toggle:e.currentTarget,dropdown:this.$certificateDropdown}):(this.$certificateDropdown[s?"show":"hide"](),this.model.set("has_certificate",Number(s)))},hasCompletedPost:function(e,t){this.$completedDropdown[t.checked?"show":"hide"](),t.checked&&this.$completedTypeSelect.val("completed").trigger("change.select2"),this.model.set("has_completed_post",Number(t.checked))},completedPostTypeChange:function(e,t){var s=this;this.model.get("has_completed_post")&&(this.$completedSettingsWrapper.empty(),TVE_Dash.showLoader(),this.completedPost.changeType(t.value).then((function(){s.renderCourseCompleted(),TVE_Dash.hideLoader()})))}})},function(e,t,s){e.exports=s(3).extend({template:TVE_Dash.tpl("modals/certificate-tos"),afterRender:function(){var e=this.$(".tva-themes-tos-text")[0].innerText;e.split("\n").map((function(e){return"<p>".concat(e,"</p>")})).join(""),this.$(".tva-themes-tos-text")[0].innerText=e},declineTerms:function(){this.close()},acceptTerms:function(){sessionStorage.setItem("certificateTOS","accepted"),this.close()},afterOpen:function(){this.$('[data-fn="acceptTerms"]').focus()},beforeClose:function(){var e="accepted"===sessionStorage.getItem("certificateTOS");this.toggle.checked=e,this.dropdown[e?"show":"hide"](),this.model.set("has_certificate",Number(e))}})},function(e,t,s){var i=s(0),n=s(102);e.exports=i.extend({template:TVE_Dash.tpl("settings/api-key-item"),className:"tva-card tva-card-small tva-api-key-card",initialize:function(){i.prototype.initialize.apply(this,arguments),this.listenTo(this.model,"sync",this.render)},afterRender:function(){this.$normalState=this.$(".tva-api-key-details"),this.$deletelState=this.$(".tva-api-key-delete")},editToken:function(){this.openModal(n,{model:this.model,collection:this.collection,top:"40px",className:"tvd-modal tvd-modal-big"})},deleteToken:function(){this.$normalState.hide(),this.$deletelState.show()},delete:function(){var e=this;TVE_Dash.showLoader(),this.model.destroy({success:function(t){e.remove(),e.collection.remove(t),e.collection.trigger("toggleTable");var s=TVE_Dash.sprintf(TVA.t.token_deleted,t.get("name"));TVE_Dash.success(s)},error:function(e,t){t&&t.responseJSON&&TVE_Dash.err(t.responseJSON.message)},complete:function(){TVE_Dash.hideLoader()}})},cancel:function(){this.$normalState.show(),this.$deletelState.hide()},changeField:function(e,t){var s=t.getAttribute("data-field");this._save(s,Number(t.checked))},_save:function(e,t){var s={};s[e]=t,this.model.set(s),this.model.save(),TVE_Dash.success(TVA.t.SuccessfulSave)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(0).extend({tagName:"select",events:{change:"onSelected"},selected:-1,initialize:function(e){(e=n({idField:"id",labelField:"label",className:"tva-filter-dropdown",defaultOption:"",selected:-1},e)).collection&&(this.collection=new Backbone.Collection(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=[],i=n({id:"id",label:"label"},t);return e instanceof Backbone.Collection&&(e=e.toJSON()),e.forEach((function(e){e instanceof Backbone.Model&&(e=e.toJSON()),s.push({id:e[i.id],label:e[i.label]})})),s}(e.collection,{id:e.idField,label:e.labelField})),e.defaultOption&&this.setDefaultOption(e.defaultOption)),this.$el.addClass(e.className),this.selected=e.selected},render:function(){var e=o();return this.collection.each((function(t){e=e.add(o('<option value="'.concat(t.get("id"),'">').concat(t.get("label"),"</option>")))}),this),this.$el.append(e).val(String(this.selected)),this},setDefaultOption:function(e){return this.collection.add(new Backbone.Model({id:-1,label:e}),{at:0}),this},selectOption:function(e,t){var s=this.collection.findWhere(e);s instanceof Backbone.Model&&(this.$el.val(s.get("id")),t&&this.$el.trigger("change"))},onSelected:function(e){this.trigger("change",e.currentTarget.value)}})},function(e,t,s){var i=s(3);e.exports=i.extend({template:TVE_Dash.tpl("modals/design/hi-professor")})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(1),a=TVA.skins,c=s(105);e.exports=o.extend({template:TVE_Dash.tpl("design/new/dashboard"),className:"tva-designs",afterInitialize:function(){var e=this;this.collection=a,this.listenTo(TVA.skins,"fetch ajax",(function(){return TVE_Dash.showLoader(!0)})),this.listenTo(TVA.skins,"sync reset ajaxdone",(function(){return TVE_Dash.hideLoader()})),this.listenTo(TVA.skins,"add remove reset",this.render),this.listenTo(TVA.skins,"sync",(function(t,s,i){i&&i.silent||e.render()}))},publishClicked:function(e,t){var s=TVA.skins.get(Number(t.dataset.skinId));TVA.Utils.confirmation(n(n({},TVA.t.skin_publish_confirmation),{},{title:TVA.t.skin_publish_confirmation.title.replace("{title}","<strong>".concat(s.get("name"),"</strong>")),yesClass:"tva-modal-btn-blue"})).then((function(){TVA.skins.setDefaultSkin(t.dataset.skinId).then((function(){TVE_Dash.success(TVA.t.skin_published.replace("{name}","<strong>".concat(s.get("name"),"</strong>")),3e3)}))}))},getRenderParams:function(){var e=TVA.skins.getActiveSkin();return{activeSkin:e,skins:TVA.skins.filter((function(t){return t!==e}))}},skinAction:function(e,t){var s=TVA.skins.get(Number(t.dataset.skinId));switch(t.dataset.action){case"delete":TVA.Utils.confirmation(TVA.t.skin_delete_confirmation).then((function(){s.destroy().then((function(){return TVE_Dash.success(TVA.t.skin_deleted.replace("{name}","<strong>".concat(s.get("name"),"</strong>")))})).fail((function(e){return TVE_Dash.err(e.responseJSON.message,3e3)}))}));break;case"rename":var i=t.closest(".tva-skin-item,.tva-main-skin-parent");jQuery(i).find(".tva-skin-name").tvaInlineEdit({validation_fn:function(e){return!TVA.skins.getByName(e)||(TVE_Dash.err(TVA.t.skin_invalid_name.replace("{name}","<strong>".concat(e,"</strong>"))),!1)}}).one("change",(function(e,t){s.set("name",t),s.save(null,{silent:!0})}));break;case"duplicate":TVA.skins.duplicateSkin(t.dataset.skinId).then((function(){TVE_Dash.success(TVA.t.skin_duplicated.replace("{name}","<strong>".concat(s.get("name"),"</strong>")),3e3)}))}},addClicked:function(){TVE_Dash.showLoader();var e=new a.model;return e.save().then((function(){a.add(e),TVE_Dash.hideLoader()})),!1},openCloudModal:function(){return this.openModal(c,{"max-width":"1040px",height:"90vh",width:"90vw"}).on("cloud-skin-downloaded",(function(e){a.unshift(e)})),!1}})},function(e,t,s){function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var s=[],i=!0,n=!1,r=void 0;try{for(var o,a=e[Symbol.iterator]();!(i=(o=a.next()).done)&&(s.push(o.value),!t||s.length!==t);i=!0);}catch(e){n=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}return s}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);return"Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s?Array.from(e):"Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var a=s(299);e.exports=s(3).extend({template:"modals/skins/template",inheritFrom:null,itemTemplate:"modals/skins/cloud-template-item",radioTemplate:"modals/skins/cloud-radio-item",templates:[],bigModalClass:"tvd-modal-big",selectedTemplate:null,afterInitialize:function(){var e=this;this.model.on("cloud_template_select",(function(t){e.inheritFrom=t,e.save()}))},contentTypeChanged:function(e,t){this.$("#tva-post-format-input").toggle("tva_lesson"===t.options[t.selectedIndex].getAttribute("data-secondary"))},getTitle:function(){return this.$("#tva-template-name").val()},getTemplateData:function(){var e=this.$("#tva-content-type")[0];return{primary:e.options[e.selectedIndex].getAttribute("data-primary"),secondary:e.options[e.selectedIndex].getAttribute("data-secondary"),format:this.$("#tva-post-format").val()}},save:function(){var e=this,t=this.getTitle();if(0===t.length)return TVE_Dash.err(TVA.t.InvalidName),void this.$("#tva-template-name").focus();var s=this.getTemplateData();TVE_Dash.showLoader(),this.model.skin_id=this.collection.skin_id,this.model.createTemplate(t,s.primary,s.secondary,s.format).save({inherit_from:this.inheritFrom||"default"}).done((function(t){e.filterModel.trigger("tva_dash:filterByModel",e.model),t[0].just_added=1,e.collection.reset(t),e.close(),TVE_Dash.hideLoader()}))},openCloudTemplatesModal:function(){if(0===this.getTitle().length)return TVE_Dash.err(TVA.t.InvalidName),void this.$("#tva-template-name").focus();this.gotoStep(1),this.$el.addClass(this.bigModalClass),this.renderTemplates()},afterStep0Loaded:function(){this.$el.removeClass(this.bigModalClass)},dom:function(){var e=this;this.$items=this.$(".tve-c-modal-items"),this.$radioFilterItems=this.$(".tve-c-modal-radio-filter"),this.dropdownFilter=new a({el:this.$(".tve-c-modal-select-filter")[0],items:[{id:"all",order:1,text:"All Templates",description:"Everything in one place."},{id:"local",order:2,text:"Saved Templates",description:"Saved templates are the ones that we have."},{id:"cloud",order:3,text:"Cloud Templates",description:"Cloud templates come from the cloud.",default:!0}]}).on("select",(function(){return e.renderTemplates(!1)}))},renderRadioFilters:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.$radioFilterItems.empty(),this.getRadioFilterItems(t).forEach((function(t){return e.$radioFilterItems.append(TVE_Dash.tpl(e.radioTemplate)({item:t}))}))},renderTemplates:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(i){t&&e.showLoader(),delete e.selectedTemplate,e.$items.empty(),e.$items.data("masonry")&&e.$items.data("masonry").destroy(),e.getItems(s).then((function(s){var n=e.filterItems(s);n.forEach((function(t){e.$items.append(TVE_Dash.tpl(e.itemTemplate)({item:t,itemWidth:260}))})),e.$items.masonry(),t&&e.hideLoader(),e.renderRadioFilters(n),i()}))}))},selectTemplate:function(e,t){this.selectedTemplate=t.dataset.id,this.$items.find(".selected").removeClass("selected"),t.closest(".tve-c-modal-item").classList.add("selected")},onRadioFilterClick:function(e,t){this.$radioFilterItems.find(".active").removeClass("active"),t.classList.add("active"),this.renderTemplates(!1)},onSearch:_.throttle((function(){this.renderTemplates(!1)}),420),refreshItems:function(){this.renderTemplates(!0,!0).then((function(){return TVE_Dash.hideLoader()}))},filterItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.getRadioFilterValue()||"",s=this.getDropdownFilterValue(),i=this.getSearchValue().trim().toLowerCase(),r=this.getTemplateData(),o=t.split("|"),a=n(o,2),c=a[0],l=a[1];return e.filter((function(e){var n=!0;return s&&"all"!==s&&s!==e.type&&(n=!1),n&&i&&!e.title.toLowerCase().includes(i)&&(n=!1),n&&t&&"all"!==t&&(e.primary!==c||e.secondary!==l)&&(n=!1),n&&"tva_lesson"===e.secondary&&e.format!==r.format&&(n=!1),n}))},createTemplate:function(){this.selectedTemplate?(this.inheritFrom=this.selectedTemplate,this.save()):TVE_Dash.err("Please select a template")},getSearchValue:function(){return this.$(".tve-c-modal-search-input").val()},getDropdownFilterValue:function(){return this.dropdownFilter.getValue()},getRadioFilterValue:function(){var e=this.getTemplateData();return"".concat(e.primary,"|").concat(e.secondary)},getRadioFilterItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={all:{id:"all",label:"All",count:e.length,default:1}};return e.forEach((function(e){var s,i="".concat(e.primary,"|").concat(e.secondary.trim());switch(i){case"home|tva_course_type":s="School Page";break;case"singular|tva_lesson":s="Lesson";break;case"singular|tva_module":s="Module";break;case"archive|tva_courses":s="Course Overview";break;default:s="NOT FOUND"}void 0===t[i]&&(t[i]={id:i,label:s,count:0,default:0}),t[i].count++})),Object.values(t)},getItems:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(s){!t&&e.templates.length?s(e.templates):wp.apiRequest({url:"".concat(TVA.routes.templates,"/cloud"),data:{tva_skin_id:e.skin_id,is_singular:"single"===e.type?1:0,bypass_cache:t?1:0}}).done((function(t){e.templates=[].concat(i(t),i(e.getLocalTemplates(e.type))),s(e.templates)}))}))},getLocalTemplates:function(){return this.collection.filter().map((function(e){return{id:e.get("ID"),type:"local",title:e.get("post_title"),primary:e.primary(),secondary:e.secondary(),format:e.format(),thumb:e.get("thumbnail")}}))}})},function(e,t,s){var i,n;i=jQuery,n=s(66),e.exports=s(3).extend({template:"modals/wizard/templates",item:TVE_Dash.tpl("modals/wizard/template"),itemClass:".ttd-wizard-template",className:"tvd-modal tvd-modal-templates",hasPreview:!1,afterRender:function(){this.$el.addClass(this.className),this.$templatesList=this.$("#structure-templates-list")},afterOpen:function(){var e=this,t=this.$(".modal-content").addClass("ttd-loading loader-absolute");this.$el.toggleClass("w-narrow",!!this.model.getStepKey("narrowTemplate")),this.model.loadStepTemplates(!1).then((function(s){e.templates=_.sortBy(s,(function(e){return e.order})),e.createLazyLoader(),e.buildPreview(),e.markSelectedTemplate({id:e.model.getPreviewTemplateId()}),t.removeClass("ttd-loading loader-absolute")}))},createLazyLoader:function(){this.lazyLoader=new window.LazyLoad({container:this.$el[0],elements_selector:".tve-lazy-img",threshold:0,load_delay:0,callback_loaded:function(e){i(e).parent().removeClass("lazy-loading")}})},updateLazyLoader:function(){this.lazyLoader.update()},buildPreview:function(){var e=this,t="";if(["header","footer","sidebar"].includes(this.model.get("active"))){this.removeMasonry();var s=[],r=[];_.each(this.templates,(function(e){"local"===e.source?s.push(e):r.push(e)})),t+=new n({title:"Apprentice templates",items:r,view:this}).render().$el.html(),s.length&&(t+=new n({title:"My saved templates",items:s,view:this}).render().$el.html())}else _.each(this.templates,(function(s){t+=e.item({model:e.model,item:s,itemClass:e.itemClass.replace(".","")})}));this.$templatesList.html(t);var o=this.$(".do-masonry"),a=parseInt(this.$templatesList.find(this.itemClass).width());this.$templatesList.find("img").each((function(){var e=this.dataset.ratio;e&&i(this).parent().css("height",a*parseFloat(e))})),o.hasClass("masonry")&&o.masonry("destroy"),o.masonry({gutter:30,columnWidth:this.itemClass,isAnimated:!0}),this.hasPreview=!0,this.updateLazyLoader()},removeMasonry:function(){this.$(".do-masonry").removeClass("do-masonry")},markSelectedTemplate:function(e){this.$(this.itemClass).removeClass("active").filter('[data-id="'.concat(e.id,'"]')).addClass("active")},clickSelect:function(e,t){var s=this;return("iframe"===this.model.getStepKey("previewMode")&&"cloud"===t.dataset.source?new Promise((function(e,i){var n=s.model.get("active");TVE_Dash.showLoader(!0),s.model.templates.fetchInstance(n,t.dataset.id).done((function(i){var r=i.data||i;s.model.templates.updateTemplate(n,t.dataset.id,{id:r.id,source:"local"}),e(r)})).fail(i)})):new Promise((function(e){e({id:t.dataset.id,source:t.dataset.source})}))).then((function(e){s.markSelectedTemplate(e),TVA.wizardView.previewTemplate(e)})),requestAnimationFrame((function(){s.close()})),!1}})},function(e,t,s){var i,n;i=jQuery,n=s(0),e.exports=n.extend({template:TVE_Dash.tpl("settings/email-template-item"),triggerTpl:TVE_Dash.tpl("settings/email-template-trigger"),initialize:function(){n.prototype.initialize.apply(this,arguments),this.emailShortcodesCollection=new Backbone.Collection(Object.values(TVA.emailShortcodes)),this.emailTriggersCollection=new Backbone.Collection(Object.values(TVA.emailTriggers))},afterRender:function(){var e=this;this.$emailShortcodes=this.$("#tva-email-shortcodes"),this.$emailTriggers=this.$("#tva-email-triggers-wrapper"),this.$emailBodyTextarea=this.$("#tva-email-body"),this.$saveButton=this.$(".tva-email-template-save"),this.emailBodyCodeEditor=this._configureCodeEditor(),this.emailShortcodesCollection.each((function(t){e.$emailShortcodes.append(i("<option/>").text(t.get("label")).val(t.get("slug")))})),this.emailTriggersCollection.each((function(t){e.$emailTriggers.append(e.triggerTpl({model:t,checked:e.model.get("triggers").includes(t.get("slug"))}))})),setTimeout((function(){e.emailBodyCodeEditor.refresh(),e.emailBodyCodeEditor.setCursor(e.emailBodyCodeEditor.lineCount(),0),e.emailBodyCodeEditor.focus()}))},changeField:function(e,t){var s={};s[t.getAttribute("data-field")]=t.value,this.model.set(s)},saveTrigger:function(){var e=[];this.$(".tva-email-trigger:checked").each((function(t,s){e.push(s.getAttribute("name"))})),this.model.set("triggers",e)},insertShortcode:function(){var e=this.emailShortcodesCollection.findWhere({slug:this.$emailShortcodes.val()});e&&this._insertCodeEditorText(e.get("text"))},save:function(){var e=this;TVE_Dash.showLoader(),this.$saveButton.attr("disabled","true"),this.model.save(null,{success:function(){TVE_Dash.success(TVA.t.template_saved)},error:function(e,t){TVE_Dash.err(t.responseJSON.message)},complete:function(){e.$saveButton.removeAttr("disabled"),TVE_Dash.hideLoader()}})},_insertCodeEditorText:function(e){var t=this.emailBodyCodeEditor.getDoc(),s=t.getCursor();t.replaceRange(e,s)},_configureCodeEditor:function(){var e=this,t=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};t.codemirror=_.extend({},t.codemirror,{lineNumbers:!0,mode:"text",indentUnit:2,tabSize:2,lineWrapping:!0});var s=wp.codeEditor.initialize(this.$emailBodyTextarea,t);return s.codemirror.setSize("100%","300px"),s.codemirror.on("change",(function(t){e.model.set("body",t.getValue())})),s.codemirror}})},function(e,t,s){var i=s(19);e.exports=i.extend({template:TVE_Dash.tpl("labels/course-structure-input"),afterRender:function(){},onTitleChange:function(e){var t,s,i,n=e.currentTarget,r=n.attributes["data-label-type"].value,o=n.value.trim()||this.defaultTitle[r];if(!o)return n.classList.add("tva-error"),n.focus(),!1;o!==this.model.get(r)?this.model.persist((t={},s="".concat(r),i=o,s in t?Object.defineProperty(t,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[s]=i,t),{loader:!0,showSuccess:!0}):n.value=this.model.get(r)},onTitleKeyup:function(e){27===e.which&&e.currentTarget.blur()}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a;o=jQuery,a=s(1),e.exports=a.extend({className:"tva-course-type-label",template:TVE_Dash.tpl("labels/course-type-label"),events:n(n({},a.prototype.events),{},{"change .tva-title-events":"onTitleChange","keyup .tva-title-events":"onTitleKeyup","blur .tva-title-events":"onTitleBlur"}),afterInitialize:function(e){o.extend(this,e),this.model&&this.model.on("change",this.render.bind(this))},onTitleChange:function(e){var t=e.currentTarget,s=t.value.trim()||this.defaultTitle;if(!s)return t.classList.add("tva-error"),t.focus(),!1;s!==this.model.get("title")?this.model.persist({title:s},{loader:!0,showSuccess:!0}):t.value=this.model.get("title")},onTitleKeyup:function(e){27===e.which&&e.currentTarget.blur()}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(71);e.exports=o.extend({className:"tva-label-item click",events:n(n({},o.prototype.events),{},{click:"editing"}),template:TVE_Dash.tpl("labels/item"),deletedMessage:TVA.t.label_deleted,getConfirmationModal:function(){return s(177)},beforeDelete:function(e){TVA.courses.where({label:e.get("ID")}).forEach((function(e){e.set("label",-1,{silent:!0}),e.saveState()}))},spectrumOptions:function(){return{containerClassName:"tva-label-spectrum"}},toggleLoader:function(){this.$el.tvaToggleLoader(20,!!this.model.get("loading"),{background:"",position:"right",padding:"0 20px 0 0"})}})},function(e,t,s){e.exports=s(110).extend({template:TVE_Dash.tpl("modals/labels/confirm-delete")})},function(e,t,s){var i=s(19);e.exports=i.extend({template:TVE_Dash.tpl("labels/simple-label"),afterRender:function(){},onTitleChange:function(e){var t=e.currentTarget,s=t.value.trim()||this.defaultTitle;if(!s)return t.classList.add("tva-error"),t.focus(),!1;s!==this.model.get("title")?this.model.persist({title:s},{loader:!0,showSuccess:!0}):t.value=this.model.get("title")},onTitleKeyup:function(e){27===e.which&&e.currentTarget.blur()}})},function(e,t,s){var i=s(19);e.exports=i.extend({template:TVE_Dash.tpl("labels/textarea-warning-label"),afterRender:function(){}})},function(e,t,s){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,r,o,a,c,l,u;n=jQuery,r=s(0),o=r.extend({tagName:"li",className:"tvd-collection-header tva-logs-small",initialize:function(e){this.value=e.value,this.$(".tvd-collection-item").hide()},render:function(){return this.$el.html('<div class="tve-debug-item"><h5>'.concat(this.value||0===this.value?this.value:"---","</h5></div>")),this}}),a=o.extend({className:"tvd-collection-item tve-debug-column tva-logs-big"}),c=r.extend({tagName:"li",className:"tvd-collection-item tve-debug-column tve-debug-sub-table tva-logs-big",render:function(){return this.renderData(),this},renderData:function(){this.$el.append(new u({model:this.model}).render().$el)}}),l=r.extend({tagName:"li",className:"tvd-collection-header ttw-table-header",template:TVE_Dash.tpl("settings/log-info-item")}),u=r.extend({tagName:"ul",className:"tvd-collection tvd-with-header tva-logs",events:{"click .ttw-table-header":"toggleLog"},toggleLog:function(e){var t=n(e.currentTarget);return this.$(".tvd-collection-item, .tvd-collection-header").not(".ttw-table-header").toggle(),t.find(".tve-debug-slide > span").toggleClass("tve-churn-icon-keyboard_arrow_up"),t.find(".tve-debug-slide > span").toggleClass("tve-churn-icon-keyboard_arrow_down"),!1},render:function(){var e=this,t=this.model.get("data");return this.model.get("type")&&this.model.get("identifier")&&this.renderInfo(),"object"===i(t)&&_.each(t,(function(t,s){e.$el.append(new o({value:s}).render().$el);var n="object"===i(t)&&null!==t?new c({model:new Backbone.Model({data:t})}):new a({value:t});e.$el.append(n.render().$el)})),this},renderInfo:function(){this.$el.append(new l({model:this.model}).render().$el)}}),e.exports=r.extend({template:TVE_Dash.tpl("settings/log-item"),afterRender:function(){this.$(".tve-debug-table").append(new u({model:this.model}).render().$el)}})},function(e,t){var s;s=jQuery,e.exports=TVE_Dash.views.ModalSteps.extend({events:s.extend(TVE_Dash.views.ModalSteps.prototype.events,{"click .click":"_call","input .input":"_call"}),_call:function(e){var t=e.currentTarget.dataset.fn;if("function"==typeof this[t])return this[t].call(this,e,e.currentTarget)}})},function(e,t,s){var i,n;i=jQuery,n=s(10),e.exports=s(3).extend({template:TVE_Dash.tpl("modals/customer/edit"),selectedCourses:[],afterStep0Loaded:function(){var e=this;this.model.getPurchasedItems().then((function(t){e.renderPurchasedItems(t)}))},afterStep1Loaded:function(){this.selectedCourses=[],this.$("#tva-customer-courses").html("<label>".concat(TVA.t.loading,"</label>")),this.renderProducts()},save:function(){var e=this;if(0===this.selectedCourses.length)return TVE_Dash.err(TVA.t.noItemSelected);TVE_Dash.showLoader(),wp.apiRequest({url:"".concat(this.model.url(),"/add-access"),type:"POST",data:{course_ids:this.selectedCourses}}).done((function(t){TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t.newAccessSaved),e.close(),e.model.set("courses",new Backbone.Collection(t)),e.model.set("purchasedItems",null),e.model.trigger("access_changed"),TVA.products.resetAndFetch()}))},toggleCourse:function(e,t){var s=t.dataset.id,i=this.selectedCourses.indexOf(s);-1===i?this.selectedCourses.push(s):this.selectedCourses.splice(i,1)},renderProducts:function(){var e=this.$("#tva-customer-courses").empty(),t=this.model.get("purchasedItems");TVA.products.each((function(s){var n=i("<label><span>".concat(s.get("name"),"</span></label>")),r=i('<input type="checkbox" class="click" data-fn="toggleCourse" data-id="'.concat(s.get("id"),'">')),o=t.findWhere({product_id:s.get("id")});r.prop({checked:o,disabled:o}),e.append(n.prepend(r))}))},renderPurchasedItems:function(e){var t=TVE_Dash.tpl("customers/access-item"),s=this.getCurrentStep().find("#tva-add-access-item"),i=this.getCurrentStep().find("#tva-customer-items-wrapper"),n=i.find("#tva-customer-items-list").empty(),r=this.getCurrentStep().find("#tva-user-access-text");0===e.length?(s.toggle(!1),i.html(TVE_Dash.tpl("customers/no-access-item")({model:this.model})),r.remove()):0===TVA.products.length?(s.toggle(!1),i.html(TVE_Dash.tpl("customers/no-course")())):(e.each((function(e){"Order role"!==e.get("source")&&"Sendowl_product role"!==e.get("source")&&n.append(t({model:e}))})),s.toggle(!0))},deleteAccessItem:function(e){var t=this,s=i(e.currentTarget).parent(),r=parseInt(e.currentTarget.dataset.id),o=this.model.get("purchasedItems").findWhere({id:r}),a=new n({template:TVE_Dash.tpl("customers/delete-purchased-item"),className:"tva-delete-simple",confirm:function(){var e;o.url="".concat(t.model.url(),"/disable-item/").concat(r),a.$el.html(TVA.t.deleting),t.model.set("courses",null),(e=o,new Promise((function(t,s){if(!(e instanceof Backbone.Model))return s(e);e.destroy({beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpApiSettings.nonce)},success:function(e){t(e)},error:function(){return s(e)}})}))).then((function(){t.renderPurchasedItems(t.model.get("purchasedItems")),t.model.trigger("access_changed",!1),TVA.products.resetAndFetch()}))}}).render();s.append(a.$el)}})},function(e,t,s){e.exports=s(28).extend({template:TVE_Dash.tpl("modals/add-customer"),setField:function(e,t){var s={};t.getAttribute("data-field").split(",").forEach((function(e){s[e]=t.value})),this.model.set(s)},dom:function(){var e=this,t=this.$("#tva-add-customer-courses-list").empty();0===TVA.products.length&&t.after(TVE_Dash.tpl("customers/no-course")()),TVA.products.each((function(s){return t.append(e.productItemTpl({model:s}))}))},save:function(){var e=this;return this.model.isValid()?0===this.courses.length?TVE_Dash.err(TVA.t.selectCourse):(this.model.set("services",{course_ids:this.courses}),TVE_Dash.showLoader(),void this.model.save(null,{success:function(t,s){TVE_Dash.success(s.message),e.collection instanceof Backbone.Collection&&e.collection.fetch(),TVA.products.resetAndFetch()},error:function(e,t){TVE_Dash.err(t.responseJSON.message)},complete:function(t){200===t.status&&e.close(),TVE_Dash.hideLoader()}})):TVE_Dash.err(this.model.getValidationError())}})},function(e,t,s){var i,n;i=jQuery,n=s(28),e.exports=n.extend({template:TVE_Dash.tpl("modals/import-customer"),codeMirrorEditor:null,uploader:null,customerList:[],customersPerRequest:100,afterStep2Loaded:function(){return this.codeMirrorEditor.refresh(),this.codeMirrorEditor.setCursor(this.codeMirrorEditor.lineCount(),0),this.codeMirrorEditor.focus(),this},afterStep3Loaded:function(){var e=this;this.$("tbody").empty(),this.$("#tva-csv-customer-stats").empty();var t=0,s=0;this.customerList.forEach((function(n){var r=i("<tr>");0===parseInt(n.is_valid)&&(r.addClass("tva-customers-list-error"),s++),r.append(i("<td>").html(n.buyer_name)),r.append(i("<td>").html(n.buyer_email+(r.hasClass("tva-customers-list-error")?'<span style="color: #ff0000; float: right;">Invalid entry</span>':""))),e.$("tbody").append(r),t++})),this.$("#tva-csv-customer-stats").append("<span>".concat(TVA.Utils._n(t,"member","members",!0),"</span>")),s&&this.$("#tva-csv-customer-stats").append('&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #FF0000;">'.concat(s," Invalid entries</span>"));var n=this.$("#tva-add-customer-courses-list").empty();return TVA.products.each((function(t){return n.append(e.productItemTpl({model:t}))})),this},allowJumpToStep:function(e){if(3===e){if(2===this.currentStep&&0===this.codeMirrorEditor.getValue().length)return TVE_Dash.err(TVA.t.MissingCustomers),!1;if(1===this.currentStep&&0===this.uploader.files.length)return TVE_Dash.err(TVA.t.ChooseCsv),!1}return!0},dom:function(){n.prototype.dom.apply(this,arguments),this.codeMirrorEditor=this._configureCodeEditor(),this.uploader=this._configurePlupload()},_configureCodeEditor:function(){var e=this,t=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};t.codemirror=_.extend({},t.codemirror,{lineNumbers:!0,mode:"text",indentUnit:2,tabSize:2,lineWrapping:!0,scrollbarStyle:null});var s=wp.codeEditor.initialize(this.$("#tva-list-import"),t);return s.codemirror.setSize("100%","250px"),s.codemirror.on("change",(function(t){var s=t.getValue().split(/\r\n|\n/),i=[];s.forEach((function(e){var t=e.split(",");if(t[0].trim().length){var s=t[1]?t[1].trim():"";i.push({buyer_name:t[0].trim(),buyer_email:s,is_valid:Number(s&&TVA.Utils.isEmail(s))})}})),e.customerList=i})),s.codemirror},_configurePlupload:function(){var e=this,t=this.$(".tva-drop-file-elem"),s=this.$(".tva-file-upload-trigger"),i=this.$('.tva-modal-step[data-step="1"] .tva-modal-btn-green'),n=new plupload.Uploader({headers:{"X-WP-Nonce":TVA.apiSettings.nonce},runtimes:"html5,html4",dragdrop:!0,multi_selection:!1,drop_element:t[0],browse_button:s[0],container:t[0],url:"".concat(TVA.routes.customer,"/upload_file"),multipart:!0,filters:{max_files:1,max_file_size:"1mb",mime_types:[{title:"Custom",extensions:"csv"}]},init:{FilesAdded:function(t,s){var n=s[0];e.$("#tva-file-name").html(n.name),i.addClass("disabled"),t.start()},Error:function(e,t){var s=t.message;if(t.response)try{var n=JSON.parse(t.response);n.message&&(s=n.message)}catch(e){}TVE_Dash.err(s),i.removeClass("disabled")},FileUploaded:function(t,s,n){var r=JSON.parse(n.response);if(Array.isArray(r)){var o=[];r.forEach((function(e){o.push({buyer_name:e.buyer_name,buyer_email:e.buyer_email,is_valid:e.is_valid})})),e.customerList=o}i.removeClass("disabled")}}});return n.init(),n},save:function(){if(0!==this.customerList.filter((function(e){return 1===parseInt(e.is_valid)})).length){if(0===this.courses.length)return TVE_Dash.err(TVA.t.selectCourse);this.model.set("services",{course_ids:this.courses}),TVE_Dash.showLoader(),this.importCustomersAjax()}else TVE_Dash.err("There are a few issues. Please correct them before saving")},importCustomersAjax:function(){var e=this,t=this.customerList.slice(0,this.customersPerRequest);i.ajax({url:"".concat(TVA.routes.customer,"/import_customers"),type:"POST",data:{customers:t,services:this.model.get("services"),notify:this.model.get("notify")},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)}}).success((function(t){e.customerList=e.customerList.slice(e.customersPerRequest,e.customerList.length),e.customerList.length?e.importCustomersAjax():(e.close(),TVE_Dash.hideLoader(),TVE_Dash.success(t.message),e.collection.fetch(),e.collection.each((function(e){e.removeServices(),e.set("purchasedItems",null)}))),TVA.products.resetAndFetch()})).error((function(t){TVE_Dash.err(t.responseJSON.message),TVE_Dash.hideLoader(),e.close()}))}})},function(e,t,s){e.exports=s(28).extend({template:TVE_Dash.tpl("modals/lesson-unlock"),initialize:function(e){e=e||{},this.studentID=e.studentID||null,this.courseModel=e.courseModel||null,this.itemsBypassed=e.itemsBypassed||null},unlock:function(){var e=this;TVE_Dash.showLoader(),wp.apiRequest({type:"POST",url:"".concat(TVA.routes.customer,"/bypass_drip"),data:{course_id:this.courseModel.get("id"),student_id:this.studentID,item_id:this.model.get("id")}}).success((function(t){t.items_bypassed=t.items_bypassed[e.courseModel.get("id")],t.locked_items&&(t.locked_items=t.locked_items[e.courseModel.get("id")]),e.courseModel.trigger("item_bypass_set",t),TVE_Dash.success(TVA.t.drip_campaign_settings.content_unlocked)})).error((function(){TVE_Dash.err(TVA.t.something_went_wrong)})).done((function(){e.close()}))},afterOpen:function(){this.$('[data-fn="unlock"]').focus()}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a,c,l,u;o=jQuery,a=s(142),c=s(3),l=s(43),u=s(10),e.exports=c.extend({template:"modals/products/access-rules",defaults:["not_logged","not_purchased","locked"],title:TVA.t.edit_access_rule,stepSelector:".tvd-rule-modal-step",events:function(){return n(n({},c.prototype.events),{},{"change .tva-rule-title-events":"onTitleChange"})},afterRender:function(){c.prototype.afterRender.apply(this,arguments),this.renderTitle(),this.renderConditions(),this.singleStep||this.renderRestriction()},renderTitle:function(){var e=o("#tva-rule-title");this.defaults.includes(this.scope)?e.attr("value",TVA.t.access_rule_select_labels[this.scope]):e.attr("placeholder",TVA.t.access_rule_placeholder)},renderRestriction:function(){var e=this,t={autoSave:!1,scope:this.scope,model:this.model,course_id:this.course_id};this.single||(t.title=TVA.t.access_custom),this.contentRestriction=new l(t),this.contentRestriction.model.ensureDataExists(this.custom_id).then((function(){e.$(".tva-content-restriction").html(e.contentRestriction.render().$el)}))},renderEmptyCondition:function(){this.conditionsContainer.append(new a({ruleModel:this.model,parentWrapper:this.$(".tva-access-rules"),model:new Backbone.Model({scope:this.scope,index:this.model.get("index")})}).render().$el)},renderConditions:function(){var e=this;this.conditionsContainer=o(".tva-rule-conditions"),this.model.set("index",0);var t=this.model.get("conditions"),s=!1;t&&Object.keys(t).forEach((function(i){var n=t[i];n.length&&(s=!0,e.conditionsContainer.append(new a({parentWrapper:e.$(".tva-access-rules"),ruleModel:e.model,model:new Backbone.Model({scope:e.scope,index:e.model.get("index"),type:i,selected:n})}).render().$el),e.model.set("index",e.model.get("index")+1))})),s||(this.renderEmptyCondition(),this.model.set("index",this.model.get("index")+1)),this.hideAddConditionButton()},hideAddConditionButton:function(){this.model.get("index")>=Object.keys(TVA.t.access_rule_select_labels[this.scope]).length&&this.$(".tva-add-rule-conditions").hide()},addCondition:function(){!1!==this.model.validateConditions()?(this.model.set("index",this.model.get("index")+1),this.renderEmptyCondition(),this.hideAddConditionButton()):TVE_Dash.err(1===this.model.get("index")?TVA.t.access_rule_conditions_empty:TVA.t.access_rule_conditions_invalid)},deleteCondition:function(e){var t=this,s=this.$(e.currentTarget).parents(".tva-rule-condition"),i=new u({template:TVE_Dash.tpl("products/content-sets/delete-rule-condition"),className:"tva-delete-simple",confirm:function(){TVE_Dash.showLoader(),t.model.set("index",t.model.get("index")-1),e.currentTarget.dataset.type&&t.model.get("conditions")&&(t.model.get("conditions")[e.currentTarget.dataset.type]=[]),t.render(),TVE_Dash.hideLoader()}});s.append(i.render().$el)},checkboxClick:function(e){var t=e.currentTarget.dataset.id,s=parseInt(t);if(e.currentTarget.checked)isNaN(s)?this.model.get("conditions").roles.push(t):this.model.get("conditions").products.push(s);else if(isNaN(s)){var i=this.model.get("conditions").roles;i.splice(i.indexOf(t),1)}else{var n=this.model.get("conditions").products;n.splice(n.indexOf(s),1)}},onTitleChange:function(e){var t=e.currentTarget.value.trim();t!==this.model.get("title")&&this.model.set("title",t)},next:function(){var e=this.model.validateCustomSettings(this.settingsCollection);!0===e?(this.$("select.tva-section-option").select2(),this.gotoStep(1)):TVE_Dash.err(e)},save:function(){if(this.defaults.includes(this.scope))this.close();else{var e=this.model.validateCustomSettings(this.settingsCollection);if(!0===e)if(this.singleStep)this.updateRuleConditions();else{var t=this.contentRestriction.model.validateOptions();!0===t?this.addRule():TVE_Dash.err(t)}else TVE_Dash.err(e)}},addRule:function(){var e=this;TVE_Dash.showLoader(),this.saving=!0,this.model.set("option",this.contentRestriction.model.get("option")),this.model.set("".concat(this.model.get("option")),this.contentRestriction.model.get("".concat(this.model.get("option")))),this.model.save().done((function(){e.settingsCollection.unshift(e.model),TVE_Dash.success(TVA.t.access_rule_added.replace("{name}","<strong>".concat(e.model.get("title"),"</strong>"))),TVE_Dash.hideLoader(),e.close()}))},updateRuleConditions:function(){var e=this;TVE_Dash.showLoader(),this.saving=!0,this.model.save().done((function(){e.originalModel.set(e.model.toJSON()),e.settingsCollection.trigger("settings_changed"),TVE_Dash.success(TVA.t.access_rule_edited.replace("{name}","<strong>".concat(e.model.get("title"),"</strong>"))),TVE_Dash.hideLoader(),e.close()}))},onClose:function(){this.saving||this.singleStep?this.saving=!1:wp.apiRequest({url:TVA.Utils.buildUrl("".concat(TVA.routes.access_restriction,"/delete_custom_post"),{course_id:this.course_id,scope:this.scope}),type:"DELETE"})}})},function(e,t,s){var i;i=jQuery,e.exports=s(1).extend({template:TVE_Dash.tpl("access-restriction/states/create"),afterInitialize:function(e){i.extend(!0,this,e)},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels})),this.afterRender(),this},onCancel:function(){"custom_redirect"===this.model.get("name")?this.model.set("state","search-link"):this.model.set("state","search")},onSave:function(){var e=this;if(this.tvaClearError(),!this.model.isValid())return this.tvaShowErrors(this.model);TVE_Dash.showLoader();var t=this.model.save();t&&(t.done((function(){e.model.set("state","normal")})),t.always((function(){TVE_Dash.hideLoader()})))},onInput:function(e,t){this.model.set(t.getAttribute("data-field"),t.value)}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(1).extend({labels:{title:""},template:TVE_Dash.tpl("access-restriction/states/delete"),afterInitialize:function(e){o.extend(!0,this,e)},render:function(){return this.$el.html(this.template({model:this.model,labels:this.labels})),this.afterRender(),this},confirmRemove:function(){var e=this;if(this.callbacks.confirm)return this.callbacks.confirm(this.model);TVE_Dash.showLoader(),this.model.set(n(n({},this.model.defaults()),{},{previous_id:this.model.get("value")}));var t=this.model.save();t&&(t.done((function(){"custom_redirect"===e.model.get("name")?e.model.set(n(n({},e.model.defaults()),{},{state:"search-link"})):e.model.set(n(n({},e.model.defaults()),{},{state:"search"}))})),t.always((function(){TVE_Dash.hideLoader()})))},cancelRemove:function(){this.model.set("state","normal")}})},function(e,t,s){var i,n;i=jQuery,n=s(143),e.exports=s(112).extend({labels:{title:"",text:TVA.t.search_link},initPostSearch:function(){var e=this,t=this;n(this.$("#tva-search-base-page"),{renderItem:function(e,t){return i('<li class="tva-selected-post">').append('<span class="tva-ps-result-title">'.concat(t.label,'</span><span class="tva-ps-result-email"> (').concat(t.type,")</span>")).appendTo(e)},select:function(s,i){if(t.href=t.getFullUrl(i.item.url),t.$("#tva-search-base-page").val(t.href),"page"===i.item.post_type){TVE_Dash.showLoader(),e.model.set({value:i.item.id,title:i.item.value,state:"search"});var n=e.model.save();n&&(n.done((function(){e.model.set({state:"normal",category:!1})})),n.always((function(){TVE_Dash.hideLoader()})))}else"Link"===i.item.type&&e.model.set({value:0,title:i.item.value,custom_link:t.href,preview_url:t.href,category:"custom_link",state:"normal"})}})}})},function(e,t,s){var i,n;i=jQuery,n=s(0),e.exports=n.extend({template:TVE_Dash.tpl("settings/sendowl/links-option"),items:[],className:"tva-card tva-purchase-card",buttonLabel:"Button",disabledClass:"tva-so-option-disabled",queryStringName:"",afterInitialize:function(e){this.option=e.option,this.queryStringName=e.queryStringName,this.hasData()&&(this.items=TVA.sendowl[this.option]),this.buttonLabel=e.button_label||this.buttonLabel},hasData:function(){return TVA.sendowl[this.option]&&Array.isArray(TVA.sendowl[this.option])&&TVA.sendowl[this.option].length>0},afterRender:function(){var e=this;this.$select=this.$("select").empty().append('<option value="">Select an option</option>'),this.$button=this.$("button"),this.hasData()?this.items.forEach((function(t){var s=i("<option/>").val("discounts"===e.option?t.code:t.id).text(t.name);e.$select.append(s)})):(this.$select.hide(),this.$select.after(TVE_Dash.tpl("settings/sendowl/no-".concat(this.option))())),this.$button.html(this.buttonLabel)},toggleDisabled:function(e){this.$el.toggleClass(this.disabledClass,e)},toggle:function(e){this.$el.toggle(e)},refreshData:function(e,t){var s=this;TVE_Dash.showLoader(),t.setAttribute("disabled","disabled"),i.ajax({url:"".concat(TVA.routes.sendowl,"/refresh_data"),type:"POST",data:{option:this.option},beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",TVA.apiSettings.nonce)}}).success((function(e){e.items&&Array.isArray(e.items)&&(s.items=TVA.sendowl[s.option]=e.items,s.render(),s.refreshDataCallback())})).error((function(e){TVE_Dash.err(e.responseJSON.message)})).complete((function(){TVE_Dash.hideLoader(),t.removeAttribute("disabled")}))},refreshDataCallback:i.noop,selectChange:i.noop})},function(e,t,s){var i=s(0);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/links-input"),className:"tva-card tva-purchase-links",baseUrl:TVA.checkout_endpoint,params:[],queryParams:[],htmlParams:[],afterInitialize:function(e){var t=this;this.params=e.queryParams,this.queryParams=[],this.htmlParams=[],_.each(this.params,(function(e,s){t.queryParams.push("".concat(s,"=").concat(e)),t.htmlParams.push("".concat(s,"='").concat(e,"'"))})),this.model=new Backbone.Model({url:this.getUrl(),shortcode:this.getShortcode(),html:this.getHTML()})},afterRender:function(){!1==!!TVA.settings.checkout_page.value&&this.$("#tva-html-url-input, #tva-links-url-input, #tva-links-shortcode-input").parent().addClass("tva-disable-copy")},getUrl:function(){return"".concat(this.baseUrl,"?").concat(this.queryParams.join("&"))},getShortcode:function(){return"[tva_sendowl_buy ".concat(this.htmlParams.join(" ")," title='Buy Now']")},getHTML:function(){return'<a href="'.concat(this.getUrl(),'">Buy Now</a>')}})},function(e,t,s){var i,n;jQuery,i=s(1),n=s(12),e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/th-page-cards"),selectedClass:"tva-selected",afterRender:function(){this.$("[data-type=".concat(this.model.get("type"),"]")).addClass(this.selectedClass)},click:function(e,t){var s=this;if(e.stopPropagation(),!t.classList.contains(this.selectedClass)){TVE_Dash.showLoader(),this.model.set("type",t.dataset.type);var i=new n({key:"thankyou_page_type",value:t.dataset.type});if(i.isValid()){var r=i.save();r&&r.done((function(){s.$(".".concat(s.selectedClass)).removeClass(s.selectedClass),s.$("[data-type=".concat(s.model.get("type"),"]")).addClass(s.selectedClass),TVE_Dash.success(TVA.t.SuccessfulSave,3e3,null,"top")})).always((function(){return TVE_Dash.hideLoader()}))}else TVE_Dash.err(i.validationError.message)}}})},function(e,t,s){var i=s(1),n=s(12),r=s(6),o=s(5);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/redirect-th-options"),afterInitialize:function(){var e=this;this.model=new Backbone.Model({message:TVA.settings.welcome_message.value}),this.model.on("tva_tinymce_blur",(function(){var t=new n({key:"welcome_message",value:e.model.get("message")});if(t.isValid()){TVA.settings.welcome_message.value=e.model.get("message");var s=t.save();s&&s.done((function(){return TVE_Dash.success(TVA.t.settings_tab.checkout_screen.message_updated)}))}else TVE_Dash.err(t.validationError.message)}))},afterRender:function(){TVA.Utils.renderMCE("tva-thankyou-message",this.model,"message"),new r({el:this.$(".tva-thankyou-page-multiple"),model:new o(TVA.settings.thankyou_multiple_page),states_views_path:"./page-states/",labels:{search:{title:"Set your thank you page"},normal:{title:"Thank you Page"},delete:{title:"Are you sure you want to remove this thank you page?"}},settings:{normal:{edit_with_tar:1===parseInt(TVA.tar_active)}},afterRender:function(){this.$(".tva-page-label").append('<br><span class="tva-notice-span tvd-tooltipped" data-position="top" data-tooltip="If one of your customers purchases access to more than one course then we will show this thank you page rather than redirecting to the start of one of the courses.">'.concat(TVA.t.settings_tab.checkout_screen.th_info,"</span>")).prepend("<h3>".concat(TVA.t.settings_tab.checkout_screen.several_courses,"</h3>")).show()}}).render(),requestAnimationFrame(TVA.Utils.rebindWistiaFancyBoxes)}})},function(e,t,s){var i,n,r;jQuery(),i=s(1),n=s(6),r=s(5),e.exports=i.extend({afterInitialize:function(){this.model=new r(TVA.settings.thankyou_page)},afterRender:function(){new n({el:this.$el,model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your thank you page"},normal:{title:"Thank you Page"},delete:{title:"Are you sure you want to remove this thank you page?"}},settings:{normal:{edit_with_tar:1===parseInt(TVA.tar_active)}}}).render()}})},function(e,t,s){var i,n,r;jQuery,i=s(1),n=s(40),r=s(71),e.exports=i.extend({id:"tva-topics",className:"tva-topics",template:TVE_Dash.tpl("topics/dashboard"),collection:TVA.topics,afterInitialize:function(){this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"remove",this.render)},itemsContainer:function(){return this.$(".tva-topics-list")},render:function(){var e=this;i.prototype.render.apply(this,arguments);var t=this.itemsContainer();return this.collection.each((function(s){return t.append(e.newItemView(s).render().$el)})),this},newModel:function(){return new n},newItemView:function(e){return new r({model:e,parent:this})},add:function(){var e=this,t=this.newModel();TVE_Dash.showLoader(),t.save().then((function(){e.collection.add(t),t.set("editing",!0),requestAnimationFrame((function(){return TVE_Dash.hideLoader()}))}))}})},,,,function(e,t,s){var i=s(283),n=Backbone.Model.extend({defaults:function(){return jQuery.extend(!0,{},{inherit_from:0,content_index:-1,condition:"and",triggers:[],forced_unlock:"inherited",visibility:"inherited"})},initialize:function(e,t){if(!t||!t.campaign)throw new Error("Missing `campaign` option in unlock settings constructor call");this.campaign=t.campaign,this.parse(e)},parse:function(e){e.triggers instanceof i||(e.triggers=new i(e.triggers||[]),this.set("triggers",e.triggers),e.triggers.campaign=this.campaign,e.triggers.unlockSettings=this)},toJSON:function(){var e=Backbone.Model.prototype.toJSON.call(this);return e.triggers=e.triggers.toJSON(),e},getSummary:function(){return{inherited:this.hasInherited(),locked:!0,forced_unlock:this.isForcedUnlockOn(),condition:this.get("condition"),items:this.get("triggers").map((function(e){return e.getSummary()}))}},addTrigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end";this.removeTrigger(e),"automator"===e.id?this.get("triggers").reset([],{silent:!0}):this.removeTrigger("automator");var s="add",i={};switch(!0){case["end","last"].includes(t):s="push";break;case["start","first",0,"0"].includes(t):case parseInt(t)<0:s="unshift";break;default:t=parseInt(t),i.at=t>this.get("triggers").length?this.get("triggers").length:i.at}return this.get("triggers")[s](e,i),this},getTriggerCount:function(){return this.get("triggers").length},getTrigger:function(e){return this.get("triggers").get(e)},hasTrigger:function(e){return!!this.get("triggers").get(e)},removeTrigger:function(){for(var e=this,t=arguments.length,s=new Array(t),i=0;i<t;i++)s[i]=arguments[i];return s.forEach((function(t){var s=t;t instanceof Backbone.Model?s=t.get("id"):t.id&&(s=t.id),e.get("triggers").remove(s)})),this},setInheritFrom:function(e){this.set("inherit_from",e)},unsetInheritFrom:function(){this.set("inherit_from",0)},hasInherited:function(){var e=parseInt(this.get("inherit_from"));return!isNaN(e)&&e>0},isForcedUnlockOn:function(){var e="inherited"===this.get("forced_unlock")&&this.campaign.get("force_unlock_order");return"yes"===this.get("forced_unlock")||e}});e.exports=n},function(e,t,s){var i=s(128).extend({scheduleType:"non_repeating",defaults:function(){return jQuery.extend(!0,{},{id:"first-lesson",schedule:TVA.drip.schedule_defaults[this.scheduleType]})},getLabel:function(){return this.getInterval()+" "+TVA.t.drip_first_lesson},getSummary:function(){var e=this.getInterval();return{id:this.get("id"),icon:this.icon(),text:"+".concat(e),tooltip:this.getLabel()}},icon:function(){return"drip-trigger-first-lesson"}});e.exports=i},function(e,t,s){var i=s(2).extend({defaults:function(){return jQuery.extend(!0,{},{id:"course-content",objects:[],uneditedObjects:[]})},getLabel:function(){if(1===this.get("objects").length){var e="User has to complete %s %s";return e=TVE_Dash.sprintf(e,[this.get("objects")[0].type,this.get("objects")[0].text])}return"User has to complete multiple content"},canEdit:function(){return this.canRemove()},canRemove:function(){return!0},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:"Progress",tooltip:this.getLabel()}},icon:function(){return"drip-content"}});e.exports=i},function(e,t,s){e.exports=s(2).extend({defaults:function(){return{label:"",value:0,min:0,max:100}}})},function(e,t,s){e.exports=s(125).extend({defaults:{options:[],source:"",type:"soundcloud"},getRegexes:function(e){var t=[];switch(e){case"soundcloud":t.push("soundcloud");break;case"custom":t.push(".");break;default:t.push(e)}return t}})},function(e,t,s){var i=s(2);e.exports=i.extend({idAttribute:"ID",defaults:{title:"",course_id:0,edit_url:"",preview_url:""},url:function(){return"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/certificate/").concat(this.get("ID")?this.get("ID"):"")}})},function(e,t,s){var i=s(2);e.exports=i.extend({idAttribute:"ID",defaults:{title:"",course_id:0,edit_url:"",preview_url:"",type:"completed",extra_id:0,allow_comments:0,post_name:""},url:function(){return"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v1,"/completed_post/").concat(this.get("ID")?this.get("ID"):"")},changeType:function(e){var t=this;return this.set("type",e),new Promise((function(e){wp.apiRequest({type:"POST",url:"".concat(t.url(),"/change_type"),data:{course_id:t.get("course_id"),type:t.get("type")}}).done((function(s){t.set({post_name:s.post_name,title:s.title,edit_url:s.edit_url,preview_url:s.preview_url,extra_id:s.extra_id},{silent:!0}),e(s)})).always((function(t){return e(t)}))}))},getTitle:function(){var e=!1;return this.get("title")&&(e=this.get("title")),e||(e=this.get("preview_url"))&&"//"===e.substring(0,2)&&(e=e.substring(2)),e||""}})},function(e,t,s){var i=s(2),n=s(288),r=i.extend({idAttribute:"term_id",initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.set("templates",new n(e.templates||[],{skin_id:e.term_id||""}))},parse:function(e){return e.templates&&e.templates instanceof n||(e.templates=new n(e.templates||[],{skin_id:e.term_id})),e},url:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return TVA.Utils.buildUrl([TVA.routes.skins,this.getId(),e].filter((function(e){return e})).join("/"),t)},defaults:function(){return{name:"",description:"",default:0}},isLegacy:function(){return 1===this.get("legacy")},isJustAdded:function(){return!!this.get("just_added")},isActive:function(){return!0===this.get("is_active")},getId:function(){return this.get(this.idAttribute)},destroy:function(){var e=this,t=this.collection;return t.trigger("ajax"),i.prototype.destroy.apply(this.deepClone(),arguments).then((function(){return t.remove(e)})).always((function(){return t.trigger("ajaxdone")}))},inheritTypography:function(){return!!this.get("inherit_typography")},getTypographyPreviewUrl:function(){return this.deepGet("typography.preview_url")+"&admin_preview_id=".concat(this.deepGet("typography.ID"),"&tva_skin_id=").concat(this.getId())},patch:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return wp.apiRequest({url:this.url("patch",{patch:e}),type:"PUT",data:t})},getTemplates:function(){var e=this.get("templates");return e&&e instanceof n||(e=new n(e||[],{skin_id:this.getId()})),e},refreshTemplates:function(){var e=this;wp.apiRequest({url:TVA.routes.templates,data:{tva_skin_id:this.getId()}}).done((function(t){e.set("templates",new n(t||[],{skin_id:e.getId()},{silent:!0}))}))}});e.exports=r},function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function r(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){o(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var a=s(208),c=a.STEPS,l=a.SECTIONS,u=s(2),d=s(2).extend({wizard:null,promises:{},defaults:function(){var e={};return Object.values(c).forEach((function(t){return e[t.id]=null})),e.template_instances={},e},load:function(e){var t=this;return this.promises[e]||(this.promises[e]=new Promise((function(s,i){if(null!==t.attributes[e])return s(t.attributes[e]);t.fetch(e).done((function(i){i&&i.data&&(t.set(e,Object.values(i.data)),s(i.data))})).fail(i)}))),this.promises[e].finally((function(){delete t.promises[e]})),this.promises[e]},updateTemplate:function(e,t,s){var i=this.get(e);if(i){var n=i.find((function(e){return String(e.id)===String(t)}));if(n)for(var r in s)n[r]=s[r]}return this},loadTemplate:function(e,t,s,i){var n=this,r=e+"--"+t,o=this.get("template_instances");return new Promise((function(a,c){if(o[r])return a(o[r]);n.fetchInstance(e,t,s,i).done((function(e){var t=e.data||e;o[r]=t,n.set({instances:o}),a(t)})).fail(c)}))},clearCache:function(e){var t=this.get("template_instances");Object.keys(t).forEach((function(s){s.startsWith(e+"--")&&delete t[s]})),this.set(e,null)},fetch:function(e){var t=this;return wp.apiRequest({url:TVA.Utils.buildUrl(this.wizard.url(),{},"/templates"),data:{type:e}}).fail((function(s){var i;TVE_Dash.err((null===(i=s.responseJSON)||void 0===i?void 0:i.message)||"An error occurred while fetching templates","error"),t.attributes[e]=null}))},fetchInstance:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"cloud",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:TVA.Utils.buildUrl(this.wizard.url(),{},"/templates/".concat(t));return wp.apiRequest({url:i,data:{type:e,source:s}})},indexOf:function(e,t){return this.get(e)?this.get(e).findIndex((function(e){return String(e.id)===t})):-1},count:function(e){return this.get(e)?this.get(e).length:0},getNextTemplateId:function(e,t){return(this.get(e)[this.indexOf(e,t)+1]||{id:""}).id},getPrevTemplateId:function(e,t){return(this.get(e)[this.indexOf(e,t)-1]||{id:""}).id},getNextTemplateSource:function(e,t){return(this.get(e)[this.indexOf(e,t)+1]||{source:""}).source},getPrevTemplateSource:function(e,t){return(this.get(e)[this.indexOf(e,t)-1]||{source:""}).source},getTemplate:function(e,t){var s=this.indexOf(e,t);return s>-1?this.get(e)[s]:null}}),h=u.extend({SKIN_ID:null,sections:l,url:function(){return TVA.Utils.buildUrl(TVA.routes.wizard,{tva_skin_id:this.SKIN_ID})},iframeData:{headerHeight:"",footerHeight:"",templateId:"",scrollWidth:"",nextPage:{},prevPage:{}},isNew:function(){return!0},defaults:function(){return{activeIndex:-1,active:"",done:[],settings:{}}},parse:function(e){return this.globals=jQuery.extend(!0,{},e),TVA.wizard.urls=e.urls||{},e.wizard_data?e.wizard_data:e},initialize:function(e){this.templates=new d,this.templates.wizard=this,e&&e.skin_id&&(this.SKIN_ID=parseInt(e.skin_id),delete this.attributes.skin_id),e&&e.active&&(-1===this.indexOf(e.active)?this.set("active",""):this.loadStepTemplates())},fetch:function(){var e=this;if(this.$$fetched){var t=jQuery.Deferred();return t.resolve(),t.promise()}return u.prototype.fetch.apply(this,arguments).always((function(){return e.$$fetched=!0}))},getSteps:function(e){var t=this;return c.filter((function(t){return t.section===e})).map((function(e){return e.active=t.get("active")===e.id,e.done=t.get("done").includes(e.id),e.disabled=!t.canAccessStep(e.id),e}))},loadStepTemplates:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],s=this.getStepKey("hasTemplates"),i=s?this.templates.load(this.get("active")):new Promise((function(e){return e([])}));return t&&i.then((function(t){e.trigger("templates-loaded",t)})),i},_id:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?"string"==typeof e?e:e.id:""},_step:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?"string"==typeof e?c[e]:e:{}},indexOf:function(e){return e=this._id(e),_.findIndex(c,(function(t){return t.id===e}))},canAccessStep:function(e){return!0},markComplete:function(e){Array.isArray(e)||(e=[e]);var t=new Set(this.get("done").concat(e));return this.set({done:Array.from(t).map(this._id)},{silent:!0}),this},getStep:function(e){return c[e]},gotoStep:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"header";if(e=this._id(e),this.canAccessStep(e)&&e!==this.get("active")){var t=this.getCurrentStep();this.set({active:e,activeIndex:this.indexOf(e)}),this.triggerStepChange(t)}return this},triggerStepChange:function(e){e&&e.id===this.get("active")||this.loadStepTemplates(),e||(e=c[this.get("activeIndex")]);var t=c[this.get("activeIndex")];this.trigger("step-change",t,e)},getCurrentStep:function(){return c[this.get("activeIndex")]},getStepKey:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCurrentStep();return t&&t[e]},setOriginalData:function(){return TVA.wizardOriginal=jQuery.extend(!0,{},this.attributes),this},getOriginalStepData:function(e){return this.deepGet("settings.".concat(this.get("active"),".").concat(e),null,TVA.wizardOriginal)},hasActiveStep:function(){return this.get("activeIndex")>=0&&c[this.get("activeIndex")]},previous:function(){for(var e=this.get("activeIndex")-1;c[e]&&c[e].comingSoon;)e--;return c[e]&&this.gotoStep(c[e].id),this},hasNextStep:function(){return-1!==this.getNextAvailableStepIndex()},hasPreviousStep:function(){return-1!==this.getPrevAvailableStepIndex()},next:function(){if(this.isFinished(!1))return this.set({active:"",activeIndex:-1}),this.trigger("finished"),this;var e=this.getNextAvailableStep();return e&&this.gotoStep(e.id),this},getStepBaseURL:function(){var e,t=this.getCurrentStep(),s=this._id(t);switch(s){case"logo":case"color":case"header":case"footer":case"lesson":case"menu":case"sidebar":case"":e="lesson";break;default:e=s}return TVA.wizard.urls[e]},getFrameURL:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getCurrentStep()||this.getNextAvailableStep(),s=new URL(this.getStepBaseURL()),i={};return this.isFinished()||!t?i.step="__welcome":i=r(r({step:t.id},this.getFramePreviewParams(t)),e),p(s,i,{tva_skin_id:this.SKIN_ID,"force-flat":"1"})},getFramePreviewParams:function(e){var t={};switch((e=this._step(e)).id){case"logo":case"color":t.step="logo";break;case"sidebar":t={step:e.id};break;default:t={step:e.id,template_id:this.deepGet("settings.".concat(e.id,".template_id"),"")}}return t},isStarted:function(){return this.get("done").length>0||this.get("active")},isFinished:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!!e&&this.get("active");return!t&&this.get("done").length>=c.filter((function(e){return!e.comingSoon})).length},getNextAvailableStep:function(){return c[this.getNextAvailableStepIndex()]||null},getNextAvailableStepIndex:function(){var e=this,t=c.map((function(e,t){return t})).filter((function(t){return!c[t].comingSoon&&!e.get("done").includes(c[t].id)}));if(0===t.length)return-1;var s=t[0],i=Number(this.get("activeIndex"));return t.some((function(e){return e>i&&(s=e,!0)})),s!==i?s:-1},getPrevAvailableStepIndex:function(){var e=this,t=c.map((function(e,t){return t})).filter((function(t){return!c[t].comingSoon&&!e.get("done").includes(c[t].id)})).reverse();if(0===t.length)return-1;var s=t[0],i=Number(this.get("activeIndex"));return t.some((function(e){return e<i&&(s=e,!0)})),s!==i?s:-1},start:function(){return this.gotoStep(this.getNextAvailableStep())},setStepData:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.get("active"),n=this.get("settings");return s&&delete n[i],n[i]=r(r({},n[i]||{}),e),this.set({settings:n},{silent:t}),this},completeStep:function(){var e,t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!(null!==(e=this.getCurrentStep())&&void 0!==e&&e.delayNextStep),i=this.get("active"),n=this.get("activeIndex"),r=this.getNextAvailableStep();"logo"===i?(this.templates.clearCache("header"),this.templates.clearCache("footer")):"lesson"===i?this.templates.clearCache("sidebar"):["header","footer","sidebar"].includes(i)&&this.templates.clearCache(i),this.trigger("ajax-send",i),this.markComplete(i),s&&this.next();var o={beforeSend:function(e,t){var s=new URL(t.url);s.searchParams.append("step",i),s.searchParams.append("next",r?r.id:""),s.searchParams.append("nextIndex",c.indexOf(r)),t.url=s.toString()},silent:!0};return this.save(void 0,o).done((function(e){e.skin&&e.skin.templates&&TVA.skins.get(t.SKIN_ID).get("templates").reset(e.skin.templates),t.setOriginalData(),e.step_templates&&t.templates.set(r.id,e.step_templates),s||(t.set({active:i,activeIndex:n},{silent:!0}),t.next())})).fail((function(e){var t;return TVE_Dash.err((null===(t=e.responseJSON)||void 0===t?void 0:t.message)||"Something went wrong")})).always((function(){t.trigger("ajax-done",i)}))},canContinue:function(){return!!this.getPreviewTemplateId()},getPreviewTemplateId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get("active");return String(this.deepGet("settings.".concat(e,".template_id"),""))},getPreviewTemplateSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get("active");return String(this.deepGet("settings.".concat(e,".source"),""))},getAdjacentTemplateId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"next";return this.templates["next"===e?"getNextTemplateId":"getPrevTemplateId"](this.get("active"),this.getPreviewTemplateId())},getAdjacentTemplateSource:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"next";return this.templates["next"===e?"getNextTemplateSource":"getPrevTemplateSource"](this.get("active"),this.getPreviewTemplateId())},getPreviewTemplateTitle:function(){var e=this.getPreviewTemplateId(),t=this.templates.getTemplate(this.get("active"),e),s=this.getCurrentStep();return t&&t.post_title||s&&s.selector&&s.selector.label},hasAdjacentTemplate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"next",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.get("active"),s=!1;if("homepage"===t&&"page"===this.homepageState.get("type"))s=!!this.iframeData["".concat(e,"Page")];else{var i=this.templates.indexOf(t,this.getPreviewTemplateId(t));"prev"===e?s=i>0:"next"===e&&(s=i<this.templates.count(t)-1)}return s},selectTemplate:function(e){var t,s=this;return(t=regeneratorRuntime.mark((function t(){var i,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i={template_id:e.id},"iframe"!==s.getStepKey("previewMode")){t.next=14;break}if(s.setStepData(i),r=s.get("active"),"cloud"!==e.source){t.next=10;break}return t.next=7,new Promise((function(t){s.templates.fetchInstance(r,e.id).done((function(i){s.templates.updateTemplate(r,e.id,{id:i.id,source:"local"}),t({id:i.id,source:"local"})}))}));case 7:e=t.sent,i.template_id=e.id,s.setStepData({template_id:e.id,source:"local"});case 10:n=new Promise((function(t){t({id:e.id})})),s.triggerStepChange(),t.next=15;break;case 14:n=s.templates.loadTemplate(s.get("active"),e.id,e.source);case 15:return n.finally((function(){e.source&&(i.source=e.source),s.setStepData(i),s.trigger("template-selected")})),t.abrupt("return",n);case 17:case"end":return t.stop()}}),t)})),function(){var e=this,s=arguments;return new Promise((function(n,r){var o=t.apply(e,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))})()},getTemplateDefaultIcon:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getCurrentStep(),t="";switch(this._id(e)){case"post":t="singular-post-standard";break;case"blog":t="archive-general-template";break;case"homepage":case"page":t="singular-page"}return t?TVA.Utils.icon(t):""},hasTopBar:function(){return this.getCurrentStep()&&this.getStepKey("hasTopMenu")},hasTemplateSelector:function(){return!!this.get("active")&&("homepage"===this.get("active")?this.homepageState.data().hasTemplateSelector:!!this.getStepKey("selector"))},hasSelectorDropdown:function(){return"homepage"!==this.get("active")||this.homepageState.data().hasTemplateDropdown},getContinueLabel:function(){var e=this.isFinished(!1);return"homepage"===this.get("active")&&"blog"===this.homepageState.get("type")?e?"Choose":"Continue":e?"Choose":"Choose and continue"},isStepCompleted:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.get("active");return this.get("done").includes(this._id(e))},getPopupMessage:function(){if(this.hasActiveStep()){var e=this.getCurrentStep();return"homepage"===e.id?this.homepageState.data().popupMessage:(this.isStepCompleted()?e.completedPopupMessage:e.popupMessage)||""}},getStepTitle:function(){var e=this.getCurrentStep();return e?this.isStepCompleted()?e.sidebarLabel:"homepage"===e.id?this.homepageState.data().title:e.title:""},hasStepChanges:function(){var e=this,t=this.get("active");if(!t)return!1;var s=this.deepGet("settings.".concat(t));return Object.keys(s).some((function(t){return String(e.getOriginalStepData(t))!==String(s[t])}))},hasPreviousStepLink:function(){return!this.isStepCompleted()&&this.get("activeIndex")>0}}),p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e instanceof URL||(e=new URL(e)),_.each(t,(function(t,s){e.searchParams.append("tva-wizard[".concat(s,"]"),t||"")})),e.searchParams.append("_preview","1"),TVA.Utils.buildUrl(String(e),s)+"#obj=TVA/localize=ThriveAppFront"};e.exports=h},function(e,t){e.exports={STEPS:TVA.wizard.structure.steps,SECTIONS:TVA.wizard.structure.sections}},function(e,t,s){e.exports=s(39).model.extend({getText:function(){return TVA.t.integrations.thrivecart.rule_text}})},function(e,t,s){var i=s(5),n=s(6),r=s(43),o=s(55);e.exports=s(1).extend({template:TVE_Dash.tpl("access-restriction/index"),initialize:function(){var e=this;this.model=new i(TVA.settings.login_page),this.listenTo(this.model,"value-changed",(function(){TVE_Dash.LocalStorage.set("tva-login-page-id",String(e.model.get("value")))}))},render:function(){return this.$el.html(this.template()),this.renderLoginRegistrationSettings(),this.renderContentRestrictions(),this},renderLoginRegistrationSettings:function(){var e=new n({el:this.$(".tva-login-states-container"),model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your login & registration page"},normal:{title:"Login & registration page"},delete:{title:"Are you sure you want to remove this login & registration page?"}}});e.render(),this.addChild(e)},renderContentRestrictions:function(){[this.notLogged,this.notPurchased,this.locked].forEach((function(e){e&&e.destroy()})),this.notLogged=new r({scope:"not_logged",settings:TVA.accessRestriction.settings.not_logged,global_settings:!0}),this.notPurchased=new r({scope:"not_purchased",settings:TVA.accessRestriction.settings.not_purchased,global_settings:!0}),this.locked=new r({scope:"locked",settings:TVA.accessRestriction.settings.locked,global_settings:!0}),[this.notLogged,this.notPurchased,this.locked].forEach((function(e){e.off("model.sync").on("model.sync",(function(e,t){TVA.accessRestriction.settings[e.scope]=t}))}))},openRestrictionsModal:function(e){this.renderContentRestrictions();var t=this.notLogged;switch(e.currentTarget.dataset.scope){case"not_purchased":t=this.notPurchased;break;case"locked":t=this.locked}return this.openModal(o,{accessTab:this,scope:e.currentTarget.dataset.scope,course:this.model,width:"670px",top:"40px",className:"tvd-modal tvd-modal-small",contentRestriction:t}),!1}})},function(e,t,s){e.exports=s(212).extend({initialize:function(){var e="search-link";(parseInt(this.get("value"))||this.get("custom_link"))&&(e="normal"),this.attributes.state=e}})},function(e,t,s){e.exports=s(5).extend({url:function(){return TVA.Utils.buildUrl(TVA.routes.access_restriction+"/redirect-page",{op:this.get("state")})}})},function(e,t,s){var i,n;jQuery,i=s(91),n=s(38),e.exports=i.extend({initialize:function(){this.model=new n,this.listenTo(this.model.get("author"),"change",this.onAuthorChanged)},afterRender:function(){var e=this;this.renderForm(),this.$('[data-fn="editTitle"]').trigger("click"),setTimeout((function(){return e.$(".title-box input")[0].focus()}),100)},saveCourse:function(){var e=this;return!!this.model.isValid()&&(TVE_Dash.showLoader(),this.model.save(null,{success:function(t){TVA.courses.add(t),e.changeView("#courses/".concat(t.get("id"),"/new")),TVE_Dash.hideLoader()},error:function(e,t){TVE_Dash.hideLoader(),TVE_Dash.err(t.responseJSON.message)}}))}})},function(e,t,s){function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}e.exports=s(4).extend({idAttribute:"id",model:s(2),getSelectedItem:function(){return this.findWhere({selected:!0})},setSelected:function(e){return this.setSelectedId(e.get(this.idAttribute))},setSelectedId:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e=parseInt(e);var s=this.findWhere(i({},this.idAttribute,e));return s||(s=this.findWhere(i({},this.idAttribute,t))),s&&(this.each((function(e){return e.set("selected",!1)})),s.set("selected",!0),this.trigger("selectionchange",s)),this}})},function(e,t,s){var i={"./access-restriction/content-restriction":81,"./access-restriction/content-restriction.js":81,"./access-restriction/page-redirect":212,"./access-restriction/page-redirect-link":211,"./access-restriction/page-redirect-link.js":211,"./access-restriction/page-redirect.js":212,"./available-settings":216,"./available-settings.js":216,"./base":2,"./base-page":5,"./base-page.js":5,"./base.js":2,"./certificate":204,"./certificate.js":204,"./chapter":85,"./chapter.js":85,"./complete-post":205,"./complete-post.js":205,"./course":38,"./course.js":38,"./course/item":84,"./course/item.js":84,"./customer":136,"./customer.js":136,"./drip/campaign":126,"./drip/campaign.js":126,"./drip/triggers/automator":131,"./drip/triggers/automator.js":131,"./drip/triggers/campaign":130,"./drip/triggers/campaign.js":130,"./drip/triggers/course-content":201,"./drip/triggers/course-content.js":201,"./drip/triggers/datetime":80,"./drip/triggers/datetime.js":80,"./drip/triggers/factory":127,"./drip/triggers/factory.js":127,"./drip/triggers/first-lesson":200,"./drip/triggers/first-lesson.js":200,"./drip/triggers/purchase":128,"./drip/triggers/purchase.js":128,"./drip/triggers/scheduled":129,"./drip/triggers/scheduled.js":129,"./drip/unlock-settings":199,"./drip/unlock-settings.js":199,"./email-template":217,"./email-template.js":217,"./filter":218,"./filter.js":218,"./integration/base":39,"./integration/base.js":39,"./integration/rule":79,"./integration/rule.js":79,"./integration/thrivecart":209,"./integration/thrivecart.js":209,"./label":21,"./label.js":21,"./labels/dynamic-settings":219,"./labels/dynamic-settings.js":219,"./lesson":86,"./lesson.js":86,"./media/audio-model":203,"./media/audio-model.js":203,"./media/base":125,"./media/base.js":125,"./media/video-model":124,"./media/video-model.js":124,"./module":83,"./module.js":83,"./product":41,"./product.js":41,"./resource":154,"./resource.js":154,"./sendowl-account-key":220,"./sendowl-account-key.js":220,"./setting-item":12,"./setting-item.js":12,"./skin":206,"./skin-item-template":87,"./skin-item-template.js":87,"./skin.js":206,"./slider-input":202,"./slider-input.js":202,"./student":88,"./student.js":88,"./token":156,"./token.js":156,"./topic":40,"./topic.js":40,"./wizard":207,"./wizard.js":207,"./wizard/const":208,"./wizard/const.js":208};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=215},function(e,t,s){e.exports=s(2).extend({defaults:{tooltip:'data-position="top" data-tooltip="'.concat(TVA.t.OptionUnavailable,'"')},url:function(){return"".concat(TVA.routes.settings,"/get_available_settings/")}})},function(e,t,s){e.exports=s(2).extend({url:function(){return TVA.routes.email_template}})},function(e,t,s){e.exports=s(2).extend({defaults:function(){return{title:"core",template:"core",name:"",counter:0}},setOptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.set(e),t||this.trigger("tva_dash:filter")}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o=s(2),a=s(21),c=a.extend({savedMessage:TVA.t.settingsSaved,save:function(){return this.settings.save()},defaults:function(){return n(n({},a.prototype.defaults.call(this)),{},{opt:"show"})},toJSON:function(){return this.pick(Object.keys(this.defaults()))}}),l=c.extend({defaults:function(){return{title:""}}}),u=c.extend({defaults:function(){return{title:""}}}),d=c.extend({defaults:function(){return{singular:"",plural:""}}}),h=o.extend({initialize:function(e){this.set("labels",this.initLabels(e.labels||{},"labels",c)),this.set("buttons",this.initLabels(e.buttons||{},"buttons",l)),this.set("course_labels",this.initLabels(e.course_labels||{},"course_labels",u)),this.set("course_navigation",this.initLabels(e.course_navigation||{},"course_navigation",l)),this.set("course_structure",this.initLabels(e.course_structure||{},"course_structure",d)),this.set("course_progress",this.initLabels(e.course_progress||{},"course_progress",l))},initLabels:function(e,t,s){var i=this,n={},r=this.get(t)||{};return _.each(e||{},(function(e,t){n[t]=r[t]instanceof s?r[t]:new s,n[t].set(e,{silent:!0}),n[t].settings=i})),n},getUserContextLabel:function(e){return this.get("labels")[e]},getCTAButtonLabel:function(e){return this.get("buttons")[e]},getCourseTypeLabel:function(e){return this.get("course_labels")[e]},getCourseNavigationLabel:function(e){return this.get("course_navigation")[e]},getCourseStructureLabel:function(e){return this.get("course_structure")[e]},getCourseProgressLabel:function(e){return this.get("course_progress")[e]},parse:function(e){e.labels=this.initLabels(e.labels,"labels",c)},toJSON:function(){return n(n({},o.prototype.toJSON.call(this)),{},{switch_labels:this.get("switch_labels"),labels:_.mapObject(this.get("labels"),(function(e){return e.toJSON()}))})},url:function(){return TVA.routes.labels+"/dynamic-settings"}});e.exports=new h(TVA.dynamicLabelSetup.settings)},function(e,t,s){e.exports=s(2).extend({defaults:{key:"",secret:""},validate:function(e){var t=[];if(e.key.trim()||t.push(this.validation_error("key",TVA.t.emptyKey)),e.secret.trim()||t.push(this.validation_error("secret",TVA.t.emptySecret)),e.key.trim()===e.secret.trim()&&t.push(this.validation_error("key&secret",TVA.t.identicalKeys)),t.length)return t},url:function(){return"".concat(TVA.routes.sendowl,"/save_account_keys")}})},function(e,t,s){var i,n,r,o;jQuery,i=s(297),n=s(156),r=s(102),o=s(167),e.exports=s(1).extend({template:TVE_Dash.tpl("settings/api-keys"),initialize:function(){this.collection=new i(TVA.tokens),this.listenTo(this.collection,"add",this.renderOne),this.listenTo(this.collection,"add",this.toggleTable),this.listenTo(this.collection,"toggleTable",this.toggleTable)},afterRender:function(){this.$apiWrapper=this.$("#tva-api-keys-wrapper"),this.$noApiKeysWrapper=this.$("#tva-no-api-keys"),this.toggleTable(),this.collection.each(this.renderOne,this)},toggleTable:function(){var e=this.collection.length;this.$apiWrapper.toggle(e>0),this.$noApiKeysWrapper.toggle(0===e)},renderOne:function(e){this.$el.append(new o({model:e,collection:this.collection}).render().$el)},addKey:function(){this.openModal(r,{model:new n,collection:this.collection,width:"550px",className:"tvd-modal tva-api-modal"})}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r,o,a,c,l,u,d,h,p,m;r=jQuery,o=s(0),a=s(92),c=s(26),l=s(103),u=s(104),d=s(214),h=s(21),p=s(55),m=a.extend({renderThumbs:!0,label:"",initialize:function(e){var t=new d(TVA.labels.toJSON());return t.idAttribute="ID",this.collection=t,a.prototype.initialize.call(this,function(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){n(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}({collection:t},e))}}),e.exports=o.extend({template:TVE_Dash.tpl("courses/access-tab"),integrations:null,integrationsViews:[],$integrationsWrapper:null,$rulesCountMessage:null,labelDropdown:null,initialize:function(e){var t=this;r.extend(!0,this,e),this.integrations=TVA.access_integrations,this.labelDropdown=new m({add_item:{str:{title:TVA.t.addNewLabel,save:TVA.t.saveLabel},inputTemplate:TVE_Dash.tpl("labels/add-inline"),spectrum:function(e){var t=this,s=e.currentTarget,i=r(s).find("input").spectrum({containerClassName:"tva-color-picker",showPalette:!1,allowEmpty:!1,showInitial:!1,showButtons:!0,chooseText:"Apply",cancelText:"Cancel",showInput:!0,preferredFormat:"hex",hide:function(e){s.style.setProperty("--thumb-color",e.toString()),t.focusInput()}});return requestAnimationFrame((function(){return i.spectrum("show")})),!1},getModelForSave:function(){var e=this.$(".tva-colorpicker").val();return new h({title:this.$input.val(),label_color:e,color:e})},afterSave:function(e){TVA.labels.push(e)},addToCollection:function(e){this.dropdown.collection.push(e)}}}),this.labelDropdown.on("tva.dropdown.item.selected",this.onLabelChange.bind(this)),this.listenTo(this.model.get("rules"),"add",this.renderRulesCount),this.listenTo(this.model.get("rules"),"remove",this.renderRulesCount),this.listenTo(this.model,"change",this.changeModel),this.listenTo(this.model,"change:is_private",(function(e){return t.togglePrivateContent(e.get("is_private"))}))},afterRender:function(){this.$("#tva-course-is-private").prop("checked",this.model.get("is_private")),this.$integrationsWrapper=this.$("#tva-course-integrations-wrapper"),this.$rulesCountMessage=this.$("#tva-rules-count-message"),this.$privateContent=this.$(".tva-restrictions-card-state"),this.renderLabelDropdown(),this.togglePrivateContent(this.model.get("is_private")),TVE_Dash.data_binder(this)},renderRulesCount:function(){var e=this.model.get("rules").filter((function(e){return e.getItems().length||"thrivecart"===e.get("integration")}));0===e.length?this.$rulesCountMessage.text(TVA.t.noAccessRulesSet):1===e.length?this.$rulesCountMessage.text(TVA.t.oneAccessRuleSet):this.$rulesCountMessage.text(TVE_Dash.sprintf(TVA.t.accessRulesSet,e.length))},renderIntegrations:function(e){var t=this;if(e||(e=this.integrations),this.$integrationsWrapper.empty(),!(e instanceof Backbone.Collection))return null;e.each((function(e){var s={model:e,rules:t.model.get("rules")},i=function(){var t;switch(e.get("slug")){case"woocommerce":t=new u(s);break;case"thrivecart":t=new l(s);break;default:t=new c(s)}return t}();t.$integrationsWrapper.append(i.render().$el),t.integrationsViews.push(i)})),this.renderRulesCount()},togglePrivateContent:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e?this.renderIntegrations(this.integrations):(this.integrationsViews.forEach((function(e){e.remove(),e.destroy()})),this.integrationsViews=[]),this.$privateContent.hide().filter('[data-state="'.concat(e?1:0,'"]')).show()},renderLabelDropdown:function(){this.labelDropdown.collection.setSelectedId(this.model.get("label")),this.$("#tva-course-label").append(this.labelDropdown.render().$el)},onLabelChange:function(e){var t=this;if(this.model.set("label",parseInt(e.get("ID"))),this.model.hasChanged("label")&&!this.model.get("is_private")){this.labelDropdown.$el.tvaToggleLoader();var s=this.model.get("structure");this.model.save().done((function(){t.model.set("structure",s),TVE_Dash.success(TVA.t.label_saved),t.labelDropdown.$el.tvaToggleLoader()}))}},openRestrictionsModal:function(e){return this.openModal(p,{accessTab:this,scope:e.currentTarget.dataset.scope,course:this.model,width:"670px",top:"40px",className:"tvd-modal tvd-modal-small"}),!1},renderRestrictionSummary:function(){var e=this;this.$(".course-restriction-summary").each((function(t,s){s.textContent=e.model.getRestrictionSummary(s.dataset.scope)}))},changeModel:r.noop})},function(e,t,s){var i=s(1);e.exports=i.extend({template:TVE_Dash.tpl("reports/courses"),afterInsert:function(){window.thriveReportsInit(this.el,"courses")}})},function(e,t,s){!function(t){var i=s(2),n=s(78),r=s(56),o=s(168),a=s(10),c=s(1),l=s(7);function u(){var e=t(this),s=e.sortable("option","items"),n=e.find(s),r=n.length-1,o=new i;n.each((function(e,t){o.set(t.dataset.id,r-e)})),o.url="".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v2,"/courses/update_orders"),o.save(),n.reverse().each((function(e,t){return TVA.courses.findWhere({id:parseInt(t.getAttribute("data-id"))}).set({order:e},{silent:!0})})),TVA.courses.sort()}e.exports=c.extend({className:"tva-course-main",template:TVE_Dash.tpl("courses/list"),itemTemplate:TVE_Dash.tpl("courses/item"),addTemplate:TVE_Dash.tpl("courses/add"),noItemsTemplate:TVE_Dash.tpl("courses/no-items"),$courses:null,$pagination:null,initialize:function(){var e=this;this.collection=TVA.courses,this.listenTo(this.collection,"fetched",this.renderCourses),this.listenTo(this.collection,"destroy",(function(){e.renderCourses(e.collection)})),this.listenTo(this.collection,"fetching",(function(){return e.$courses.tvaToggleLoader(50,!0)}))},destroy:function(){c.prototype.destroy.apply(this,arguments),this.collection.hasFilters()&&this.collection.resetFilters().fetch()},render:function(){return this.$el.html(this.template()),this.$courses=this.$("#tva-courses"),this.$pagination=this.$(".tva-pagination"),this.$noticeOnePublishedCourse=this.$("#tva-one-published-course-notice"),this.topicFilter=new o({collection:TVA.topics,idField:"ID",labelField:"title",defaultOption:"Filter by topics",selected:this.collection.getFilter("topic",-1)}).render().on("change",this.topicChanged.bind(this)),this.$(".tva-filter-topic").append(this.topicFilter.$el),this.$(".tva-filter-topic select").select2(),this.renderCourses(this.collection),this.$courses.sortable({items:"> .tva-course-card",handle:".tva-course-handle",placeholder:"tva-drag-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:u}),this.$courses.disableSelection(),this.renderPagination(),this},renderCourses:function(e){var t=this;return this.$courses.tvaToggleLoader(!1).empty(),e instanceof n?(e.length?(this.toggleOneCoursePublishedNotification(),e.each((function(e){t.$courses.append(t.itemTemplate({course:e,topic:e.getTopic()}))})),this.$courses.append(this.addTemplate)):this.$courses.append(this.noItemsTemplate),this):this},toggleOneCoursePublishedNotification:function(){this.$noticeOnePublishedCourse.toggle(!TVA.courses.hasFilters()&&1===TVA.courses.where({status:"publish"}).length&&1!==parseInt(TVA.settings.skip_homepage_redirect.value))},renderPagination:function(){var e=new r({collection:this.collection,el:this.$pagination});e.render(),e.$el.hide()},duplicateCourse:function(e,t){e.stopPropagation();var s=parseInt(t.dataset.id),i=this;TVE_Dash.showLoader(),t.setAttribute("disabled","true"),wp.apiRequest({url:"".concat(TVA.apiSettings.root).concat(TVA.apiSettings.v2,"/courses/duplicate"),type:"POST",data:{id:s}}).done((function(e){TVA.courses.add(e),i.render(),TVE_Dash.hideLoader(),t.removeAttribute("disabled")})).fail((function(e){TVE_Dash.hideLoader(),TVE_Dash.err(e.responseJSON.message)}))},deleteCourse:function(e,s){var i=this;e.stopPropagation();var n=parseInt(s.dataset.id),r=t(s).parents(".tva-course-card").first(),o=new a({template:TVE_Dash.tpl("courses/delete-course"),className:"tva-delete-course",confirm:function(){i.collection.get(n).destroy({success:function(){TVA.products.resetAndFetch(),TVA.customers.reset()}}),i.toggleOneCoursePublishedNotification()},afterRender:function(){r.removeClass("click")},cancel:function(){r.addClass("click"),this.remove()}}).render();r.append(o.$el)},topicChanged:function(e){this.collection.addFilter("topic",e)},courseDetails:function(e,t){this.changeView("#courses/".concat(t.dataset.id)),e.stopPropagation()},previewCourse:function(e){e.stopPropagation()},addCourse:function(){this.changeView("#courses/add-new-course")},toggleCourseStatus:function(e,s){var i=this,n=parseInt(s.dataset.id);if(!isNaN(n)){var r=TVA.courses.findWhere({id:n}),o=["publish","future"].includes(r.get("status"))?"draft":"publish";return new Promise((function(e,t){r.get("structure")instanceof l?e():(TVE_Dash.showLoader(),r.fetch({success:function(t){t.set("structure",new l(t.get("structure"))),e()},error:function(){t()}}))})).then((function(){var e=r.get("structure").findItemsByOptions({post_status:"publish"});if("publish"===o&&!e.length)return TVE_Dash.hideLoader(),TVE_Dash.err(TVA.t.NumberLessons);TVE_Dash.showLoader(),r.save({status:o},{success:function(){r.set("fetched",!1),TVE_Dash.hideLoader(),TVE_Dash.success(TVA.t["course_".concat(o)]),s.classList.remove("publish"),s.classList.remove("draft"),s.classList.remove("future"),s.classList.add(o),t(s).find(".tva-custom-tooltip").text("draft"===o?TVA.t.click_to_publish_course:TVA.t.click_to_unpublish_course),i.toggleOneCoursePublishedNotification()}})})),e.stopPropagation(),this}}})}(jQuery)},function(e,t,s){function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var n=s(1),r=s(57),o=s(216),a=s(13),c=s(11),l={template:s(58),advanced:s(61),index:s(18)};e.exports=n.extend({className:"tva-wizard-container",model:null,template:TVE_Dash.tpl("design/base"),initialize:function(){var e=this;TVE_Dash.showLoader(),TVA.design.$el=this.$el,TVA.design.$el.on("tva_iframe_loaded",(function(){TVE_Dash.hideLoader(),c.iframeLoaded()})),n.prototype.initialize.apply(this,arguments);var t=Object.values(TVA.settings).filter((function(e){return"template"===e.category}));this.model=new Backbone.Model(t.reduce((function(e,t){return Object.assign(e,i({},t.name,t.value))}),{})),this.collection=TVA.courses,this.listenTo(this.model,"change:preview_option",(function(e){TVA.settings.preview_option.value=e.get("preview_option")})),this.fragment=Backbone.history.getFragment().split("/"),TVA.globals.availableSettingsModel?this.renderDesign():(TVA.globals.availableSettingsModel=new o,TVA.globals.availableSettingsModel.fetch().success((function(){return e.renderDesign()})))},render:function(){return this},renderDesign:function(){var e=TVA.courses.toArray().filter((function(e){return"publish"===e.get("status")}));return this.model.get("preview_option")&&0===e.length&&this.model.set({preview_option:!1}),0===e.length&&TVA.settings.show_hi_professor_modal&&(this.openModal(s(169),{model:new Backbone.Model,"max-width":"60%",width:"800px"}),delete TVA.settings.show_hi_professor_modal),this.$el.html(this.template({model:this.model,published:e})),this.renderSettings(this.fragment[1]),this.renderPreview(),TVE_Dash.materialize(this.$el),this.$(".scrollbar-inner").scrollbar(),this},renderSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"template",t=null;l[e]&&(t=l[e]),this.settings=new t({model:this.model,collection:this.collection,available_settings:TVA.globals.availableSettingsModel,el:this.$(".tva-options-container")})},renderPreview:function(){this.$("#tva-preview-"+(this.model.get("preview_option")?"live":"demo")).addClass("active"),new r({model:this.model,el:this.$(".tva-template-container")})},setActivePreview:function(e,t){var s=this,i=parseInt(t.getAttribute("data-preview"));a.prototype.save.apply(this,[]).always((function(){wp.apiRequest({type:"POST",url:"".concat(TVA.routes.settings_v2,"/switch_preview/"),data:{key:"preview_option",value:i}}).done((function(e,t,n){200===n.status&&(s.model.set({preview_option:i}),s.renderDesign())})).fail((function(){TVE_Dash.hideLoader()}))}))}})},function(e,t,s){var i=s(1),n=s(12);e.exports=i.extend({template:TVE_Dash.tpl("design/welcome"),className:"tva-wiz-welcome",gotIt:function(){new n({key:"visual_editor_welcome",value:1}).save(),TVA.Router.menuItems.findWhere({slug:"design"}).set({route:"#design"}),TVA.Router.navigate("#design",{trigger:!0})}})},function(e,t,s){var i,n,r,o,a;i=jQuery,r=s(173),o=s(12),a=s(300),e.exports=s(1).extend({template:TVE_Dash.tpl("settings/email-templates"),initialize:function(){n instanceof a||(n=new a(Object.values(TVA.emailTemplates))),this.collection=n,this.emailServiceSetting=new o({key:"email_service",value:TVA.settings.email_service.value})},render:function(){return this.$el.html(this.template()),this.$("#email-template").select2(),this.$apiSelect=this.$("#tva-email-apis"),this.afterRender(),this},afterRender:function(){var e=this;this.$select=this.$("#email-template"),this.$formWrapper=this.$("#tva-email-template-form-wrapper"),this.collection.each((function(t){e.$select.append(i("<option/>").text(t.get("name")).val(t.get("slug")))})),1===this.collection.length&&this.$select.val(this.collection.first().get("slug")).trigger("change"),this.$apiSelect.empty(),TVA.connected_email_providers.forEach((function(t){var s=e.emailServiceSetting.get("value")===t.id,n="campaignmonitoremail"===t.id?"campaignmonitor":t.id,r="".concat(TVE_Dash_Const.dash_url,"/inc/auto-responder/views/images/").concat(n,".png"),o=i('<option value="'.concat(t.id,'" data-image="').concat(r,'">').concat(t.name,"</option>"));s&&o.prop("selected",!0),e.$apiSelect.append(o)})),this.$apiSelect.select2({minimumResultsForSearch:-1,templateResult:this.select2ImageItemRenderer,templateSelection:this.select2ImageItemRenderer}).data("select2").$dropdown.addClass("tva-email-apis-select-dropdown")},select2ImageItemRenderer:function(e){return e.element&&e.element.dataset.image?i('<span><span class="opt-image" style="background-image: url(\''.concat(e.element.dataset.image,"')\"></span><span>").concat(e.text,"</span></span>")):e.text},selectApiConnection:function(e,t){this.emailServiceSetting.setValue(t.value).save()},renderEmailTemplate:function(e,t){var s=t.value;0!==s.length?this.$formWrapper.html(new r({model:this.collection.findWhere({slug:s})}).render().$el):this.$formWrapper.empty()}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a,c,l,u,d;o=jQuery,a=s(1),c=s(301),l=s(180),u=s(70),d=s(56),e.exports=a.extend({template:TVE_Dash.tpl("settings/logs"),searchDefaultParams:{s:"",types:[]},initialize:function(){a.prototype.initialize.apply(this,arguments),this.collection=new c(TVA.logs.items,{total:TVA.logs.total}),this.types=TVA.logs.types,this.listenTo(this.collection,"fetched",_.bind(this.renderData,this))},afterRender:function(){this.$filters=this.$("#tva-logs-filters"),this.$content=this.$("#tva-logs-content"),this.$pagination=this.$(".tva-pagination"),Array.isArray(this.types)&&this.types.length>0&&this.renderTypes(),this.renderSearch(),this.renderData(),this.renderPagination()},renderTypes:function(){var e=this;this.$select=o('<select multiple="multiple"></select>'),this.$clearSelect=o('<span id="tva-clear-dropdown-filter" style="max-width:100px;" class="tva-customers-clear click" data-fn="clearDropdownFilter">'.concat(TVA.Utils.icon("cross")," Clear Filters</span>")).hide(),this.$filters.append(this.$select),this.$filters.append(this.$clearSelect),this.types.forEach((function(t){var s=o("<option/>").val(t.type).text(t.type);e.$select.append(s)})),this.$select.select2({closeOnSelect:!1,allowHtml:!0,allowClear:!0,tags:!0}).on("select2:select select2:unselect",(function(){return e._handleLogsFilterSelection()})).trigger("select2:select").data("select2").$dropdown.addClass("tva-select2-with-checkboxes")},_handleLogsFilterSelection:function(){var e=this.$select.val(),t="Filters ".concat(TVA.Utils.icon("filter"));this.$clearSelect.toggle(Array.isArray(e)&&e.length>0),Array.isArray(e)&&e.length>0&&(t="".concat(e.length," ").concat(1===e.length?"Filter":"Filters"," Active ").concat(TVA.Utils.icon("filter"))),this.$(".select2-selection").html(t),this.searchDefaultParams=n(n({},this.searchDefaultParams),{types:e||[]}),this.collection.search(this.searchDefaultParams)},clearDropdownFilter:function(){this.$select.val("").trigger("select2:select")},renderSearch:function(){var e=this,t=new u({placeholder:"Search Logs..."});this.$(".tva-logs-search").append(t.render().$el),t.on("change",(function(t){e.searchDefaultParams=n(n({},e.searchDefaultParams),{s:t}),e.collection.search(e.searchDefaultParams)}))},renderData:function(){var e=this;this.$content.empty(),this.collection.each((function(t){e.$content.append(new l({model:t}).render().$el)})),this.$(".tvd-collection-header:not(.ttw-table-header), .tvd-collection-item:not(.ttw-table-header)").hide()},renderPagination:function(){new d({el:this.$pagination,collection:this.collection,noItemTemplate:TVE_Dash.tpl("settings/logs-empty-list")}).render()}})},function(e,t,s){var i=s(85);e.exports=s(16).extend({template:TVE_Dash.tpl("modals/courses/item"),afterInitialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.model||(this.model=new i({course_id:e.course.get("id"),order:parseInt(this.structure.length),post_parent:isNaN(parseInt(e.post_parent))?0:parseInt(e.post_parent)}))},afterRender:function(){return new(s(48))({el:this.$_content,model:this.model}).render(),this},save:function(){var e=this,t=this.model.save(null,{success:function(t){e.structure.add(t);var s=TVA.courses.findWhere({id:e.course.get("id")});s&&s.trigger("tva.structure.modified",t)}});t&&(TVE_Dash.showLoader(),t.always((function(){TVE_Dash.hideLoader(),e.close()})))}})},function(e,t,s){var i,n,r;i=jQuery,n=s(7),r=s(181),e.exports=r.extend({template:TVE_Dash.tpl("modals/courses/content"),warningTemplate:TVE_Dash.tpl("courses/merge-warning"),$parentsSelect:null,$description:null,targetStructure:null,events:i.extend(r.prototype.events,{"change #tva-parent-target":function(e){var t=this;i(e.currentTarget).siblings("#tva-child-target").select2("destroy").remove();var s=isNaN(parseInt(e.currentTarget.value))?0:parseInt(e.currentTarget.value),r=this.structure.findItem(s);if(this.itemModel.set("post_parent",s),r&&r.get("structure")instanceof n&&(this.targetStructure=r.get("structure")),r&&"module"===r.getType()&&"chapters"===r.get("structure").getType()){this.itemModel.set("post_parent",0);var o=i("<select/>").attr("id","tva-child-target").append('<option value="">'.concat(TVA.t.SelectChapter,"</option>")).on("change",(function(e){var s=isNaN(parseInt(e.currentTarget.value))?0:parseInt(e.currentTarget.value),i=t.structure.findItem(s);t.itemModel.set("post_parent",s),i&&i.get("structure")instanceof n&&(t.targetStructure=i.get("structure"))}));this.$step.find(".tvd-modal-content").append(o),r.get("structure").each((function(e){o.append('<option value="'.concat(e.get("id"),'">').concat(e.get("post_title"),"</option>"))})),o.select2()}}}),afterRender:function(){return r.prototype.afterRender.apply(this,arguments),this.$description=this.$("#tva-item-description"),this.$parentsSelect=this.$("#tva-parent-target"),this},decisionMaking:function(e,t){var i=t.dataset.type,n=s(215)("./".concat(i));if(this.itemModel=new n({course_id:this.course.get("id"),order:this.structure.length}),0===this.structure.length)return this.gotoStep(2),this.renderForm();switch(this.itemModel.getType()){case"lesson":switch(this.structure.getType()){case"lessons":return this.next(),this.renderForm();case"chapters":case"modules":return this.renderParentsDropDowns()}break;case"chapter":switch(this.structure.getType()){case"chapters":return this.next(),this.renderForm();case"modules":return this.renderParentsDropDowns();case"lessons":this.itemModel.set("merge_items",this.structure.pluck("id"));var r=this.structure.where({post_status:"publish"});return this.itemModel.set("post_status",r.length>0?"publish":"draft"),this.renderWarning()}break;case"module":switch(this.structure.getType()){case"lessons":case"chapters":this.itemModel.set("merge_items",this.structure.pluck("id"));var o=this.structure.where({post_status:"publish"});return this.itemModel.set("post_status",o.length>0?"publish":"draft"),this.renderWarning();case"modules":return this.next(),this.renderForm()}}},parentSet:function(){if(this.itemModel.get("merge_items"))return this.next(),void this.renderForm();var e=this.targetStructure?this.targetStructure.getType():this.structure.getType();if(!this.itemModel.get("post_parent"))return TVE_Dash.err(TVE_Dash.sprintf(TVA.t.PleaseSelect,"modules"===e?TVA.t.module:TVA.t.chapter));if("lessons"===this.targetStructure.getType()&&"chapter"===this.itemModel.getType()){var t=this.structure.where({post_status:"publish"});return this.itemModel.set("post_status",t.length>0?"publish":"draft"),this.itemModel.set("merge_items",this.targetStructure.pluck("id")),this.renderWarning()}this.next(),this.renderForm()},renderParentsDropDowns:function(){var e=this;switch(this.$parentsSelect.empty(),this.structure.getType()){case"chapters":this.$description.text("In which chapter you would like to add your lesson"),this.$parentsSelect.append(i('<option value="">'.concat(TVA.t.SelectChapter,"</option>")));break;case"modules":this.$description.text(TVE_Dash.sprintf(TVA.t.WhichModule,this.itemModel.getType())),this.$parentsSelect.append(i('<option value="">'.concat(TVA.t.SelectModule,"</option>")))}this.structure.each((function(t){e.$parentsSelect.append(i('<option value="'.concat(t.get("id"),'">').concat(t.get("post_title"),"</option>")))})),this.$parentsSelect.select2()},renderWarning:function(){this.$step.find(".tvd-modal-content").html(this.warningTemplate())},backToStepZero:function(){this.gotoStep(0)},renderForm:function(){new(s(270)("./".concat(this.itemModel.getType())))({el:this.$step.find("> .tvd-modal-content"),model:this.itemModel}).render()},save:function(){var e=this,t=this.itemModel.save(null,{success:function(t){if(e.targetStructure)if("lessons"===e.targetStructure.getType()&&"chapter"===t.getType()){var s=new n(e.targetStructure.toJSON());s.updateModels({post_parent:t.get("id")}),t.set("structure",s),e.targetStructure.reset([e.itemModel])}else e.targetStructure.add(t);else if(t.get("merge_items")){var i=new n(e.structure.toJSON());i.updateModels({post_parent:t.get("id")}),t.set("structure",i),e.structure.reset([e.itemModel])}else e.structure.add(t);var r=TVA.courses.findWhere({id:e.course.get("id")});r&&r.trigger("tva.structure.modified",t)}});t&&(TVE_Dash.showLoader(),t.always((function(){e.close(),TVE_Dash.hideLoader()})))}})},function(e,t,s){var i=s(86);e.exports=s(16).extend({template:TVE_Dash.tpl("modals/courses/item"),afterInitialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.model||(this.model=new i({course_id:e.course.get("id"),order:this.structure.length,post_parent:this.parentModel instanceof Backbone.Model?this.parentModel.get("id"):0,comment_status:this.parentModel instanceof Backbone.Model?this.parentModel.get("comment_status"):"closed"}))},afterRender:function(){return new(s(49))({el:this.$_content,model:this.model}).render(),this},save:function(){var e=this,t=this.model.save(null,{success:function(t){e.structure.add(t);var s=TVA.courses.findWhere({id:e.course.get("id")});s&&s.trigger("tva.structure.modified",t),e.lesson.trigger("render")}});t&&(TVE_Dash.showLoader(),t.always((function(){TVE_Dash.hideLoader(),e.close()})))}})},function(e,t,s){var i=s(83);e.exports=s(16).extend({template:TVE_Dash.tpl("modals/courses/item"),afterInitialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.model||(this.model=new i({course_id:e.course.get("id"),order:this.structure.length}))},afterRender:function(){return new(s(50))({el:this.$_content,model:this.model}).render(),this},save:function(){var e=this,t=this.model.get("structure"),s=this.model.changedAttributes();!1!==s&&Object.keys(s).includes("comment_status")&&t.updateChildrenCommentStatus(this.model.get("id"),this.model.get("comment_status"));var i=this.model.save(null,{success:function(s){e.structure.add(s),s.set("structure",t);var i=TVA.courses.findWhere({id:e.course.get("id")});i&&i.trigger("tva.structure.modified",s)}});i&&(TVE_Dash.showLoader(),i.always((function(){TVE_Dash.hideLoader(),e.close()})))}})},function(e,t,s){e.exports=s(28).extend({template:TVE_Dash.tpl("modals/edit-customer")})},function(e,t,s){e.exports=s(3).extend({template:"modals/products/content-sets",dom:function(){this.$setsContainer=this.$(".tva-content-sets-container"),this.$formContainer=this.$(".tva-content-sets-form-container"),TD_SETS.sets.resetFilters(),this.ListView=new TD_SETS.Views.List({collection:TD_SETS.sets,product:this.model,modal:this}),this.$setsContainer.html(this.ListView.render().$el)}})},function(e,t,s){e.exports=s(187).extend({template:TVE_Dash.tpl("access-restriction/states/wizard/create")})},function(e,t,s){e.exports=s(188)},function(e,t,s){e.exports=s(111)},function(e,t,s){e.exports=s(189)},function(e,t,s){e.exports=s(112)},function(e,t,s){var i,n,r,o,a,c;i=jQuery,n=s(98),r=s(2),o=s(70),a=s(1),c=s(25),e.exports=a.extend({className:"tva-products",template:TVE_Dash.tpl("products/list"),templateNoItem:TVE_Dash.tpl("products/no-item"),templateNoSearchResult:TVE_Dash.tpl("products/no-search-result"),templateItem:TVE_Dash.tpl("products/list-item"),searchFilterView:null,dragHandleSelector:".tva-drag-handle",isLoading:!0,afterInitialize:function(){var e=this;i(window).scroll(this.checkScroll.bind(this)),i(window).on("resize",this.checkWindowScroll.bind(this)),this.collection=TVA.products,this.listenTo(this.collection,"total-changed",this.loadResults),this.listenTo(this.collection,"fetched",this.loadResults),this.listenTo(this.collection,"fetching",(function(){return e.$loadingNotice.show()}))},afterRender:function(){this.$itemsWrapper=this.$(".tva-products-wrapper").empty(),this.$filters=this.$("#tva-products-filters-wrapper"),this.$loadingNotice=this.$(".tva-loading-notice").hide(),this.$productsCounter=this.$("#tva-products-counter"),this.$hideFor0Products=this.$(".tva-hide-for-no-products"),this.renderProducts(),this.renderSearchFilter(),this.$itemsWrapper.sortable({items:"> .tva-product",handle:this.dragHandleSelector,placeholder:"tva-drag-placeholder",forcePlaceholderSize:!0,tolerance:"pointer",update:this.updateOrderNumbers.bind(this)})},updateOrderNumbers:function(){if(0!==TVA.products.length){var e=this.$itemsWrapper.sortable("option","items"),t=this.$itemsWrapper.find(e),s=t.length-1,i=new r;t.each((function(e,t){i.set(t.dataset.id,s-e)})),i.url="".concat(TVA.routes.products,"/update_orders"),TVE_Dash.showLoader(),i.save().done((function(e){e&&(t.reverse().each((function(e,t){return TVA.products.findWhere({id:parseInt(t.getAttribute("data-id"))}).set({order:e},{silent:!0})})),TVA.products.sort(),TVE_Dash.hideLoader())}))}},renderSearchFilter:function(){var e=this;this.searchFilterView=new o({placeholder:TVA.t.searchProducts+"...",value:this.collection.hasFilters()?this.collection.getFilter("search",""):""}),this.addChild(this.searchFilterView),this.$filters.append(this.searchFilterView.render().$el),this.searchFilterView.on("change",(function(t){return t.trim().length>0?e.collection.search({search:t}):e.collection.resetAndFetch()}))},renderProducts:function(){return this.$itemsWrapper.empty(),0===this.collection.length?this.collection.hasFilters()?this.$itemsWrapper.html(this.templateNoSearchResult()):(this.$hideFor0Products.hide(),this.$itemsWrapper.html(this.templateNoItem())):this.$hideFor0Products.show(),this.renderCollection().checkWindowScroll(),this},addNewProduct:function(e,t){var s=this;this.collection.hasFilters()?this.collection.resetAndFetch().done((function(){return s.addNewProduct(e,t)})):this.openModal(n,{collection:this.collection,screen:t.getAttribute("data-screen"),width:"760px",className:"tvd-modal tva-new-product-modal"})},renderCollection:function(){var e=this;return this.itemViews&&this.itemViews.forEach((function(e){return e.destroy()})),this.itemViews=[],this.contentProducts=[],this.collection.each((function(t){var s=new c({model:t,collection:e.collection,allowDrag:!0,showCustomersNumber:!0,showTooltipDot:!0});t.getContent().forEach((function(t){void 0===e.contentProducts[t]?e.contentProducts[t]=1:e.contentProducts[t]++})),e.itemViews.push(s),e.$itemsWrapper.append(s.render().$el)})),this.itemViews.forEach((function(t){t.model.getContent().forEach((function(s){e.contentProducts[s]>1&&t.$el.addClass("tva-tooltip-enabled")}))})),this.addChild(this.itemViews),this.$(".tva-product-item").toggleClass("tva-drag-disabled",this.collection.hasFilters()),this.isLoading=!1,this.$productsCounter.html(TVA.Utils._n(this.collection.total,"product","products")),this},checkScroll:function(){var e=this.collection.pageInfo();return e.currentPage>=e.totalPages||!this.isLoading&&this.$el[0].scrollTop+this.$el[0].clientHeight+100>this.$el[0].scrollHeight&&(this.isLoading=!0,this.collection.next()),this},checkWindowScroll:function(){return document.body.scrollHeight>document.body.clientHeight||this.checkScroll(),this},loadResults:function(){this.renderProducts(),this.$loadingNotice.hide()}})},function(e,t,s){var i=s(1);e.exports=i.extend({template:TVE_Dash.tpl("reports/quiz")})},function(e,t,s){e.exports=s(1).extend({template:TVE_Dash.tpl("settings/sendowl"),render:function(){return this.$el.html(this.template()),this},changeSendOwlView:function(e,t){this.changeView(t.getAttribute("data-route"))}})},function(e,t,s){var i=s(1),n=s(6);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/checkout"),afterInitialize:function(){this.model=new Backbone.Model({state:"register"})},afterRender:function(){this.$(".tva-page-container").html(TVE_Dash.tpl("settings/sendowl/checkout-content")),new n({el:this.$(".tva-so-checkout-tabs"),model:this.model,states_views_path:"./sendowl/tabs/checkout-states/"}).render(),this.$("[data-tab=".concat(this.model.get("state"),"]")).addClass("tva-active-tab")},click:function(e,t){e.stopPropagation(),this.model.set("state",t.dataset.tab),this.$(".tva-active-tab").removeClass("tva-active-tab"),this.$("[data-tab=".concat(t.dataset.tab,"]")).addClass("tva-active-tab")}})},function(e,t,s){var i=s(1);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/create-product")})},function(e,t,s){var i=s(1),n=s(220);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/integration"),afterInitialize:function(){this.model=new n(TVA.settings.account_keys.value)},input:function(e,t){var s={};s[t.getAttribute("data-field")]=t.value,this.model.set(s)},save:function(e,t){this.model.isValid()?(TVE_Dash.showLoader(),t.setAttribute("disabled","true"),this.model.save(null,{success:function(e,t){TVA.settings.account_keys.value=e.toJSON(),TVE_Dash.success(t.message)},error:function(e,t){TVE_Dash.err(t.responseJSON.message)},complete:function(){TVE_Dash.hideLoader(),t.removeAttribute("disabled")}})):TVE_Dash.err(this.model.getValidationError())}})},function(e,t,s){var i=s(1),n=s(190),r=s(191);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/links"),className:"tva-purchase",optionSelectedClass:"tva-selected",activeOption:null,activeDiscount:null,linksInputView:null,linksQueryString:{pp:"Sendowl"},afterRender:function(){this.$options=this.$(".tva-so-options"),this.$optionContent=this.$(".tva-option-content"),this.$discountContent=this.$(".tva-discount-content"),this.$linksContent=this.$(".tva-links-content"),requestAnimationFrame(TVA.Utils.rebindWistiaFancyBoxes)},selectOption:function(e,t){this.$options.removeClass(this.optionSelectedClass);var s=t.getAttribute("data-option"),i=t.getAttribute("data-query-string"),n=t.getAttribute("data-option-button-label"),r=t.getAttribute("data-option-discount-label");this.linksQueryString={pp:"Sendowl"},this._removeLinksInputView(),this._renderOption(s,n,i),this._renderDiscount(r),this.activeDiscount.toggle(this.activeOption.hasData()),t.classList.add(this.optionSelectedClass)},_renderOption:function(e,t,s){var i=this;this.activeOption instanceof n&&(delete this.linksQueryString[this.activeOption.queryStringName],this.activeOption.remove()),this.activeOption=new n({option:e,button_label:t,queryStringName:s}),this.activeOption.selectChange=function(e,t){i.activeDiscount.toggleDisabled(!1),i.linksQueryString[i.activeOption.queryStringName]=t.value,i._renderLinks()},this.activeOption.refreshDataCallback=function(){var e=i.activeOption.hasData();i.activeDiscount.toggle(e)},this.$optionContent.append(this.activeOption.render().$el)},_renderDiscount:function(e){var t=this;this.activeDiscount instanceof n&&(delete this.linksQueryString[this.activeOption.queryStringName],this.activeDiscount.remove()),this.activeDiscount=new n({option:"discounts",button_label:e,queryStringName:"thrv_so_discount"}),this.activeDiscount.selectChange=function(e,s){t.linksQueryString[t.activeDiscount.queryStringName]=s.value,t._renderLinks()},this.$discountContent.append(this.activeDiscount.render().$el),this.activeDiscount.toggleDisabled(!0)},_renderLinks:function(){this._removeLinksInputView(),this.linksInputView=new r({queryParams:this.linksQueryString}),this.$linksContent.html(this.linksInputView.render().$el)},_removeLinksInputView:function(){this.linksInputView instanceof r&&this.linksInputView.remove()}})},function(e,t,s){var i=s(1);e.exports=i.extend({afterInitialize:function(){var e=this;this.model=new Backbone.Model,this.listenTo(this.model,"tva.so-guide-change",(function(){e.setSteps(),e.render()})),this.setSteps()},setSteps:function(){var e=TVA.sendowl,t=_.isNumber(TVA.settings.checkout_page.value)&&parseInt(TVA.settings.checkout_page.value)>0,s=_.isNumber(TVA.settings.thankyou_page.value)&&parseInt(TVA.settings.thankyou_page.value)>0,i=_.isNumber(TVA.settings.thankyou_page_type.value)&&parseInt(TVA.settings.thankyou_page_type.value)>0,n=TVA.settings.account_keys.value&&TVA.settings.account_keys.value.secret,r="redirect"===TVA.settings.thankyou_page_type.value,o={step1Completed:Array.isArray(e.bundles)&&e.bundles.length>0||Array.isArray(e.products)&&e.products.length>0,step2Completed:t&&(s||r||i),step3Completed:t,step4Completed:n,step5Completed:TVA.courses.length>0,step6Completed:TVA.courses.getSendOwlItems().length>0,step7Completed:n};this.model.set(o)},template:TVE_Dash.tpl("settings/sendowl/quick-start")})},function(e,t,s){var i=s(1),n=s(6),r=s(5);e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/register-page"),afterInitialize:function(){this.model=new r(TVA.settings.checkout_page)},afterRender:function(){new n({el:this.$(".tva-so-checkout-reg"),model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your registration page"},normal:{title:"Registration Page"},delete:{title:"Are you sure you want to remove this registration page?"}},afterRender:function(){if("normal"===this.model.attributes.state&&this.model.attributes.value){for(var e in TVA.settings.checkout_page)TVA.settings.checkout_page[e]="value"===e?parseInt(this.model.attributes[e]):this.model.attributes[e];this.model.trigger("tva.so-guide-change")}}}).render(),requestAnimationFrame(TVA.Utils.rebindWistiaFancyBoxes)}})},function(e,t,s){var i,n;jQuery,i=s(1),n=s(192),e.exports=i.extend({template:TVE_Dash.tpl("settings/sendowl/thankyou-page"),afterInitialize:function(){this.model=new Backbone.Model({type:TVA.settings.thankyou_page_type.value}),this.listenTo(this.model,"change:type",this.render)},afterRender:function(){this.renderCards(),this.renderPageOptions(),TVA.settings.thankyou_page_type.value=this.model.attributes.type,this.model.trigger("tva.so-guide-change")},renderCards:function(){this.cardsView=new n({el:this.$(".tva-cards"),model:this.model}),this.cardsView.render()},renderPageOptions:function(){try{new(s(302)("./".concat(this.model.get("type"),".js")))({el:this.$(".tva-thankyou-wrapper"),model:this.model}).render()}catch(e){}}})},function(e,t,s){var i=s(1);e.exports=i.extend({})},function(e,t,s){var i,n,r;jQuery,i=s(1),n=s(5),r=s(6),e.exports=i.extend({initialize:function(){i.prototype.initialize.apply(this,arguments),this.model=new n(TVA.settings.thankyou_page)},afterRender:function(){new r({el:this.$el,model:this.model,states_views_path:"./page-states/",labels:{search:{title:"Set your register page"},normal:{title:TVA.t.setTyPage},delete:{title:"Are you sure you want to remove this register page?"}}}).render()}})},function(e,t,s){var i,n,r,o,a;jQuery,i=s(12),n=s(6),r=s(111),o=s(5),a=s(2),e.exports=s(1).extend({template:TVE_Dash.tpl("settings/general"),initialize:function(){var e=Object.values(TVA.settings).filter((function(e){return"general"===e.category}));this.model=new Backbone.Model(e.reduce((function(e,t){return Object.assign(e,function(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}({},t.name,t))}),{})),this.registerPageModel=new o(TVA.settings.register_page),this.listenTo(TVA.indexPageModel,"sync",(function(e){Array.isArray(TVA.design.demo_courses)&&TVA.design.demo_courses.forEach((function(t){t.preview_url=e.get("preview_url")+t.slug})),TVA.courses.fetch(),TVA.courses.where({fetched:!0}).forEach((function(e){e.set("fetched",!1)}))}))},render:function(){return this.$el.html(this.template({model:this.model,visualEditingEnabled:TVA.visualEditingEnabled})),this.afterRender(),this},afterRender:function(){var e=this;this.$("[data-toggle-setting]").each((function(t,s){e.toggleElementsDependencies(s)})),new n({el:this.$(".tva-course-states-container"),model:TVA.indexPageModel,states_views_path:"./page-states/",labels:{search:{title:"Set your courses page"},normal:{title:"Courses Page"},delete:{title:"Are you sure you want to remove this course page?"}},settings:{search:{ajaxData:{no_landing_pages:1}}},afterRender:function(){this.$(".tva-edit-page-with-tar").remove()}}).render(),new n({el:this.$("#tva-clear-cache-states-container"),templates:{normal:TVE_Dash.tpl("states/simple"),delete:TVE_Dash.tpl("states/delete")},callbacks:{confirm:this.clearCertificatesCache},labels:{normal:{title:TVA.t.clear_certificate_cache}},model:new a({state:"normal",id:123}),states_views_path:"./page-states/"}).render(),TVA.settings.certificate_verification.value&&this.renderValidationPage(new o(TVA.settings.certificate_validation_page))},changeSettingCheckbox:function(e,t){var s=this,i=t.checked?t.getAttribute("data-val-checked")||1:t.getAttribute("data-val-not-checked")||0;this._save(t.getAttribute("data-field"),i).then((function(e){"certificate_validation_page"===e.name&&s.renderValidationPage(new o(e))})).always((function(){TVE_Dash.hideLoader()})),this.toggleElementsDependencies(t)},renderValidationPage:function(e){new r({template:TVE_Dash.tpl("states/validation-page"),el:this.$("#tva-validation-page-wrapper"),model:e}).render()},toggleElementsDependencies:function(e){var t=e.getAttribute("data-toggle-setting"),s=!!e.getAttribute("data-toggle-value");t&&this.$(t).toggle(s===e.checked)},input:function(e,t){var s=t.value;"number"===t.type&&(s=Number(s)),this._save(t.getAttribute("data-field"),s).always((function(){TVE_Dash.hideLoader()}))},clearCertificatesCache:function(e){e.url="".concat(TVA.routes.certificate,"/clear-cache"),TVE_Dash.showLoader();var t=e.destroy();t&&t.always((function(){e.set("state","normal"),TVE_Dash.hideLoader()}))},_save:function(e,t){if(TVE_Dash.showLoader(),!TVA.visualEditingEnabled||"load_scripts"!==e){this.model.get(e).value=t,TVA.settings[e].value=t;var s=new i({key:e,value:t});if(s.isValid())return s.save();TVE_Dash.err(s.validationError.message)}}})},function(e,t,s){function i(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(e);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}function r(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?r(Object(s),!0).forEach((function(t){a(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function a(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function c(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}var l,u,d,h,p,m,g,f,v,b,y;l=jQuery,u=s(90),d=s(136),h=s(70),p=s(56),m=s(183),g=s(184),f=s(1),v=s(75),b=s(269),y=Backbone.Collection.extend({getItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];return e+="###",this.toJSON().forEach((function(s){s.id=e+s.id,t.push(s)})),t}}),e.exports=f.extend({$filters:null,$pagination:null,searchFilterView:null,template:TVE_Dash.tpl("customers/list"),ensureData:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(TVA.customers instanceof Backbone.Collection&&10===TVA.customers.length)){e.next=6;break}t.collection=TVA.customers,t.products=TVA.allProducts,t.setupCollectionListeners(),e.next=8;break;case 6:return TVE_Dash.showLoader(),e.abrupt("return",new Promise((function(e){wp.apiRequest({url:TVA.routes.customer,data:{limit:10}}).done((function(e){t.collection=TVA.customers=new b(e.items,{total:e.total}),t.products=TVA.allProducts=e.products,t.setupCollectionListeners()})).always(e)})));case 8:case"end":return e.stop()}}),e)})),function(){var t=this,s=arguments;return new Promise((function(i,n){var r=e.apply(t,s);function o(e){c(r,i,n,o,a,"next",e)}function a(e){c(r,i,n,o,a,"throw",e)}o(void 0)}))})()},setupCollectionListeners:function(){var e=this;this.collection.on("fetching",(function(){e.$customers.tvaToggleLoader(20,!0)})),this.collection.on("fetched",(function(){e.renderCustomers(),e.$customers.tvaToggleLoader(20,!1)}))},destroy:function(){f.prototype.destroy.apply(this,arguments),this.collection.hasFilters()&&this.collection.resetFilters().fetch()},render:function(){var e=this;return TVA.migrate_access&&1===parseInt(TVA.migrate_access.should_migrate)?u.getInstance():(this.$el.html(this.template()),this.$filters=this.$("#tva-filters-wrapper"),this.$customers=this.$("#tva-customers"),this.$pagination=this.$(".tva-pagination"),this.renderDropdownFilter(),this.searchFilterView=this.renderSearchFilter().on("change",(function(t){var s=o({},{s:t});if(e.$("#tva-dropdown-filter").length){var i=e.$("#tva-dropdown-filter").val();if("0"!==i){var n=i.split("###");s[n[0]]=n[1]}}e.$(".tva-no-students").empty(),e.$customers.tvaToggleLoader(),e.fetchOrdered(s)})),this.renderCustomers(),this.renderPagination(),this.afterRender()),TVE_Dash.hideLoader(),this},renderCustomers:function(){var e=this;this.$customers.empty(),this.collection.each((function(t){var s=new v({model:t,collection:e.collection,customer:t});e.$customers.append(s.render().$el)})),this.$(".tva-students-total").html(this.collection.total),this.$(".tva-students-label").html(TVA.Utils._n(this.collection.total,"student","students",!1)),this.$pagination.toggleClass("tva-flex-start",0===this.collection.length)},renderSearchFilter:function(){var e=new h;return this.$filters.append(e.render().$el),e},dropdownFilterChange:function(e,t){var s=t.value.split("###"),i=o({},{s:this.searchFilterView.getValue()});this.$(".tva-no-students").empty(),i[s[0]]=s[1],this.$customers.tvaToggleLoader(),this.fetchOrdered(i)},renderDropdownFilter:function(){var e=[],t="Search";e=[].concat(i(e),[{id:"TA_Products_OptionGroup",name:"Products",option_group:1}],i(new y(this.products).getItems("ta_product_id"))),e=[].concat(i(e),[{id:"Courses_OptionGroup",name:"Courses",option_group:1}],i(new y(TVA.courses.models).getItems("course_id"))),TVA.sendowl.is_available&&(e=[].concat(i(e),[{id:"Products_OptionGroup",name:"SendOwl Products",option_group:1}],i(new y(TVA.sendowl.products).getItems("product_id"))),e=[].concat(i(e),[{id:"Bundles_OptionGroup",name:"SendOwl Bundles",option_group:1}],i(new y(TVA.sendowl.bundles).getItems("bundle_id"))),t+=" course, product, bundles..."),e.unshift({id:0,name:"All members"});var s=l('<select id="tva-dropdown-filter" class="change" data-fn="dropdownFilterChange"><option></option></select>');e.forEach((function(e){s.append(e.option_group?'<optgroup label="'.concat(e.name,'"></optgroup>'):l("<option/>").val(e.id).text(e.name))})),s.find('option[value="0"]').attr("selected","selected"),this.$filters.append(s),s.select2({placeholder:"Filter by product"}).on("select2:open",(function(){l("input.select2-search__field").prop("placeholder",t)})).data("select2").$dropdown.addClass("tva-customers-select")},renderPagination:function(){new p({el:this.$pagination,collection:this.collection,noItemTemplate:TVE_Dash.tpl("customers/empty-list")}).render()},afterInsert:function(){window.thriveReportsInit(this.el,"students")},addCustomer:function(){var e=this;TVE_Dash.showLoader(),TVA.products.getAll().then((function(){TVE_Dash.hideLoader(),e.openModal(m,{model:new d({}),collection:e.collection,width:"1180px",top:"40px",className:"tvd-modal tvd-modal-big"})}))},importCustomer:function(){var e=this;TVE_Dash.showLoader(),TVA.products.getAll().then((function(){TVE_Dash.hideLoader(),e.openModal(g,{model:new d({}),collection:e.collection,width:"1180px",top:"40px",className:"tvd-modal tvd-modal-big"})}))},orderBy:function(e){var t=l(e.currentTarget),s=e.currentTarget.dataset.col,i="asc"===e.currentTarget.dataset.order?"desc":"asc";t.attr("data-order",i),t.toggleClass("tva-rotate-90"),this.collection.ordering={},this.collection.ordering[s]=i,this.$customers.tvaToggleLoader(),this.fetchOrdered()},fetchOrdered:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};0!==Object.keys(t).length&&(this.collection.filters=t),this.collection.fetchWithData().success((function(t){e.collection.reset(t.items),e.collection.total=t.total,e.collection.resetPagination(),TVA.customers=e.collection,e.collection.trigger("fetched")}))}})},function(e,t,s){var i=s(15),n=s(19);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/access-restrictions"),itemsContainer:function(){return this.$(".tva-labels-grid")},toggleLabelsSection:function(e){return this.$(".tva-user-contexts").toggleClass("tva-expanded"),this.settings.set("switch_labels",e.currentTarget.checked),this.settings.save(),!1},afterRender:function(){var e=this;this._renderContextItems(this.$(".tva-user-contexts"),TVA.dynamicLabelSetup.userLabelContexts,TVA.dynamicLabelSetup.userLabelDefaults,n,(function(t){return e.settings.getUserContextLabel(t)}))}})},function(e,t,s){var i=s(15),n=s(109);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/call-to-action-buttons"),afterRender:function(){var e=this;this._renderContextItems(this.$("#tva-cta-buttons"),TVA.dynamicLabelSetup.ctaLabelContexts,TVA.dynamicLabelSetup.ctaLabelDefaults,n,(function(t){return e.settings.getCTAButtonLabel(t)}))}})},function(e,t,s){var i=s(15),n=s(175);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-content-types"),afterRender:function(){var e=this;this._renderContextItems(this.$("#tva-course-type-labels"),TVA.dynamicLabelSetup.courseTypeLabelContexts,TVA.dynamicLabelSetup.courseTypeLabelDefaults,n,(function(t){return e.settings.getCourseTypeLabel(t)}))}})},function(e,t,s){var i=s(15),n=s(109),r=s(179);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-navigation"),afterRender:function(){var e=this;this._renderContextItems(this.$("#tva-course-navigation"),TVA.dynamicLabelSetup.courseNavigationContexts,TVA.dynamicLabelSetup.courseNavigationDefaults,n,(function(t){return e.settings.getCourseNavigationLabel(t)})),this._renderContextItems(this.$("#tva-course-navigation-warnings"),TVA.dynamicLabelSetup.courseNavigationWarnings,TVA.dynamicLabelSetup.courseNavWarningsDefaults,r,(function(t){return e.settings.getCourseNavigationLabel(t)}))}})},function(e,t,s){var i=s(15),n=s(178);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-progress"),afterRender:function(){var e=this;this._renderContextItems(this.$("#tva-course-progress"),TVA.dynamicLabelSetup.courseProgressContexts,TVA.dynamicLabelSetup.courseProgressDefaults,n,(function(t){return e.settings.getCourseProgressLabel(t)}))}})},function(e,t,s){var i=s(15),n=s(174);e.exports=i.extend({template:TVE_Dash.tpl("settings/labels/course-structure"),afterRender:function(){var e=this;this._renderContextItems(this.$("#tva-course-structure"),TVA.dynamicLabelSetup.courseStructureContexts,TVA.dynamicLabelSetup.courseStructureDefaults,n,(function(t){return e.settings.getCourseStructureLabel(t)}))}})},function(e,t,s){var i,n,r;jQuery,i=s(1),n=s(12),r=s(105),e.exports=i.extend({initialize:function(){TVE_Dash.hideLoader(),TVA.licenseActivated&&(this.openModal(r,{show_first_step:!0,model:new n({key:"wizard",value:""}),no_close:!0,className:"tvd-modal tva-modal-welcome",dismissible:!1,modal_title:TVA.t.choose_school_design,skin_download_params:{activate:1,fresh_install:1},download_callback:function(e,t){TVA.skins.unshift(e),TVA.Router.menuItems.updateItem({route:"#design-welcome"},{route:"#design"}),TVA.Router.navigate("#design/".concat(e.term_id,"/wizard"),{trigger:!0}),t.always=!1,TVE_Dash.showLoader(!0),window.location.reload()}}),TVA.settings.show_hi_professor_modal=!0)}})},,,,,,function(e,t,s){var i=s(79);e.exports=Backbone.Collection.extend({model:i,hasIntegration:function(e){return this.findWhere({integration:e})instanceof i},hasEmptyRules:function(){var e=!0;return this.each((function(t){if("thrivecart"===t.get("integration"))return e=!1;e&&t.get("items").length&&(e=!1)})),e},resetRules:function(){this.hasIntegration("thrivecart")&&this.remove(this.findWhere({integration:"thrivecart"})),this.each((function(e){return e.resetItems()}))}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a,c,l;o=jQuery,a=s(41),c=s(82),l=new Map,e.exports=c.extend({model:a,fetchOptions:{remove:!1},url:function(){return this._filter=n(n({},this._filter),{offset:this.offset,number:this.limit}),this.getUrl(TVA.routes.products,o.param(_.pick(this._filter,(function(e){return!!e}))))},hasFilters:function(){var e=this._filter;return delete e.offset,delete e.number,Object.keys(e).length>0},resetFilters:function(){return this.offset=0,this.currentPage=1,c.prototype.resetFilters.apply(this,arguments)},resetAndFetch:function(){return this.resetFilters().fetch({reset:!0})},fetchAll:function(){return this.currentPage=this.pageInfo().totalPages,this.fetch({reset:!0,data:{offset:0,number:1e5}})},getAll:function(){var e=this;return new Promise((function(t){e.length<e.total?e.fetchAll().done((function(){return t(e)})):t(e)}))},search:function(e){return this.currentPage=1,this.offset=0,this._filter=n(n({},this._filter),e),this.fetch({reset:!0}),this},getByName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.toLowerCase().trim(),i=this.filter((function(e){var i=e.get("name").toLowerCase().trim()===s;return t&&e.get("id")===t&&(i=!1),i}));return!!Array.isArray(i)&&i[0]},newItemOrder:function(){return TVA.products.total||0},changeTotal:function(e){this.total=this.total+parseInt(e),this.trigger("total-changed")},comparator:function(e,t){return parseInt(t.get("order"))-parseInt(e.get("order"))},cacheModel:function(e){l.set(Number(e.get("id")),e)},get:function(e){return c.prototype.get.call(this,e)||l.get(Number(e))||void 0}})},function(e,t,s){var i=s(40);e.exports=s(4).extend({model:i,comparator:function(e,t){return t.get("ID")-e.get("ID")}})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o;o=jQuery,e.exports=s(82).extend({model:s(88),limit:10,offset:0,currentPage:1,ordering:{enrolled:"desc"},filters:{},search:function(e){this.currentPage=1,this.offset=0,this.filter=n(n({},this.filter),e),this.fetch()},url:function(){return this.filter=n(n({},this.filter),{offset:this.offset,limit:this.limit}),this.getUrl(TVA.routes.customer,o.param(_.pick(this.filter,(function(e){return!!e}))))},next:function(){this.currentPage++,this.fetchStudents()},prev:function(){this.currentPage--,this.fetchStudents()},fetchStudents:function(){var e=this;this.offset=(this.currentPage-1)*this.limit,this.trigger("fetching"),this.fetchWithData({offset:this.offset}).success((function(t){e.reset(t.items,{total:t.total,ordering:e.ordering}),e.trigger("fetched")}))},resetPagination:function(){return this.currentPage=1,this.offset=0,this},resetIndividualStudentViews:function(){this.invoke("set",{courses:[]})},fetchWithData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(e=n(n({},e),this.filters)).limit=this.limit,e.ordering=this.ordering,wp.apiRequest({url:"".concat(TVA.routes.customer),data:e})}})},function(e,t,s){var i={"./base":17,"./base.js":17,"./chapter":48,"./chapter.js":48,"./lesson":49,"./lesson.js":49,"./module":50,"./module.js":50};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=270},,,,,,,,function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function n(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var o=e.apply(t,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))}}var r;(r=n(regeneratorRuntime.mark((function e(t){var i,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){return(o=n(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,s){wp.apiRequest({url:TVA.Utils.buildUrl(TVA.routes.admin,{},"localize")}).done((function(s){t.extend(!0,TVA,s),e(s)})).fail((function(e){return s(e)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(){return o.apply(this,arguments)},window.TVA=window.TVA||{},TVA.globals={},TVA.Utils=s(279),TVA.Utils.LocalStorage=s(280).instance(),s(281),TVA.$eventBus=t({}),t(window).on("td_sets_ready",(function(){window.TD_SETS=window.TD_SETS||{},t.extend(!0,window.TD_SETS,{Views:{List:s(35),Item:s(36),Form:s(37)}})})),i=TVA.$app=t("#tva-app"),TVA.lazyLoading=!0,e.next=13,r();case 13:t(n(regeneratorRuntime.mark((function e(){var n,r,o,a,c,l,u,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:location.href.includes("debug")&&requestAnimationFrame(TVA.Utils.debugIcons.bind(TVA.Utils)),t(document).on("keyup",(function(e){e.type="page_keyup",TVA.$eventBus.trigger(e)})),n=s(78),TVA.courses=new n(TVA.courses.items,{total:TVA.courses.total}),TVA.courses.on("add remove change destroy",(function(){return TVA.$eventBus.trigger("courses_changed")})),TVA.skins=new(s(287))(TVA.skins),r=_.debounce((function(){return TVA.skins.fetch()}),200),TVA.$eventBus.on("courses_changed",r),o=s(268),TVA.topics=new o(TVA.topics),a=s(289),TVA.labels=new a(TVA.labels),TVA.dismissedTooltips=TVA.dismissedTooltips||[],s(134),TVA.indexPageModel=new(s(5))(TVA.settings.index_page),TVA.certificateValidationPage=new(s(5))(TVA.settings.certificate_validation_page),c=s(267),TVA.products=new c(TVA.products.items,{total:TVA.products.total}),TVA.products.on("add remove change destroy",(function(){return TVA.$eventBus.trigger("products_changed")})),TVA.$eventBus.on("products_changed",(function(){return TVA.courses.where({fetched:!0}).forEach((function(e){return e.set("fetched",!1)}))})),l=s(291),TVA.access_integrations=new l(TVA.access_integrations),u=s(269),TVA.customers=new u([],{total:0}),d=s(292),TVA.Router=new d,Backbone.history.start({hashchange:!0}),TVA.settings.wizard.value||TVA.Router.navigate("#wizard",{trigger:!0}),Backbone.history.fragment||TVA.Router.navigate("#home",{trigger:!0}),TVA.keepLoader||i.tvaToggleLoader(!1,null,{fadeDuration:200}),TVA.lazyLoading=!1;case 31:case"end":return e.stop()}}),e)}))));case 14:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})(jQuery)},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}window.tinymce=window.tinymce||void 0,window.tinyMCEPreInit=window.tinyMCEPreInit||void 0;var o,a=s(20);o=jQuery,e.exports={icon:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ta-",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e?(s=" "+s,TVE_Dash.tpl("utils/icon",{icon:t+e,cls:s})):""},isEmail:function(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())},renderMCE:function(e,t,s){var i=this,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(r){setTimeout((function(){i.clearMCEEditor(e),i.editorInit(e,t,s,n).then((function(e){return r(Array.isArray(e)?e[0]:null)}))}))}))},editorInit:function(e,t,s){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if("undefined"==typeof tinymce||!tinymce)return Promise.resolve(null);var n=this.buildMCEInit({mce:window.tinyMCEPreInit.mceInit.tve_tinymce_tpl,qt:window.tinyMCEPreInit.qtInit.tve_tinymce_tpl},e);return window.tinyMCEPreInit.mceInit=o.extend(tinyMCEPreInit.mceInit,n.mce_init),window.tinyMCEPreInit.mceInit[e].setup=function(n){n.on("init",(function(){n.setContent(t.get(s)||"")})),n.on("change",(function(){var n=tinymce.get(e);t.set(s,n.getContent(),{silent:i})})),n.on("blur",(function(){var i=window.tinymce.get(e);t.get(s)!==i.getContent()&&t.set(s,i.getContent()),t.trigger("tva_tinymce_blur")}))},window.tinymce.init(tinyMCEPreInit.mceInit[e])},clearMCEEditor:function(e,t){void 0!==window.tinymce&&tinymce&&("string"==typeof e&&(e=[e]),e.forEach((function(e){t!==e&&function(e){try{window.tinymce.get(e).destroy(),window.tinymce.execCommand("mceRemoveControl",!0,e)}catch(e){}}(e)})))},buildMCEInit:function(e,t){var s={},i={};return s[t]=jQuery.extend(!0,{},e.mce),i[t]=jQuery.extend(!0,{},e.qt),i[t].id=t,s[t].selector="#"+t,s[t].body_class=s[t].body_class.replace("tve_tinymce_tpl",t),{mce_init:s,qt_init:i}},wpMedia:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,i={id:"tva-media-frame-".concat(s),title:"Select or upload an image",button:{text:"Use this Image"},library:{type:"image"},multiple:!1},n=wp.media(o.extend(i,e));n.on("select",e.select||function(){var e=n.state().get("selection").first().toJSON();t.set(s,e.url)}),n.open()},rebindWistiaFancyBoxes:function(){window.rebindWistiaFancyBoxes&&window.rebindWistiaFancyBoxes()},pluckFields:function(e,t){return e instanceof Backbone.Collection&&(e=e.toJSON()),e.map((function(e){return s=e,i={},t.forEach((function(e){return i[e]=s instanceof Backbone.Model?s.get(e):s[e]})),i;var s,i}))},ucFirst:function(e){return e.charAt(0).toUpperCase()+e.substring(1)},_n:function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t+"s",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return(i?e+" ":"")+TVA.t[1===e?t:s]},getPreviewUrl:function(){var e=TVA.courses.findWhere({status:"publish"});return TVA.settings.preview_option.value&&e?e.get("preview_url"):Array.isArray(TVA.design.demo_courses)&&TVA.design.demo_courses.length>0?TVA.design.demo_courses[0].preview_url:TVA.courses.first()?TVA.courses.first().get("preview_url"):""},addUrlFragment:function(e,t){return[e.replace(/\/$/,""),t.replace(/^\//,"")].join("/")},buildUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=new URL(e);return _.each(t,(function(e,t){i.searchParams.append(t,e)})),s&&(e.includes("?rest_route")?i.searchParams.set("rest_route",this.addUrlFragment(i.searchParams.get("rest_route"),s)):i.pathname=this.addUrlFragment(i.pathname,s)),i.toString()},ensureUrlProtocol:function(e){if(!e.trim())return"";var t=e;return e.match(/^(http:|https:|ftp:)?\/\//)||(t="http://".concat(e)),t},confirmation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n({title:"Are you sure?",description:"","max-width":"calc(100% - 40px)",width:"550px",in_duration:200,out_duration:300,className:"tvd-modal tva-modal-create tva-modal-confirm tva-modal-design",dismissible:!0,template:"confirmation",yesClass:"tva-modal-btn-red",noClass:""},e);return new Promise((function(e){TVE_Dash.modal(a,n(n({},t),{},{model:new Backbone.Model(t),confirm:function(){this.close(),e()},cancel:function(){this.close()}}))}))},is_in_viewport:function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)},dateFormat:function(e){return window.moment(e).format("MMM DD, YYYY hh:mma")},debugIcons:function(){var e=this,t=o("#wpbody-content #ta-icons");t.length||(t=o('<div id="ta-icons" style="position:absolute; top: 100px; left: 100px;"></div>').prependTo(o("#wpbody-content"))).css({boxShadow:"1px 1px 3px rgba(0,0,0,.5)",zIndex:"99999",background:"#fff",padding:"10px",fontSize:"30px",width:"990px",display:"grid",columnGap:"20px",gridTemplateColumns:"repeat(auto-fit, 90px)"});var s="<style>.tva-debug-icon svg { width: 30px !important; height: 30px !important;}.tva-debug-icon { box-shadow: 0 0 1px rgba(0,0,0,.3); padding: 3px} </style>";o("#tva-admin-icons [viewBox]").each((function(t,i){i.id&&(s+='<span class="tva-debug-icon tva-flex tva-flex-mid tva-flex-column" title="'.concat(i.id,'">').concat(e.icon(i.id.replace("ta-","")),'<span style="font-size:8px;border-top:1px solid #dedede">').concat(i.id,"</span></span>"))})),t.html(s)},pageLoader:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:140;TVA.keepLoader=!0,this.$loaderContainer=this.$loaderContainer||o("#tva-app"),this.$loaderContainer.tvaToggleLoader(t,e,{background:"#eaefef",wrapperCss:{position:"fixed",left:"36px",top:"32px"}})},saveTooltips:function(e){e&&(TVA.dismissedTooltips=Array.from(new Set(TVA.dismissedTooltips.concat(e))),wp.apiRequest({type:"post",url:"".concat(TVA.routes.settings_v2,"/user-meta"),data:{meta_key:"tva_dismissed_tooltips",meta_value:TVA.dismissedTooltips.filter((function(e){return e}))}}))},isTooltipViewed:function(e){return TVA.dismissedTooltips.includes(e)},bindModalSelect2:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.each((function(e,s){var i=n({},t);Object.keys(s.dataset).forEach((function(e){return i[e]=s.dataset[e]}));var r=o(s).select2(n({minimumResultsForSearch:null!=i&&i.minimumResultsForSearch?i.minimumResultsForSearch:1/0,templateResult:function(e,t){if(!e.element)return null;if(!e.element.dataset.icon)return e.text;var s=TVA.Utils.icon(e.element.dataset.icon);return t.classList.add("tva-with-icon"),o(s+'<span class="item-text">'+e.text+"</span>")}},i)).on("select2:opening",(function(e){e.currentTarget.parentNode.classList.add("select2--open");var t=String(e.currentTarget.className+(null==i?void 0:i.withSearch)?"":" no-search").replace("select2-hidden-accessible",""),s=o(e.currentTarget).data("select2").$dropdown;s.addClass(("tva-modal-dropdown "+t).trim()),i.fitParent&&s.find(".select2-dropdown").css("min-width","".concat(jQuery(e.currentTarget.parentNode).outerWidth(),"px"))})).on("select2:closing",(function(e){return e.currentTarget.parentNode.classList.remove("select2--open")}));r.data("select2").$container.addClass(i.containerClass||""),r.data("select2").$dropdown.addClass(i.dropdownClass||"")}))}}},function(e,t){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i={setItem:function(e,t){},getItem:function(e){},removeItem:function(e){}};function n(){this.api=window.localStorage||i,this.listening=!1,this.listeners={}}n.prototype.set=function(e,t){if(!e||null==t)return this;"object"===s(t)&&(t=JSON.stringify(t));try{this.api.setItem(e,t)}catch(e){}return this},n.prototype.get=function(e){if(e){var t=this.api.getItem(e);if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}},n.prototype.unset=function(e){if(!e)return this;try{this.api.removeItem(e)}catch(e){}return this},n.prototype._listen=function(){var e=this;jQuery(window).on("storage",(function(t){t||(t=window.event);var s=e.listeners[t.key];s&&s.length&&s.forEach((function(e){e(JSON.parse(t.newValue),JSON.parse(t.oldValue))}))}))},n.prototype.on=function(e,t){this.listeners[e]?this.listeners[e].push(t):this.listeners[e]=[t],!1===this.listening&&(this._listen(),this.listening=!0)},n.prototype.off=function(e,t){var s=this.listeners[e];s.length>1?s.splice(s.indexOf(t),1):this.listeners[e]=[]},n.prototype.setComponentMeta=function(e,t,s){var i=this.get("tcb-components-display")||{};i[e]=i[e]||{},i[e][t]=s,this.set("tcb-components-display",i)},n.instance=function(){return this._instance||(this._instance=new n),this._instance},e.exports=n},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a,c;o=jQuery,a='<div class="tvd-card-preloader tva-element-loader"><div class="tvd-preloader-wrapper tvd-active"><div class="tvd-spinner-layer tvd-spinner-blue-only"><div class="tvd-circle-clipper tvd-left"><div class="tvd-circle"></div></div><div class="tvd-gap-patch"><div class="tvd-circle"></div></div><div class="tvd-circle-clipper tvd-right"><div class="tvd-circle"></div></div></div></div></div>',c=s(123),o.fn.tvaToggleLoader=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};"number"==typeof e&&(e+="px");var i={position:"center",background:"rgba(255, 255, 255, .8)",fadeDuration:100,wrapperCss:{}},r=s=n(n({},i),s),c=r.position,l=r.background,u=r.padding;return!1===e&&(t=!1),this.each((function(){var i=o(this),r=i.data("tva-loader")||!!i.find(".tvd-card-preloader.tva-element-loader").length;if(null==t&&(t=!r),r!==t){i.data("tva-loader",t);var d=i.find(".tvd-card-preloader.tva-element-loader");if(!t)return d.fadeOut(s.fadeDuration,(function(){d.remove(),i.removeClass("tva-disabled tva-element-loading").css("position","")})),void(d.length||i.removeClass("tva-disabled tva-element-loading").css("position",""));var h=!d.length;d.length?d.stop():d=o(a).hide(),i.addClass("tva-disabled tva-element-loading"),["","static"].includes(i.css("position"))&&i.css("position","relative");var p={"align-items":"center","justify-content":"center"},m=c.includes("outside")?"-".concat(parseInt(e)+5,"px"):"",g={};c.includes("top")&&(p["align-items"]="flex-start"),c.includes("bottom")&&(p["align-items"]="flex-end"),c.includes("left")&&(p["justify-content"]="flex-start",g["margin-left"]=m),c.includes("right")&&(p["justify-content"]="flex-end",g["margin-right"]=m),d.css(n(n({},p),{},{background:l,padding:u},s.wrapperCss)),d.find(".tvd-preloader-wrapper").css(n({width:e,height:e},g)),h&&i.append(d),d.css("display","flex").fadeIn(s.fadeDuration)}}))},o.fn.tvaInlineEdit=function(e){var t=n({required:!0},e||{});return this.each((function(){var e=o(this);if(e.data("tva-inline-edit"))return e.data("tva-inline-edit").editing();e.data("tva-inline-edit-orig-html",e.html());var s=new c(n({$element:e},t));e.html(s.render().$el),e.data("tva-inline-edit",s)}))}},function(e,t,s){var i=s(126),n=s(4).extend({model:i,url:function(){return TVA.routes.campaigns},massApplySettings:function(e){var t=new n(this.filter((function(e){return e.isRepeating()})));return t.length?(t.each((function(t){t.applySettings(e,!1)})),t.sync("update",t,{}),this):this},getTitleFromLabel:function(e){for(var t=1,s=this.where({post_title:e});0!==s.length;)t++,s=this.where({post_title:e+" "+t});return 1===t?e:e+" "+t}});e.exports=n},function(e,t,s){var i=s(127);e.exports=s(4).extend({model:i})},function(e,t,s){TVA.drip.trigger_views.tqb_result=s(285);var i="tqb_result",n=_.findWhere(TVA.drip.content_triggers,{id:i}),r=s(131).extend({scheduleType:i,defaults:function(){return jQuery.extend(!0,{},{id:i,schedule:{}})},canRemove:function(){return!0},canEdit:function(){return parseInt(TVA.tqb_active)},icon:function(){return"drip-tqb"},getLabel:function(){return n.name},getSummary:function(){return{id:this.get("id"),icon:this.icon(),text:n.summary,tooltip:this.getLabel()}}});e.exports=r},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a={quizComplete:"quiz_complete",basedOnResults:"based_on_result"},c=s(132),l=s(133);e.exports=s(0).extend({template:TVE_Dash.tpl("quiz-result-trigger-settings"),$condSelect:null,$condWhenSelect:null,shouldDisplayInfoText:!1,quiz:{},labels:{condWhenSelect:{number:"User achieves minimum score",percentage:"User achieves minimum percentage",right_wrong:"Minimum number of correct answers",personality:"Result is selected categories"},slider:{number:"Score",percentage:"Percentage",right_wrong:"Correct answers",personality:""}},afterInitialize:function(){var e=this;this.listenTo(this.model,"change:quiz_id",(function(){e.model.set({when:a.quizComplete},{silent:!0}),e.model.unset("when_cond",{silent:!0}),e.redraw(e.model.get("quiz_id"))}))},redraw:function(e){this.setQuiz(e),this.buildCondWhenSelect(),this.generateWhenControls(this.model.get("when")===a.basedOnResults)},afterRender:function(){var e=this;this.$condSelect=this.$("#tva-tqb-cond"),this.$condWhenSelect=this.$("#tva-tqb-cond-when"),this.$extraControlsWrapper=this.$(".tva-tqb-extra-controls"),this.$infoText=this.$(".info-text.orange").hide(),Object.values(TVA.quizzes).forEach((function(t){e.$condSelect.append(new Option(t.post_title,t.ID,!1,!1))})),this.model.get("quiz_id")||this.model.set({quiz_id:Object.values(TVA.quizzes)[0].ID,when:a.quizComplete},{silent:!0}),this.redraw(this.model.get("quiz_id")),TVE_Dash.data_binder(this),TVA.Utils.bindModalSelect2(this.$("select"))},buildCondWhenSelect:function(){0!==Object.keys(this.quiz).length&&(this.$condWhenSelect.empty(),this.$condWhenSelect.append(new Option("Quiz completed",a.quizComplete,!1,!1)),this.labels.condWhenSelect[this.quiz.type]&&this.$condWhenSelect.append(new Option(this.labels.condWhenSelect[this.quiz.type],a.basedOnResults,!1,!1)),this.$condWhenSelect.trigger("change"))},changeWhen:function(e,t){this.generateWhenControls(t.value===a.basedOnResults)},resultIsWithinRage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length&&(e=this.quiz),"object"===o(e.results)&&"min"in e.results&&"max"in e.results},generateWhenControls:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.$extraControlsWrapper.empty(),this.shouldDisplayInfoText=!1,this.$infoText.hide(),t){if(this.resultIsWithinRage())this.$extraControlsWrapper.html(new c({model:{label:this.labels.slider[this.quiz.type],value:this.model.get("when_cond")||this.quiz.results.min,min:this.quiz.results.min,max:this.quiz.results.max},change:function(t){e.model.set({when_cond:t})}}).render().$el),void 0!==this.model.get("when_cond")&&(this.quiz.results.max<Number(this.model.get("when_cond"))||this.quiz.results.min>Number(this.model.get("when_cond")))&&(this.shouldDisplayInfoText=!0);else if(this.$extraControlsWrapper.html(new l({inputs:this.quiz.results.map((function(t){return{value:parseInt(t.id),label:t.text,checked:Array.from(e.model.get("when_cond")||[]).includes(t.id)}})),change:function(t){e.model.set({when_cond:t})}}).render().$el),void 0!==this.model.get("when_cond")){var s=this.quiz.results.filter((function(t){return e.model.get("when_cond").includes(t.id)}));s.length!==this.model.get("when_cond").length&&(this.shouldDisplayInfoText=!0)}this.shouldDisplayInfoText&&this.$infoText.show()}},setQuiz:function(e){this.quiz=TVA.quizzes[e]},getData:function(){return n(n({},this.model.toJSON()),{},{schedule:{}})}})},function(e,t,s){var i=s(81);e.exports=s(4).extend({model:i,comparator:function(e,t){return parseInt(e.get("order"))-parseInt(t.get("order"))}})},function(e,t,s){var i=s(4),n=s(206),r=s(207),o=new Map,a=i.extend({model:n,url:function(){return TVA.Utils.buildUrl(TVA.routes.skins,{})},comparator:function(e,t){return t.getId()-e.getId()},getActiveSkin:function(){return this.findWhere({is_active:!0})},skin:function(e){return e instanceof n?e:this.get(Number(e))},post:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.trigger("fetch"),wp.apiRequest({url:this.url()+(t?"/"+t.replace(/^\//,""):""),type:"POST",data:s}).done((function(t){e.reset(t),e.trigger("sync")}))},setDefaultSkin:function(e){var t=this.skin(e);return TVA.visualEditingEnabled=!t.isLegacy(),TVA.visualEditingEnabled&&(TVA.settings.load_scripts.value=1),this.post("set-default",{id:t.getId()})},duplicateSkin:function(e){return this.post("duplicate",{id:this.skin(e).getId()})},getWizard:function(e){var t=this.skin(e).getId();if(!o.get(t)){var s=new r({skin_id:t});o.set(t,s),TVA.$eventBus.on("courses_changed",(function(){return delete s.$$fetched}))}return o.get(t)},getByName:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.toLowerCase().trim();return this.find((function(e){return e.get("name").toLowerCase().trim()===t}))}});e.exports=a},function(e,t,s){var i=s(87),n=s(4);e.exports=n.extend({model:i,initialize:function(e,t){if(!t||void 0===t.skin_id)throw new Error("This collection cannot be initialized without a skin_id");this.skin_id=parseInt(t.skin_id)},filterItems:function(e){return this.filter((function(t){switch(e){case"core":return t.isDefault();case"homepage":return t.isHomepage();case"lesson":return t.isLesson();case"module":return t.isModule();case"course":return t.isCourse();case"course_completed":return t.isCompleted()}return!0}))},comparator:function(e){return e.id},filterByType:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.filter((function(s){var i=s.primary()===e;return null!==t&&i&&(i=i&&s.secondary()===t),i}))}})},function(e,t,s){e.exports=s(268).extend({model:s(21),comparator:function(e,t){return e.get("ID")-t.get("ID")}})},function(e,t,s){e.exports=s(78).extend({comparator:function(e){return-1*new Date(e.get("last_edit_date")).getTime()}})},function(e,t,s){var i=s(39),n=s(209);e.exports=s(4).extend({model:function(e,t){switch(e||(e={slug:null}),e.slug){case"thrivecart":return new n(e,t);default:return new i.model(e,t)}},getItems:function(e){var t=this.findWhere({slug:e});return t instanceof i.model?t.getItems():new i.items_collection},getIntegration:function(e){var t=this.findWhere({slug:e});return t instanceof i.model?t:new i.model}})},function(e,t,s){function i(e,t,s,i,n,r,o){try{var a=e[r](o),c=a.value}catch(e){return void s(e)}a.done?t(c):Promise.resolve(c).then(i,n)}function n(e){return function(){var t=this,s=arguments;return new Promise((function(n,r){var o=e.apply(t,s);function a(e){i(o,n,r,a,c,"next",e)}function c(e){i(o,n,r,a,c,"throw",e)}a(void 0)}))}}var r,o,a,c,l,u;r=jQuery,o=s(1),a=s(137),c=s(42),l=s(293),u=s(140),e.exports=Backbone.Router.extend({$el:r("#tva-app"),$body:r("body"),$content:r("#tva-content"),contentView:null,menuItems:null,submenuItems:null,submenuView:null,routes:{home:"renderView","courses(/:submenu)(/:sub_option)":"renderView","students(/:id)(/:sub_option)(/:course_id)":"renderView","reports(/:dashboard)(/:report)":"renderReportsView","products(/:id)(/:section)(/:back_term)":"renderView","settings(/:submenu)(/:sub_option)":"renderView",wizard:"renderView","design(/:submenu)(/:sub_option)":"renderView","design(/:submenu)/:templates":"renderView","design-legacy(/:submenu)":"renderView","design-welcome":"renderView"},menu:null,submenu:null,subOption:"",initialize:function(){this.menuItems=new l(Object.values(TVA.menuItems)),this.submenuItems=new Backbone.Collection,this.menuView=new a({el:this.$el.find(".tva-menu")[0],collection:this.menuItems}).render(),this.submenuView=new c({el:this.$el.find(".tva-submenu")[0],collection:this.submenuItems})},setActiveMenu:function(e){this.$body.removeClass((function(e,t){return(t.match(/(^|\s)tva-active-tab-\S+/g)||[]).join(" ")})).addClass("tva-active-tab-".concat(e)),this.menuItems.each((function(t){return t.set("selected",e.includes(t.get("slug")))}))},renderView:function(e,t){var s=this;this.subOption=t;var i=Backbone.history.getFragment().split("/");this.menu=i[0],this.setActiveMenu(this.menu);var n=this.menuItems.findWhere({selected:!0});if(n){if(this.submenuView.menuItem=n,this.submenuItems.reset(n.get("items").models),0===n.get("items").length&&!n.get("dynamic_items")||this.menu.includes("design-legacy"))return this.loadContent(this.menu,t);this.submenu=e||this.menu,n.get("items").each((function(e){e.set("selected",e.get("slug")===s.submenu),e.get("slug")===s.submenu&&e.get("items").length?(e.set("collapsed",!1),e.get("items").each((function(e){e.set("selected",e.get("slug")===t)}))):e.set("collapsed",!0)})),this.loadContent(this.submenu,t,i)}},renderReportsView:function(e,t){this.setActiveMenu("reports");var s=this.menuItems.findWhere({selected:!0});this.submenuView.menuItem=s,this.submenuItems.reset(s.get("items").models),s.get("items").each((function(s){s.set("selected",s.get("slug")===(e||"reports")),s.get("slug")===e&&s.get("items").length?(s.set("collapsed",!1),s.get("items").each((function(e){e.set("selected",e.get("slug")===t)}))):s.set("collapsed",!0)})),this.contentView&&this.contentView.destroy();var i="reports/".concat(e||"main");t?i="".concat(i,"/").concat(t):e&&(i="".concat(i,"/main")),this.contentView=new u({template:i,scope:"".concat(e,"-").concat(t)}),this.$content.html(this.contentView.render().$el),this.contentView.afterInsert()},loadContent:function(e){var t=arguments,s=this;return n(regeneratorRuntime.mark((function i(){var n,r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(n=t.length>1&&void 0!==t[1]?t[1]:"",r=t.length>2&&void 0!==t[2]?t[2]:[],s.contentView&&s.contentView.destroy(),s.contentView=s.factoryView(e,n,r),!(s.contentView instanceof o)){i.next=9;break}return i.next=7,s.contentView.ensureData();case 7:s.$content.html(s.contentView.render().$el),s.contentView.afterInsert();case 9:case"end":return i.stop()}}),i)})))()},factoryView:function(e){var t,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=parseInt(e);try{t=isNaN(o)?s(294)("./".concat(e).concat(n?"/"+n:"")):function(){switch(i.menu){case"products":return s(303)("./".concat(n));case"students":return r[3]?s(72):s(304)("./".concat(n));case"courses":return s(91);case"design":return n=n?n.replace("-","/"):"skin/item",s(305)("./".concat(n));default:return s(1)}}()}catch(i){console.log(i),console.error(e+" view is not yet implemented. Please do so !"),t=s(1)}return this.currentView&&this.currentView.destroy(),this.currentView=new t({id:parseInt(e),subID:parseInt(r[3])}),this.currentView}})},function(e,t,s){var i=s(2).extend({defaults:{selected:!1},initialize:function(e){var t=e&&e.items?Object.values(e.items):[];this.set("items",new n(t)),this.set("sections",new Backbone.Collection(e.sections||[]))}}),n=s(4).extend({model:i,updateItem:function(e,t){var s=this.findWhere(e);s&&s.set(t)}});e.exports=n},function(e,t,s){var i={"./access-migration":90,"./access-migration.js":90,"./access-restriction":210,"./access-restriction.js":210,"./access-restriction/content-restriction":43,"./access-restriction/content-restriction.js":43,"./access-rule-condition":142,"./access-rule-condition.js":142,"./add-new-course":213,"./add-new-course.js":213,"./api-keys":221,"./api-keys.js":221,"./api-keys/item":167,"./api-keys/item.js":167,"./base":0,"./base.js":0,"./checkbox-group":133,"./checkbox-group.js":133,"./confirm-action":10,"./confirm-action.js":10,"./content-base":1,"./content-base.js":1,"./course/access-tab-content":222,"./course/access-tab-content.js":222,"./course/chapter":95,"./course/chapter.js":95,"./course/completion-tab":165,"./course/completion-tab.js":165,"./course/details-tab-content":146,"./course/details-tab-content.js":146,"./course/form":91,"./course/form.js":91,"./course/forms/base":17,"./course/forms/base.js":17,"./course/forms/chapter":48,"./course/forms/chapter.js":48,"./course/forms/lesson":49,"./course/forms/lesson.js":49,"./course/forms/module":50,"./course/forms/module.js":50,"./course/header":145,"./course/header.js":145,"./course/integration":26,"./course/integration.js":26,"./course/item":46,"./course/item.js":46,"./course/items-tab-content":148,"./course/items-tab-content.js":148,"./course/lesson":47,"./course/lesson.js":47,"./course/module":149,"./course/module.js":149,"./course/permalink":147,"./course/permalink.js":147,"./course/thrivcart-integration":103,"./course/thrivcart-integration.js":103,"./course/woocommerce-integration":104,"./course/woocommerce-integration.js":104,"./courses":224,"./courses-reports":223,"./courses-reports.js":223,"./courses.js":224,"./datepicker":44,"./datepicker.js":44,"./design":170,"./design-legacy":225,"./design-legacy.js":225,"./design-welcome":226,"./design-welcome.js":226,"./design.js":170,"./design/":18,"./design/advanced":61,"./design/advanced.js":61,"./design/base":13,"./design/base.js":13,"./design/font-manager":60,"./design/font-manager.js":60,"./design/fonts/google":59,"./design/fonts/google.js":59,"./design/fonts/safe":27,"./design/fonts/safe.js":27,"./design/index":18,"./design/index.js":18,"./design/preview":57,"./design/preview.js":57,"./design/skin/filters":62,"./design/skin/filters.js":62,"./design/skin/item":106,"./design/skin/item.js":106,"./design/skin/template":63,"./design/skin/template.js":63,"./design/skin/templates":107,"./design/skin/templates.js":107,"./design/template":58,"./design/template.js":58,"./design/utils":11,"./design/utils.js":11,"./design/wizard":108,"./design/wizard.js":108,"./design/wizard/color":68,"./design/wizard/color.js":68,"./design/wizard/logo":67,"./design/wizard/logo.js":67,"./design/wizard/menu":69,"./design/wizard/menu.js":69,"./design/wizard/sidebar":64,"./design/wizard/sidebar.js":64,"./design/wizard/templates-list-section":66,"./design/wizard/templates-list-section.js":66,"./design/wizard/top":65,"./design/wizard/top.js":65,"./drip/campaign/display":161,"./drip/campaign/display.js":161,"./drip/campaign/form-general":160,"./drip/campaign/form-general.js":160,"./drip/course-tab":158,"./drip/course-tab.js":158,"./drip/modals/campaign-settings":159,"./drip/modals/campaign-settings.js":159,"./drip/modals/content-unlock-settings":162,"./drip/modals/content-unlock-settings.js":162,"./drip/schedule":99,"./drip/schedule.js":99,"./drip/triggers/course-content":164,"./drip/triggers/course-content.js":164,"./drip/triggers/datetime":100,"./drip/triggers/datetime.js":100,"./drip/triggers/first-lesson":163,"./drip/triggers/first-lesson.js":163,"./drip/triggers/purchase":101,"./drip/triggers/purchase.js":101,"./email-templates":227,"./email-templates.js":227,"./email-templates/item":173,"./email-templates/item.js":173,"./filters/drop-down":168,"./filters/drop-down.js":168,"./filters/text-input":70,"./filters/text-input.js":70,"./home":134,"./home.js":134,"./inline-edit":123,"./inline-edit.js":123,"./input-title":150,"./input-title.js":150,"./item-state":6,"./item-state.js":6,"./labels/button-label":109,"./labels/button-label.js":109,"./labels/course-structure":174,"./labels/course-structure.js":174,"./labels/course-type-label":175,"./labels/course-type-label.js":175,"./labels/item":176,"./labels/item.js":176,"./labels/simple-label":178,"./labels/simple-label.js":178,"./labels/textarea-warning-label":179,"./labels/textarea-warning-label.js":179,"./labels/user-context-item":19,"./labels/user-context-item.js":19,"./logs":228,"./logs.js":228,"./logs/item":180,"./logs/item.js":180,"./media-settings":94,"./media-settings.js":94,"./menu/menu":137,"./menu/menu-item":138,"./menu/menu-item.js":138,"./menu/menu.js":137,"./menu/submenu":42,"./menu/submenu-dropdown":139,"./menu/submenu-dropdown.js":139,"./menu/submenu-item":89,"./menu/submenu-item.js":89,"./menu/submenu.js":42,"./modals/access-migration":141,"./modals/access-migration.js":141,"./modals/api-key/base":102,"./modals/api-key/base.js":102,"./modals/base":3,"./modals/base.js":3,"./modals/certificate-tos":166,"./modals/certificate-tos.js":166,"./modals/confirm-modal":20,"./modals/confirm-modal.js":20,"./modals/course-access-restriction":55,"./modals/course-access-restriction.js":55,"./modals/course-item":157,"./modals/course-item.js":157,"./modals/course-items/chapters":229,"./modals/course-items/chapters.js":229,"./modals/course-items/content":230,"./modals/course-items/content.js":230,"./modals/course-items/grouping/chapter":96,"./modals/course-items/grouping/chapter.js":96,"./modals/course-items/grouping/module":151,"./modals/course-items/grouping/module.js":151,"./modals/course-items/lessons":231,"./modals/course-items/lessons.js":231,"./modals/course-items/modules":232,"./modals/course-items/modules.js":232,"./modals/course-items/move":152,"./modals/course-items/move.js":152,"./modals/course-items/resources":153,"./modals/course-items/resources.js":153,"./modals/course-items/resources/item":155,"./modals/course-items/resources/item.js":155,"./modals/customer/access-items/base":182,"./modals/customer/access-items/base.js":182,"./modals/customer/add":183,"./modals/customer/add.js":183,"./modals/customer/base":28,"./modals/customer/base.js":28,"./modals/customer/edit":233,"./modals/customer/edit.js":233,"./modals/customer/import":184,"./modals/customer/import.js":184,"./modals/customer/lesson-unlock":185,"./modals/customer/lesson-unlock.js":185,"./modals/design/hi-professor":169,"./modals/design/hi-professor.js":169,"./modals/help-corner":135,"./modals/help-corner.js":135,"./modals/icons":97,"./modals/icons.js":97,"./modals/labels/confirm-delete":177,"./modals/labels/confirm-delete.js":177,"./modals/products/access-rules":186,"./modals/products/access-rules.js":186,"./modals/products/add":98,"./modals/products/add.js":98,"./modals/products/content-sets":234,"./modals/products/content-sets.js":234,"./modals/schedule":93,"./modals/schedule.js":93,"./modals/skins/cloud":105,"./modals/skins/cloud.js":105,"./modals/skins/template":171,"./modals/skins/template.js":171,"./modals/steps-modal":181,"./modals/steps-modal.js":181,"./modals/td-base":16,"./modals/td-base.js":16,"./modals/topics/confirm-delete":110,"./modals/topics/confirm-delete.js":110,"./modals/wizard/templates":172,"./modals/wizard/templates.js":172,"./page-states-cloud/create":235,"./page-states-cloud/create.js":235,"./page-states-cloud/delete":236,"./page-states-cloud/delete.js":236,"./page-states-cloud/normal":237,"./page-states-cloud/normal.js":237,"./page-states-cloud/search":239,"./page-states-cloud/search-link":238,"./page-states-cloud/search-link.js":238,"./page-states-cloud/search.js":239,"./page-states/create":187,"./page-states/create.js":187,"./page-states/delete":188,"./page-states/delete.js":188,"./page-states/normal":111,"./page-states/normal.js":111,"./page-states/search":112,"./page-states/search-link":189,"./page-states/search-link.js":189,"./page-states/search.js":112,"./pagination":56,"./pagination.js":56,"./product/_abstract":14,"./product/_abstract.js":14,"./product/content":114,"./product/content-item":113,"./product/content-item.js":113,"./product/content-sets/controls/search-input":53,"./product/content-sets/controls/search-input.js":53,"./product/content-sets/form":37,"./product/content-sets/form.js":37,"./product/content-sets/item":36,"./product/content-sets/item.js":36,"./product/content-sets/list":35,"./product/content-sets/list.js":35,"./product/content.js":114,"./product/course-tab":51,"./product/course-tab.js":51,"./product/drip":115,"./product/drip.js":115,"./product/item":25,"./product/item.js":25,"./product/partials/add-content":52,"./product/partials/add-content.js":52,"./product/partials/add-courses":23,"./product/partials/add-courses.js":23,"./product/partials/add-form":22,"./product/partials/add-form.js":22,"./product/partials/content-store":24,"./product/partials/content-store.js":24,"./product/partials/rule-item":54,"./product/partials/rule-item.js":54,"./product/restricted-content":116,"./product/restricted-content.js":116,"./product/rules":117,"./product/rules.js":117,"./products":240,"./products.js":240,"./quiz-reports":241,"./quiz-reports.js":241,"./reports":140,"./reports.js":140,"./select":92,"./select.js":92,"./sendowl":242,"./sendowl.js":242,"./sendowl/checkout":243,"./sendowl/checkout.js":243,"./sendowl/create-product":244,"./sendowl/create-product.js":244,"./sendowl/integration":245,"./sendowl/integration.js":245,"./sendowl/links":246,"./sendowl/links.js":246,"./sendowl/links/input-links":191,"./sendowl/links/input-links.js":191,"./sendowl/links/option":190,"./sendowl/links/option.js":190,"./sendowl/quick-start":247,"./sendowl/quick-start.js":247,"./sendowl/tabs/checkout-states/register":248,"./sendowl/tabs/checkout-states/register.js":248,"./sendowl/tabs/checkout-states/thankyou":249,"./sendowl/tabs/checkout-states/thankyou.js":249,"./sendowl/tabs/th-page-cards":192,"./sendowl/tabs/th-page-cards.js":192,"./sendowl/tabs/thankyou-type/redirect":193,"./sendowl/tabs/thankyou-type/redirect.js":193,"./sendowl/tabs/thankyou-type/static":194,"./sendowl/tabs/thankyou-type/static.js":194,"./sendowl/thankyou-states/redirect":250,"./sendowl/thankyou-states/redirect.js":250,"./sendowl/thankyou-states/static":251,"./sendowl/thankyou-states/static.js":251,"./settings":252,"./settings.js":252,"./slider-input":132,"./slider-input.js":132,"./student/base-student":29,"./student/base-student.js":29,"./student/course":72,"./student/course.js":72,"./student/courses":118,"./student/courses-item":74,"./student/courses-item.js":74,"./student/courses.js":118,"./student/item":75,"./student/item.js":75,"./student/lesson":30,"./student/lesson.js":30,"./student/module":73,"./student/module.js":73,"./students":253,"./students.js":253,"./tabs":144,"./tabs.js":144,"./topics":195,"./topics.js":195,"./topics/item":71,"./topics/item.js":71,"./translations/access-restrictions":254,"./translations/access-restrictions.js":254,"./translations/call-to-action-buttons":255,"./translations/call-to-action-buttons.js":255,"./translations/course-content-types":256,"./translations/course-content-types.js":256,"./translations/course-navigation":257,"./translations/course-navigation.js":257,"./translations/course-progress":258,"./translations/course-progress.js":258,"./translations/course-structure":259,"./translations/course-structure.js":259,"./translations/labels":15,"./translations/labels.js":15,"./wizard":260,"./wizard.js":260,"./wp-media":45,"./wp-media.js":45};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=294},function(e,t,s){var i={"./access-migration.js":90,"./access-restriction.js":210,"./access-restriction/content-restriction.js":43,"./access-rule-condition.js":142,"./add-new-course.js":213,"./api-keys.js":221,"./api-keys/item.js":167,"./base.js":0,"./checkbox-group.js":133,"./confirm-action.js":10,"./content-base.js":1,"./course/access-tab-content.js":222,"./course/chapter.js":95,"./course/completion-tab.js":165,"./course/details-tab-content.js":146,"./course/form.js":91,"./course/forms/base.js":17,"./course/forms/chapter.js":48,"./course/forms/lesson.js":49,"./course/forms/module.js":50,"./course/header.js":145,"./course/integration.js":26,"./course/item.js":46,"./course/items-tab-content.js":148,"./course/lesson.js":47,"./course/module.js":149,"./course/permalink.js":147,"./course/thrivcart-integration.js":103,"./course/woocommerce-integration.js":104,"./courses-reports.js":223,"./courses.js":224,"./datepicker.js":44,"./design-legacy.js":225,"./design-welcome.js":226,"./design.js":170,"./design/advanced.js":61,"./design/base.js":13,"./design/font-manager.js":60,"./design/fonts/google.js":59,"./design/fonts/safe.js":27,"./design/index.js":18,"./design/preview.js":57,"./design/skin/filters.js":62,"./design/skin/item.js":106,"./design/skin/template.js":63,"./design/skin/templates.js":107,"./design/template.js":58,"./design/utils.js":11,"./design/wizard.js":108,"./design/wizard/color.js":68,"./design/wizard/logo.js":67,"./design/wizard/menu.js":69,"./design/wizard/sidebar.js":64,"./design/wizard/templates-list-section.js":66,"./design/wizard/top.js":65,"./drip/campaign/display.js":161,"./drip/campaign/form-general.js":160,"./drip/course-tab.js":158,"./drip/modals/campaign-settings.js":159,"./drip/modals/content-unlock-settings.js":162,"./drip/schedule.js":99,"./drip/triggers/course-content.js":164,"./drip/triggers/datetime.js":100,"./drip/triggers/first-lesson.js":163,"./drip/triggers/purchase.js":101,"./email-templates.js":227,"./email-templates/item.js":173,"./filters/drop-down.js":168,"./filters/text-input.js":70,"./home.js":134,"./inline-edit.js":123,"./input-title.js":150,"./item-state.js":6,"./labels/button-label.js":109,"./labels/course-structure.js":174,"./labels/course-type-label.js":175,"./labels/item.js":176,"./labels/simple-label.js":178,"./labels/textarea-warning-label.js":179,"./labels/user-context-item.js":19,"./logs.js":228,"./logs/item.js":180,"./media-settings.js":94,"./menu/menu-item.js":138,"./menu/menu.js":137,"./menu/submenu-dropdown.js":139,"./menu/submenu-item.js":89,"./menu/submenu.js":42,"./modals/access-migration.js":141,"./modals/api-key/base.js":102,"./modals/base.js":3,"./modals/certificate-tos.js":166,"./modals/confirm-modal.js":20,"./modals/course-access-restriction.js":55,"./modals/course-item.js":157,"./modals/course-items/chapters.js":229,"./modals/course-items/content.js":230,"./modals/course-items/grouping/chapter.js":96,"./modals/course-items/grouping/module.js":151,"./modals/course-items/lessons.js":231,"./modals/course-items/modules.js":232,"./modals/course-items/move.js":152,"./modals/course-items/resources.js":153,"./modals/course-items/resources/item.js":155,"./modals/customer/access-items/base.js":182,"./modals/customer/add.js":183,"./modals/customer/base.js":28,"./modals/customer/edit.js":233,"./modals/customer/import.js":184,"./modals/customer/lesson-unlock.js":185,"./modals/design/hi-professor.js":169,"./modals/help-corner.js":135,"./modals/icons.js":97,"./modals/labels/confirm-delete.js":177,"./modals/products/access-rules.js":186,"./modals/products/add.js":98,"./modals/products/content-sets.js":234,"./modals/schedule.js":93,"./modals/skins/cloud.js":105,"./modals/skins/template.js":171,"./modals/steps-modal.js":181,"./modals/td-base.js":16,"./modals/topics/confirm-delete.js":110,"./modals/wizard/templates.js":172,"./page-states-cloud/create.js":235,"./page-states-cloud/delete.js":236,"./page-states-cloud/normal.js":237,"./page-states-cloud/search-link.js":238,"./page-states-cloud/search.js":239,"./page-states/create.js":187,"./page-states/delete.js":188,"./page-states/normal.js":111,"./page-states/search-link.js":189,"./page-states/search.js":112,"./pagination.js":56,"./product/_abstract.js":14,"./product/content-item.js":113,"./product/content-sets/controls/search-input.js":53,"./product/content-sets/form.js":37,"./product/content-sets/item.js":36,"./product/content-sets/list.js":35,"./product/content.js":114,"./product/course-tab.js":51,"./product/drip.js":115,"./product/item.js":25,"./product/partials/add-content.js":52,"./product/partials/add-courses.js":23,"./product/partials/add-form.js":22,"./product/partials/content-store.js":24,"./product/partials/rule-item.js":54,"./product/restricted-content.js":116,"./product/rules.js":117,"./products.js":240,"./quiz-reports.js":241,"./reports.js":140,"./select.js":92,"./sendowl.js":242,"./sendowl/checkout.js":243,"./sendowl/create-product.js":244,"./sendowl/integration.js":245,"./sendowl/links.js":246,"./sendowl/links/input-links.js":191,"./sendowl/links/option.js":190,"./sendowl/quick-start.js":247,"./sendowl/tabs/checkout-states/register.js":248,"./sendowl/tabs/checkout-states/thankyou.js":249,"./sendowl/tabs/th-page-cards.js":192,"./sendowl/tabs/thankyou-type/redirect.js":193,"./sendowl/tabs/thankyou-type/static.js":194,"./sendowl/thankyou-states/redirect.js":250,"./sendowl/thankyou-states/static.js":251,"./settings.js":252,"./slider-input.js":132,"./student/base-student.js":29,"./student/course.js":72,"./student/courses-item.js":74,"./student/courses.js":118,"./student/item.js":75,"./student/lesson.js":30,"./student/module.js":73,"./students.js":253,"./tabs.js":144,"./topics.js":195,"./topics/item.js":71,"./translations/access-restrictions.js":254,"./translations/call-to-action-buttons.js":255,"./translations/course-content-types.js":256,"./translations/course-navigation.js":257,"./translations/course-progress.js":258,"./translations/course-structure.js":259,"./translations/labels.js":15,"./wizard.js":260,"./wp-media.js":45};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=295},function(e,t,s){function i(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=s(154),r=s(4).extend({model:n,url:function(){return TVA.Utils.buildUrl(TVA.routes.resources,{lesson_id:this.lessonID})},setLessonId:function(e){return this.lessonID=Number(e),this},comparator:function(e,t){return e.get("order")-t.get("order")},buildOrder:function(){return this.each((function(e,t){return e.set("order",t,{silent:!0})})),this},getAutoIncrement:function(){if(!this.length)return 1;var e=this.length+1;return this.each((function(t){if(t.hasDefaultTitle()){var s=Number(t.get("title").replace("Resource ",""));!isNaN(s)&&s>=e&&(e=s+1)}})),e}}),o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.collections=new Map}var t,s,n;return t=e,(s=[{key:"get",value:function(e){if(e=Number(e),!this.collections.has(e)){var t=new r;t.setLessonId(e),this.collections.set(e,t)}return this.collections.get(e)}},{key:"save",value:function(e,t){var s=TVA.routes.resources+"/mass-update";return wp.apiRequest({url:s,type:"POST",data:{lesson_id:e.lessonID,resources:e.toJSON(),removed_ids:t}}).done((function(t){return e.reset(t)}))}}])&&i(t.prototype,s),n&&i(t,n),e}();e.exports=new o},function(e,t,s){jQuery,e.exports=s(4).extend({model:s(156)})},function(e,t,s){var i=s(4).extend({url:function(){return TVA.Utils.buildUrl(TVA.routes.skins+"/cloud",{})},filterByName:function(e){var t=e.toLowerCase().trim();return t?this.filter((function(e){return e.get("name").toLowerCase().includes(t)}))||[]:this.models}});e.exports=i},function(e,t,s){var i=s(0);e.exports=i.extend({template:"dropdown",afterInitialize:function(e){this.items=e.items||[],"function"==typeof e.onSelect&&(this.onSelect=e.onSelect),this.render(),this.$selectedValue=this.$(".ttd-selected-value"),this.$items=this.$(".ttd-dropdown-items"),this.setDefaultValue()},getItems:function(){return this.items},setItems:function(e){return this.items=e,this},onSelect:function(e,t){this.$el.removeClass("open"),this.setValue(t.dataset.id),this.trigger("select",t.dataset.id)},toggle:function(){this.$el.toggleClass("open")},open:function(){this.$el.addClass("open")},close:function(){this.$el.removeClass("open")},setValue:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.selectedValue=e,this.$items.find(".selected").removeClass("selected"),this.$items.find('[data-id="'.concat(e,'"]')).addClass("selected"),this.$selectedValue.html(this.getSelectedText())},getValue:function(){return this.selectedValue},getSelectedText:function(){var e=this,t=this.getItems().find((function(t){return t.id===e.getValue()}));return t?t.text:""},setDefaultValue:function(){var e=this.items.find((function(e){return e.default}));e||(e=this.items[0]),this.setValue(e.id)}})},function(e,t,s){var i=s(217);e.exports=Backbone.Collection.extend({model:i})},function(e,t,s){function i(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function n(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?i(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):i(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var o,a;o=jQuery,a={},e.exports=s(82).extend({search:function(e){this.currentPage=1,this.offset=0,a=n(n({},a),e),this.fetch()},url:function(){return a=n(n({},a),{offset:this.offset,limit:this.limit}),this.getUrl(TVA.routes.logs,o.param(_.pick(a,(function(e){return!!e}))))}})},function(e,t,s){var i={"./redirect.js":193,"./static.js":194};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=302},function(e,t,s){var i={"./_abstract":14,"./_abstract.js":14,"./content":114,"./content-item":113,"./content-item.js":113,"./content-sets/controls/search-input":53,"./content-sets/controls/search-input.js":53,"./content-sets/form":37,"./content-sets/form.js":37,"./content-sets/item":36,"./content-sets/item.js":36,"./content-sets/list":35,"./content-sets/list.js":35,"./content.js":114,"./course-tab":51,"./course-tab.js":51,"./drip":115,"./drip.js":115,"./item":25,"./item.js":25,"./partials/add-content":52,"./partials/add-content.js":52,"./partials/add-courses":23,"./partials/add-courses.js":23,"./partials/add-form":22,"./partials/add-form.js":22,"./partials/content-store":24,"./partials/content-store.js":24,"./partials/rule-item":54,"./partials/rule-item.js":54,"./restricted-content":116,"./restricted-content.js":116,"./rules":117,"./rules.js":117};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=303},function(e,t,s){var i={"./base-student":29,"./base-student.js":29,"./course":72,"./course.js":72,"./courses":118,"./courses-item":74,"./courses-item.js":74,"./courses.js":118,"./item":75,"./item.js":75,"./lesson":30,"./lesson.js":30,"./module":73,"./module.js":73};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=304},function(e,t,s){var i={"./":18,"./advanced":61,"./advanced.js":61,"./base":13,"./base.js":13,"./font-manager":60,"./font-manager.js":60,"./fonts/google":59,"./fonts/google.js":59,"./fonts/safe":27,"./fonts/safe.js":27,"./index":18,"./index.js":18,"./preview":57,"./preview.js":57,"./skin/filters":62,"./skin/filters.js":62,"./skin/item":106,"./skin/item.js":106,"./skin/template":63,"./skin/template.js":63,"./skin/templates":107,"./skin/templates.js":107,"./template":58,"./template.js":58,"./utils":11,"./utils.js":11,"./wizard":108,"./wizard.js":108,"./wizard/color":68,"./wizard/color.js":68,"./wizard/logo":67,"./wizard/logo.js":67,"./wizard/menu":69,"./wizard/menu.js":69,"./wizard/sidebar":64,"./wizard/sidebar.js":64,"./wizard/templates-list-section":66,"./wizard/templates-list-section.js":66,"./wizard/top":65,"./wizard/top.js":65};function n(e){var t=r(e);return s(t)}function r(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=305}]);