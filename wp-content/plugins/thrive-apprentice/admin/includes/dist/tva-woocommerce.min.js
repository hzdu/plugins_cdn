!function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=306)}({306:function(e,t){!function(e){window.TVA_WC=window.TVA_WC||{products:[],assigned_products:[]},e((function(){TVA_WC.products=new Backbone.Collection(TVA_WC.products||[]);var r=e("select#product-type");"variable-subscription"===r.val()&&e("li.tva-courses_tab").show();r.on("change",(function(t){"variable-subscription"===t.currentTarget.value&&e("li.tva-courses_tab").show()})),new t({el:e("#tva-courses"),selectedProductsIds:TVA_WC.assigned_products})}));var t=Backbone.View.extend({selectedProductsIds:[],$searchInput:null,events:{"input #tva-search":_.debounce((function(e){var t=e.currentTarget.value,r=TVA_WC.products.filter((function(e){return e.get("name").toLowerCase().includes(t.toLowerCase())}));this.renderSearchResults(r)}),400),"focus #tva-search":function(){this.renderSearchResults(TVA_WC.products.filter())},"blur #tva-search":function(e){var t=this;setTimeout((function(){e.currentTarget.value="",t.$("#tva-search-results").remove()}),100)}},initialize:function(t){e.extend(this,!0,t),this.$searchInput=this.$("#tva-search"),this.renderChips()},renderChips:function(){var t=this;this.$("#tva-chips").remove();var r=e("<div/>").attr("id","tva-chips");_.each(this.selectedProductsIds,(function(e){return r.append(t.renderChip(e))})),this.$searchInput.after(r)},removeChip:function(e){e=parseInt(e),TVA_WC.products.findWhere({id:e})&&this.selectedProductsIds.splice(this.selectedProductsIds.indexOf(e),1),this.renderChips()},renderChip:function(t){var r=this,n=TVA_WC.products.findWhere({id:t});if(!n)return"";t=parseInt(t);var s=e('<div class="tva-chip"><span class="tva-remove-chip" data-id="'.concat(t,'">&times;</span></div>'));return n instanceof Backbone.Model&&(s.append('<input type="hidden" name="tva_products[]" value="'.concat(t,'"/>')),s.prepend(e("<span>".concat(n.get("name"),"</span>"))),s.find(".tva-remove-chip").on("click",(function(e){r.removeChip(e.currentTarget.dataset.id)}))),s},renderSearchResults:function(t){var r=this,n=e("<div/>").attr("id","tva-search-results").html(TVA_WC.t.no_item_found);t.length&&n.empty(),_.each(t,(function(e){return n.append(r.getSearchResultItemHtml(e))})),this.$("#tva-search-results").remove(),this.$searchInput.after(n)},getSearchResultItemHtml:function(t){var r=this,n=e("<div/>").addClass("tva-result-item").attr("data-id",t.get("id"));return n.append(e("<span/>").text(t.get("name"))),n.on("mousedown",(function(t){var n=e(t.currentTarget),s=parseInt(n.data("id"));r.$searchInput.val(""),TVA_WC.products.findWhere({id:s})&&-1===r.selectedProductsIds.indexOf(s)&&(r.selectedProductsIds.push(s),r.renderChips()),n.parent().remove()})),n}})}(jQuery)}});