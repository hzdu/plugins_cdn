!function(){var e={37866:function(e){let t,s,i,n;jQuery,t=Backbone.View.extend({render:function(){return this},modal:function(e,t){return TVE_Dash.modal(e,t)}}),s=TVE_Dash.views.Modal.extend({}),Backbone.emulateHTTP=!0,i=Backbone.Model.extend({idAttribute:"id"}),n=Backbone.Collection.extend({last:function(){return this.at(this.size()-1)}}),e.exports={base_view:t,modal_view:s,base_model:i,base_collection:n}},66723:function(e,t,s){var i=s(37866),n=s(18699);e.exports=i.base_collection.extend({model:i.base_collection.extend({defaults:{hash:"",label:""}}),add_page:function(e,t){var s=new n({hash:e,label:t});return this.add(s)}})},12015:function(e,t,s){var i=s(37866),n=s(57334);e.exports=i.base_collection.extend({model:n,sync:function(e,t,s){var i;return(s=s||{}).cache=!1,s.url=this.url(),_.isUndefined(TVE_Admin.nonce)||_.isNull(TVE_Admin.nonce)||(i=s.beforeSend,s.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",TVE_Admin.nonce),i)return i.apply(this,arguments)}),Backbone.sync(e,t,s)},url:function(){return TVE_Admin.rest_routes.symbols+"/cloud"}})},61519:function(e,t,s){var i=s(37866),n=s(46654);e.exports=i.base_collection.extend({model:n,default_category:{count:0,description:TVE_Admin.t.uncategorized_symbols,filter:"raw",name:TVE_Admin.t.uncategorized_symbols,slug:"uncategorized-symbols",taxonomy:TVE_Admin.symbols_tax,parent:null,term_group:0,term_id:0,term_taxonomy_id:0},sync:function(e,t,s){var i;return(s=s||{}).cache=!1,!t.has("id")||"delete"!==e&&"update"!==e||(s.url=this.url()+"/"+t.get("id")),_.isUndefined(TVE_Admin.nonce)||_.isNull(TVE_Admin.nonce)||(i=s.beforeSend,s.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",TVE_Admin.nonce),i)return i.apply(this,arguments)}),Backbone.sync(e,t,s)},initialize:function(e,t){return e.push(this.default_category),this.constructor.__super__.initialize.apply(this,arguments)},url:function(){return TVE_Admin.rest_routes.symbols_terms}})},52983:function(e,t,s){var i=s(37866),n=s(50565);e.exports=i.base_collection.extend({model:n,sync:function(e,t,s){var i;return(s=s||{}).cache=!1,s.url=this.url(),_.isUndefined(TVE_Admin.nonce)||_.isNull(TVE_Admin.nonce)||(i=s.beforeSend,s.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",TVE_Admin.nonce),i)return i.apply(this,arguments)}),Backbone.sync(e,t,s)},url:function(){return TVE_Admin.rest_routes.symbols}})},96959:function(e,t,s){var i=s(37866),n=s(71995),a=s(12829);e.exports=i.base_collection.extend({model:n,url:function(){return a.ajaxurl("action=tcb_admin_ajax_controller&route=templates")}})},35909:function(e,t,s){var i=s(37866),n=s(86336);e.exports=i.base_collection.extend({model:n})},18699:function(e,t,s){var i=s(37866);e.exports=i.base_model.extend({defaults:{id:"",hash:"",label:"",full_link:!1},initialize:function(e){this.get("id")||this.set("id",e.label.replace(/ /g,"").toLowerCase()),this.set("full_link",e.hash.match(/^http/))},get_url:function(){return this.get("full_link")?this.get("hash"):"#"+this.get("hash")}})},57334:function(e,t,s){var i=s(37866);e.exports=i.base_model.extend({idAttribute:"id",sync:function(e,t,s){var i;return(s=s||{}).cache=!1,!t.has("id")||"delete"!==e&&"update"!==e||(s.url=this.url()+"/"+t.get("id")),_.isUndefined(TVE_Admin.nonce)||_.isNull(TVE_Admin.nonce)||(i=s.beforeSend,s.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",TVE_Admin.nonce),i)return i.apply(this,arguments)}),Backbone.sync(e,t,s)},url:function(){return TVE_Admin.rest_routes.symbols+"/cloud/"+this.get("id")}})},46654:function(e){e.exports=Backbone.Model.extend({idAttribute:"term_id",sync:function(e,t,s){var i,n=this.get("rest_nonce")?this.get("rest_nonce"):TVE_Admin.nonce;return(s=s||{}).cache=!1,!t.has("term_id")||"delete"!==e&&"update"!==e||(s.url=this.url()+"/"+t.get("term_id")),_.isUndefined(n)||_.isNull(n)||(i=s.beforeSend,s.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",n),i)return i.apply(this,arguments)}),Backbone.sync(e,t,s)},url:function(){return this.get("rest_symbol_terms")||TVE_Admin.rest_routes.symbols_terms},parse:function(e){return 0===e.parent&&delete e.parent,e}})},50565:function(e,t,s){const i=s(37866),n=s(61519);e.exports=i.base_model.extend({idAttribute:"id",sync:function(e,t,s){var i;return(s=s||{}).cache=!1,!t.has("id")||"delete"!==e&&"update"!==e||(s.url=this.url()+"/"+t.get("id")),_.isUndefined(TVE_Admin.nonce)||_.isNull(TVE_Admin.nonce)||(i=s.beforeSend,s.beforeSend=function(e){if(e.setRequestHeader("X-WP-Nonce",TVE_Admin.nonce),i)return i.apply(this,arguments)}),Backbone.sync(e,t,s)},url:function(){return TVE_Admin.rest_routes.symbols},get_terms:function(){var e=[],t=this.get(TVE_Admin.symbols_tax);return _.isEmpty(t)&&e.push(0),_.forEach(this.get(TVE_Admin.symbols_tax),(function(t){e.push(t.term_id)})),e},get_current_category:function(){for(var e=this.get_terms(),t=TVE_Admin.symbols_tax_terms,s=0;s<t.length;s++)if(e[0]===t[s].term_id)return t[s];return new n(TVE_Admin.symbols_tax_terms.slice(0),{parse:!0}).default_category}})},3359:function(e,t,s){var i=s(37866),n=s(12829);e.exports=i.base_model.extend({defaults:{id:"",category:[]},url:function(){return n.ajaxurl("action=tcb_admin_ajax_controller&route=templatecategory")}})},71995:function(e,t,s){var i=s(37866),n=s(12829);e.exports=i.base_model.extend({defaults:{id:"",name:"",tpl:[]},url:function(){var e=n.ajaxurl("action=tcb_admin_ajax_controller&route=templatemodel");return _.isNumber(this.get("id"))&&(e+="&id="+this.get("id")),e}})},86336:function(e,t,s){var i=s(37866),n=s(12829);e.exports=i.base_model.extend({defaults:{id:""},url:function(){var e=n.ajaxurl("action=tcb_admin_ajax_controller&route=usertpl");return _.isNumber(this.get("id"))&&(e+="&id="+this.get("id")),e}})},12829:function(e){var t={};jQuery,t.ajaxurl=function(e){var t=-1!==ajaxurl.indexOf("?")?"&":"?";return e&&e.length?(e=e.replace(/^(\?|&)/,""),e+="&_nonce="+TVE_Admin.admin_nonce,ajaxurl+t+e):ajaxurl+t+"_nonce="+TVE_Admin.admin_nonce},e.exports=t},39373:function(e,t,s){var i=s(37866);e.exports=i.base_view.extend({el:jQuery("#tcb-admin-breadcrumbs-wrapper")[0],template:TVE_Dash.tpl("breadcrumbs"),initialize:function(){this.$title=jQuery("head > title"),this.original_title=this.$title.html(),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"add",this.render)},render:function(){this.$el.empty().html(this.template({links:this.collection}))}})},77351:function(e,t,s){const i=s(37866),n=s(70406),a=s(3359),o=s(82379),r=s(46654);s(42846).category,e.exports=i.base_view.extend({className:"create-search-container",initialize(e){this.searchView=new c(e),this.createView=new l(e)},render(e){return this.$el.append(this.createView.render(e).$el),this.$el.append(this.searchView.render(e).$el),this}});const l=i.base_view.extend({template:TVE_Dash.tpl("symbols/create"),className:"create-container",events:{"click span.new-cat":"create_category","click span.new-symbol":"create_symbol","click .create-category":"create_template_category"},initialize:function(e){this.symbols_view=e.symbols_view,this.footers_view=e.footers_view,this.headers_view=e.headers_view},render:function(e){this.tab_selected=e.tab_selected;const t=this.get_create_text(e);return this.$el.html(this.template({create_text:t,ct_selected:"symbol"===e.tab_selected})),this},get_create_text:function(e){let t="";switch(e.tab_selected){case"symbol":t=TVE_Admin.t.create_new;break;case"templates":case"ct":t=TVE_Admin.t.create_category;break;case"headers":case"footers":t=TVE_Admin.t["create_"+e.tab_selected.slice(0,-1)]}return t},create_template_category:function(e){const t="templates"===this.tab_selected?"ct":this.tab_selected;return"function"==typeof this[`create_${t}`]&&this[`create_${t}`](e),!1},create_ct:function(){this.modal(n,{model:new a({})})},create_headers:function(e){return this.headers_view.itemsList.create_item(e),!1},create_footers:function(e){this.footers_view.itemsList.create_item(e)},create_category:function(){this.modal(o,{title:TVE_Admin.t.create_category,description:TVE_Admin.t.description_category,save_text:TVE_Admin.t.save_category_text,placeholder:TVE_Admin.t.placeholder_category,in_duration:200,is_symbol:0,out_duration:300,save_category:_.bind(this.save_category,this)})},create_symbol:function(){this.modal(o,{title:TVE_Admin.t.create_symbol,description:TVE_Admin.t.description_symbol,save_text:TVE_Admin.t.save_symbol_text,placeholder:TVE_Admin.t.placeholder_symbol,is_symbol:1,in_duration:200,out_duration:300,show_category:1,categories:this.symbols_view.$categories,save_category:_.bind(this.save_category,this)})},save_category:function(e){return e.rest_symbol_terms=TVE_Admin.rest_routes.symbols_terms,new r(e).save(null,{success:e=>{const t=new t({category:e,collection:this.symbols_view.$collection}),s=e.toJSON();s.term_id=s.id,s.term_taxonomy_id=s.id,TVE_Admin.symbols_tax_terms.unshift(s),e.set("term_id",s.id),this.symbols_view.$el.find(".symbols-container").prepend(t.$el),this.symbols_view.$categories.unshift(e),TVE_Dash.success(TVE_Admin.t.category_created)},error:function(e,t,s){let i="";if(t.responseJSON)i=t.responseJSON.message;else if(t.responseText)try{i="parsererror"===s?"Could not parse response: "+t.responseText:JSON.parse(t.responseText).message}catch(e){}i||(i=(t.statusText||s)+(t.status?" ("+t.status+")":"")),TVE_Dash.err(i)}})}}),c=i.base_view.extend({template:TVE_Dash.tpl("symbols/search"),className:"search-container",events:{"keyup input.search-symbols":"search_items"},initialize:function(e){this.symbols_view=e.symbols_view,this.templates_view=e.templates_view,this.ct_symbols_view=e.ct_symbols_view,this.headers_view=e.headers_view,this.footers_view=e.footers_view},render:function(e){return this.tab_selected=e.tab_selected,this.$el.html(this.template({input_title:TVE_Admin.t["search_"+e.tab_selected],input_placeholder:TVE_Admin.t[e.tab_selected+"_name"]})),this},search_items:function(e){const t={search:e.currentTarget.value};switch(this.tab_selected){case"symbol":this.symbols_view.fetchSymbols(t);break;case"ct":this.ct_symbols_view.render_templates(t);break;case"headers":this.headers_view.search_items(e.currentTarget.value);break;case"footers":this.footers_view.search_items(e.currentTarget.value)}}})},86916:function(e,t,s){var i,n=s(37866),a=s(42846),o=s(91265),r=s(77351);i=jQuery,e.exports=n.base_view.extend({template:TVE_Dash.tpl("ct-symbols"),className:"templates-symbols-tabs",initialize:function(e){this.main_view=e.main_view,this.tab_selected=e.tab_selected},events:{"click .tab-item":"tabClick","click .activate-notification-template":"changeNotificationTemplate"},render:function(){return this.$el.html(this.template()),this.render_templates(),this.render_symbols(),this.render_notifications(),this.render_section("headers"),this.render_section("footers"),this.render_create_search(),this.after_render(),this},after_render:function(){const e=new URLSearchParams(window.location.search).get("tab_selected");this.$tabs=this.$(".tab-item"),this.$content=this.$(".tcb-tab-content"),this.$tabs.filter(`[data-content="${e||this.tab_selected}"]`).trigger("click")},tabClick:function(e){const t=e.currentTarget.dataset.content,s=this.$content.filter(`[data-content="${t}"]`),i="notifications"===t;this.$tabs.removeClass("active"),e.currentTarget.classList.add("active"),this.$content.removeClass("active"),s.addClass("active"),i&&this.setActiveNotificationTemplate(),this.tab_selected=t,this.createSearchView.render({tab_selected:t}),this.createSearchView.$el.toggle(!i)},setActiveNotificationTemplate(){const e=this.$(`.notifications-content .notifications-previews-wrapper[data-id="${TVE_Admin.notifications.notifications_template}"]`),t=this.$(".active-template .notifications-previews-wrapper");e.attr("data-id")!==t.attr("data-id")&&(this.$(".inactive-templates .templates-wrapper").empty().append(t),this.$(".active-template .templates-wrapper").empty().append(e))},changeNotificationTemplate:function(e){const t=jQuery(e.currentTarget).parents(".notifications-previews-wrapper"),s=this.$(".active-template .notifications-previews-wrapper"),n=t.attr("data-id");this.$(".inactive-templates .templates-wrapper").empty().append(s),this.$(".active-template .templates-wrapper").empty().append(t),i.ajax({url:ajaxurl,type:"post",data:{action:"notification_update_template",post_id:n}})},render_templates:function(e){const t=s(47285),n=jQuery.extend({},{},e);this.templates_view&&this.templates_view.remove(),TVE_Admin.globals.templates.fetch({data:i.param(n),update:!0,success:()=>{this.templates_view=new t({collection:TVE_Admin.globals.templates}),this.$(".ct-content").html(this.templates_view.render().$el)},error:function(e,t,s){TVE_Dash.err(t.responseText)}})},render_create_search:function(){this.createSearchView=new r({symbols_view:this.symbols_view,templates_view:this.templates_view,headers_view:this.headers_view,footers_view:this.footers_view,ct_symbols_view:this}),this.createSearchView.render({tab_selected:this.tab_selected}).$el.insertAfter(this.$(".tcb-header-tabs")),this.createSearchView.$el.toggle("notifications"!==this.tab_selected)},render_symbols:function(){this.symbols_view=new a.base({dashboard_view:this}),this.$(".symbols-content").append(this.symbols_view.$el).addClass("symbols-dashboard-wrapper")},render_notifications:function(){this.$(".notifications-content").html(TVE_Dash.tpl("notifications")({editLink:TVE_Admin.notifications.notifications_edit_url}))},render_section:function(e){this[e+"_view"]=new o.base({dashboard_view:this,type:e}),this.$("."+e+"-content").append(this[e+"_view"].$el).addClass("symbols-dashboard-wrapper")}})},82551:function(e,t,s){var i=s(37866);e.exports=i.base_view.extend({el:jQuery("#tcb-admin-header-wrapper"),template:TVE_Dash.tpl("header"),initialize:function(e){this.render({admin_logo_url:e.url,class:void 0!==e.class?e.class:""})},render:function(e){this.$el.html(this.template({header:e}))}})},82379:function(e,t,s){var i=s(37866),n=s(50565),a=a||{};a.views=a.views||{},e.exports=i.modal_view.extend({className:"tvd-modal tvd-modal-fixed-footer",template:TVE_Dash.tpl("modals/modal-create"),events:{"click .tvd-modal-save":"save","click #add_category":"toggle_category_selection","keypress input.content-title":"input_key_pressed"},afterRender:function(){this.$el.attr("id","tcb-modal-save-elements"),this.$el.attr("class","tvd-modal tcb-sym-modal-save-elements"),this.$name=this.$(".content-title"),this.$autocomplete=this.$("#tcb-save-template-categ-suggest")},toggle_category_selection:function(){this.$(".category_selection").toggle(),this.prepare_symbol_category()},prepare_symbol_category:function(){var e=[];this.categories.each((function(t){e.push({id:t.get("term_id"),text:t.get("name"),value:t.get("name")})})),this.bind_autocomplete(this.$autocomplete,{data:e})},input_key_pressed:function(e){13===e.keyCode&&this.save(e)},save:function(e){var t,s;if(!this.validate_input())return!1;this.is_symbol?(t={title:this.$name.val(),status:"publish"},(s=this.get_category_for_symbol())&&0!==parseInt(s)&&(t.tcb_symbols_tax=s),this.save_symbol(t,e)):(t={name:this.$name.val()},this.save_category(t),e.preventDefault(),this.close())},get_category_for_symbol:function(){if(void 0!==this.category_id&&0!==parseInt(this.category_id))return this.category_id;var e=this.$autocomplete.val();return e?e[Object.keys(e)[0]]:0},validate_input:function(){if(_.isEmpty(this.$name.val().trim())){var e=this.is_symbol?TVE_Admin.t.symbol_name_required:TVE_Admin.t.category_name_required;return TVE_Dash.err(e),!1}return!0},bind_autocomplete:function(e,t){var s=this,i=this.get_autocomplete_options(t);e.select2(i).on("select2:selecting",(function(e){e.params.args.data.isNew&&(e.params.args.data.text=e.params.args.data.value)})).on("select2:select",(function(e){var t=jQuery(this);e.params.data.isNew?s.save_category({name:e.params.data.value}).then((function(i){var n=i.id;s.$("#tcb-template-category-id").val(n),t.find('[value="'+e.params.data.id+'"]').replaceWith('<option selected value="'+n+'">'+e.params.data.value+"</option>"),t.val(n).trigger("change")})):s.$("#tcb-template-category-id").val(s.$autocomplete.val())})).on("select2:unselect",(function(e){s.$("#tcb-template-category-id").val(""),e.params.originalEvent&&e.params.originalEvent.stopPropagation()}))},get_autocomplete_options:function(e){var t={tags:!0,multiple:!0,placeholder:TVE_Admin.t.select_category,minimumResultsForSearch:0,maximumSelectionLength:1,data:{},createTag:function(e){return{id:e.term,text:'"'+e.term+'" <b style="color:#1ca6e5; float: right;; text-transform: uppercase">'+TVE_Admin.t.add_as_category+"</b>",value:e.term,isNew:!0}},escapeMarkup:function(e){return e}};return void 0===e&&(e={}),jQuery.extend({},t,e)},save_symbol:function(e,t){var s=new n(e),i=this;s.save(null,{async:!1,success:function(e){i.close(),i.$el.find("a.tvd-modal-save").attr("href",e.get("edit_url")),TVE_Dash.success(TVE_Admin.t.symbol_created),window.TVE_Admin.router.templatessymbols({tab_selected:"symbol"})},error:function(e,s,i){var n="";if(s.responseJSON)n=s.responseJSON.message;else if(s.responseText)try{n="parsererror"===i?"Could not parse response: "+s.responseText:JSON.parse(s.responseText).message}catch(e){}n||(n=(s.statusText||i)+(s.status?" ("+s.status+")":"")),TVE_Dash.err(n),t.preventDefault()}})}})},90084:function(e,t,s){var i=s(37866);e.exports=i.modal_view.extend({template:TVE_Dash.tpl("modals/tve-delete-confirmation"),events:{"click .tvd-modal-submit":"yes"},yes:function(e){var t=jQuery(e.currentTarget),s=this;this.btnLoading(t),TVE_Dash.showLoader(),this.model.destroy({data:{force:this.is_term},processData:!0,wait:!0,success:function(e,t){s.is_term&&(s.model_view.remove_deleted_category(t),window.TVE_Admin.router.templatessymbols({tab_selected:"symbol"})),s.model_view.remove(),TVE_Dash.success(s.text_deleted)},error:function(e,t){TVE_Dash.err(t.responseJSON&&t.responseJSON.message||TVE_Admin.t.text_not_deleted)},complete:function(){s.close(),TVE_Dash.hideLoader()}})}})},62451:function(e,t,s){var i=s(37866);e.exports=i.modal_view.extend({template:TVE_Dash.tpl("modals/tve-delete-confirmation"),events:{"click .tvd-modal-submit":"yes"},afterInitialize:function(e){this.text=e.text,this.extra_setting=e.extra_setting&&1===e.extra_setting?1:0},afterRender:function(){this.$el.addClass("content-templates-delete-class"),this.extra_setting&&this.$(".tcb-admin-extra-setting-row").removeClass("hidden")},yes:function(e){var t=jQuery(e.currentTarget),s=this;this.btnLoading(t),TVE_Dash.showLoader(),this.model.destroy({data:{extra_setting_check:s.$("#tcb-admin-extra-setting-check").is(":checked")?1:0},processData:!0,wait:!0,success:function(e,t){window.TVE_Admin.router.templatessymbols({tab_selected:"ct"}),TVE_Dash.success(t.text)},error:function(e,t){TVE_Dash.err(t.responseText)},complete:function(){s.close(),TVE_Dash.hideLoader()}})}})},77052:function(e,t,s){var i=s(37866);e.exports=i.modal_view.extend({template:TVE_Dash.tpl("modals/move-category"),events:{"click .tvd-modal-submit":"save"},afterRender:function(){this.$el.addClass("template-move-tocat")},save:function(){var e=this;TVE_Dash.showLoader(),this.model.set("id_category",this.$("#tcb-admin-t-categ-combo").val()),this.model.save(null,{wait:!0,success:function(e,t){TVE_Dash.success(t.text),window.TVE_Admin.router.templatessymbols()},error:function(e,t){TVE_Dash.err(t.responseText)},complete:function(){TVE_Dash.hideLoader(),e.close()}})}})},51382:function(e,t,s){var i=s(37866);e.exports=i.modal_view.extend({template:TVE_Dash.tpl("modals/move-symbol"),events:{"click .tvd-modal-submit":"save"},afterRender:function(){this.$el.addClass("sym-move-tocat")},save:function(){var e=this,t=this.$("#tcb-admin-t-categ-combo").val();TVE_Dash.showLoader(),this.model.set("move_symbol",t),this.model.unset("tcb_symbols_tax"),this.model.save(null,{wait:!0,success:function(e,t){TVE_Dash.success(TVE_Admin.t.symbol_moved_success),window.TVE_Admin.router.templatessymbols({tab_selected:"symbol"})},error:function(e,t){TVE_Dash.error(TVE_Admin.t.symbol_moved_error)},complete:function(){TVE_Dash.hideLoader(),e.close()}})}})},70406:function(e,t,s){var i=s(37866);e.exports=i.modal_view.extend({template:TVE_Dash.tpl("modals/new-category"),className:"tvd-modal",events:{"click #tcb-add-new-category-input":"addNewCategoryInput","click .tcb-admin-delete-text-element":"deleteTextElement","click .tvd-modal-submit":"save"},afterInitialize:function(e){},afterRender:function(){this.addNewCategoryInput(),this.$el.addClass("add-new-cat-modal")},addNewCategoryInput:function(){var e=this.$("#tcb-categ-input-template").clone();this.$("#tcb-categ-input").append(e.html())},deleteTextElement:function(e){jQuery(e.target).closest(".tcb-admin-text-element-wrapper")[0].remove()},save:function(){var e=[],t=this;this.$(".tcb-category-input-item").each((function(t,s){s.value&&e.push(s.value)})),e.length>0?(TVE_Dash.showLoader(),this.model.set("category",e),this.model.save(null,{wait:!0,success:function(e,t){TVE_Dash.success(t.text),window.TVE_Admin.router.templatessymbols({tab_selected:"ct"})},error:function(e,t){TVE_Dash.err(t.responseText)},complete:function(){TVE_Dash.hideLoader(),t.close()}})):TVE_Dash.err(TVE_Admin.t.no_categories)}})},92465:function(e,t,s){var i,n=s(37866),a=s(50565),o=s(57334),r=s(52983),l=s(12015),c=c||{};c.views=c.views||{},i=jQuery,c.views.ModalCreate=n.modal_view.extend({className:"tvd-modal tvd-modal-headers-footers",template:TVE_Dash.tpl("modals/section-modal-create"),events:{keypress:"keyAction","click .tcb-modal-close":"close"},afterRender:function(){var e=new c.views.ModalList({type:this.type,collection:this.collection,cloud_collection:this.cloud_collection,modalView:this});this.$(".sections-modal-create-container").append(e.$el)}}),c.views.ModalList=n.base_view.extend({className:"items-list",template:TVE_Dash.tpl("modals/section-modal-create-step-1"),events:{"click .tcb-modal-tab-elem":"select_item","click .tcb-hf-right":"choose_item","keyup input.search-sections":"search_items","click .tcb-hf-icon":"slide_templates"},initialize:function(e){this.collection=e.collection,this.cloud_collection=e.cloud_collection,this.type=e.type.slice(0,-1),this.modalView=e.modalView,this.render()},render:function(){return this.$el.html(this.template({section_name:this.type})),this.after_render(),this},after_render:function(){this.set_elements(),this.render_items(this.collection,this.$saved_templates),this.render_items(this.cloud_collection,this.$cloud_templates)},set_elements:function(){this.$saved_templates=this.$(".saved-templates"),this.$cloud_templates=this.$(".our-templates"),this.$save=this.$(".tcb-hf-right").hide()},render_items:function(e,t){t.empty(),e.length||this.no_items(t),e.each((function(e){var s=new c.views.ModalItem({item:e});t.append(s.$el)}))},slide_templates:function(e){i(e.currentTarget).parent().next().slideToggle()},no_items:function(e){var t=new c.views.MessageView({listView:this,parentContainer:e});e.append(t.render().$el)},select_item:function(e){var t=e.currentTarget.dataset.id,s=parseInt(e.currentTarget.dataset.cloud)?this.$cloud_templates:this.$saved_templates;this.$(".tcb-modal-tab-elem").each((function(){this.classList.remove("active"),this.dataset.id===t&&i(this).parents("."+s.attr("class")).length&&this.classList.add("active")})),this.$save.prop("disabled",!1).show()},choose_item:function(){var e=this.$(".active");this.show_create_step(e)},search_items:function(e){var t,s,i=e.currentTarget.value;return 27===e.keyCode&&this.modalView.close(),t=new r(this.filter_sections(i,this.collection)),s=new l(this.filter_sections(i,this.cloud_collection)),this.render_items(t,this.$saved_templates),this.render_items(s,this.$cloud_templates),!1},filter_sections:function(e,t){return t.filter((function(t){return-1!==(t.get("title")?t.get("title").rendered:t.get("post_title")).toLowerCase().indexOf(e.toLowerCase())}))},show_create_step:function(e){var t,s=parseInt(e.data("cloud")),i=e.attr("data-id");s?this.show_cloud_symbol(i):(t=this.collection.findWhere({id:parseInt(i)}),this.render_create_view(t))},show_cloud_symbol:function(e){var t={type:this.type},s=new o({id:e}),n=this.cloud_collection.findWhere({id:e});s.fetch({data:i.param(t),success:_.bind(this.fetchItemSuccess,this,n)})},fetchItemSuccess:function(e,t){var s=t;s.set({thumb:e.get("thumb"),tve_custom_css:s.get("head_css"),status:"publish",tve_updated_post:s.get("content")}),this.render_create_view(s)},render_create_view:function(e){var t=new c.views.ModalCreateItem({item:e,type:this.type,listView:this});this.$el.html(t.$el),t.$input_name.trigger("focus")}}),c.views.ModalCreateItem=n.base_view.extend({className:"create-item-container",template:TVE_Dash.tpl("modals/section-modal-create-step-2"),events:{"click .tcb-hf-back":"go_back","click .tcb-hf-right":"submit","click .tcb-notification-icon-error":"hide_error_container","keyup #dashboard-create-section":"key_press_handler"},initialize:function(e){this.item=e.item,this.type=e.type,this.listView=e.listView,this.render()},render:function(){var e=new c.views.ModalItem({item:this.item});return this.$el.html(this.template({type:this.type})),this.$(".item-create").html(e.$el),this.after_render(),this},after_render:function(){this.$input_name=this.$(".item-title"),this.$error_container=this.$(".error-container")},key_press_handler:function(e){13===e.keyCode&&this.submit()},go_back:function(){this.listView.render()},submit:function(){var e,t=this.validate_input(),s=this.item.clone();return!!t&&(e={content:s.get("content"),status:s.get("status"),tcb_symbols_tax:this.listView.modalView.mainView.tax_id,title:this.$input_name.val(),tve_custom_css:this.item.get("tve_custom_css"),tve_updated_post:s.get("tve_updated_post"),thumb:s.get("thumb"),thumb_id:s.get("id")},this.save_item(e),!1)},save_item:function(e){var t=this,s=new a(e);i("#tve-page-loader").addClass("tve-open"),s.save(null,{success:function(e){t.render_new_item(e),TVE_Dash.success(TVE_Admin.t[t.type+"_save"]),t.listView.modalView.close(),window.location.href=e.get("edit_url")},error:_.bind(this.on_error,this)})},on_error:function(e,t,s){let n="";if(t.responseJSON)n=t.responseJSON.message;else if(t.responseText)try{n="parsererror"===s?"Could not parse response: "+t.responseText:JSON.parse(t.responseText).message}catch(e){}n||(n=(t.statusText||s)+(t.status?" ("+t.status+")":"")),this.$error_container.fadeIn(200).html(TVE_Dash.tpl("symbols/save-templates-error")({error_message:n})),i("#tve-page-loader").removeClass("tve-open")},render_new_item:function(e){var t=new this.listView.modalView.mainlistItemView({type:this.type,item:e});this.listView.modalView.mainView.$(".sections-list-items").append(t.$el)},hide_error_container:function(){this.$error_container.fadeOut(200)},validate_input:function(){return!_.isEmpty(this.$input_name.val().trim())||(this.$error_container.fadeIn(200).html(TVE_Dash.tpl("symbols/save-templates-error")({error_message:TVE_Admin.t[this.type+"_name_required"]})),!1)}}),c.views.ModalItem=n.base_view.extend({className:"item-container",template:TVE_Dash.tpl("modals/section-modal-create-item"),initialize:function(e){this.item=e.item,this.render()},render:function(){return this.$el.html(this.template({item:this.item})),this}}),c.views.MessageView=n.base_view.extend({className:"text-no-sections",template:TVE_Dash.tpl("modals/section-modal-message"),initialize:function(e){this.listView=e.listView,this.parentContainer=e.parentContainer},render:function(){var e=this.get_message(),t=this.parentContainer.hasClass("our-templates");return this.$el.html(this.template({message:e,type:this.listView.type+"s"})),t?this.$(".no-sections-on-site").hide():this.$(".no-sections-on-cloud").hide(),""!==e&&(this.$(".no-sections-on-cloud").hide(),this.$(".no-sections-on-site").hide(),this.$(".no-search-results").show()),this},get_message:function(){return this.listView.$("#search-sections").val()}}),e.exports={create:c.views.ModalCreate}},91265:function(e,t,s){var i,n=s(37866),a=s(52983),o=s(12015),r=s(50565),l=s(90084),c=s(92465),d=s(6617),m=m||{};m.views=m.views||{},m.objects=m.objects||{},i=jQuery,m.views.Base=n.base_view.extend({template:TVE_Dash.tpl("symbols/sections-container"),className:"tcb-dash-symbols-wrapper",initialize:function(e){this.dashboard_view=e.dashboard_view,this.type=e.type,this.render(),this.fetchItems()},render:function(){this.$el.html(this.template())},fetchItems:function(e){var t={tcb_symbols_tax:this.get_category_id(),per_page:100,optimole_skip_processing:1},s=jQuery.extend({},t,e);TVE_Dash.showLoader(),this.$collection=new a,this.$collection.fetch({data:i.param(s),success:_.bind(this.fetchSuccess,this)})},fetchSuccess:function(e,t,s){this.render_items(e)},render_items:function(e){this.itemsList=new m.views.List({type:this.type,collection:e,tax_id:this.get_category_id()}),this.$(".sections-container").html("").append(this.itemsList.$el)},search_items:function(e){var t;t=this.filter_sections(e),this.render_items(t)},filter_sections:function(e){var t=this.$collection.filter((function(t){return-1!==t.get("title").rendered.toLowerCase().indexOf(e.toLowerCase())}));return new a(t)},get_category_id:function(){var e=this;return _.find(TVE_Admin.sections_tax_terms,(function(t){return t.slug===e.type})).term_id}}),m.views.List=n.base_view.extend({template:TVE_Dash.tpl("symbols/sections-list"),className:"sections-list-container",events:{"click .create-section":"create_item"},initialize:function(e){this.collection=e.collection,this.type=e.type,this.tax_id=e.tax_id,this.render()},render:function(){this.$el.html(this.template({type:this.type})),this.render_items()},render_items:function(){var e=this.$(".sections-list-items").html(""),t=this.type.charAt(0)+this.type.slice(1,-1),s=this;this.no_items(),this.collection.each((function(i){var n=new m.views.Item({type:t,item:i,all_items:s.collection});e.append(n.$el)}))},no_items:function(){var e=this.$(".no-items");if(e.toggle(!this.collection.length),!this.collection.length){var t=TVE_Admin.t.empty_list.replace(/%s/g,this.type);e.html(t),this.$(".create-section").html("")}},create_item:function(e){return e.currentTarget.disabled=!0,this.fetch_cloud_items({},e),!1},fetch_cloud_items:function(e,t){var s={type:this.type.slice(0,this.type.length-1)},n=jQuery.extend({},s,e),a=this;return this.cloud_symbols?(this.open_create_modal(),t.currentTarget.disabled=!1,!1):(this.cloud_symbols=new o,this.cloud_symbols.fetch({data:i.param(n),success:function(){a.open_create_modal(),t.currentTarget.disabled=!1}}),!1)},open_create_modal:function(){return this.modal(c.create,{mainlistItemView:m.views.Item,mainView:this,collection:this.collection,cloud_collection:this.cloud_symbols,type:this.type,title:TVE_Admin.t["create_"+this.type],description:TVE_Admin.t.description_category,save_text:TVE_Admin.t.save_category_text,placeholder:TVE_Admin.t.placeholder_category,"max-width":"unset",width:"70%",in_duration:200,is_symbol:0,out_duration:300}),!1}}),m.views.Item=n.base_view.extend({template:TVE_Dash.tpl("symbols/section-item"),className:"section-item-container",events:{"click .sym-pen":"edit_section_name","click .sym-delete":"delete_symbol","click .sym-duplicate":"duplicate_symbol","click .edit-symbol":"edit_symbol"},initialize:function(e){this.item=e.item,this.type=e.type,this.all_items=e.all_items,this.render()},render:function(){return this.$el.html(this.template({type:this.type,item:this.item})),this.$symbol_name=this.$(".symbol-title-text"),this},edit_section_name:function(e){var t=this,s=i(e.currentTarget),n=new Backbone.Model({value:this.item.get("title").rendered,label:"",required:!0}),a=new d({model:n,tagName:"div"});s.hide(),this.$symbol_name.hide().after(a.render().$el),n.on("change:value",(function(e,i){t.save_symbol({title:i}),a.remove(),t.$symbol_name.show(),s.show()})),n.on("tcb_admin_no_change",(function(){t.$symbol_name.html(t.model.get("title").rendered).show(),a.remove(),s.show()})),a.focus()},delete_symbol:function(){this.modal(l,{model:this.item,model_view:this,is_term:!1,title:"Delete "+this.type,text:TVE_Admin.t["delete_"+this.type+"_txt"].replace("%s",this.item.get("title").rendered),text_deleted:TVE_Admin.t[this.type+"_deleted"],text_not_deleted:TVE_Admin.t[this.type+"_not_deleted"],"max-width":"60%",width:"750px",in_duration:200,out_duration:300,className:"delete-symbol tvd-modal"})},duplicate_symbol:function(){var e,t,s=this,i=this.item.clone(),n=i.get("tcb_symbols_tax");t=_.isEmpty(n)?n:n[0].term_id,e={content:i.get("content"),status:i.get("status"),tcb_symbols_tax:t,title:i.get("title").rendered,tve_custom_css:i.get("tve_custom_css"),tve_updated_post:i.get("tve_updated_post")},new r(e).save({old_id:i.get("id")},{success:function(e){var t=new m.views.Item({type:s.type,item:e,all_items:s.all_items});s.all_items.add(e),s.$el.after(t.render().$el),TVE_Dash.success(TVE_Admin.t["duplicate_"+s.type+"_success"])},error:function(e){TVE_Dash.err(TVE_Admin.t["cannot_duplicate_"+this.type])}})},edit_symbol:function(){window.open(this.item.get("edit_url"),"_blank")},save_symbol:function(e){var t=this;this.item.set(e),this.item.unset("tcb_symbols_tax"),this.item.unset("old_id"),this.item.unset("thumb"),this.item.save(null,{success:function(e){t.$symbol_name.html(e.get("title").rendered),TVE_Dash.success(TVE_Admin.t[this.type+"_save"])},error:function(e,t,s){var i="";if(t.responseJSON)i=t.responseJSON.message;else if(t.responseText)try{i="parsererror"===s?"Could not parse response: "+t.responseText:JSON.parse(t.responseText).message}catch(e){}i||(i=(t.statusText||s)+(t.status?" ("+t.status+")":"")),TVE_Dash.err(i)}})}}),e.exports={base:m.views.Base}},42846:function(e,t,s){var i,n=s(37866),a=s(52983),o=s(61519),r=s(46654),l=s(50565),c=s(6617),d=s(90084),m=s(82379),h=s(51382),u=u||{};u.views=u.views||{},u.objects=u.objects||{},i=jQuery,u.views.Base=n.base_view.extend({template:TVE_Dash.tpl("symbols/container"),className:"tcb-dash-symbols-wrapper",initialize:function(e){this.dashboard_view=e.dashboard_view,this.render(),this.fetchSymbols()},initCategories:function(){this.$categories=new o(TVE_Admin.symbols_tax_terms.slice(0),{parse:!0})},render:function(){this.$el.html(this.template())},fetchSymbols:function(e){const t={tcb_symbols_tax_exclude:TVE_Admin.default_terms,per_page:100,optimole_skip_processing:1},s=jQuery.extend({},t,e);this.initCategories(),TVE_Dash.showLoader(),this.$collection=new a,this.$collection.fetch({data:i.param(s),success:_.bind(this.fetch_success,this)})},fetch_success:function(e,t,s){this.render_categories(e)},render_categories:function(e){var t=this.$(".symbols-container").html("");this.$categories.each((function(s){var i=new u.views.Category({category:s,collection:e});t.append(i.$el)}))},set_categories_from_symbols:function(e){var t=this;e.each((function(e){var s=e.get(TVE_Admin.symbols_tax);_.isEmpty(s)?t.$categories[0]=t.default_category:_.forEach(s,(function(e){t.$categories[e.term_id]||(t.$categories[e.term_id]=e)}))}))}}),u.views.Category=u.views.Base.extend({template:TVE_Dash.tpl("symbols/category"),className:"category-view-wrapper",events:{"click .edit-category-name":"edit_category_name","click .delete-category":"delete_category"},initialize:function(e){this.$category_item=e.category,this.$collection=e.collection,this.render()},render:function(){return this.$el.empty(),this.$el.html(this.template({category:this.$category_item})),this.list_items(),this.$category_name=this.$(".cat-name"),this},list_items:function(){var e=this.get_collection_for_category();return this.$list=new u.views.List({collection:e,category_item:this.$category_item}),this.$el.append(this.$list.$el),this},get_collection_for_category:function(){var e=this,t=this.$collection.clone(),s=[];return t.each((function(t){-1===t.get_terms().indexOf(parseInt(e.$category_item.get("term_id")))&&s.push(t)})),t.remove(s),t},edit_category_name:function(e){var t=this,s=i(e.currentTarget),n=new Backbone.Model({value:this.$category_item.get("name"),label:"",required:!0}),a=new c({model:n,tagName:"div"});s.hide(),this.$category_name.hide().after(a.render().$el),n.on("change:value",(function(e,i){t.save_category({name:i}),a.remove(),t.$category_name.show(),s.show()})),n.on("tcb_admin_no_change",(function(){t.$category_name.html(t.$category_item.get("name")).show(),a.remove(),s.show()})),a.focus()},delete_category:function(){this.modal(d,{model:this.$category_item,model_view:this,is_term:!0,title:"Delete category",text:TVE_Admin.t.delete_category_txt.replace("%s",this.$category_item.get("name")),text_deleted:TVE_Admin.category_deleted,text_not_deleted:TVE_Admin.t.category_not_deleted,"max-width":"60%",width:"750px",in_duration:200,out_duration:300,className:"delete-symbol tvd-modal"})},remove_deleted_category:function(e){if(e.deleted){var t,s=e.previous.id;_.forEach(TVE_Admin.symbols_tax_terms,(function(e,i){e.term_id===s&&(t=i)}))}void 0!==t&&TVE_Admin.symbols_tax_terms.splice(t,1)},save_category:function(e){var t=this;this.$category_item.set(e),this.$category_item.save(null,{success:function(e){t.$category_name.html(e.get("name")),TVE_Dash.success(TVE_Admin.t.category_save)},error:function(e,t,s){var i="";if(t.responseJSON)i=t.responseJSON.message;else if(t.responseText)try{i="parsererror"===s?"Could not parse response: "+t.responseText:JSON.parse(t.responseText).message}catch(e){}i||(i=(t.statusText||s)+(t.status?" ("+t.status+")":"")),TVE_Dash.err(i)}})},change_category:function(e){var t=e.currentTarget.getAttribute("data-term-id");this.$el.find(".term-item").each((function(){this.getAttribute("data-term-id")===t?this.classList.add("active"):this.classList.remove("active")})),this.set_active_category(t)},set_active_category:function(e){var t=this;if(!this.$categories)return!1;e||(e=Object.keys(this.$categories)[0]),_.forEach(this.$categories,(function(s,i){t.$categories[i].active=i===e}))}}),u.views.Search=u.views.Base.extend({template:TVE_Dash.tpl("symbols/search"),className:"search-container",events:{"click span.new-cat":"create_category","click span.new-symbol":"create_symbol","keyup input.search-symbols":"search_symbols"},initialize:function(e){this.categories_collection=e.categories,this.symbols_collection=e.collection,this.base_view=e.base_view,this.render()},render:function(){return this.$el.html(this.template()),this},create_category:function(){this.modal(m,{title:TVE_Admin.t.create_category,description:TVE_Admin.t.description_category,save_text:TVE_Admin.t.save_category_text,placeholder:TVE_Admin.t.placeholder_category,in_duration:200,is_symbol:0,out_duration:300,save_category:_.bind(this.save_category,this)})},create_symbol:function(){this.modal(m,{title:TVE_Admin.t.create_symbol,description:TVE_Admin.t.description_symbol,save_text:TVE_Admin.t.save_symbol_text,placeholder:TVE_Admin.t.placeholder_symbol,is_symbol:1,in_duration:200,out_duration:300,show_category:1,categories:this.categories_collection,save_category:_.bind(this.save_category,this)})},save_category:function(e){var t=this;return e.rest_symbol_terms=TVE_Admin.rest_routes.symbols_terms,new r(e).save(null,{success:function(e){(s=e.toJSON()).term_id=s.id,s.term_taxonomy_id=s.id,TVE_Admin.symbols_tax_terms.unshift(s),e.set("term_id",s.id);var s,i=new u.views.Category({category:e,collection:t.symbols_collection});t.base_view.$el.find(".symbols-container").prepend(i.$el),t.categories_collection.unshift(e),TVE_Dash.success(TVE_Admin.t.category_created)},error:function(e,t,s){var i="";if(t.responseJSON)i=t.responseJSON.message;else if(t.responseText)try{i="parsererror"===s?"Could not parse response: "+t.responseText:JSON.parse(t.responseText).message}catch(e){}i||(i=(t.statusText||s)+(t.status?" ("+t.status+")":"")),TVE_Dash.err(i)}})},search_symbols:function(e){var t={search:e.currentTarget.value};_.isEmpty(e.currentTarget.value)?this.base_view.fetchSymbols():this.base_view.fetchSymbols(t)}}),u.views.List=u.views.Base.extend({template:TVE_Dash.tpl("symbols/list"),className:"symbols-items",events:{"click .open-create-modal":"new_symbol_modal"},initialize:function(e){this.$collection=e.collection,this.$category_item=e.category_item,this.render()},render:function(){return this.$el.html(this.template({length:this.$collection.length})),this.$collection.each(this.renderOne,this),TVE_Dash.hideLoader(),this},renderOne:function(e){var t=new u.views.Item({model:e});return this.$el.prepend(t.render().$el),this},new_symbol_modal:function(){this.modal(m,{title:TVE_Admin.t.create_symbol,description:TVE_Admin.t.description_symbol,save_text:TVE_Admin.t.save_symbol_text,placeholder:TVE_Admin.t.placeholder_symbol,is_symbol:1,in_duration:200,out_duration:300,show_category:0,category_id:this.$category_item.get("term_id")})}}),u.views.Item=u.views.Base.extend({template:TVE_Dash.tpl("symbols/item"),className:"symbol-item-container",events:{"click .sym-pen":"edit_symbol_name","click .sym-delete":"delete_symbol","click .sym-duplicate":"duplicate_symbol","click .sym-move":"move_symbol","click .edit-symbol":"edit_symbol"},initialize:function(e){this.model=e.model},render:function(){return this.$el.html(this.template({item:this.model})),this.$symbol_name=this.$(".symbol-title-text"),this},delete_symbol:function(){this.modal(d,{model:this.model,model_view:this,is_term:!1,title:"Delete symbol",text:TVE_Admin.t.delete_symbol_txt.replace("%s",this.model.get("title").rendered),text_deleted:TVE_Admin.t.symbol_deleted,text_not_deleted:TVE_Admin.t.symbol_not_deleted,"max-width":"60%",width:"750px",in_duration:200,out_duration:300,className:"delete-symbol tvd-modal"})},edit_symbol_name:function(e){var t=this,s=i(e.currentTarget),n=new Backbone.Model({value:this.model.get("title").rendered,label:"",required:!0}),a=new c({model:n,tagName:"div"});s.hide(),this.$symbol_name.hide().after(a.render().$el),n.on("change:value",(function(e,i){t.save_symbol({title:i}),a.remove(),t.$symbol_name.show(),s.show()})),n.on("tcb_admin_no_change",(function(){t.$symbol_name.html(t.model.get("title").rendered).show(),a.remove(),s.show()})),a.focus()},save_symbol:function(e){var t=this;this.model.set(e),this.model.unset("tcb_symbols_tax"),this.model.unset("thumb"),this.model.save(null,{success:function(e){t.$symbol_name.html(e.get("title").rendered),TVE_Dash.success(TVE_Admin.t.symbol_save)},error:function(e,t,s){var i="";if(t.responseJSON)i=t.responseJSON.message;else if(t.responseText)try{i="parsererror"===s?"Could not parse response: "+t.responseText:JSON.parse(t.responseText).message}catch(e){}i||(i=(t.statusText||s)+(t.status?" ("+t.status+")":"")),TVE_Dash.err(i)}})},duplicate_symbol:function(){var e,t,s,i=this,n=this.model.clone(),a=n.get("tcb_symbols_tax");s=_.isEmpty(a)?a:a[0].term_id,t={content:n.get("content"),status:n.get("status"),tcb_symbols_tax:s,title:n.get("title").rendered,tve_custom_css:n.get("tve_custom_css"),tve_updated_post:n.get("tve_updated_post")},(e=new l(t)).save({old_id:n.get("id")},{success:function(t){var s=new u.views.Item({model:t});i.$el.after(s.render().$el),TVE_Dash.success(TVE_Admin.t.duplicate_symbol_success),e.unset("old_id")},error:function(e){TVE_Dash.err(TVE_Admin.t.cannot_duplicate_symbol)}})},move_symbol:function(){var e=new o(TVE_Admin.symbols_tax_terms.slice(0),{parse:!0});this.modal(h,{model:this.model,categories:e,current_category:this.model.get_current_category(),"max-width":"60%",width:"750px",in_duration:200,out_duration:300})},edit_symbol:function(){window.open(this.model.get("edit_url"),"_blank")}}),e.exports={base:u.views.Base,category:u.views.Category}},65378:function(e,t,s){var i=s(37866),n=s(41435),a=s(6617),o=s(62451),r=s(35909);e.exports=i.base_view.extend({template:TVE_Dash.tpl("c-item"),className:"tcb-admin-c-item-row",events:{"click .tcb-admin-edit-category-name":"editCategoryTitle","click .tcb-admin-delete-category-item":"deleteCategory","click .tcb-admin-show-more-less-btn":"showMoreShowLess"},index:0,initialize:function(e){this.collection=new r(this.model.get("tpl")),this.listenTo(this.collection,"remove",(function(){window.TVE_Admin.router.templatessymbols()})),this.listenTo(this.model,"destroy",(function(){window.TVE_Admin.router.templatessymbols()}))},render:function(){return this.$el.html(this.template({model:this.model,collection_length:this.collection.length})),this.$categoryTitle=this.$(".tvd-card-title"),this.collection.each(this.renderOneTemplateItem,this),this.index>5&&this.$(".tcb-admin-show-more-less").removeClass("hidden"),this},renderOneTemplateItem:function(e){this.index++;var t=new n({model:e,index:this.index});return this.$(".tcb-admin-template-t-item").append(t.render().$el),this},showMoreShowLess:function(){var e=this.$(".tcb-admin-show-hide-tpl"),t=this.$(".tcb-admin-show-more-less-btn");e.is(":visible")?(e.addClass("hidden"),t.html(TVE_Admin.t.show_more)):(e.removeClass("hidden"),t.html(TVE_Admin.t.show_less))},deleteCategory:function(){this.modal(o,{model:this.model,title:"Delete category",text:TVE_Admin.t.delete_category_txt.replace("%s",this.model.get("name")),extra_setting:1,"max-width":"60%",width:"750px",in_duration:200,out_duration:300})},editCategoryTitle:function(){var e=this,t=this.$(".tcb-admin-edit-category-name"),s=new Backbone.Model({value:this.model.get("name"),label:"",required:!0}),i=new a({model:s,tagName:"div"});t.hide(),this.$categoryTitle.hide().after(i.render().$el),s.on("change:value",(function(){e.saveCategoryName.apply(e,arguments),i.remove(),e.$categoryTitle.show(),t.show()})),s.on("tcb_admin_no_change",(function(){e.$categoryTitle.html(e.model.get("name")).show(),i.remove(),t.show()})),i.focus()},saveCategoryName:function(e,t){var s=this;this.model.set("name",t),this.model.save(null,{success:function(e,i){s.$categoryTitle.html(t),TVE_Dash.success(i.text)},error:function(e,t){TVE_Dash.err(t.responseText)}})}})},7801:function(e,t,s){var i=s(37866);e.exports=i.base_view.extend({template:TVE_Dash.tpl("item"),render:function(){return this.$el.html(this.template({model:this.model})),TVE_Dash.hideLoader(),this}})},47285:function(e,t,s){var i=s(37866),n=s(70406),a=s(65378),o=s(3359);e.exports=i.base_view.extend({template:TVE_Dash.tpl("list"),events:{"click #tcb-add-new-category":"addNewCategory"},render:function(){return this.$el.html(this.template({})),this.collection.each(this.renderOne,this),TVE_Dash.hideLoader(),this},renderOne:function(e){var t=new a({model:e});return this.$el.append(t.render().$el),this},addNewCategory:function(){this.modal(n,{model:new o({})})}})},41435:function(e,t,s){var i=s(37866),n=s(6617),a=s(77052),o=s(62451);e.exports=i.base_view.extend({template:TVE_Dash.tpl("t-item"),className:"tvd-col tcb-admin-c-item-card",events:{"click .tcb-admin-edit-template-name":"editTitle","click .tcb-admin-icon-move-symbol":"moveCategory","click .tcb-admin-delete-template-item":"deleteTemplate"},initialize:function(e){this.index=e.index},render:function(){return this.$el.html(this.template({model:this.model})),this.$templateTitle=this.$(".tvd-card-title"),this.index>5&&this.$el.addClass("tcb-admin-show-hide-tpl hidden"),this},deleteTemplate:function(){this.modal(o,{model:this.model,text:TVE_Admin.t.delete_template_txt.replace("%s",this.model.get("name")),extra_setting:0,"max-width":"60%",width:"750px",in_duration:200,title:"Delete template",out_duration:300})},moveCategory:function(){this.modal(a,{model:this.model,"max-width":"60%",width:"750px",in_duration:200,out_duration:300})},editTitle:function(){var e=this,t=this.$(".tcb-admin-edit-template-name"),s=new Backbone.Model({value:this.model.get("name"),label:"",required:!0});t.hide();var i=new n({model:s,tagName:"div"});this.$templateTitle.hide().after(i.render().$el),s.on("change:value",(function(){e.saveName.apply(e,arguments),i.remove(),e.$templateTitle.show(),t.show()})),s.on("tcb_admin_no_change",(function(){e.$templateTitle.html(e.model.get("name")).show(),i.remove(),t.show()})),i.focus()},saveName:function(e,t){var s=this;this.model.set("name",t),this.model.save(null,{success:function(e,i){s.$templateTitle.html(t),TVE_Dash.success(i.text)},error:function(e,t){TVE_Dash.err(t.responseText)}})}})},6617:function(e,t,s){var i=s(37866);e.exports=i.base_view.extend({className:"tvd-input-field",template:TVE_Dash.tpl("text-edit"),events:{"keyup input":"keyup","change input":function(){var e=this.input.val().trim();return e?(this.model.set("value",e),!1):(this.input.addClass("tvd-invalid"),!1)},"blur input":function(){this.model.trigger("tcb_admin_no_change")}},keyup:function(e){27===e.which&&this.model.trigger("tcb_admin_no_change")},render:function(){return this.$el.html(this.template({item:this.model})),this.input=this.$("input"),this},focus:function(){this.input.focus().select()}})}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i](a,a.exports,s),a.exports}_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/<#=([\s\S]+?)#>/g,escape:/<#-([\s\S]+?)#>/g},function(e){const t=window.TVE_Admin=window.TVE_Admin||{};t.globals=t.globals||{},e((function(){const i=s(42846),n=s(86916),a=Backbone.Router.extend({view:null,$el:e("#tcb-admin-dashboard-wrapper"),routes:{templates:"templates","template/:id":"template_view",symbols:"symbols",templatessymbols:"templatessymbols"},breadcrumbs:{col:null,view:null},init_breadcrumbs:function(){var e=s(39373),t=s(66723);this.breadcrumbs.col=new t,this.breadcrumbs.view=new e({collection:this.breadcrumbs.col})},init_header:function(e){var t=s(82551);this.header_view=new t(e)},set_page:function(s,i,n){this.breadcrumbs.col.reset(),n=n||{},this.breadcrumbs.col.add_page(t.dash_url,t.t.dashboard,!0),_.each(n,_.bind((function(e){this.breadcrumbs.col.add_page(e.route,e.label)}),this)),this.breadcrumbs.col.add_page("",i);var a=e("head > title");this.original_title||(this.original_title=a.html()),a.html(i+" &lsaquo; "+this.original_title)},templates:function(){this.init_header({url:t.architect_logo}),this.set_page("templates",t.t.templates);var e=this,i=s(47285);this.view&&this.view.remove(),TVE_Dash.showLoader(),t.globals.templates.fetch({update:!0,success:function(s,n,a){e.view=new i({collection:t.globals.templates}),e.$el.html(e.view.render().$el)},error:function(e,t,s){TVE_Dash.err(t.responseText),TVE_Dash.hideLoader()}})},template_view:function(e){if(this.view&&this.view.remove(),TVE_Dash.opened_modal_view&&TVE_Dash.opened_modal_view.close(),isNaN(parseInt(e)))t.router.navigate("#templatessymbols",{trigger:!0});else{var i=this,n=new(s(86336))({id:parseInt(e)}),a=s(7801);TVE_Dash.showLoader(),n.fetch({cache:!1,success:function(e,t,s){i.view=new a({model:e}),i.$el.html(i.view.render().$el),i.set_page("template/"+e.get("id"),e.get("name"),[{route:"templatessymbols",label:"Templates & Symbols"},{route:"template/"+e.get("id"),label:e.get("name")}])}}).error((function(e){TVE_Dash.err(e.responseText),TVE_Dash.hideLoader(),t.router.navigate("#templates",{trigger:!0})}))}},symbols:function(){this.init_header({url:t.symbols_logo,class:"tcb-sym-header"}),this.set_page("symbols",t.t.templates_symbols),this.view&&this.view.remove(),this.view=new i.base,this.$el.append(this.view.$el).addClass("symbols-dashboard-wrapper")},templatessymbols:function(e){const s=e&&e.tab_selected?e.tab_selected:"ct";this.init_header({url:t.symbols_logo,class:"tcb-sym-header"}),this.set_page("symbols",t.t.global_elements),this.view&&this.view.remove(),this.view=new n({main_view:this,tab_selected:s}),this.$el.append(this.view.render().$el)}});var o=s(96959);t.globals.templates=new o({}),t.router=new a,t.router.init_breadcrumbs(),Backbone.history.stop(),Backbone.history.start({hashchange:!0}),Backbone.history.fragment||t.router.navigate("#templates",{trigger:!0})}))}(jQuery)}();