import{b as p,a as d}from"./vuex.esm.8fdeb4b6.js";import{W as g}from"./WpTable.e9a9eb34.js";import{n as c}from"./_plugin-vue2_normalizer.61652a7c.js";import{D as f}from"./index.da77b995.js";import"./SaveChanges.e40a9083.js";import{_ as m}from"./default-i18n.3a91e0e5.js";import{e as o,i as u}from"./helpers.871dba46.js";import{B as _}from"./Datepicker.d7130848.js";import{C as y,a as P}from"./index.0395bbae.js";import{C as h}from"./Index.ffa20ee1.js";import{a as v,b as $}from"./Caret.6d7f2e24.js";import{S as b}from"./Exclamation.fd45a7b0.js";import{C as w}from"./Table.8c51f443.js";import{C}from"./Card.0104a053.js";import{C as k}from"./Tooltip.68a8a92b.js";import"./attachments.506687b9.js";import"./cleanForSlug.071f7a1a.js";import"./isArrayLikeObject.75d4eb51.js";import"./constants.8df4c584.js";import"./html.50126bda.js";import"./_commonjsHelpers.f84db168.js";import"./NewsChannel.34f76348.js";import"./client.e62d6c37.js";import"./translations.c394afe3.js";import"./portal-vue.esm.98f2e05b.js";import"./Slide.15a07930.js";const S=""+window.__aioseoDynamicImportPreload__("images/import-from-csv.fa7a7c61.png");const n={page:{url:null,priority:{label:"0.7",value:"0.7"},frequency:{label:m("weekly","all-in-one-seo-pack"),value:"weekly"},lastModified:f.now().toFormat("MM/dd/yyyy")}},x={components:{BaseDatepicker:_,CoreAlert:y,CoreModal:h,SvgCircleCheck:v,SvgCircleClose:$,SvgCircleExclamation:b},data(){return{csvFileImage:S,priorityOptionsValues:[],frequencyOptionsValues:[],inputFile:null,filename:null,file:null,loading:!1,showImportModal:!1,page:o(n.page),errors:{url:{invalid:null,exists:null},upload:!1},isLoading:!1,strings:{placeholder:this.$t.sprintf(this.$t.__("Enter a page URL, e.g. %1$s",this.$td),`${this.$aioseo.urls.home}/new-page`),pageUrl:this.$t.__("Page URL",this.$td),priority:this.$t.__("Priority",this.$td),frequency:this.$t.__("Frequency",this.$td),lastModified:this.$t.__("Last Modified",this.$td),addPage:this.$t.__("Add Page",this.$td),importFromCSV:this.$t.__("Import from CSV",this.$td),saveChanges:this.$t.__("Save Changes",this.$td),cancel:this.$t.__("Cancel",this.$td),importAdditionalPages:this.$t.__("Import Additional Pages",this.$td),modalDescription:this.$t.sprintf(this.$t.__("You can import additional page URL's to your sitemap using a CSV file. The following 4 columns are required: %1$sPage URL, Priority, Frequency, Date Modified.%2$s",this.$td),"<strong>","</strong>"),downloadSampleFile:this.$t.__("Download Sample CSV File",this.$td),imgAltText:this.$t.__("CSV example file",this.$td),fileUploadPlaceholder:this.$t.__("Import from CSV file...",this.$td),chooseAFile:this.$t.__("Choose a File",this.$td),import:this.$t.__("Import",this.$td),csvFileTypeRequired:this.$t.__("The file that you've currently selected is not a CSV file.",this.$td),invalidCSV:this.$t.__("Unable to read CSV file. Please check if the file is valid and try again.",this.$td),errors:{url:{invalid:this.$t.__("Please enter a valid URL.",this.$td),exists:this.$t.__("URL already exists.",this.$td)}}},sampleCSVData:`Page URL,Priority,Frequency,Date Modified\r
https://aioseo.com/pricing/,0.0,weekly,01/30/2022`}},methods:{...p(["updateAdditionalPages"]),addPage(){const s=[...this.pages];s.unshift(JSON.stringify(this.page)),this.updateAdditionalPages(s),this.page=o(n.page),this.errors.url.invalid=null,this.$emit("process-page-add-and-update")},editPage(s,e){if(this.$set(this.page,s,e),!u(this.page.url)&&this.page.url){this.errors.url.invalid=!0;return}if(this.pageExists(this.page.url)&&!this.inTable){this.errors.url.invalid=!1,this.errors.url.exists=!0;return}this.errors.url.invalid=!1,this.errors.url.exists=!1,this.inTable&&this.$emit("process-page-edit",this.page)},updatePage(s){const e=[...this.pages];e[this.getPaginatedIndex(s)]=JSON.stringify(this.page),this.updateAdditionalPages(e),this.$emit("process-page-add-and-update"),this.$emit("cancel",!0)},pageExists(s){return this.getParsedPages().some(({url:e})=>e===s)},reset(){this.errors.upload=!1,this.filename=null,this.file=null,this.inputFile=null},triggerFileUpload(){this.reset(),this.$refs.file.$el.querySelector("input").focus(),this.$refs.file.$el.querySelector("input").click()},async submitFile(){this.loading=!0;try{const s=await this.parseFile(),e=this.pages;s.forEach(t=>{const i=this.prepareAdditionalPage(t);i&&e.unshift(JSON.stringify(i))}),this.updateAdditionalPages(e)}catch{this.errors.upload=this.strings.invalidCSV}this.reset(),this.page=o(n.page),this.showImportModal=!1,this.loading=!1},prepareAdditionalPage(s){const e=o(n.page);return s.forEach(t=>{if(u(t)&&!this.pageExists(t)){e.url=t;return}if(this.priorityOptionsValues.includes(t)){e.priority.label=e.priority.value=t;return}if(this.frequencyOptionsValues.includes(t.toLowerCase())){e.frequency.label=e.frequency.value=t.toLowerCase();return}isNaN(Date.parse(t))||(e.lastModified=t)}),e.url!==null?e:!1},parseFile(){const s=new FileReader;return s.readAsText(this.file),new Promise((e,t)=>{s.onerror=()=>{s.abort(),t(new DOMException)},s.onload=()=>{const r=s.result.split(/[\r\n]/).map(l=>l.split(","));e(r)}})},handleFileUpload(){this.reset(),this.file=this.$refs.file.$el.querySelector("input").files[0],this.file&&(this.filename=this.file.name,this.file.type!=="text/csv"&&(this.errors.upload=this.strings.csvFileTypeRequired))},closeImportModal(){this.reset(),this.showImportModal=!1}},computed:{...d({pages:s=>s.options.sitemap.general.additionalPages.pages}),importValidated(){return this.file.type==="text/csv"}},props:{inTable:Boolean,row:Object,index:Number,getPaginatedIndex:Function,getParsedPages:Function,rowPage:{type:Object,default(){return{}}},editedPage:{type:Object,default(){return{}}}},mounted(){this.priorityOptionsValues=this.$constants.PRIORITY_OPTIONS.map(s=>s.value),this.frequencyOptionsValues=this.$constants.FREQUENCY_OPTIONS.map(s=>s.value),this.inTable&&(this.page=this.rowPage!==this.editedPage?this.rowPage:this.editedPage)}};var D=function(){var e=this,t=e._self._c;return t("div",{staticClass:"additional-pages-input",class:{"in-table":e.inTable}},[e.inTable?e._e():t("div",{staticClass:"page-input-header"},[t("div",{staticClass:"page-url"},[e._v(e._s(e.strings.pageUrl))]),t("div",{staticClass:"page-priority"},[e._v(e._s(e.strings.priority))]),t("div",{staticClass:"page-frequency"},[e._v(e._s(e.strings.frequency))]),t("div",{staticClass:"page-last-modified"},[e._v(e._s(e.strings.lastModified))])]),t("div",{staticClass:"page-row"},[t("div",{staticClass:"page-url"},[t("base-input",{class:this.errors.url.invalid&&"aioseo-error"||this.page.url&&this.errors.url.exists&&"aioseo-warning"||this.page.url&&"aioseo-active",attrs:{value:e.page.url,size:"medium",placeholder:e.strings.placeholder},on:{keyup:function(i){return e.editPage("url",i.target.value)}},scopedSlots:e._u([{key:"append-icon",fn:function(){return[t("div",{staticClass:"append-icon"},[e.isLoading?e._e():[e.errors.url.invalid?t("svg-circle-close"):e._e(),!e.errors.url.invalid&&!e.errors.url.exists&&e.page.url?t("svg-circle-check"):e._e(),e.errors.url.exists&&e.page.url?t("svg-circle-exclamation"):e._e()]],2)]},proxy:!0}])}),this.errors.url.invalid?t("core-alert",{attrs:{type:"red",size:"small"}},[e._v(" "+e._s(e.strings.errors.url.invalid)+" ")]):e._e(),this.errors.url.exists?t("core-alert",{attrs:{type:"yellow",size:"small"}},[e._v(" "+e._s(e.strings.errors.url.exists)+" ")]):e._e()],1),t("div",{staticClass:"page-priority"},[t("base-select",{attrs:{size:"medium",value:e.page.priority,options:e.$constants.PRIORITY_OPTIONS},on:{input:function(i){return e.editPage("priority",i)}}})],1),t("div",{staticClass:"page-frequency"},[t("base-select",{attrs:{size:"medium",value:e.page.frequency,options:e.$constants.FREQUENCY_OPTIONS},on:{input:function(i){return e.editPage("frequency",i)}}})],1),t("div",{staticClass:"page-last-modified"},[t("base-datepicker",{attrs:{size:"medium",value:e.page.lastModified},on:{input:function(i){return e.editPage("lastModified",i)}}})],1)]),t("div",{staticClass:"page-input-footer"},[e.inTable?t("div",[t("base-button",{attrs:{type:"blue",size:"medium",disabled:e.errors.url.invalid||e.errors.url.exists||!e.page.url},on:{click:function(i){return e.updatePage(e.index)}}},[e._v(" "+e._s(e.strings.saveChanges)+" ")]),t("base-button",{attrs:{type:"gray",size:"medium"},on:{click:function(i){return e.$emit("cancel",!0)}}},[e._v(" "+e._s(e.strings.cancel)+" ")])],1):e._e(),e.inTable?e._e():t("div",[t("base-button",{attrs:{type:"blue",size:"small-table",disabled:e.errors.url.invalid||e.errors.url.exists||!e.page.url},on:{click:e.addPage}},[e._v(" "+e._s(e.strings.addPage)+" ")]),t("base-button",{attrs:{type:"black",size:"small-table"},on:{click:function(i){e.showImportModal=!0}}},[e._v(" "+e._s(e.strings.importFromCSV)+" ")])],1)]),e.showImportModal?t("core-modal",{on:{close:e.closeImportModal},scopedSlots:e._u([{key:"headerTitle",fn:function(){return[e._v(" "+e._s(e.strings.importAdditionalPages)+" ")]},proxy:!0},{key:"body",fn:function(){return[t("div",{staticClass:"aioseo-modal-body import-additional-pages"},[t("div",{staticClass:"alert"},[t("p",{domProps:{innerHTML:e._s(e.strings.modalDescription)}}),t("a",{attrs:{download:"aioseo-additional-pages-sample.csv",href:"data:text/csv;charset=utf-8,"+e.sampleCSVData}},[e._v(" "+e._s(e.strings.downloadSampleFile)+" ")])]),t("img",{attrs:{src:e.$getAssetUrl(e.csvFileImage),alt:e.strings.imgAltText}}),e.errors.upload?t("core-alert",{staticClass:"import-error",attrs:{type:"red"}},[t("svg-circle-close"),e._v(" "+e._s(e.errors.upload)+" ")],1):e._e(),t("div",{staticClass:"file-upload"},[t("base-input",{class:{"aioseo-error":e.errors.upload},attrs:{size:"medium",placeholder:e.strings.fileUploadPlaceholder},on:{focus:e.triggerFileUpload},model:{value:e.filename,callback:function(i){e.filename=i},expression:"filename"}}),t("base-button",{attrs:{type:"black",size:"medium"}},[e._v(" "+e._s(e.strings.chooseAFile)+" "),t("base-input",{ref:"file",attrs:{type:"file"},on:{click:e.reset,change:e.handleFileUpload},model:{value:e.inputFile,callback:function(i){e.inputFile=i},expression:"inputFile"}})],1)],1),t("base-button",{staticClass:"import",attrs:{type:"blue",size:"medium",disabled:!e.file||!e.importValidated,loading:e.loading},on:{click:e.submitFile}},[e._v(" "+e._s(e.strings.import)+" ")])],1)]},proxy:!0}],null,!1,2709596361)}):e._e()],1)},L=[],A=c(x,D,L,!1,null,null,null,null);const R=A.exports;const U={mixins:[g],components:{AddAdditionalPage:R,CoreWpTable:w,CoreCard:C,CoreTooltip:k,CoreModal:h,SvgTrash:P},data(){return{tableId:"sitemap-additional-pages",changeItemsPerPageSlug:"sitemapAdditionalPages",page:{},editedPage:{},resultsPerPage:10,searchResults:null,deletingRow:!1,activeRow:-1,showDeleteModal:!1,shouldDeleteURL:null,selectedRows:null,bulkOptions:[{label:this.$t.__("Delete",this.$tdPro),value:"delete"}],strings:{placeholder:this.$t.sprintf(this.$t.__("Enter a page URL, e.g. %1$s",this.$td),`${this.$aioseo.urls.home}/new-page`),pageUrl:this.$t.__("Page URL",this.$td),priority:this.$t.__("Priority",this.$td),frequency:this.$t.__("Frequency",this.$td),lastModified:this.$t.__("Last Modified",this.$td),searchUrls:this.$t.__("Search URLs",this.$td),edit:this.$t.__("Edit",this.$td),delete:this.$t.__("Delete",this.$td),addPage:this.$t.__("Add Page",this.$td),importFromCSV:this.$t.__("Import from CSV",this.$td),always:this.$t.__("always",this.$td),additionalPages:this.$t.__("Additional Pages",this.$td),additionalPagesTooltip:this.$t.__("You can use this section to add any URLs to your sitemap which aren't a part of your WordPress installation. For example, if you have a contact form that you would like to be included on your sitemap you can enter the information manually.",this.$td),areYouSureDeleteLink:this.$t.__("Are you sure you want to delete this page?",this.$td),areYouSureDeleteLinks:this.$t.__("Are you sure you want to delete these pages?",this.$td),thisWillRemoveLink:this.$t.__("This will permanently remove this page from the additional pages sitemap.",this.$td),thisWillRemoveLinks:this.$t.__("This will permanently remove the selected pages from the additional pages sitemap.",this.$td),yesDeleteLink:this.$t.__("Delete Page",this.$td),yesDeleteLinks:this.$t.__("Delete Selected Pages",this.$td),noChangedMind:this.$t.__("No, I changed my mind",this.$td)}}},computed:{...d(["options","additionalPages"]),...d({pages:s=>s.options.sitemap.general.additionalPages.pages}),currentPages(){return this.searchResults||this.getParsedPages()},rows(){const s=this.currentPages.map(t=>({url:t.url,priority:t.priority&&t.priority.label?t.priority.label:"",frequency:t.frequency&&t.frequency.label?t.frequency.label:"",lastModified:t.lastModified})),e=this.pageNumber===1?0:(this.pageNumber-1)*this.resultsPerPage;return s.slice(e,e+this.resultsPerPage)},totals(){return{page:1,pages:Math.ceil(this.currentPages.length/this.resultsPerPage),total:this.currentPages.length}},columns(){return[{slug:"url",label:this.$t.__("Page URL",this.$td)},{slug:"priority",label:this.$t.__("Priority",this.$td),width:"90px"},{slug:"frequency",label:this.$t.__("Frequency",this.$td),width:"90px"},{slug:"lastModified",label:this.$t.__("Last Modified",this.$td),width:"110px"},{slug:"page-actions",label:"",width:"40px"}]},areYouSureDeleteLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.areYouSureDeleteLinks:this.strings.areYouSureDeleteLink},yesDeleteLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.yesDeleteLinks:this.strings.yesDeleteLink},thisWillRemoveLink(){return Array.isArray(this.shouldDeleteURL)?this.strings.thisWillRemoveLinks:this.strings.thisWillRemoveLink}},methods:{...p(["updateAdditionalPages"]),fetchData(){return Promise.resolve()},processSearch(s){if(this.$refs.table.editRow(null),this.pageNumber=1,s===""){this.searchResults=null,this.searchTerm=null;return}s||(s=this.searchTerm),this.wpTableLoading=!0,this.searchResults=this.getParsedPages().filter(e=>e.url.includes(s)),this.searchTerm=s,this.wpTableLoading=!1},processBulkAction({action:s,selectedRows:e}){e.length&&s==="delete"&&(this.showDeleteModal=!0,this.shouldDeleteURL=e)},processPageDelete(){this.wpTableLoading=!0,Array.isArray(this.shouldDeleteURL)?this.shouldDeleteURL.forEach(s=>{this.deletePage(s)}):this.deletePage(this.shouldDeleteURL),this.showDeleteModal=!1,this.wpTableLoading=!1},deletePage(s){const e=[];this.getParsedPages().forEach(t=>{t.url!==s&&e.push(JSON.stringify(t))}),this.updateAdditionalPages(e),this.searchResults&&this.processSearch()},maybeProcessDelete(s){this.showDeleteModal=!0,this.shouldDeleteURL=s},processPageEdit(s){this.editedPage=s},processPageAddAndUpdate(){this.searchTerm&&this.processSearch(this.searchTerm)},rowPage(s){return this.searchResults?this.searchResults[this.getPaginatedIndex(s)]:this.getParsedPages()[this.getPaginatedIndex(s)]},getPaginatedIndex(s){return(this.pageNumber-1)*this.resultsPerPage+s},getParsedPages(){return this.pages.map(s=>JSON.parse(s))}}};var F=function(){var e=this,t=e._self._c;return e.options.sitemap.general.enable?t("core-card",{attrs:{slug:"additionalPages",toggles:e.options.sitemap.general.additionalPages.enable},scopedSlots:e._u([{key:"header",fn:function(){return[t("base-toggle",{model:{value:e.options.sitemap.general.additionalPages.enable,callback:function(i){e.$set(e.options.sitemap.general.additionalPages,"enable",i)},expression:"options.sitemap.general.additionalPages.enable"}}),t("span",[e._v(e._s(e.strings.additionalPages))])]},proxy:!0},{key:"tooltip",fn:function(){return[e._v(" "+e._s(e.strings.additionalPagesTooltip)+" ")]},proxy:!0}],null,!1,1670858465)},[t("div",{staticClass:"aioseo-additional-pages"},[t("add-additional-page",{attrs:{getPaginatedIndex:e.getPaginatedIndex,getParsedPages:e.getParsedPages},on:{"process-page-add-and-update":e.processPageAddAndUpdate}}),t("core-wp-table",{key:e.wpTableKey,ref:"table",staticClass:"additional-pages-table",attrs:{id:e.tableId,"bulk-options":e.bulkOptions,columns:e.columns,"initial-items-per-page":e.$aioseo.settings.tablePagination.sitemapAdditionalPages,"initial-page-number":e.pageNumber,loading:e.wpTableLoading,rows:e.rows,"search-label":e.strings.searchUrls,"show-search":!0,totals:e.totals,"show-items-per-page":""},on:{paginate:e.processPagination,"process-bulk-action":e.processBulkAction,"process-change-items-per-page":e.processChangeItemsPerPage,search:e.processSearch,"sort-column":e.processSort},scopedSlots:e._u([{key:"url",fn:function({row:i,index:r,editRow:l}){return[t("a",{staticClass:"post-title",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),l(r)}}},[e._v(" "+e._s(i.url)+" ")]),t("div",{staticClass:"row-actions"},[t("span",[t("a",{staticClass:"edit",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),l(r)}}},[t("span",[e._v(e._s(e.strings.edit))])]),e._v(" | ")]),t("span",[t("a",{staticClass:"delete",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),a.stopPropagation(),e.maybeProcessDelete(i.url)}}},[t("span",[e._v(e._s(e.strings.delete))])])])])]}},{key:"edit-row",fn:function({index:i,editRow:r}){return[t("add-additional-page",{attrs:{index:i,rowPage:e.rowPage(i),editedPage:e.editedPage,getPaginatedIndex:e.getPaginatedIndex,getParsedPages:e.getParsedPages,inTable:""},on:{cancel:function(l){return r(null)},"process-page-add-and-update":e.processPageAddAndUpdate,"process-page-edit":e.processPageEdit}})]}},{key:"page-actions",fn:function({row:i}){return[t("div",{staticClass:"page-actions"},[t("core-tooltip",{attrs:{type:"action"},scopedSlots:e._u([{key:"tooltip",fn:function(){return[e._v(" "+e._s(e.strings.delete)+" ")]},proxy:!0}],null,!0)},[t("svg-trash",{nativeOn:{click:function(r){return e.maybeProcessDelete(i.url)}}})],1)],1)]}}],null,!1,3880771216)}),e.showDeleteModal?t("core-modal",{attrs:{"no-header":""},on:{close:function(i){e.showDeleteModal=!1}},scopedSlots:e._u([{key:"body",fn:function(){return[t("div",{staticClass:"aioseo-modal-body delete"},[t("button",{staticClass:"close",on:{click:function(i){i.stopPropagation(),e.showDeleteModal=!1}}}),t("h3",[e._v(e._s(e.areYouSureDeleteLink))]),t("div",{staticClass:"reset-description"},[e._v(" "+e._s(e.strings.thisWillRemoveLink)+" ")]),t("base-button",{attrs:{type:"blue",size:"medium",loading:e.deletingRow},on:{click:e.processPageDelete}},[e._v(" "+e._s(e.yesDeleteLink)+" ")]),t("base-button",{attrs:{type:"gray",size:"medium"},on:{click:function(i){e.showDeleteModal=!1}}},[e._v(" "+e._s(e.strings.noChangedMind)+" ")])],1)]},proxy:!0}],null,!1,3154880166)}):e._e()],1)]):e._e()},T=[],M=c(U,F,T,!1,null,null,null,null);const ne=M.exports;export{ne as default};
