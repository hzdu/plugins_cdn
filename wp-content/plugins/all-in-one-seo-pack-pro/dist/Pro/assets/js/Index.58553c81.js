import{d as x,i as R}from"./index.da77b995.js";import{W as h}from"./WpTable.e9a9eb34.js";import{n as u}from"./_plugin-vue2_normalizer.61652a7c.js";import"./SaveChanges.e40a9083.js";import{C as m}from"./Tooltip.68a8a92b.js";import{C as g}from"./Table.8c51f443.js";import{a as f,b as E,c as D}from"./Affiliate.e587b0fd.js";import{a as b,C as O}from"./index.0395bbae.js";import{P as y}from"./PostTypes.9ab32454.js";import{S as I}from"./Suggestion.5facc4fd.js";import{a as $,m as A,c as q}from"./vuex.esm.8fdeb4b6.js";import{C as N}from"./Tabs.659e6500.js";import{C as H}from"./Index.ffa20ee1.js";import{S as U,e as T,d as F}from"./Caret.6d7f2e24.js";import{B as Y}from"./Editor.e0f43476.js";import{T as S}from"./Slide.15a07930.js";import{S as L}from"./Plus.6984df43.js";const l=i=>i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),os={methods:{filteredSuggestionsOutbound(i){const t=i.links.suggestionsOutbound.rows,s=[];return t.forEach(e=>{this.editorIsSuggestionAlreadyAdded(e)||s.push(e)}),s},editorIsSuggestionAlreadyAdded(i){return x()?this.blockEditorIsSuggestionAlreadyAdded(i):R()?this.classicEditorIsSuggestionAlreadyAdded(i):!1},blockEditorIsSuggestionAlreadyAdded(i){const t=window.wp.data.select("core/block-editor").getBlocks();return t?this.doesBlockHaveLink(t,i):!1},doesBlockHaveLink(i,t){let s=!1;return i.forEach(e=>{s||!e.attributes||t.suggestions.forEach(n=>{const o=l(n.context.permalink.trim()),r=new RegExp(`(<a href="${o}"[^<>]*>)(.*)(</a[^<>]*>)`,"i");if(e.attributes.content&&e.attributes.content.search(r)!==-1){s=!0;return}if(!e.innerBlocks)return;this.doesBlockHaveLink(e.innerBlocks,t)&&(s=!0)})}),s},classicEditorIsSuggestionAlreadyAdded(i){let t="",s=null,e=null;if(document.querySelector("#wp-content-wrap.tmce-active")?(s=window.tinyMCE.get("content"),t=s.getContent({format:"raw"})):(e=document.querySelector("textarea#content"),t=e?e.value:""),!t)return!1;let n=!1;return i.suggestions.forEach(o=>{const r=l(o.context.permalink.trim()),a=new RegExp(`(<a href="${r}"[^<>]*>)(.*)(</a[^<>]*>)`,"i");t.search(a)!==-1&&(n=!0)}),n}}},C={methods:{findTargetBlock(i,t){const s=l(t);let e=null;return i.forEach(n=>{if(e||!n.attributes)return;if(n.attributes.content&&n.attributes.content.search(s)!==-1){e=n.clientId;return}if(!n.innerBlocks)return;const o=this.findTargetBlock(n.innerBlocks,t);o&&(e=o)}),e}}},v={mixins:[C],props:{post:{type:Object,required:!0},postIndex:{type:Number,required:!1},postId:{type:Number,required:!1},linksReport:{type:Boolean,default(){return!1}},postReport:{type:Boolean,default(){return!1}},metabox:{type:Boolean,default(){return!1}}},beforeMount(){this.$bus.$on("updatingLinks",i=>{this.wpTableLoading=i}),this.pageNumber=this.linkType?this.linkAssistant.postReport[this.linkType].totals.page:1},data(){return{changeItemsPerPageSlug:"linkAssistantPostsReport",action:"",showModal:!1,selectedRows:[],bulkOptions:[{label:this.$t.__("Delete",this.$td),value:"delete"}],strings:{frontPage:this.$t.__("Front Page",this.$tdPro),deleteLink:this.$t.__("Delete Link",this.$tdPro)},modalStrings:{areYouSureSingle:this.$t.__("Are you sure you want to delete this link?",this.$tdPro),areYouSureMultiple:this.$t.__("Are you sure you want to delete these links?",this.$tdPro),areYouSureAll:this.$t.__("Are you sure you want to delete all links?",this.$tdPro),actionCannotBeUndone:this.$t.__("This action cannot be undone.",this.$tdPro),yesSingle:this.$t.__("Yes, I want to delete this link",this.$tdPro),yesMultiple:this.$t.__("Yes, I want to delete these links",this.$tdPro),yesAll:this.$t.__("Yes, I want to delete all links",this.$tdPro),noChangedMind:this.$t.__("No, I changed my mind",this.$tdPro)}}},computed:{...$(["linkAssistant","currentPost"]),rows(){if(!this.metabox)return this.post.links[this.linkType].rows;const i=this.pageNumber===1?0:(this.pageNumber-1)*10;return this.post.links[this.linkType].rows.slice(i,i+10)}},methods:{...A("linkAssistant",["linkDelete","linksBulk","fetchPostReport","fetchLinksReportInner","postSettingsUpdate"]),fetchData(i){this.$bus.$emit("updatingLinks",!0);const t={...i,additionalFilters:{postId:this.post.ID||this.currentPost.id,postIndex:this.postIndex,type:this.linkType}},s=this.postReport?"fetchPostReport":"fetchLinksReportInner";return this[s](t).finally(()=>{this.$bus.$emit("updatingLinks",!1)})},openPostReport(i){window.location.href=`#/post-report?postId=${this.postId}&postIndex=${this.postIndex}&initialTab=${i}`},maybeDoBulkAction({action:i,selectedRows:t}){t===!1||!i||(this.action=i,this.selectedRows=t,this.showModal=!0)},doBulkAction(){if(this.showModal=!1,!(this.selectedRows===!1||typeof this.selectedRows>"u")){if(typeof this.selectedRows=="number"){this.doDeleteLink(this.selectedRows);return}if(this.metabox&&this.linkType!=="inboundInternal"){this.idsToIndexes(this.selectedRows).forEach(t=>{this.editorRemoveLink(t)});return}this.$bus.$emit("updatingLinks",!0),this.linksBulk({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,action:this.action,linkType:this.linkType,linkIds:this.selectedRows,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated"),this.refreshTable()})}},doDeleteLink(i){const t=this.post.links[this.linkType].rows[i].id;if(t){if(this.metabox&&this.linkType!=="inboundInternal"){this.editorRemoveLink(i);return}this.$bus.$emit("updatingLinks",!0),this.linkDelete({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,linkId:t,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated"),this.refreshTable()})}},editorRemoveLink(i){x()&&(this.$bus.$emit("updatingLinks",!1),this.blockEditorRemoveLink(i),this.$bus.$emit("updatingLinks",!1)),R()&&this.classicEditorRemoveLink(i)},blockEditorRemoveLink(i){const t=this.currentPost.linkAssistant.links[this.linkType].rows[i];if(!t)return;this.$bus.$emit("updatingLinks",!0);const s=l(t.anchor.trim()),e=t.phrase_html.trim(),n=l(e),o=window.wp.data.select("core/block-editor").getBlocks(),r=this.findTargetBlock(o,e);if(!r){this.$bus.$emit("updatingLinks",!1);return}const a=window.wp.data.select("core/block-editor").getBlock(r);if(!a){this.$bus.$emit("updatingLinks",!1);return}let c=new RegExp(`(<t?a[^<>]*>)(.*)?(${s})(.*)?(</t?a[^<>]*>)`,"i");const d=e.replace(c,"$2$3$4");c=new RegExp(`${n}`,"i"),window.wp.data.dispatch("core/block-editor").updateBlockAttributes(r,{content:a.attributes.content.replace(c,d)}).then(()=>{this.$delete(this.post.links[this.linkType].rows,i)}).catch(k=>{console.error(`Couldn	 delete link with type "${this.linkType}" and index ${i}:`,k)}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})},classicEditorRemoveLink(i){const t=this.currentPost.linkAssistant.links[this.linkType].rows[i];if(!t||!window.tinyMCE)return;this.$bus.$emit("updatingLinks",!0);let s="",e=null,n=null;if(document.querySelector("#wp-content-wrap.tmce-active")?(e=window.tinyMCE.get("content"),s=e.getContent({format:"raw"})):(n=document.querySelector("textarea#content"),s=n?n.value:""),!s){this.$bus.$emit("updatingLinks",!1);return}let o=t.phrase_html.trim();e||(o=o.replace(/(\sdata-mce-href=".*")/gi,""));const r=l(t.anchor.trim());let a=new RegExp(`(<t?a[^<>]*>)(.*)?(${r})(.*)?(</t?a[^<>]*>)`,"i");const c=o.replace(a,"$2$3$4"),d=l(o);a=new RegExp(`${d}`,"i"),s=s.replace(a,c),e?e.setContent(s):n.value=s,this.$delete(this.post.links[this.linkType].rows,i),this.postSettingsUpdate({postContent:s}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated")})},idsToIndexes(i){let t,s=[];return Array.isArray(i)&&(t=i.map(Number)),t&&this.post.links[this.linkType].rows.forEach((e,n)=>{t.includes(e.id)&&s.push(n)}),i==="all"&&(s=this.post.links[this.linkType].rows.map((e,n)=>n)),s.sort(function(e,n){return n-e})}}};const K={components:{CoreModal:H,SvgClose:U},props:{selectedRows:{required:!0},strings:{type:Object,required:!0}},computed:{areYouSure(){return this.selectedRows==="all"?this.strings.areYouSureAll:Array.isArray(this.selectedRows)&&1<this.selectedRows.length?this.strings.areYouSureMultiple:this.strings.areYouSureSingle},confirmation(){return this.selectedRows==="all"?this.strings.yesAll:Array.isArray(this.selectedRows)&&1<this.selectedRows.length?this.strings.yesMultiple:this.strings.yesSingle}}};var W=function(){var t=this,s=t._self._c;return s("core-modal",{staticClass:"aioseo-confirmation-modal",attrs:{"no-header":""},scopedSlots:t._u([{key:"body",fn:function(){return[s("div",{staticClass:"aioseo-modal-body"},[s("button",{staticClass:"close",on:{click:function(e){return e.stopPropagation(),t.$emit("closeModal",!0)}}},[s("svg-close",{on:{click:function(e){return t.$emit("closeModal",!0)}}})],1),s("h3",[t._v(t._s(t.areYouSure))]),s("div",{staticClass:"reset-description",domProps:{innerHTML:t._s(t.strings.actionCannotBeUndone)}}),s("base-button",{attrs:{type:"blue",size:"medium"},on:{click:function(e){return t.$emit("doBulkAction",e)}}},[t._v(" "+t._s(t.confirmation)+" ")]),s("base-button",{attrs:{type:"gray",size:"medium"},on:{click:function(e){return t.$emit("closeModal",!0)}}},[t._v(" "+t._s(t.strings.noChangedMind)+" ")])],1)]},proxy:!0}])})},z=[],G=u(K,W,z,!1,null,null,null,null);const _=G.exports;const Z={components:{CoreTooltip:m},props:{phrase:{type:String,required:!0},phraseHtml:{type:String,required:!0},anchor:{type:String,required:!0},url:{type:String,required:!0},tooltip:{type:Boolean,required:!1,default:!0},clickableAnchor:{type:Boolean,default(){return!1}}},computed:{partPattern(){const i=l(this.anchor);return new RegExp(`(.*)(<t?a[^>]*>.*${i}.*</t?a>)(.*)`,"i")},firstPart(){return this.stripTags(this.getPart(1))},linkAnchor(){return this.stripTags(this.getPart(2))},lastPart(){return this.stripTags(this.getPart(3))}},methods:{getPart(i){const t=this.phraseHtml.match(this.partPattern);return t?t[i]:""},stripTags(i){return i.replace(/(<([^>]+)>)/gi,"")},maybeOpenLink(){this.clickableAnchor&&window.open(this.url,"_blank").focus()}}};var V=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-link-assistant-phrase",on:{mouseover:function(e){return t.$emit("mouseOver")},mouseleave:function(e){return t.$emit("mouseLeave")}}},[s("span",{staticClass:"phrase"},[s("span",{staticClass:"first"},[t._v(t._s(t.firstPart))]),t.tooltip?s("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[s("a",{staticClass:"tooltip-url",attrs:{href:t.url,target:"_blank"}},[t._v(t._s(t.url))])]},proxy:!0}],null,!1,3985851943)},[s("span",{staticClass:"anchor",on:{click:t.maybeOpenLink}},[t._v(t._s(t.linkAnchor))])]):t._e(),t.tooltip?t._e():s("div",[s("span",{staticClass:"anchor"},[t._v(t._s(t.linkAnchor))])]),s("span",{staticClass:"last"},[t._v(t._s(t.lastPart))])],1),t._t("icons")],2)},J=[],Q=u(Z,V,J,!1,null,null,null,null);const w=Q.exports,X={components:{CoreTooltip:m,CoreWpTable:g,LinkAssistantConfirmationModal:_,LinkAssistantPhrase:w,SvgLinkExternal:f,SvgTrash:b},mixins:[v,h],data(){return{tableId:"aioseo-post-report-affiliate",linkType:"affiliate",strings:{deleteAllLinks:this.$t.sprintf(this.$t.__("Delete All %1$s Links",this.$td),this.$t.__("Affiliate",this.$tdPro))}}},computed:{columns(){return[{slug:"phrase",label:this.$t.__("Phrase",this.$td)},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf(this.$t.__("See All %1$s %2$s Links",this.$td),this.post.links.affiliate.totals.total,this.$t.__("Affiliate",this.$tdPro))}},methods:{processPagination(i){this.pageNumber=i,!this.metabox&&(this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1))}}};var j=function(){var t=this,s=t._self._c;return s("div",[s("core-wp-table",{key:t.wpTableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{"bulk-options":t.bulkOptions,columns:t.columns,id:t.tableId,"initial-items-per-page":t.$aioseo.settings.tablePagination.linkAssistantPostsReport,"initial-page-number":t.pageNumber,loading:t.wpTableLoading,rows:t.rows,"show-pagination":!t.linksReport,"show-search":!1,"show-table-footer":t.postReport,totals:t.post.links.affiliate.totals,"show-items-per-page":""},on:{paginate:t.processPagination,"process-bulk-action":t.maybeDoBulkAction,"process-change-items-per-page":t.processChangeItemsPerPage},scopedSlots:t._u([{key:"phrase",fn:function({row:e}){return[s("link-assistant-phrase",{attrs:{phrase:e.phrase,phraseHtml:e.phrase_html,anchor:e.anchor,url:e.url,clickableAnchor:!0}})]}},{key:"delete",fn:function({index:e}){return[s("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[s("svg-trash",{nativeOn:{click:function(n){return t.maybeDoBulkAction({action:"delete",selectedRows:e})}}})],1)]}}])}),t.postReport?t._e():s("div",{staticClass:"links-bottom"},[s("div",{staticClass:"links-bottom-left"},[t.post.links.affiliate.totals.total>5&&t.postReport?s("div",[s("svg-link-external"),s("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPostReport("affiliate")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()]),s("div",{staticClass:"links-bottom-right"},[t.post.links.affiliate.rows.length?s("a",{staticClass:"link-delete",on:{click:function(e){return e.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),t.showModal?s("link-assistant-confirmation-modal",{attrs:{selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(e){t.showModal=!1}}}):t._e()],1)},tt=[],st=u(X,j,tt,!1,null,null,null,null);const rs=st.exports,et={components:{CoreTooltip:m,CoreWpTable:g,LinkAssistantConfirmationModal:_,LinkAssistantPhrase:w,SvgLinkExternal:f,SvgTrash:b},mixins:[v,h],data(){return{tableId:"aioseo-post-report-external",linkType:"external",strings:{deleteAllLinks:this.$t.sprintf(this.$t.__("Delete All %1$s Links",this.$td),this.$t.__("External",this.$tdPro))}}},computed:{columns(){return[{slug:"phrase",label:this.$t.__("Phrase",this.$td)},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf(this.$t.__("See All %1$s %2$s Links",this.$td),this.post.links.external.totals.total,this.$t.__("External",this.$tdPro))}},methods:{processPagination(i){this.pageNumber=i,!this.metabox&&(this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1))}}};var it=function(){var t=this,s=t._self._c;return s("div",[s("core-wp-table",{key:t.wpTableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{"bulk-options":t.bulkOptions,columns:t.columns,id:t.tableId,"initial-items-per-page":t.$aioseo.settings.tablePagination.linkAssistantPostsReport,"initial-page-number":t.pageNumber,loading:t.wpTableLoading,rows:t.rows,"show-pagination":!t.linksReport,"show-search":!1,"show-table-footer":t.postReport,totals:t.post.links.external.totals,"show-items-per-page":""},on:{paginate:t.processPagination,"process-bulk-action":t.maybeDoBulkAction,"process-change-items-per-page":t.processChangeItemsPerPage},scopedSlots:t._u([{key:"phrase",fn:function({row:e}){return[s("link-assistant-phrase",{attrs:{phrase:e.phrase,phraseHtml:e.phrase_html,anchor:e.anchor,url:e.url,clickableAnchor:!0}})]}},{key:"delete",fn:function({index:e}){return[s("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[s("svg-trash",{nativeOn:{click:function(n){return t.maybeDoBulkAction({action:"delete",selectedRows:e})}}})],1)]}}])}),t.postReport?t._e():s("div",{staticClass:"links-bottom"},[s("div",{staticClass:"links-bottom-left"},[t.post.links.external.totals.total>5&&t.linksReport?s("div",[s("svg-link-external"),s("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPostReport("external")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()]),s("div",{staticClass:"links-bottom-right"},[t.post.links.external.rows.length?s("a",{staticClass:"link-delete",on:{click:function(e){return e.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),t.showModal?s("link-assistant-confirmation-modal",{attrs:{selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(e){t.showModal=!1}}}):t._e()],1)},nt=[],ot=u(et,it,nt,!1,null,null,null,null);const as=ot.exports,rt={components:{CoreTooltip:m,CoreWpTable:g,LinkAssistantConfirmationModal:_,LinkAssistantPhrase:w,SvgLinkExternal:f,SvgLinkSuggestion:I,SvgTrash:b},mixins:[v,y,h],data(){return{tableId:"aioseo-post-report-inbound-internal",linkType:"inboundInternal",strings:{deleteAllLinks:this.$t.sprintf(this.$t.__("Delete All %1$s Links",this.$td),this.$t.__("Inbound Internal",this.$td)),outboundSuggestions:this.$t.sprintf(this.$t.__("%1$s Link Suggestions",this.$td),this.$t.__("Inbound",this.$td))}}},computed:{columns(){return[{slug:"post_title",label:this.$t.__("Post Title",this.$td)},{slug:"phrase",label:this.$t.__("Phrase",this.$td)},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf(this.$t.__("See All %1$s %2$s Links",this.$td),this.post.links.inboundInternal.totals.total,this.$t.__("Inbound Internal",this.$td))}},methods:{maybeViewPost(i){var t,s;this.viewPost(((s=(t=i.context)==null?void 0:t.postType)==null?void 0:s.singular)||"Post")},maybeEditPost(i){var t,s;this.editPost(((s=(t=i.context)==null?void 0:t.postType)==null?void 0:s.singular)||"Post")},processPagination(i){this.pageNumber=i,!this.metabox&&(this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1))}}};var at=function(){var t=this,s=t._self._c;return s("div",[s("core-wp-table",{key:t.wpTableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{"bulk-options":t.bulkOptions,columns:t.columns,id:t.tableId,"initial-items-per-page":t.$aioseo.settings.tablePagination.linkAssistantPostsReport,"initial-page-number":t.pageNumber,loading:t.wpTableLoading,rows:t.rows,"show-pagination":!t.linksReport,"show-search":!1,"show-table-footer":t.postReport,totals:t.post.links.inboundInternal.totals,"show-items-per-page":""},on:{paginate:t.processPagination,"process-bulk-action":t.maybeDoBulkAction,"process-change-items-per-page":t.processChangeItemsPerPage},scopedSlots:t._u([{key:"post_title",fn:function({row:e}){return[s("span",[t._v(" "+t._s(e.context.postTitle)+" "),e.context.permalink.replace(/\/$/,"")===t.$aioseo.urls.home?s("span",[t._v("("+t._s(t.strings.frontPage)+")")]):t._e()]),e.context?s("div",{staticClass:"row-actions"},[s("span",{staticClass:"view"},[s("a",{attrs:{href:e.context.permalink,target:"_blank"}},[t._v(t._s(t.maybeViewPost(e)))]),t._v(" | ")]),s("span",{staticClass:"edit"},[s("a",{attrs:{href:e.context.editLink,target:"_blank"}},[t._v(t._s(t.maybeEditPost(e)))])])]):t._e()]}},{key:"phrase",fn:function({row:e}){return[s("link-assistant-phrase",{attrs:{phrase:e.phrase,phraseHtml:e.phrase_html||"",anchor:e.anchor,url:e.url,clickableAnchor:!0}})]}},{key:"delete",fn:function({index:e}){return[s("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[s("svg-trash",{nativeOn:{click:function(n){return t.maybeDoBulkAction({action:"delete",selectedRows:e})}}})],1)]}}])}),t.postReport?t._e():s("div",{staticClass:"links-bottom"},[s("div",{staticClass:"links-bottom-left"},[t.post.links.inboundInternal.rows.length?s("base-button",{attrs:{type:"blue",tag:"button"},nativeOn:{click:function(e){return t.$emit("openSuggestions")}}},[s("svg-link-suggestion"),t._v(" "+t._s(t.strings.outboundSuggestions)+" ")],1):t._e(),t.post.links.inboundInternal.totals.total>5&&t.linksReport?s("div",[s("svg-link-external"),s("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPostReport("inbound-internal")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()],1),s("div",{staticClass:"links-bottom-right"},[t.post.links.inboundInternal.rows.length?s("a",{staticClass:"link-delete",on:{click:function(e){return e.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),t.showModal?s("link-assistant-confirmation-modal",{attrs:{selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(e){t.showModal=!1}}}):t._e()],1)},lt=[],ut=u(rt,at,lt,!1,null,null,null,null);const ls=ut.exports,ct={components:{CoreTooltip:m,CoreWpTable:g,LinkAssistantConfirmationModal:_,LinkAssistantPhrase:w,SvgLinkExternal:f,SvgLinkSuggestion:I,SvgTrash:b},mixins:[v,y,h],data(){return{tableId:"aioseo-post-report-outbound-internal",linkType:"outboundInternal",strings:{deleteAllLinks:this.$t.sprintf(this.$t.__("Delete All %1$s Links",this.$td),this.$t.__("Outbound Internal",this.$tdPro)),outboundSuggestions:this.$t.sprintf(this.$t.__("%1$s Link Suggestions",this.$td),this.$t.__("Outbound",this.$tdPro)),openUrl:this.$t.__("Open URL",this.$tdPro)}}},computed:{columns(){return[{slug:"post_title",label:this.$t.__("Post Title / URL",this.$tdPro)},{slug:"phrase",label:this.$t.__("Phrase",this.$td)},{slug:"delete",width:"50px"}]},seeAllLinks(){return this.$t.sprintf(this.$t.__("See All %1$s %2$s Links",this.$td),this.post.links.outboundInternal.totals.total,this.$t.__("Outbound Internal",this.$tdPro))}},methods:{processPagination(i){this.pageNumber=i,!this.metabox&&(this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1))}}};var dt=function(){var t=this,s=t._self._c;return s("div",[s("core-wp-table",{key:t.wpTableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{"bulk-options":t.bulkOptions,columns:t.columns,id:t.tableId,"initial-items-per-page":t.$aioseo.settings.tablePagination.linkAssistantPostsReport,"initial-page-number":t.pageNumber,loading:t.wpTableLoading,rows:t.rows,"show-pagination":!t.linksReport,"show-search":!1,"show-table-footer":t.postReport,totals:t.post.links.outboundInternal.totals,"show-items-per-page":""},on:{paginate:t.processPagination,"process-bulk-action":t.maybeDoBulkAction,"process-change-items-per-page":t.processChangeItemsPerPage},scopedSlots:t._u([{key:"post_title",fn:function({row:e}){return[e.context&&e.context.postTitle?s("span",[t._v(" "+t._s(e.context.postTitle)+" "),e.url.replace(/\/$/,"")===t.$aioseo.urls.home?s("span",[t._v("("+t._s(t.strings.frontPage)+")")]):t._e()]):t._e(),!e.context||!e.context.postTitle?s("span",[t._v(" "+t._s(e.url)+" "),e.url.replace(/\/$/,"")===t.$aioseo.urls.home?s("span",[t._v("("+t._s(t.strings.frontPage)+")")]):t._e()]):t._e(),e.context?s("div",{staticClass:"row-actions"},[s("span",{staticClass:"view"},[s("a",{attrs:{href:e.url,target:"_blank"}},[t._v(t._s(t.viewPost(e.context.postType.singular)))]),t._v(" | ")]),s("span",{staticClass:"edit"},[s("a",{attrs:{href:e.context.editLink,target:"_blank"}},[t._v(t._s(t.editPost(e.context.postType.singular)))])])]):t._e(),e.context?t._e():s("div",{staticClass:"row-actions"},[s("span",{staticClass:"view"},[s("a",{attrs:{href:e.url,target:"_blank"}},[t._v(t._s(t.strings.openUrl))])])])]}},{key:"phrase",fn:function({row:e}){return[s("link-assistant-phrase",{attrs:{phrase:e.phrase,phraseHtml:e.phrase_html,anchor:e.anchor,url:e.url,clickableAnchor:!0}})]}},{key:"delete",fn:function({index:e}){return[s("core-tooltip",{attrs:{type:"action"},scopedSlots:t._u([{key:"tooltip",fn:function(){return[t._v(" "+t._s(t.strings.deleteLink)+" ")]},proxy:!0}],null,!0)},[s("svg-trash",{nativeOn:{click:function(n){return t.maybeDoBulkAction({action:"delete",selectedRows:e})}}})],1)]}}])}),t.postReport?t._e():s("div",{staticClass:"links-bottom"},[s("div",{staticClass:"links-bottom-left"},[t.post.links.outboundInternal.rows.length?s("base-button",{attrs:{type:"blue",tag:"button"},nativeOn:{click:function(e){return t.$emit("openSuggestions")}}},[s("svg-link-suggestion"),t._v(" "+t._s(t.strings.outboundSuggestions)+" ")],1):t._e(),t.post.links.outboundInternal.totals.total>5&&t.linksReport?s("div",[s("svg-link-external"),s("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPostReport("outbound-internal")}}},[t._v(" "+t._s(t.seeAllLinks)+" ")])],1):t._e()],1),s("div",{staticClass:"links-bottom-right"},[t.post.links.outboundInternal.rows.length?s("a",{staticClass:"link-delete",on:{click:function(e){return e.preventDefault(),t.maybeDoBulkAction({action:"delete",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.deleteAllLinks)+" ")]):t._e()])]),t.showModal?s("link-assistant-confirmation-modal",{attrs:{selectedRows:t.selectedRows,strings:t.modalStrings},on:{doBulkAction:t.doBulkAction,closeModal:function(e){t.showModal=!1}}}):t._e()],1)},pt=[],ht=u(ct,dt,pt,!1,null,null,null,null);const us=ht.exports,M={mixins:[C],props:{post:{type:Object,required:!0},postIndex:{type:Number,required:!1},postId:{type:Number,required:!1},filteredSuggestionsOutbound:{type:Array,required:!1},postReport:{type:Boolean,default(){return!1}},linksReport:{type:Boolean,default(){return!1}},metabox:{type:Boolean,default(){return!1}}},beforeMount(){this.$bus.$on("updatingLinks",i=>{this.wpTableLoading=i}),this.pageNumber=this.suggestionType?this.linkAssistant.postReport[this.suggestionType].totals.page:1},data(){return{changeItemsPerPageSlug:"linkAssistantPostsReport",editablePhraseKey:0,activeSuggestionRow:-1,action:"",showModal:!1,selectedRows:[],bulkOptions:[{label:this.$t.__("Add Link",this.$tdPro),value:"add"},{label:this.$t.__("Description",this.$td),value:"dismiss"}],strings:{addLink:this.$t.__("Add Link",this.$tdPro),dismiss:this.$t.__("Dismiss Suggestion",this.$tdPro)}}},computed:{...$(["linkAssistant","currentPost"]),rows(){if(!this.metabox)return this.post.links[this.suggestionType].rows;const i=this.pageNumber===1?0:(this.pageNumber-1)*10;return this.suggestionType==="suggestionsOutbound"?this.filteredSuggestionsOutbound.slice(i,i+10):this.post.links[this.suggestionType].rows.slice(i,i+10)},modalStrings(){return this.action==="add"?{areYouSureSingle:this.$t.__("Are you sure you want to add this suggestion?",this.$tdPro),areYouSureMultiple:this.$t.__("Are you sure you want to add these suggestions?",this.$tdPro),areYouSureAll:this.$t.__("Are you sure you want to add all suggestions?",this.$tdPro),actionCannotBeUndone:this.$t.__("This action cannot be undone.",this.$tdPro),yesSingle:this.$t.__("Yes, I want to add this suggestion",this.$tdPro),yesMultiple:this.$t.__("Yes, I want to add these suggestions",this.$tdPro),yesAll:this.$t.__("Yes, I want to add all suggestions",this.$tdPro),noChangedMind:this.$t.__("No, I changed my mind",this.$tdPro)}:{areYouSureSingle:this.$t.__("Are you sure you want to dismiss this suggestion?",this.$tdPro),areYouSureMultiple:this.$t.__("Are you sure you want to dismiss these suggestions?",this.$tdPro),areYouSureAll:this.$t.__("Are you sure you want to dismiss all suggestions?",this.$tdPro),actionCannotBeUndone:this.$t.__("This action cannot be undone.",this.$tdPro),yesSingle:this.$t.__("Yes, I want to dismiss this suggestion",this.$tdPro),yesMultiple:this.$t.__("Yes, I want to dismiss these suggestions",this.$tdPro),yesAll:this.$t.__("Yes, I want to dismiss all suggestions",this.$tdPro),noChangedMind:this.$t.__("No, I changed my mind",this.$tdPro)}}},methods:{...A("linkAssistant",["suggestionDismiss","suggestionsBulk","fetchPostReport","fetchLinksReportInner","postSettingsUpdate"]),fetchData(i){this.$bus.$emit("updatingLinks",!0);const t={...i,additionalFilters:{postId:this.post.ID||this.currentPost.id,postIndex:this.postIndex,type:this.suggestionType}},s=this.postReport?"fetchPostReport":"fetchLinksReportInner";return this[s](t).finally(()=>{this.$bus.$emit("updatingLinks",!1)})},toggleShowMorePhrases(i){if(this.activeSuggestionRow===i){this.activeSuggestionRow=-1;return}this.activeSuggestionRow=i},toggleShowMorePostTitles(i){if(this.activeSuggestionRow===i){this.activeSuggestionRow=-1;return}this.activeSuggestionRow=i},openPostReport(i,t){window.location.href=`#/post-report?postId=${this.postId}&postIndex=${this.postIndex}&initialTab=${i}&initialSuggestionTab=${t}`},saveModifiedPhrase(i){let t=null;this.linksReport&&(t=this.linkAssistant.linksReport.rows[this.postIndex].links[this.suggestionType].rows[i.postIndex]),this.postReport&&(t=this.linkAssistant.postReport[this.suggestionType].rows[i.postIndex]),this.metabox&&(t=this.currentPost.linkAssistant.links[this.suggestionType].rows[i.postIndex]),t.suggestions[i.phraseIndex].phrase_html!==i.phraseHtml&&(t.suggestions[i.phraseIndex].phrase=i.phrase,t.suggestions[i.phraseIndex].phrase_html=i.phraseHtml,t.suggestions[i.phraseIndex].anchor=i.anchor)},addLink(i,t){let s=null;if(this.suggestionType==="suggestionsInbound"){const n=`editablePhrase${t}`;s=this.$refs[n].selectedPhrase}if(this.suggestionType==="suggestionsOutbound"&&(s=this.selectedPostTitleIndex),s===!1||typeof s>"u"){console.error("Couldn't determine index of suggestion.");return}if(this.suggestionType==="suggestionsOutbound"){const n=l(i.suggestions[0].context.permalink),o=l(i.suggestions[s].context.permalink),r=new RegExp(`/${n}/`,"i"),a=i.suggestions[0].phrase_html.replace(r,o);i.suggestions[s].phrase_html=a,i.suggestions[s].anchor=i.suggestions[0].anchor}const e=i.suggestions[s];i.suggestions[s]=i.suggestions[0],i.suggestions[0]=e,this.maybeDoBulkAction({action:"add",selectedRows:i})},maybeDoBulkAction({action:i,selectedRows:t}){t===!1||t===void 0||!i||(this.action=i,this.selectedRows=t,this.showModal=!0)},doBulkAction(){if(this.showModal=!1,!this.selectedRows)return;if(this.action==="dismiss"&&typeof this.selectedRows=="number"){this.doDismissSuggestion(this.selectedRows);return}if(this.selectedRows==="all"){this.$bus.$emit("updatingLinks",!0),this.suggestionsBulk({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,action:this.action,suggestionType:this.suggestionType,suggestionRows:"all",linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated"),this.refreshTable()});return}let i=null;if(this.linksReport&&(i=this.linkAssistant.linksReport.rows[this.postIndex].links[this.suggestionType].rows),this.postReport&&(i=this.linkAssistant.postReport[this.suggestionType].rows),this.metabox){if(this.action==="add"&&this.suggestionType!=="suggestionsInbound"){if(this.$bus.$emit("updatingLinks",!0),Array.isArray(this.selectedRows))this.selectedRows.forEach(s=>{this.editorAddSuggestion(s)});else{const s=this.selectedRows;this.editorAddSuggestion(s)}this.$bus.$emit("updatingLinks",!1);return}i=this.currentPost.linkAssistant.links[this.suggestionType].rows}const t=[];Array.isArray(this.selectedRows)?this.selectedRows.forEach(s=>{t.push(i[s])}):t.push(this.selectedRows),this.$bus.$emit("updatingLinks",!0),this.suggestionsBulk({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,action:this.action,suggestionType:this.suggestionType,suggestionRows:t,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated"),this.refreshTable()})},doDismissSuggestion(i){this.$bus.$emit("updatingLinks",!0),this.suggestionDismiss({postIndex:this.postIndex,postId:this.post.ID||this.currentPost.id,suggestionId:i,linksReport:this.linksReport,postReport:this.postReport}).finally(()=>{this.$bus.$emit("updatingLinks",!1),this.$emit("linksUpdated"),this.refreshTable()})},editorAddSuggestion(i){x()&&this.blockEditorAddSuggestion(i),R()&&this.classicEditorAddSuggestion(i)},blockEditorAddSuggestion(i){let t=null,s=null;if(isNaN(i)?this.rows.forEach((p,P)=>{p.suggestions[0].id===i.suggestions[0].id&&(t=p,s=P)}):(s=i,t=this.rows[i]),!t||s===!1)return;this.$bus.$emit("updatingLinks",!0);const e=window.wp.data.select("core/block-editor").getBlocks(),n=t.suggestions[0].original_phrase_html.trim(),o=this.findTargetBlock(e,n);if(!o){this.$bus.$emit("updatingLinks",!1);return}const r=window.wp.data.select("core/block-editor").getBlock(o);if(!r){this.$bus.$emit("updatingLinks",!1);return}const a=l(t.suggestions[0].anchor.trim());let c=new RegExp(`(${a})`,"i");const d=t.suggestions[0].phrase_html.trim(),k=l(n);c=new RegExp(`(${k})`,"i"),window.wp.data.dispatch("core/block-editor").updateBlockAttributes(o,{content:r.attributes.content.replace(c,d)}).then(()=>{this.$delete(this.rows,s)}).catch(p=>{console.error("Couldn't add outbound link:",p)}).finally(()=>{this.postSettingsUpdate({postContent:window.wp.data.select("core/editor").getEditedPostContent(),skipNextRun:!0})})},classicEditorAddSuggestion(i){let t=null,s=null;if(isNaN(i)?this.rows.forEach((p,P)=>{p.suggestions[0].id===i.suggestions[0].id&&(t=p,s=P)}):(s=i,t=this.rows[i]),!t||s===!1)return;this.$bus.$emit("updatingLinks",!0);let e="",n=null,o=null;if(document.querySelector("#wp-content-wrap.tmce-active")?(n=window.tinyMCE.get("content"),e=n.getContent({format:"raw"})):(o=document.querySelector("textarea#content"),e=o?o.value:""),!e){this.$bus.$emit("updatingLinks",!1);return}const r=t.suggestions[0].original_phrase_html.trim(),a=l(r),c=l(t.suggestions[0].anchor.trim());let d=new RegExp(`(${c})`,"i");const k=t.suggestions[0].phrase_html.trim();d=new RegExp(`(${a})`,"i"),e=e.replace(d,k),n?n.setContent(e):o.value=e,this.$delete(this.rows,s),this.postSettingsUpdate({postContent:e,skipNextRun:!0}).finally(()=>{this.$bus.$emit("updatingLinks",!1)})}}};const gt={components:{BaseEditor:Y},props:{phrase:{type:String,required:!0},url:{type:String,required:!0},context:{type:String,required:!1}},data(){return{strings:{saveChanges:this.$t.__("Save Changes",this.$tdPro),cancel:this.$t.__("Cancel",this.$tdPro),context:this.$t.__("Context",this.$tdPro)}}},mounted(){this.$refs.linkEditor.setPhrase(this.phrase);const i=document.querySelector(".ql-autoLink");i&&(i.innerHTML='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"></line><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"></path><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"></path></svg>',i.classList.add("ql-disabled"))},methods:{getPhrase(){return this.$refs.linkEditor.getPhrase()},getPhraseHtml(){return this.$refs.linkEditor.getPhraseHtml()},getPhraseWithFormats(){return this.$refs.linkEditor.getPhraseWithFormats()},selectionChange({range:i,source:t}){const s=document.querySelector(".ql-autoLink");s&&(!i||!i.length||t!=="user")?s.classList.add("ql-disabled"):s.classList.remove("ql-disabled")}}};var ft=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-phrase-editor"},[t.context?s("div",{staticClass:"context"},[s("p",[s("strong",{staticClass:"context-label"},[t._v(t._s(t.strings.context)+":")])]),s("p",{domProps:{innerHTML:t._s(t.context)}})]):t._e(),s("base-editor",{ref:"linkEditor",attrs:{"auto-link":{url:t.url,phrase:t.phrase},"show-toolbar":"","allow-tags":""},on:{input:e=>t.$emit("input",e),"selection-change":t.selectionChange}}),s("div",{staticClass:"action-buttons"},[s("base-button",{attrs:{type:"blue",size:"small"},on:{click:function(e){return t.$emit("saveEditor")}}},[t._v(" "+t._s(t.strings.saveChanges)+" ")]),s("base-button",{attrs:{type:"gray",size:"small"},on:{click:function(e){return t.$emit("closeEditor")}}},[t._v(" "+t._s(t.strings.cancel)+" ")])],1)],1)},_t=[],kt=u(gt,ft,_t,!1,null,null,null,null);const mt=kt.exports;const bt={components:{LinkAssistantPhrase:w,LinkAssistantPhraseEditor:mt,SvgCaret:T,SvgPencil:F,SvgTrash:b,TransitionSlide:S},props:{row:{type:Object,required:!0},rowIndex:{type:Number,default:0},activeRow:{type:Number,default:-1},postIndex:{type:Number,required:!1},suggestionType:{type:String,required:!1},selectedPostTitleIndex:{type:Number,required:!1,default(){return 0}},linkSuggestion:{type:Boolean,default(){return!1}},domainsReport:{type:Boolean,default(){return!1}}},data(){return{phraseIndex:-1,showEditor:-1,hoveringOver:-1,selectedPhrase:0}},computed:{...$(["linkAssistant","currentPost"]),phrases(){return this.linkSuggestion?this.row.suggestions.slice(0,10):this.row.links.slice(0,10)},url(){return this.domainsReport?this.phrases[this.phraseIndex].url:this.suggestionType==="suggestionsInbound"?this.row.context.permalink:this.suggestionType==="suggestionsOutbound"?this.row.suggestions[this.selectedPostTitleIndex].context.permalink:""},showingMorePhrases(){return 1<this.phrases.length&&this.activeRow===this.rowIndex},viewMorePhrasesLabel(){const i=1<this.phrases.length?this.phrases.length-1:0;return this.$t.sprintf(this.$t._n("%1$d more phrase","%1$d more phrases",i,this.$td),i)},phraseContext(){let i="",t="";if(this.linkSuggestion){const n=this.row.suggestions[this.phraseIndex];i=n.phrase.trim(),t=n.paragraph.trim()}else{const n=this.row.links[this.phraseIndex];i=n.phrase.trim(),t=n.paragraph.trim()}if(i===t)return"";const s=l(i),e=new RegExp(s,"i");return t.match(e)&&(t=t.replace(e,`<strong>${i}</strong>`)),t}},methods:{tooltipUrl(i,t){return this.domainsReport?t.url:this.suggestionType==="suggestionsInbound"?i.permalink:this.suggestionType==="suggestionsOutbound"&&i.suggestions[this.selectedPostTitleIndex]?i.suggestions[this.selectedPostTitleIndex].context.permalink:""},openEditor(i,t){this.phraseIndex=t,this.showEditor=i},processModifiedPhrase(){this.showEditor=-1,this.hoveringOver=-1;const i=this.$refs.linkEditor.getPhrase(),t=this.$refs.linkEditor.getPhraseHtml(),s=this.$refs.linkEditor.getPhraseWithFormats();let e="";s.ops.forEach(n=>{n.attributes&&n.attributes.link&&(e=e+n.insert)}),e&&this.$emit("saveModifiedPhrase",{phrase:i,phraseHtml:t,anchor:e,postIndex:this.rowIndex,phraseIndex:this.phraseIndex})},deleteLink(i,t,s){i.stopPropagation(),i.preventDefault(),this.$emit("delete",{postIndex:t,linkIndex:s})}}};var $t=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-editable-phrase"},[s("div",{staticClass:"domains-report-editable-phrase"},[t.showEditor!==t.rowIndex?s("div",[s("div",{staticClass:"editable-phrase first-phrase",on:{click:function(e){return t.openEditor(t.rowIndex,0)}}},[t.linkSuggestion&&t.showingMorePhrases&&t.suggestionType!=="suggestionsOutbound"?s("input",{attrs:{type:"radio"},domProps:{checked:t.selectedPhrase===0},on:{click:function(e){e.stopPropagation(),t.selectedPhrase=0}}}):t._e(),s("link-assistant-phrase",{class:{hover:t.hoveringOver===0},attrs:{url:t.tooltipUrl(t.row,t.phrases[0]),phrase:t.phrases[0].phrase,phraseHtml:t.phrases[0].phrase_html,anchor:t.phrases[0].anchor},on:{mouseOver:function(e){t.hoveringOver=0},mouseLeave:function(e){t.hoveringOver=-1}},scopedSlots:t._u([{key:"icons",fn:function(){return[s("span",{staticClass:"icons"},[s("svg-pencil"),t.domainsReport?s("svg-trash",{nativeOn:{click:function(e){return(n=>t.deleteLink(n,t.rowIndex,0)).apply(null,arguments)}}}):t._e()],1)]},proxy:!0}],null,!1,2783923469)})],1),t.suggestionType!=="suggestionsOutbound"&&1<t.phrases.length&&t.showEditor!==t.rowIndex?s("div",{staticClass:"show-more-phrases"},[s("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.$emit("toggleShowMorePhrases",t.rowIndex),t.selectedPhrase=0}}},[s("div",[t._v(t._s(t.viewMorePhrasesLabel))]),s("svg-caret",{class:{rotated:t.showingMorePhrases}})],1)]):t._e(),s("transition-slide",{staticClass:"phrases-list",attrs:{tag:"div",active:t.showingMorePhrases&&t.suggestionType!=="suggestionsOutbound"}},t._l(t.phrases,function(e,n){return s("div",{key:n,staticClass:"editable-phrase-container"},[n?s("div",{staticClass:"editable-phrase selectable-phrase",on:{click:function(o){return t.openEditor(t.rowIndex,n)}}},[t.linkSuggestion&&t.showingMorePhrases?s("input",{attrs:{type:"radio"},domProps:{checked:n===t.selectedPhrase},on:{click:function(o){o.stopPropagation(),t.selectedPhrase=n}}}):t._e(),s("link-assistant-phrase",{class:{hover:n===t.hoveringOver},attrs:{url:t.tooltipUrl(t.row,t.phrases[0]),phrase:e.phrase,phraseHtml:e.phrase_html,anchor:e.anchor},on:{mouseOver:function(o){t.hoveringOver=n},mouseLeave:function(o){t.hoveringOver=-1}},scopedSlots:t._u([{key:"icons",fn:function(){return[s("div",{staticClass:"icons"},[s("svg-pencil"),t.domainsReport?s("svg-trash",{nativeOn:{click:function(o){return(r=>t.deleteLink(r,t.rowIndex,n)).apply(null,arguments)}}}):t._e()],1)]},proxy:!0}],null,!0)})],1):t._e()])}),0)],1):t._e(),t.showEditor===t.rowIndex?s("link-assistant-phrase-editor",{ref:"linkEditor",attrs:{value:t.phrases[this.phraseIndex].phrase,phrase:t.phrases[this.phraseIndex].phrase_html,url:t.url,context:t.phraseContext},on:{saveEditor:t.processModifiedPhrase,closeEditor:function(e){t.showEditor=-1,t.hoveringOver=-1}}}):t._e()],1)])},vt=[],wt=u(bt,$t,vt,!1,null,null,null,null);const B=wt.exports,yt={components:{CoreWpTable:g,LinkAssistantConfirmationModal:_,LinkAssistantEditablePhrase:B,SvgCirclePlus:L,SvgLinkExternal:f},mixins:[y,M,h],data(){return{tableId:"aioseo-post-report-inbound-suggestions",suggestionType:"suggestionsInbound",strings:{dismissAllSuggestions:this.$t.sprintf(this.$t.__("Dismiss All %1$s Suggestions",this.$tdPro),this.$t.__("Inbound Internal",this.$tdPro)),noSuggestions:this.$t.sprintf(this.$t.__("You currently don't have any %1$s Suggestions!",this.$tdPro),this.$t.__("Inbound Internal",this.$tdPro))}}},computed:{columns(){return[{slug:"post_title",label:this.$t.__("Post Title",this.$td)},{slug:"spacer",width:"30px"},{slug:"phrase",label:this.$t.__("Phrase",this.$td)},{slug:"add_link",width:"150px"}]},seeAllSuggestions(){return this.$t.sprintf(this.$t.__("See All %1$s %2$s Suggestions",this.$tdPro),this.post.links.suggestionsInbound.totals.total,this.$t.__("Inbound Internal",this.$tdPro))}},methods:{processPagination(i){this.pageNumber=i,!this.metabox&&(this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1))}}};var Pt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-link-suggestions-Inbound"},[s("core-wp-table",{key:t.wpTableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{"bulk-options":t.bulkOptions,columns:t.columns,id:t.tableId,"initial-items-per-page":t.$aioseo.settings.tablePagination.linkAssistantPostsReport,"initial-page-number":t.pageNumber,loading:t.wpTableLoading,rows:t.rows,"show-pagination":!t.linksReport,"show-search":!1,"show-table-footer":t.postReport,totals:t.post.links.suggestionsInbound.totals,"show-items-per-page":""},on:{paginate:t.processPagination,"process-bulk-action":t.maybeDoBulkAction,"process-change-items-per-page":t.processChangeItemsPerPage},scopedSlots:t._u([{key:"post_title",fn:function({row:e}){return[s("strong",[s("a",{staticClass:"edit-link",attrs:{href:e.context.permalink,target:"_blank"}},[t._v(t._s(e.context.postTitle))])]),s("div",{staticClass:"row-actions"},[s("span",{staticClass:"view"},[s("a",{attrs:{href:e.context.permalink,target:"_blank"}},[t._v(t._s(t.viewPost(e.context.postType.singular)))]),t._v(" | ")]),s("span",{staticClass:"edit"},[s("a",{attrs:{href:e.context.editLink,target:"_blank"}},[t._v(t._s(t.editPost(e.context.postType.singular)))]),t._v(" | ")]),s("span",{staticClass:"dismiss"},[s("a",{attrs:{href:"#"},on:{click:function(n){return n.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:e})}}},[t._v(t._s(t.strings.dismiss))])])])]}},{key:"phrase",fn:function({row:e,index:n}){return[s("link-assistant-editable-phrase",{ref:"editablePhrase"+n,attrs:{row:e,rowIndex:n,activeRow:t.activeSuggestionRow,postIndex:t.postIndex,suggestionType:t.suggestionType,linkSuggestion:""},on:{hidePhrases:function(o){t.activeSuggestionRow=-1},toggleShowMorePhrases:t.toggleShowMorePhrases,saveModifiedPhrase:t.saveModifiedPhrase}})]}},{key:"add_link",fn:function({row:e,index:n}){return[s("div",{staticClass:"add-link",on:{click:function(o){return o.preventDefault(),t.addLink(e,n)}}},[s("svg-circle-plus"),s("a",[t._v(t._s(t.strings.addLink))])],1)]}}])}),t.postReport?t._e():s("div",{staticClass:"links-bottom"},[s("div",{staticClass:"links-bottom-left"},[t.post.links.suggestionsInbound.totals.total>5&&t.linksReport?s("div",[s("svg-link-external"),s("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPostReport("link-suggestions","suggestions-inbound")}}},[t._v(" "+t._s(t.seeAllSuggestions)+" ")])],1):t._e()]),s("div",{staticClass:"links-bottom-right"},[t.post.links.suggestionsInbound.rows.length?s("a",{staticClass:"link-delete",on:{click:function(e){return e.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.dismissAllSuggestions)+" ")]):t._e()])]),t.showModal?s("link-assistant-confirmation-modal",{attrs:{strings:t.modalStrings,selectedRows:t.selectedRows},on:{closeModal:function(e){t.showModal=!1},doBulkAction:t.doBulkAction}}):t._e()],1)},xt=[],Rt=u(yt,Pt,xt,!1,null,null,null,null);const At=Rt.exports;const It={components:{SvgCaret:T,TransitionSlide:S},mixins:[y],props:{row:{type:Object,required:!0},rowIndex:{type:Number,default:0},activeRow:{type:Number,default:-1},postIndex:{type:Number,required:!1},suggestionType:{type:String,required:!1}},data(){return{selectedPostTitleIndex:-1,hoveringOver:-1}},computed:{...$(["linkAssistant","currentPost"]),postTitles(){const i=[];return this.row.suggestions.forEach(t=>{i.includes[t.context.postTitle]||i.push(t.context.postTitle)}),i.slice(0,10)},showingMorePostTitles(){return 1<this.postTitles.length&&this.activeRow===this.rowIndex},viewMorePostTitlesLabel(){const i=1<this.postTitles.length?this.postTitles.length-1:0;return this.$t.sprintf(this.$t._n("%1$d more post","%1$d more posts",i,this.$td),i)}},methods:{selectDifferentPostTitle(i){this.selectedPostTitleIndex!==i&&(this.selectedPostTitleIndex=i,this.$emit("postTitleIndexChanged",i))}}};var Tt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-post-title-selector"},[s("div",{staticClass:"post-title first-post-title",on:{mouseover:function(e){t.hoveringOver=0},mouseleave:function(e){t.hoveringOver=-1}}},[t.showingMorePostTitles?s("input",{attrs:{type:"radio"},domProps:{checked:t.selectedPostTitleIndex===0},on:{click:function(e){return e.stopPropagation(),t.selectDifferentPostTitle(0)}}}):t._e(),s("span",{staticClass:"post-title-text"},[t._v(t._s(t.postTitles[0]))]),s("div",{staticClass:"row-actions",class:{hover:t.hoveringOver===0}},[s("span",{staticClass:"view"},[s("a",{attrs:{href:t.row.suggestions[0].context.permalink,target:"_blank"}},[t._v(t._s(t.viewPost(t.row.suggestions[0].context.postType.singular)))]),t._v(" | ")]),s("span",{staticClass:"edit"},[s("a",{attrs:{href:t.row.suggestions[0].context.editLink,target:"_blank"}},[t._v(t._s(t.editPost(t.row.suggestions[0].context.postType.singular)))])])])]),1<t.postTitles.length?s("div",{staticClass:"show-more-post-titles"},[s("a",{attrs:{href:"#"},on:{click:function(e){e.preventDefault(),t.$emit("toggleShowMorePhrases",t.rowIndex),t.selectDifferentPostTitle(0)}}},[s("div",[t._v(t._s(t.viewMorePostTitlesLabel))]),s("svg-caret",{class:{rotated:t.showingMorePostTitles}})],1)]):t._e(),s("transition-slide",{staticClass:"post-titles-list",attrs:{tag:"div",active:t.showingMorePostTitles}},t._l(t.postTitles,function(e,n){return s("div",{key:n,staticClass:"post-title post-title-container"},[n?s("div",{staticClass:"selectable-post-title",on:{mouseover:function(o){t.hoveringOver=n},mouseleave:function(o){t.hoveringOver=-1}}},[t.showingMorePostTitles?s("input",{attrs:{type:"radio"},domProps:{checked:n===t.selectedPostTitleIndex},on:{click:function(o){return o.stopPropagation(),t.selectDifferentPostTitle(n)}}}):t._e(),s("span",{staticClass:"post-title-text"},[t._v(t._s(t.postTitles[n]))]),s("div",{staticClass:"row-actions",class:{hover:n===t.hoveringOver}},[s("span",{staticClass:"view"},[s("a",{attrs:{href:t.row.suggestions[n].context.permalink,target:"_blank"}},[t._v(t._s(t.viewPost(t.row.suggestions[n].context.postType.singular)))]),t._v(" | ")]),s("span",{staticClass:"edit"},[s("a",{attrs:{href:t.row.suggestions[n].context.editLink,target:"_blank"}},[t._v(t._s(t.editPost(t.row.suggestions[n].context.postType.singular)))])])])]):t._e()])}),0)],1)},St=[],Lt=u(It,Tt,St,!1,null,null,null,null);const Ct=Lt.exports,Mt={components:{CoreWpTable:g,LinkAssistantConfirmationModal:_,LinkAssistantEditablePhrase:B,LinkAssistantPostTitleSelector:Ct,SvgCirclePlus:L,SvgLinkExternal:f},mixins:[M,h],data(){return{tableId:"aioseo-post-report-outbound-suggestions",suggestionType:"suggestionsOutbound",selectedPostTitleIndex:0,strings:{dismissAllSuggestions:this.$t.sprintf(this.$t.__("Dismiss All %1$s Suggestions",this.$tdPro),this.$t.__("Outbound Internal",this.$tdPro)),noSuggestions:this.$t.sprintf(this.$t.__("You currently don't have any %1$s Suggestions!",this.$tdPro),this.$t.__("Outbound Internal",this.$tdPro))}}},computed:{columns(){return[{slug:"phrase",label:this.$t.__("Phrase",this.$td)},{slug:"spacer",width:"30px"},{slug:"post_title",label:this.$t.__("Post Title",this.$td)},{slug:"add_link",width:"150px"}]},seeAllSuggestions(){return this.$t.sprintf(this.$t.__("See All %1$s %2$s Suggestions",this.$tdPro),this.post.links.suggestionsOutbound.totals.total,this.$t.__("Outbound Internal",this.$tdPro))}},methods:{processPagination(i){this.pageNumber=i,!this.metabox&&(this.wpTableLoading=!0,this.processFetchTableData().then(()=>this.wpTableLoading=!1))}}};var Bt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-link-suggestions-outbound"},[s("core-wp-table",{key:t.wpTableKey,class:{"link-assistant-inner-table":!t.postReport},attrs:{"bulk-options":t.bulkOptions,columns:t.columns,id:t.tableId,"initial-items-per-page":t.$aioseo.settings.tablePagination.linkAssistantPostsReport,"initial-page-number":t.pageNumber,loading:t.wpTableLoading,rows:t.rows,"show-pagination":!t.linksReport,"show-search":!1,"show-table-footer":t.postReport,totals:t.post.links.suggestionsOutbound.totals,"show-items-per-page":""},on:{paginate:t.processPagination,"process-bulk-action":t.maybeDoBulkAction,"process-change-items-per-page":t.processChangeItemsPerPage},scopedSlots:t._u([{key:"post_title",fn:function({row:e,index:n}){return[s("link-assistant-post-title-selector",{ref:"postTitleSelector"+n,attrs:{row:e,rowIndex:n,activeRow:t.activeSuggestionRow,postIndex:t.postIndex,suggestionType:t.suggestionType,linkSuggestion:""},on:{hidePhrases:function(o){t.activeSuggestionRow=-1},toggleShowMorePhrases:t.toggleShowMorePhrases,saveModifiedPhrase:t.saveModifiedPhrase,postTitleIndexChanged:o=>t.selectedPostTitleIndex=o}})]}},{key:"phrase",fn:function({row:e,index:n}){return[s("link-assistant-editable-phrase",{attrs:{row:e,rowIndex:n,activeRow:t.activeSuggestionRow,postIndex:t.postIndex,suggestionType:t.suggestionType,selectedPostTitleIndex:t.selectedPostTitleIndex,linkSuggestion:""},on:{hidePhrases:function(o){t.activeSuggestionRow=-1},saveModifiedPhrase:t.saveModifiedPhrase}}),s("div",{staticClass:"row-actions"},[s("span",{staticClass:"dismiss"},[s("a",{attrs:{href:"#"},on:{click:function(o){return o.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:e})}}},[t._v(t._s(t.strings.dismiss))])])])]}},{key:"add_link",fn:function({row:e,index:n}){return[s("div",{staticClass:"add-link",on:{click:function(o){return o.preventDefault(),t.addLink(e,n)}}},[s("svg-circle-plus"),s("a",[t._v(t._s(t.strings.addLink))])],1)]}}])}),t.postReport?t._e():s("div",{staticClass:"links-bottom"},[s("div",{staticClass:"links-bottom-left"},[t.post.links.suggestionsOutbound.totals.total>5&&t.linksReport?s("div",[s("svg-link-external"),s("a",{staticClass:"link-view",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.openPostReport("link-suggestions","suggestions-outbound")}}},[t._v(" "+t._s(t.seeAllSuggestions)+" ")])],1):t._e()]),s("div",{staticClass:"links-bottom-right"},[t.filteredSuggestionsOutbound.length?s("a",{staticClass:"link-delete",on:{click:function(e){return e.preventDefault(),t.maybeDoBulkAction({action:"dismiss",selectedRows:"all"})}}},[t._v(" "+t._s(t.strings.dismissAllSuggestions)+" ")]):t._e()])]),t.showModal?s("link-assistant-confirmation-modal",{attrs:{strings:t.modalStrings,selectedRows:t.selectedRows},on:{closeModal:function(e){t.showModal=!1},doBulkAction:t.doBulkAction}}):t._e()],1)},Et=[],Dt=u(Mt,Bt,Et,!1,null,null,null,null);const Ot=Dt.exports;const qt={components:{CoreAlert:O,CoreMainTabs:N,Inbound:At,Outbound:Ot,SvgLinkInternalInbound:E,SvgLinkInternalOutbound:D},mixins:[v],props:{filteredSuggestionsOutbound:{type:Array,required:!0},initialTab:{type:String,required:!1},showAlert:{type:Boolean,default(){return!1}}},data(){return{tabsKey:0,activeTab:"suggestions-inbound",strings:{description:this.$t.sprintf(this.$t.__("Below you can add inbound and outbound internal links based on %1$s's smart suggestions. These suggestions are generated in the background, which requires some time to complete. %2$s",this.$tdPro),"AIOSEO",this.$links.getDocLink(this.$constants.GLOBAL_STRINGS.learnMore,"linkAssistant",!0))}}},computed:{...$("linkAssistant",["internalOptions"]),...q("linkAssistant",["getLinksReportCounts"]),tabs(){return[{slug:"suggestions-inbound",icon:"svg-link-internal-inbound",name:this.$t.sprintf("%1$s %2$s",this.metabox?this.post.links.suggestionsInbound.totals.total:this.getLinksReportCounts[this.postIndex].suggestionsInbound,this.$t.__("Inbound Internal Suggestions",this.$tdPro))},{slug:"suggestions-outbound",icon:"svg-link-internal-outbound",name:this.$t.sprintf("%1$s %2$s",this.metabox?this.filteredSuggestionsOutbound.length:this.getLinksReportCounts[this.postIndex].suggestionsOutbound,this.$t.__("Outbound Internal Suggestions",this.$tdPro))}]}},methods:{...A("linkAssistant",["setLinksReportCounts"]),processChangeTab(i){this.activeTab=i,this.$emit("suggestionsTabChanged",i)},dismissAlert(){this.internalOptions.internal.dismissedAlerts.suggestions=!0,this.$http.get(this.$links.restUrl("link-assistant/data/dismiss-alert")).catch(i=>console.log("Could not dismiss suggestions alert:",i))}},beforeMount(){this.initialTab&&(this.activeTab=this.initialTab),this.setLinksReportCounts()}};var Nt=function(){var t=this,s=t._self._c;return s("div",{staticClass:"aioseo-link-suggestions"},[t.internalOptions.internal.dismissedAlerts.suggestions?t._e():s("core-alert",{staticClass:"description",attrs:{type:"blue","show-close":""},on:{"close-alert":t.dismissAlert}},[s("span",{domProps:{innerHTML:t._s(t.strings.description)}})]),s("core-main-tabs",{key:t.tabsKey,attrs:{internal:"",tabs:t.tabs,active:t.activeTab,showSaveButton:!1},on:{changed:t.processChangeTab},scopedSlots:t._u([{key:"md-tab-icon",fn:function({tab:e}){return[s(e.icon,{tag:"component",class:[{warning:e.data.warning}]})]}}])}),s("div",{staticClass:"link-suggestions-container"},[s("keep-alive",[t.activeTab==="suggestions-outbound"?s("outbound",{attrs:{post:t.post,postIndex:t.postIndex,postId:t.postId,filteredSuggestionsOutbound:t.filteredSuggestionsOutbound,linksReport:t.linksReport,postReport:t.postReport,metabox:t.metabox},on:{linksUpdated:function(e){t.tabsKey++,t.$emit("linksUpdated")}}}):t._e()],1),s("keep-alive",[t.activeTab==="suggestions-inbound"?s("inbound",{attrs:{post:t.post,postIndex:t.postIndex,postId:t.postId,linksReport:t.linksReport,postReport:t.postReport,metabox:t.metabox},on:{linksUpdated:function(e){t.tabsKey++,t.$emit("linksUpdated")}}}):t._e()],1)],1)],1)},Ht=[],Ut=u(qt,Nt,Ht,!1,null,null,null,null);const cs=Ut.exports;export{rs as L,os as S,as as a,ls as b,us as c,cs as d,_ as e,B as f};
