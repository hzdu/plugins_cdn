!function(t){"use strict";String.format||(String.format=function(t){var e=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,function(t,n){return void 0!==e[n]?e[n]:t})});var e={transferDataAttributes:function(t,e){var n=t.data();for(var i in n)n.hasOwnProperty(i)&&e.attr("data-"+i,n[i])}};function n(){this.$element=null}n.prototype.addAttr=function(t,e){this.$element.attr(t,e)},n.prototype.addClass=function(t){this.$element.addClass(t)},window.essbis=function(){function i(e,i,o){n.call(this),this.width=e,this.height=i,this.$element=t("<a/>"),this.addAttr(a.attr.type,o),this.addAttr("href","#"),this.$iconElement=t("<div/>").addClass(a.cssClass.iconPrefix+o),this.$iconElement.html(t("<div/>").addClass(a.cssClass.prefix+"inner"))}function o(e){switch(this.icons=[],this.width=0,this.height=0,this.$element=t("<div/>"),e){case"vertical":this.updateContainerSize=this.updateSizeVertical;break;case"horizontal":this.updateContainerSize=this.updateSizeHorizontal}this.addClass(a.cssClass.container)}function r(){this.url="",this.imageUrl="",this.description=""}i.prototype=new n,i.prototype.createElement=function(){return this.$element.html(this.$iconElement)},o.prototype=new n,o.prototype.updateSizeHorizontal=function(t,e){this.width+=t,this.height=e>this.height?e:this.height},o.prototype.updateSizeVertical=function(t,e){this.height+=e,this.width=t>this.width?t:this.width},o.prototype.createContainer=function(){for(var t=[],e=0;e<this.icons.length;e++)t.push(this.icons[e].createElement());return this.$element.css("min-height",this.height+"px").css("min-width",this.width+"px").html(t)},o.prototype.addIcon=function(t){return this.icons.push(t),this.updateContainerSize(t.width,t.height),this};var s=function(t,e,n,i){var o=Math.round(screen.height/2-i/2),r=Math.round(screen.width/2-n/2);window.open(t,e,String.format("width={0},height={1},status=0,toolbar=0,menubar=0,location=1,scrollbars=1,top={2},left={3}",n,i,o,r))},a={attr:{}};a.attr.prefix="data-essbis",a.attr.type=a.attr.prefix+"Type",a.attr.postTitle=a.attr.prefix+"PostTitle",a.attr.postUrl=a.attr.prefix+"PostUrl",a.cssClass={},a.cssClass.prefix="essbis-",a.cssClass.container=a.cssClass.prefix+"container",a.cssClass.iconPrefix=a.cssClass.prefix+"icon-",a.buttonTypes={pinterestShare:"pinterest",twitterShare:"twitter",facebookShare:"facebook"},a.clickHandlers={},a.clickHandlers.pinterest=function(t){""==t.description&&(t.description=t.postTitle);var e=String.format("http://pinterest.com/pin/create/bookmarklet/?is_video=false&url={0}&media={1}&description={2}",encodeURIComponent(t.url),encodeURIComponent(t.imageUrl),encodeURIComponent(t.description));return s(e,"Pinterest",632,453),!1},a.clickHandlers.twitter=function(t){var e="";a.buttonSettings.settings.twitterHandle&&(e=String.format("&via={0}",a.buttonSettings.settings.twitterHandle));var n=String.format("https://twitter.com/intent/tweet?text={0}&url={1}{2}",encodeURIComponent(t.postTitle),encodeURIComponent(t.url),e);return s(n,"Twitter",550,470),!1},a.clickHandlers.facebook=function(t){var e="";return e=a.buttonSettings.settings.facebookAppID?String.format("https://www.facebook.com/dialog/feed?app_id={0}&display=popup&name={1}&link={2}&picture={3}&description={4}",a.buttonSettings.settings.facebookAppID,encodeURIComponent(t.postTitle),encodeURIComponent(t.url),encodeURIComponent(t.imageUrl),encodeURIComponent(t.description)):String.format("https://www.facebook.com/sharer/sharer.php?u={0}&display=popup",encodeURIComponent(t.url)),s(e,"Facebook",550,420),!1},a.clickHandlers.google=function(t){var e=String.format("https://plus.google.com/share?url={0}",encodeURIComponent(t.url));return s(e,"Google",550,420),!1},a.clickHandlers.linkedin=function(t){var e=String.format("http://www.linkedin.com/shareArticle?mini=true&url={0}",encodeURIComponent(t.url));return s(e,"LinkedIn",550,420),!1},a.clickHandlers.vkontakte=function(t){var e=String.format("http://vk.com/share.php?noparse=true&url={0}&image={1}&description={2}&title={3}",encodeURIComponent(t.url),encodeURIComponent(t.imageUrl),encodeURIComponent(t.description),encodeURIComponent(t.postTitle));return s(e,"VKontakte",632,453),!1},a.clickHandlers.odnoklassniki=function(t){var e=String.format("http://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1&st._surl={0}&st.comments={2}",encodeURIComponent(t.url),encodeURIComponent(t.postTitle));return s(e,"Odnoklassniki",632,453),!1},a.clickHandlers.tumblr=function(t){var e=String.format("http://www.tumblr.com/share/photo?click_thru={0}&source={1}&caption={2}",encodeURIComponent(t.url),encodeURIComponent(t.imageUrl),encodeURIComponent(t.description));return s(e,"Tumblr",632,453),!1},a.clickHandlers.reddit=function(t){var e=String.format("http://reddit.com/submit?url={0}&title={1}&text={2}",encodeURIComponent(t.url),encodeURIComponent(t.pageTitle),encodeURIComponent(t.description));return s(e,"reddit",632,453),!1},a.clickHandlers.digg=function(t){var e=String.format("http://digg.com/submit?phase=2&url={0}&title={1}&bodytext={2}",encodeURIComponent(t.url),encodeURIComponent(t.pageTitle),encodeURIComponent(t.description));return s(e,"digg",632,453),!1},a.clickHandlers.delicious=function(t){var e=String.format("http://delicious.com/post?url={0}&title={1}&bodytext={2}",encodeURIComponent(t.url),encodeURIComponent(t.pageTitle));return s(e,"delicious",632,453),!1},a.handleStats=function(t){if("undefined"!=typeof essb_settings&&essb_settings.essb3_stats){var e=essb_settings.post_id||"",n=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(n=!0);"undefined"!=typeof essb_settings&&jQuery.post(essb_settings.ajax_url,{action:"essb_stat_log",post_id:e,service:t,template:"onmedia",mobile:n,position:"onmedia",button:"icon",counter:!1,nonce:essb_settings.essb3_nonce},function(t){},"json")}},a.debug=function(t){},a.init=function(){var t=window.console=window.console||{};t.log||(t.log=function(){}),a.main.settings.debug=-1!=window.location.search.indexOf("essbisdebug")},a.themes={},a.getTheme=function(t){return a.themes.hasOwnProperty(t)?a.themes[t]:a.themes.flat},a.addTheme=function(t,e){a.themes[t]=e};var d=essbis_settings.modules.buttons.networks.split(",");a.debug(essbis_settings.modules.buttons.networks);for(var l={buttons:{}},c=0;c<d.length;c++){var u=d[c];l.buttons[u]={height:48,width:48}}a.addTheme("flat",l);var h={buttons:{}};for(c=0;c<d.length;c++){u=d[c];h.buttons[u]={height:36,width:36}}a.addTheme("flat-small",h);var m={buttons:{}};for(c=0;c<d.length;c++){u=d[c];m.buttons[u]={height:36,width:36}}a.addTheme("round",m);var g,p,f={buttons:{}};for(c=0;c<d.length;c++){u=d[c];f.buttons[u]={height:24,width:24}}return a.addTheme("tiny",f),a.buttonSets={},a.getButtonSet=function(t){return a.buttonSets.hasOwnProperty(t)?a.buttonSets[t]:a.buttonSets.default},a.addButtonSet=function(t,e){a.buttonSets[t]=e},a.addButtonSet("default",d),a.moduleNames={main:"settings",hover:"hover",buttonSettings:"buttons"},a.module={},a.main=a.module[a.moduleNames.main]=((p={}).settings=g={debug:1},p.setSettings=function(e){g=t.extend(g,e)},p),a.buttonSettings=a.module[a.moduleNames.buttonSettings]=function(){var e={pinterestImageDescription:["titleAttribute","altAttribute"],twitterHandle:"",customURL:"",customText:"",customDescription:""},n={};return n.settings=e,n.setSettings=function(n){e=t.extend(e,n)},n.settings.pinterestImageDescription=essbis_settings.pinterestImageDescription,n.settings.twitterHandle=essbis_settings.twitteruser||"",n.settings.facebookAppID=essbis_settings.fbapp||"",n.settings.dontShowOn=essbis_settings.dontshow||"",n.settings.customURL=essbis_settings.custom_url||"",n.settings.customText=essbis_settings.custom_text||"",n.settings.customDescription=essbis_settings.custom_description||"",n}(),a.module[a.moduleNames.hover]=function(){var n=0,s={ignore:a.attr.prefix+"Ignore",imageDescription:a.attr.prefix+"ImageDescription",index:a.attr.prefix+"Index",postContainer:a.attr.prefix+"HoverContainer",timeoutId:a.attr.prefix+"TimeoutId",timeoutId2:a.attr.prefix+"TimeoutId2"},d={visible:"visible",overlay:a.cssClass.prefix+"hover-overlay",container:a.cssClass.prefix+"hover-container"},l={theme:"flat",buttonSet:"default",orientation:"horizontal",hoverPanelPosition:"middle-middle",imageSelector:String.format(".[0] img",d.container),minImageHeight:100,minImageWidth:100,descriptionSource:["titleAttribute","altAttribute"],disabledClasses:".wp-smiley"+(""!=a.buttonSettings.settings.dontShowOn?","+a.buttonSettings.settings.dontShowOn:""),showOnLightbox:"1",enabledClasses:"*",parentContainerSelector:"",parentContainerLevel:2};function c(t,e){o.call(this,t),this.addClass(d.overlay),this.addClass("essbis-orientation-"+t),this.addAttr(x.attr.index,e)}function u(){return++n}function h(t){return t[0].clientHeight>=l.minImageHeight&&t[0].clientWidth>=l.minImageWidth&&t.not(l.disabledClasses).length>0&&t.filter(l.enabledClasses).length>0}function m(t,e){switch(e){case"titleAttribute":return t.attr("title");case"altAttribute":return t.attr("alt");default:return""}}function g(t,e,n){return t.parents(String.format("[{0}]",s.postContainer)).attr(e)||n}function p(t,e){var n=0,i=0,o=function(){return Math.round(t.height/2-e.height/2)},r=function(){return Math.round(t.height-e.height)},s=function(){return Math.round(t.width/2-e.width/2)},a=function(){return Math.round(t.width-e.width)};switch(l.hoverPanelPosition){case"top-left":n=0,i=0;break;case"top-middle":n=0,i=s();break;case"top-right":n=0,i=a();break;case"middle-left":n=o(),i=0;break;case"middle-middle":n=o(),i=s();break;case"middle-right":n=o(),i=a();break;case"bottom-left":n=r(),i=0;break;case"bottom-middle":n=r(),i=s();break;case"bottom-right":n=r(),i=a()}return{top:n,left:i}}function f(t){return void 0!==t?String.format('div.{0}[{1}="{2}"]',d.overlay,s.index,t):String.format("div.{0}",d.overlay)}function b(){var t=[];return"1"==l.showOnLightbox&&t.push("img.cboxPhoto"),""!=l.imageSelector&&t.push(String.format("{0}:not([{1}])",l.imageSelector,s.ignore)),t.join(",")}function v(){var t="";return""!=l.imageSelector&&(t=String.format("{0}:not([{1}])",l.imageSelector,s.ignore)),t}function w(t){var e=l.theme,n=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(n=!0),n&&l.theme_mobile&&(e=l.theme_mobile);var o=a.getButtonSet(l.buttonSet),r=a.getTheme(e);a.debug(l.orientation);var s=new c(l.orientation,t);s.addClass(e);for(var d=0;d<o.length;d++)s.addIcon(new i(r.buttons[o[d]].width,r.buttons[o[d]].height,o[d]));return s}function S(){var e=t(this);!e.attr(s.index)&&function(t){var e=!1;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0),e&&(l.minImageWidthMobile&&Number(l.minImageWidthMobile)&&(l.minImageWidth=l.minImageWidthMobile),l.minImageHeightMobile&&Number(l.minImageHeightMobile)&&(l.minImageWidth=l.minImageHeightMobile)),t[0].clientHeight>=l.minImageHeight&&t[0].clientWidth>=l.minImageWidth&&t.not(l.disabledClasses).length>0&&t.filter(l.enabledClasses).length>0}(e)&&e.attr(s.index,u());var n=e.attr(s.index);if(n){var i=t(f(n));if(0==i.length){var o=w(n),r=o.createContainer(),a=p({height:e[0].clientHeight,width:e[0].clientWidth},{height:o.height,width:o.width}),c=e.offset(),h={top:c.top+a.top,left:c.left+a.left};e.after(r),r.offset(h).addClass(d.visible)}else I(i)}else e.attr(s.ignore,"")}function C(t){var e=setTimeout(function(){t.removeClass(d.visible),t.attr(s.timeoutId2,setTimeout(function(){t.remove()},600))},100);t.attr(s.timeoutId,e)}function I(t){clearTimeout(t.attr(s.timeoutId2)),clearTimeout(t.attr(s.timeoutId)),t.addClass(d.visible)}function k(){var e=t(this),n=e.attr(a.attr.type);if(void 0===a.clickHandlers[n])return!1;var i=e.parent(String.format("div.{0}",a.cssClass.container)).attr(s.index),o=t(String.format('[{0}="{1}"]',s.index,i)),d=new r;return d.url=function(t){return g(t,a.attr.postUrl,document.URL)}(o),d.imageUrl=function(t){switch(t.prop("tagName").toLowerCase()){case"div":return t.css("background-image").replace(/^url\(["']?/,"").replace(/["']?\)$/,"");case"img":return t.attr("src");default:return""}}(o),d.description=function(t){for(var e="",n=a.buttonSettings.settings.pinterestImageDescription,i=0;i<n.length&&!e;i++)e=m(t,n[i]);return e}(o),d.postTitle=function(t){return g(t,a.attr.postTitle,document.title)}(o),a.buttonSettings.settings.customURL&&(d.url=a.buttonSettings.settings.customURL),a.buttonSettings.settings.customText&&(d.postTitle=a.buttonSettings.settings.customText),a.buttonSettings.settings.customDescription&&(d.description=a.buttonSettings.settings.customDescription),a.clickHandlers[n].call(e,d),a.handleStats(n),!1}function y(){var n=t(this),i=t();if(l.parentContainerSelector&&(i=n.parents(l.parentContainerSelector).first()),0==i.length){i=n;for(var o=0;o<l.parentContainerLevel;o++)i=i.parent()}i.length>0&&(e.transferDataAttributes(n,i),i.addClass(d.container))}c.prototype=new o;var x={};return x.attr=s,x.onReady=function(){t(String.format("input[{0}]",s.postContainer)).each(y);var e=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0);var n=l.alwaysVisible||!1,i=l.mobileOnClick||!1;e&&i&&(n=!1,e=!1),e||n||(t(document).delegate(b(),"mouseenter",S),t(document).delegate(b(),"mouseleave",function(){var e=t(this).attr(s.index);C(t(f(e)))})),t(document).delegate(String.format("div.{0} a",d.overlay),"click",k),t(document).delegate(f(),"mouseenter",function(){I(t(this))}),e||n||t(document).delegate(f(),"mouseleave",function(){C(t(this))}),(e||n)&&t(document).find(v()).each(function(){!function(e){var n=e;!n.attr(s.index)&&h(n)&&n.attr(s.index,u());var i=n.attr(s.index);if(i){var o=t(f(i));if(0==o.length){var r=w(i),a=r.createContainer(),l=p({height:n[0].clientHeight,width:n[0].clientWidth},{height:r.height,width:r.width}),c=n.offset(),m={top:c.top+l.top,left:c.left+l.left};n.after(a),a.offset(m).addClass(d.visible)}else I(o)}else n.attr(s.ignore,"")}(t(this))})},x.onResize=function(){var e=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(e=!0);var n=l.alwaysVisible||!1;e||n||(t(String.format("[{0}]",x.attr.ignore)).each(function(){t(this).removeAttr(x.attr.ignore)}),t(String.format("[{0}]",x.attr.index)).each(function(){t(this).removeAttr(x.attr.index)})),(e||n)&&t(document).find(v()).each(function(){!function(e){var n=e;!n.attr(s.index)&&h(n)&&n.attr(s.index,u());var i=n.attr(s.index);if(i){var o=t(f(i));if(0==o.length);else{I(o);var r=w(i),a=p({height:n[0].clientHeight,width:n[0].clientWidth},{height:r.height,width:r.width}),l=n.offset(),c={top:l.top+a.top,left:l.left+a.left};o.offset(c).addClass(d.visible)}}else n.attr(s.ignore,"")}(t(this))})},x.setSettings=function(e){l=t.extend(l,e)},x}(),a.setSettings=function(t){for(var e in a.debug(t),t.buttonSets)t.buttonSets.hasOwnProperty(e)&&a.addButtonSet(e,t.buttonSets[e]);for(var n in t.themes)t.themes.hasOwnProperty(n)&&a.addTheme(t.themes[n]);for(var i in t.modules)t.modules.hasOwnProperty(i)&&a.module.hasOwnProperty(i)&&a.module[i].setSettings(t.modules[i])},a.triggerActiveModules=function(t){for(var e in a.module)if(a.module.hasOwnProperty(e)){var n="module"+(e.charAt(0).toUpperCase()+e.slice(1))+"Active";a.module.hasOwnProperty(e)&&"function"==typeof a.module[e][t]&&"1"==a.main.settings[n]&&a.module[e][t]()}},a.onReady=function(){a.debug("onReady"),a.triggerActiveModules("onReady")},a.onResize=function(){a.debug("onResize"),a.triggerActiveModules("onResize")},a}(),t(function(){essbis.init(),essbis.setSettings(essbis_settings),t(document).ready(function(){setTimeout(function(){essbis.onReady()},1)}),t(window).resize(essbis.onResize)})}(jQuery);