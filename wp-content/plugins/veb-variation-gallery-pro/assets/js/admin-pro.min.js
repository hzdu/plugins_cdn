 /**
 * WooCommerce Additional Variation Images And Swatches Pro - Addon 1
 *
 * This source file is subject to the GNU General Public License v3.0
 * that is bundled with this package in the file license.txt.
 * It is also available through the world-wide-web at this URL:
 * http://www.gnu.org/licenses/gpl-3.0.html
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to support@innovativewp.org so we can send you a copy immediately.
 *
 * @author    InnovativeWP
 * @copyright Copyright (c) 2021, InnovativeWP.
 * @license   http://www.gnu.org/licenses/gpl-3.0.html GNU General Public License v3.0
 */

!function(e){var o={};function t(a){if(o[a])return o[a].exports;var i=o[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=o,t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=0)}([function(e,o,t){t(1),e.exports=t(3)},function(e,o,t){jQuery(function(e){Promise.resolve().then(function(){return t(2)}).then(function(o){var t=o.VebVariationGalleryAdminPro;t.COMPAdmin(),e("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){t.ImageUploader(),t.Sortable()}),e("#variable_product_options").on("woocommerce_variations_added",function(){t.ImageUploader(),t.Sortable()})})})},function(e,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),t.d(o,"VebVariationGalleryAdminPro",function(){return n});var a=function(){function e(e,o){for(var t=0;t<o.length;t++){var a=o[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(o,t,a){return t&&e(o.prototype,t),a&&e(o,a),o}}();var i,n=(i=jQuery,function(){function e(){!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,e)}return a(e,null,[{key:"COMPAdmin",value:function(){i().comp_deactivate_popup&&i().comp_deactivate_popup("veb-variation-gallery")}},{key:"ImageUploader",value:function(){i(document).off("click",".add-veb-variation-gallery-image"),i(document).on("click",".add-veb-variation-gallery-image",this.AddImage),i(document).on("click",".remove-veb-variation-gallery-image",this.RemoveImage),i(document).on("click",".veb_variation_gallery_media_video_popup_link",this.AttachmentVideoPopup),i(".woocommerce_variation").each(function(){var e=i(this).find(".options:first");i(this).find(".veb-variation-gallery-wrapper").insertBefore(e)})}},{key:"AddImage",value:function(o){var t=this;o.preventDefault(),o.stopPropagation();var a=void 0,n=i(this).data("product_variation_id");if("undefined"!=typeof wp&&wp.media&&wp.media.editor){if(a)return void a.open();(a=wp.media({title:veb_variation_gallery_admin.choose_image,button:{text:veb_variation_gallery_admin.add_image},library:{type:["image"]},multiple:"add"})).on("select",function(){var o=a.state().get("selection").toJSON().map(function(e){if("image"===e.type){var o=e.id,t=e.veb_variation_gallery_video,a=e.sizes,i=(a=void 0===a?{}:a).thumbnail,r=a.full,l=i?i.url:r.url;return wp.template("veb-variation-gallery-image")({id:o,url:l,product_variation_id:n,veb_variation_gallery_video:t})}}).join("");i(t).parent().prev().find(".veb-variation-gallery-images").append(o),e.Sortable(),e.VariationChanged(t)}),a.open()}}},{key:"VariationChanged",value:function(e){i(e).closest(".woocommerce_variation").addClass("variation-needs-update"),i("button.cancel-variation-changes, button.save-variation-changes").removeAttr("disabled"),i("#variable_product_options").trigger("woocommerce_variations_input_changed")}},{key:"RemoveImage",value:function(o){var t=this;o.preventDefault(),o.stopPropagation(),e.VariationChanged(this),_.delay(function(){i(t).parent().remove()},1)}},{key:"Sortable",value:function(){i(".veb-variation-gallery-images").sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"veb-variation-gallery-sortable-placeholder",start:function(e,o){o.item.css("background-color","#f6f6f6")},stop:function(e,o){o.item.removeAttr("style")},update:function(){e.VariationChanged(this)}})}},{key:"AttachmentVideoPopup",value:function(e){var o=this;e.preventDefault(),e.stopPropagation();var t=void 0;if("undefined"!=typeof wp&&wp.media&&wp.media.editor){if(t)return void t.open();(t=wp.media({title:veb_variation_gallery_admin.choose_video,button:{text:veb_variation_gallery_admin.add_video},library:{type:["video"]},multiple:!1})).on("select",function(){var e=t.state().get("selection").first().toJSON();"video"===e.type&&i(o).closest(".compat-attachment-fields").find(".compat-field-veb_variation_gallery_media_video input").val(e.url).change()}),t.on("open",function(){t.$el.find(".media-frame-content").addClass("iwp-media-frame-modify")}),t.open()}}}]),e}())},function(e,o){}]);
