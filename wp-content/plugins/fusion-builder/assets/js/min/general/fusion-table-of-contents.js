function awbTableOfContentsRefreshAllElements(){var e,t,o=(e=[],document.querySelectorAll("h1,h2,h3,h4,h5,h6").forEach(function(t){t.matches(".awb-toc-el__title")||e.push(t)}),e),n=document.querySelectorAll(".awb-toc-el"),i=".fusion-builder-module-controls-container *, .fusion-builder-modal-top-container *",a=document.body.classList.contains("fusion-builder-live-preview"),r={};function s(e,t,o=0){var n=0,i="awb-toc-el__list awb-toc-el__list--"+o,r="",c="";if("custom_icon"===t.counter_type&&t.icon&&(r='<span class="awb-toc-el__item-icon '+t.icon+'"></span>'),c+='<ul class="'+i+'">',a&&0===e.length&&window.awbTOCDummyContent1&&0===o){var l="object"==typeof t.allowed_heading_tags?Object.keys(t.allowed_heading_tags).length:3;3<l&&(l=3),e=window["awbTOCDummyContent"+l]}for(n=0;n<e.length;n++)c+='<li class="awb-toc-el__list-item">',e[n].title&&(c+='<a class="awb-toc-el__item-anchor" href="#'+e[n].id+'">'+r+e[n].title+"</a>"),Array.isArray(e[n].children)&&e[n].children.length&&(c+=s(e[n].children,t,o+1)),c+="</li>";return c+="</ul>"}function c(e){var t,n,s,c,l,d,u,w=[],f=o,h="";for("post_content"===e.limit_container?h=".fusion-content-tb *":"page_content"===e.limit_container?h="#content *":"custom"===e.limit_container&&e.select_custom_headings&&(h=e.select_custom_headings),e.ignore_headings||(e.ignore_headings=".awb-exclude-from-toc, .awb-exclude-from-toc *"),u=0;u<f.length;u++)if(t=f[u],void 0!==e.allowed_heading_tags[t.tagName.toLowerCase()]&&(!h||t.matches(h))&&(!e.ignore_headings||!t.matches(e.ignore_headings))&&(!a||!t.matches(i))&&!t.matches(".awb-off-canvas *")&&("yes"!==e.hide_hidden_titles||jQuery(t).is(":visible"))){if(e.ignore_headings_words&&"string"==typeof e.ignore_headings_words){for(n=t.textContent.toLowerCase(),s=e.ignore_headings_words.split("|"),c=!1,d=0;d<s.length;d++)s[d]&&n.includes(s[d].toLowerCase())&&(c=!0);if(c)continue}0===(l=e.allowed_heading_tags[t.tagName.toLowerCase()])&&w.push(b(t)),0<l&&g(w,t,l)}return w;function b(e){var t="",o="";return e&&(t=function(e){var t,o=e.getAttribute("id"),n=0;o||(function o(i){r[i]?r[i]!==e&&(n&&(i=i.replace(/__\d+/,"")),o(i=i+"__"+ ++n)):(r[i]=e,t=i)}(t=function(e){var t,o,n,i="toc",a=e.split(" ");for(o=8,n=0;n<a.length&&0<o;n++)(t=a[n].normalize("NFKD").replaceAll(/[^a-zA-Z0-9_]/g,""))&&(o--,i+="_"+t);return i}(e.textContent)),e.setAttribute("id",t),o=t);return o}(e),o=function(e){var t=e.cloneNode(!0),o=["bdi","bdo","del","ins","q","s","small","strike","sub","sup","u"],n=["a","abbr","address","b","blockquote","code","data","em","i","kbd","mark","p","pre","span","strong","time"];return function e(t){var o,n=function(e){var t,o=[];if(void 0===e||void 0===e.childNodes||0===e.childNodes.length)return o;for(t=0;t<e.childNodes.length;t++)i(e.childNodes[t]),o.push(e.childNodes[t]);return o}(t);for(o=0;o<n.length;o++)e(n[o])}(t),t.innerHTML.replace(/<span><\/span>/g,"").trim();function i(e){var t;void 0===e.tagName?e.outerHTML=e.textContent:(t=e.tagName.toLowerCase(),-1!==o.indexOf(t)?e.outerHTML=e.outerHTML:-1!==n.indexOf(t)&&(e.outerHTML="<span>"+e.innerHTML+"</span>"))}}(e)),{title:o,children:[],id:t}}function g(e,t,o){0===o?e.push(b(t)):(0===e.length&&e.push(b("")),o--,g(e[e.length-1].children,t,o))}}function l(e,t){var o=e.getAttribute("data-awb-toc-id");window.awbTocScrollSpies||(window.awbTocScrollSpies={}),o&&(setTimeout(function(){window.awbTocScrollSpies[o]&&(window.awbTocScrollSpies[o].stopListening(),delete window.awbTocScrollSpies[o]),"yes"===t.highlight_current_heading&&(window.awbTocScrollSpies[o]=new window.awbScrollSpy(document.body,{target:"."+e.className.replace(/ /g,"."),currentItemClass:"awb-toc-el__list-item--highlighted",offset:fusionGetScrollOffset()}))},10),jQuery(window).on("load fusion-sticky-change fusion-sticky-scroll-change",function(){"object"==typeof window.awbTocScrollSpies[o]&&(window.awbTocScrollSpies[o].options.offset=fusionGetScrollOffset())}),jQuery(window).on("fusion-sticky-transition-change",function(){setTimeout(function(){"object"==typeof window.awbTocScrollSpies[o]&&(window.awbTocScrollSpies[o].options.offset=fusionGetScrollOffset())},300)}))}!function(){var e,t,o,i,a,r,d,u,w,f={},h=!1;for(e=0;e<n.length;e++)t=n[e],o=t.getAttribute("data-awb-toc-options"),r=t.getAttribute("data-awb-toc-id"),o&&!t.getAttribute("data-awb-toc-static")&&(o=JSON.parse(o),u="yes"===o.enable_cache,i=c(o),w=s(i,o),u&&(f[r]=i),(a=t.querySelector(".awb-toc-el__content"))&&(!u&&a.childElementCount&&(h=!0),d=!a.innerHTML&&-1===w.indexOf("</li"),a.innerHTML===w||d||(a.innerHTML="",a.insertAdjacentHTML("beforeend",w),u&&(h=!0)),l(n[e],o)));h&&function(e){var t=fusion.getCurrentPostID();if(!t)return;if(document.body.classList.contains("fusion-builder-live-preview"))return;jQuery.ajax({type:"POST",url:awbTOCElementVars.ajaxUrl,data:{action:"awb_save_toc_tree",postId:t,trees:e},dataType:"json"})}(f)}(),0===(t=window.location.hash).indexOf("#toc_")&&jQuery('[href*="'+t+'"]').fusion_scroll_to_anchor_target()}jQuery(document).ready(awbTableOfContentsRefreshAllElements);