MabToc=function(e){this.id=e.id,this.element=e.element,void 0!==e.settings&&(this.settings=e.settings),this.element.classList.contains("mab-backend")&&this.init(),document.addEventListener("DOMContentLoaded",this.init.bind(this))},MabToc.prototype={id:"",element:"",settings:{},init:function(){this.wrapper=this.element.querySelector(".mab-toc"),this.list=this.element.querySelector(".mab-toc-list"),this.includeHeadings=this.settings.includeHeadings?this.settings.includeHeadings.join(","):"h2,h3,h4,h5,h6",this.includeFrom=this.settings.includeFrom||"body",this.excludeFrom=this.settings.excludeFrom||"",this.hierarchical=this.wrapper.classList.contains("mab-toc-hierarchical"),this.listIcon=(this.wrapper.classList.contains("mab-toc-list-icon"),""),0!==this.querySelectorAll(this.includeFrom).length&&(this.list.innerHTML="",this.excludeHeadings(),this.insertAnchors(),this.hierarchical?this.nestedView():this.flatView(),this.bindEvents())},insertAnchors:function(){var n=this,e=this.getHeadingNodes();0<e.length&&e.forEach(function(e,t){var i;e.classList.contains("mab-toc-exclude")||(i=n.getAnchorId(e,t),(t=document.createElement("span")).id=i,e.previousSibling&&i===e.previousSibling.id||(e.parentNode.insertBefore(t,e),e.setAttribute("data-mab-anchor-id",i)))})},getHeadingNodes:function(){var t=this,e=(e=this.includeHeadings.split(",")).map(function(e){return t.includeFrom+" "+e});return document.querySelectorAll(e)},getAnchorId:function(e,t){return(e=e.innerText.toLowerCase().trim().replace(/\W+(?!$)/g,"-").replace(/\W$/,""))&&1<=document.querySelectorAll("#"+e).length?e+"-"+t:e},excludeHeadings:function(){var e=this.getHeadingNodes();0<e.length&&e.forEach(function(e){""===e.innerText.trim()&&e.classList.add("mab-toc-exclude")}),""!==this.excludeFrom&&0<this.querySelectorAll(this.excludeFrom).length&&this.querySelectorAll(this.excludeFrom).forEach(function(e){e.querySelectorAll("h1,h2,h3,h4,h5,h6").forEach(function(e){e.classList.add("mab-toc-exclude")})})},nestedView:function(){var e,c=this,l={content:this.includeFrom,headings:this.includeHeadings,icon:this.listIcon},r=this.list,d=[r],h=0,u=l.headings.split(","),t=[];u.forEach(function(e){e=l.content+" "+e+":not(.mab-toc-exclude)",t.push(e)}),0!==(e=document.querySelectorAll(t)).length?(this.wrapper.classList.add("mab-toc-initialized"),e.forEach(function(e,t){var i,n,s,a=e,o=c.map(u,function(e,t){return a.tagName.toLowerCase()===e.toLowerCase()?parseInt(t):void 0})[0];h<o?(i=d[0].lastChild)&&(n=document.createElement(r.tagName.toLowerCase()),n=i.appendChild(n),d.unshift(n)):d.splice(0,Math.min(h-o,Math.max(d.length-1,0))),n=e.getAttribute("data-mab-anchor-id"),e=document.createElement("li"),l.icon&&""!==l.icon&&((s=document.createElement("span")).classList.add(l.icon),e.appendChild(s)),(s=document.createElement("a")).innerHTML=a.innerText.trim(),s.href="#"+n,e.appendChild(s),d[0].appendChild(e),h=o})):this.wrapper.classList.add("is-empty")},flatView:function(){var e,s=this;options={content:this.includeFrom,headings:this.includeHeadings,icon:this.listIcon},list=this.list,headingSelectors=options.headings.split(","),absoluteHeadingSelectors=[],headingSelectors.forEach(function(e){e+=":not(.mab-toc-exclude)",e=options.content+" "+e,absoluteHeadingSelectors.push(e)}),0!==(e=document.querySelectorAll(absoluteHeadingSelectors)).length?(this.wrapper.classList.add("mab-toc-initialized"),e.forEach(function(e,t){var i,n=s.getAnchorId(e,t),t=document.createElement("li");options.icon&&""!==options.icon&&((i=document.createElement("span")).classList.add(options.icon),t.appendChild(i)),(i=document.createElement("a")).innerHTML=e.innerText.trim(),i.href="#"+n,t.appendChild(i),list.appendChild(t)})):this.wrapper.classList.add("is-empty")},bindEvents:function(){this.settings.collapsable&&this.wrapper.querySelector(".mab-toc-header").addEventListener("click",this.toggle.bind(this)),window.addEventListener("hashchange",this.onHashChange.bind(this)),window.addEventListener("load",function(){this.onHashChange(null)}.bind(this))},onHashChange:function(e){var t=window.location.hash;0<this.wrapper.querySelectorAll('a[href="'+t+'"]').length&&(null!==e&&(e.preventDefault(),e.stopPropagation()),(t=document.getElementById(t.split("#")[1]))&&(t=t.getBoundingClientRect(),window.scrollTo(0,t.top-100)))},toggle:function(){this.wrapper.classList.contains("mab-toc-expanded")?this.collpase():this.wrapper.classList.contains("mab-toc-collapsed")&&this.expand()},collpase:function(){mabFrontend.domHelpers.slideUp(this.wrapper.querySelector(".mab-toc-body")),this.wrapper.classList.remove("mab-toc-expanded"),this.wrapper.classList.add("mab-toc-collapsed")},expand:function(){mabFrontend.domHelpers.slideDown(this.wrapper.querySelector(".mab-toc-body")),this.wrapper.classList.remove("mab-toc-collapsed"),this.wrapper.classList.add("mab-toc-expanded")},map:function(e,t){var i,n,s=[];for(i in e)null!=(n=t(e[i],i))&&s.push(n);return s.flat()},querySelectorAll:function(e){return mabFrontend.domHelpers.querySelectorAll(e)}};var mabToc=mabFrontend.initElement({name:"toc",function:MabToc});mabToc();