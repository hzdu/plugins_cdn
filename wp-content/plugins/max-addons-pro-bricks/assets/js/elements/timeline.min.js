MabTimeline=function(i){this.id=i.id,this.element=i.element,this.timeline=this.element.querySelector(".mab-timeline"),this.items=this.element.querySelectorAll(".mab-timeline-vertical .mab-timeline-item"),this.connector=this.element.querySelector(".mab-timeline-vertical .mab-timeline-connector"),this.progressBar=this.element.querySelector(".mab-timeline-vertical .mab-timeline-connector-inner"),this.sliders={},this.winHeight=0,this.scrollTop=0,this.lastWinHeight=-1,this.lastScrollTop=-1,this.isScrolling=!1,this.isResizing=!1,this.isAnimating=!1,this.animationClass="bounce-in",this.window=window,this.init()},MabTimeline.prototype={node:"",items:"",connector:"",progressBar:"",winHeight:0,scrollTop:0,lastWinHeight:-1,lastScrollTop:-1,isScrolling:!1,isResizing:!1,isAnimating:!1,animationClass:"bounce-in",window:"",init:function(){var i,t,e=this.timeline.getAttribute("data-timeline-layout");"vertical"===e?(this.winHeight=this.window.innerHeight,this.scrollTop=this.window.scrollY,this.bindEvents(),this.requestAnimation(),this.revealItems()):(i=this.element.querySelector(".mab-timeline-navigation"),t=JSON.parse(this.timeline.dataset.options),e=JSON.parse(i.dataset.options),this.sliders.main=new Swiper(this.timeline,t),e.slideToClickedSlide=!0,this.sliders.nav=new Swiper(i,e),this.sliders.main.controller.control=this.sliders.nav,this.sliders.nav.controller.control=this.sliders.main)},bindEvents:function(){this.window.addEventListener("scroll",function(){this.scrollTop=this.window.scrollY,this.requestAnimation(),this.revealItems()}.bind(this)),this.window.addEventListener("resize",function(){this.scrollTop=this.window.scrollY,this.winHeight=this.window.innerHeight,this.requestAnimation()}.bind(this))},requestAnimation:function(){this.isAnimating||requestAnimationFrame(this.reboot.bind(this)),this.isAnimating=!0},revealItems:function(){this.items.forEach(function(i){this.getOffset(i).top<=this.window.scrollY+.95*this.window.innerHeight&&i.classList.contains("mab-timeline-item-hidden")&&(i.classList.remove("mab-timeline-item-hidden"),i.classList.add(this.animationClass))}.bind(this))},setup:function(){var i=this.items[this.items.length-1],t=this.getOffset(i.querySelector(".mab-timeline-marker-wrapper")).height,e=this.getOffset(this.items[0].querySelector(".mab-timeline-marker-wrapper")).top-this.getOffset(this.items[0]).top,t=this.getOffset(this.element).top+this.getOffset(this.element).height-this.getOffset(i.querySelector(".mab-timeline-marker-wrapper")).top-t/2;this.connector.style.top=e+"px",this.connector.style.bottom=t+"px"},reboot:function(){this.isAnimating=!1,this.winHeight!==this.lastWinHeight&&this.setup(),this.start()},start:function(){this.scrollTop===this.lastScrollTop&&this.winHeight===this.lastWinHeight||(this.lastScrollTop=this.scrollTop,this.lastWinHeight=this.winHeight,this.progress())},progress:function(){this.items.forEach(function(i){this.getOffset(i.querySelector(".mab-timeline-marker-wrapper")).top<this.window.scrollY+this.window.innerHeight/2?i.classList.add("mab-timeline-item-active"):i.classList.remove("mab-timeline-item-active")}.bind(this));var i=this.items[this.items.length-1],t=this.getOffset(i.querySelector(".mab-timeline-marker-wrapper")).top,e=this.getOffset(i.querySelector(".mab-timeline-marker-wrapper")).height,i=this.window.scrollY-this.getOffset(this.progressBar).top+this.window.innerHeight/2;t<=this.window.scrollY+this.window.innerHeight/2&&(i=t-this.getOffset(this.progressBar).top),this.progressBar.style.height=(i+=e/2)+"px"},getOffset:function(i){return mabFrontend.domHelpers.queryOffset(i)}};var mabTimeline=mabFrontend.initElement({name:"timeline",function:MabTimeline});mabTimeline();