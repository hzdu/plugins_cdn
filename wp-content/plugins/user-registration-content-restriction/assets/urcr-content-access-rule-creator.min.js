!function(p,c,n){var t=null,g=(UR_Snackbar?t=new UR_Snackbar:n&&console.warn('URCR: "UR_Snackbar" is not defined. Maybe there was a problem while enqueuing the script.'),p(function(){i.init(),l.init(),s.init(),a.init(),g.init_all_flatpickr(),g.init_all_tooltips(),e.render_access_rule(),g.toggleSaveButtons(!1),p(".user-registration-editable-title__icon").trigger("click"),p(".user-registration-editable-title__input").trigger("select"),p(document.body).on("click",".urcr-save-rule",function(e){e.preventDefault(),e.stopPropagation(),c.rule_id&&""!==c.rule_id?r.save_rule():r.create_rule()}),p(document.body).on("click",".urcr-save-rule-as-draft",function(e){e.preventDefault(),e.stopPropagation(),r.save_rule_as_draft()}),p(document.body).on("submit",".urcr-content-access-rule-creator-form",function(e){e.preventDefault(),e.stopPropagation()}),p(document.body).on("click",".page-title-action",function(e){e.preventDefault();Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:'<i class="dashicons dashicons-plus-alt" style="color: #2778c4; border-color: #2778c4;"></i></br>'+c.labels.add_new,confirmButtonText:c.labels.confirm_text,allowOutsideClick:!1,showCancelButton:!0,cancelButtonText:c.labels.cancel_text,html:'<label for="select-box">'+c.labels.content_rule_name+'</label><input id="content_rule_name" class="swal2-input" placeholder="Give it a name"><label for="select-box">'+c.labels.access_control+'</label><select id="access-control" name="access-control" class="swal2-input"><option value="access">'+c.labels.access+'</option><option value="restrict">'+c.labels.restrict+"</option>",inputAttributes:{autocapitalize:"off"},inputPlaceholder:c.labels.content_rule_name}).then(function(e){var t;e.value&&(e=p("#content_rule_name").val(),t=p("#access-control").val(),e={action:"urcr_create_content_rules",security:c._nonce,contentName:e,accessControlValue:t,url:c.content_rule_url},p.ajax({url:c.ajax_url,data:e,type:"POST",success:function(e){e.success&&(window.location.href=e.data.redirect)}}))})}),p(document).on("click",".urcr-logic-gates-container span",function(e){e.preventDefault();var e=p(this).attr("data-value"),t=p(this).attr("class").match(/x\d+/g);t&&(t=t[0].substring(1),0<p("#urcr-logic-group-rule-x"+t).next(".ur-form-group").length&&(p("#urcr-logic-group-rule-x"+t).removeAttr("class").attr("class","urcr-logic-group-rule-"+e),p("#urcr-sub-logic-group-rule-x"+t).removeAttr("class").attr("class","urcr-sub-logic-group-rule-"+e),p("#urcr-sub-logic-group-rule-x"+t).text(e)))}),p(document).ready(function(){p(".urcr-conditional-logic-definitions").each(function(){var e=p(this).attr("id");p("#"+e).find(".ur-form-group").length<=0&&(p("#"+e).find(".ucr-logic-group-rule span").text(""),p("#"+e).before('<p class="urcr-conditional-logic-warning"><b>Warning:</b> Please add the condition logic field</p>'),p("#"+e).find(".ucr-logic-group-rule").children("span").removeAttr("Class"),p("#"+e).find(".ucr-logic-group-rule").removeAttr("Class"))})}),p(document.body).trigger("urcr_initializations_complete")}),{if_empty:function(e,t){return null===e||undefined===e||""===e?t:e},if_not_object:function(e,t){return null===e||undefined===e||"object"!=typeof e?t:e},if_not_json_object:function(e,t){return null===e||undefined===e||Array.isArray(e)||"object"!=typeof e?t:e},if_not_array:function(e,t){return null!==e&&undefined!==e&&Array.isArray(e)?e:t},init_all_tooltips:function(){var e={theme:"tooltipster-borderless",maxWidth:200,multiple:!0,interactive:!0,position:"bottom",contentAsHTML:!0,functionInit:function(e,t){t=jQuery(t.origin).attr("data-tip");t&&e.content(t)}};p(".user-registration-help-tip").tooltipster(e)},init_all_enhanced_select:function(){var t=!1;p(".urcr-enhanced-select2").each(function(){var e=p(this).data("select2_class");p(this).select2({containerCssClass:e}).on("select2:selecting",function(){t=!0}).on("select2:unselecting",function(){t=!0}).on("select2:closing",function(){if(t&&this.multiple)return t=!1})})},init_all_flatpickr:function(){p(".urcr-flatpickr").each(function(){g.init_a_flatpickr(p(this))})},init_a_flatpickr:function(e){var t=(e="string"==typeof e&&""!==e?p(e):e).data("mode"),a=!0===e.data("enable-time"),r=!0===e.data("no-calendar");value=e.val(),e.flatpickr({mode:t,enableTime:a,noCalender:r,defaultDate:value||""})},create_switch_tag:function(e){var t='<div class="'+e.divClassName+'">';return(t+='<input id="'+e.id+'" type="checkbox" class="'+e.inputClassName+'" '+e.default_checked+"  "+e.disabled+">")+('<label class="'+e.labelClassName+'" for="'+e.id+'"> '+e["default"]+" </label>")+"</div>"+'<div class="urcr-notice urcr-notice-warning"><p><b>Warning:</b> It will restrict the whole site.Please add the login shortcode in the action tab.</p></div>'},create_select_tag:function(e){var t=e.id?'id="'+e.id+'"':"",a=e.className||"",r=e.multiple?'multiple="multiple"':"",n="",i=e.options&&"object"==typeof e.options?e.options:{},c=e.data&&"object"==typeof e.data?e.data:{},o="",l=!0===e.prepend_empty_option?"<option></option>":"",s=e.attr&&"object"==typeof e.attr?e.attr:{},u="",_=e.style&&"string"==typeof e.style?'style="'+e.style+'"':"",d=e.value||"",p="";return Object.keys(s).forEach(function(e){u+=e+'="'+s[e]+'" '}),Object.keys(c).forEach(function(e){o+="data-"+e+'="'+c[e]+'" '}),n="<select "+t+' class="'+a+'" '+r+" "+o+" "+u+" "+_+">"+l,Object.keys(i).forEach(function(e){p=Array.isArray(d)&&d.includes(e)||d===e?'selected="selected"':"",n+='<option value="'+e+'" '+p+">"+i[e]+"</option>"}),n+="</select>"},generate_unique_string:function(e){return(e=g.if_empty(e,"x"))+(new Date).getTime()},resolve_smart_tags:function(t,a,e){var r;return e=g.if_not_array(e,[]),t&&a&&"object"==typeof a&&Object.keys(a).forEach(function(e){r=new RegExp("{{{"+e+"}}}","g"),t=t.replace(r,a[e])}),e&&Array.isArray(e)&&e.length&&e.forEach(function(e){e&&"object"==typeof e&&e.placeholder&&""!==e.placeholder?(r=new RegExp("{{{"+e.placeholder+":"+e.tag+"}}}","g"),t=(t=t.replace(r,e.value)).replaceAll("{{Class}}",e.tag),r=new RegExp("{{{"+e.placeholder+":[A-z0-9_]+}}}","g"),t=t.replace(r,"")):n&&console.warn("URCR: Invalid smart tag variable",e)}),t},show_success_message:function(e){return!!t&&(t.add({type:"success",message:e,duration:5}),!0)},show_failure_message:function(e){return!!t&&(t.add({type:"failure",message:e,duration:6}),!0)},insert_template:function(e,t,a,r){a=g.if_not_json_object(a,{}),r=g.if_not_array(r,[]),e&&e.append&&(a.ID&&!0===a.ID&&(a.ID=g.generate_unique_string()),t=g.resolve_smart_tags(t,a,r),e.append(t))},append_spinner:function(e){return!(!e||!e.append)&&(e.append('<span class="ur-spinner is-active"></span>'),!0)},remove_spinner:function(e){return!(!e||!e.remove)&&(e.find(".ur-spinner").remove(),!0)},updateBrowserLocationURL:function(){var e;!c.rule_id||(e=new URLSearchParams(window.location.search)).get("post-id")&&e.get("post-id")===c.rule_id.toString()||(e["delete"]("post-id"),e.set("post-id",c.rule_id),window.history.pushState({},"",window.location.origin+window.location.pathname+"?"+e.toString()))},toggleSaveButtons:function(e){e=g.if_empty(e,!0),p(".urcr-save-rule").prop("disabled",!!e),p(".urcr-save-rule-as-draft").prop("disabled",!!e)},validate_access_rule_form:function(e){var t=p(".urcr-content-access-rule-title-input").val().trim(),a={result:!0};return e=g.if_empty(e,!0),t&&""!==t||(a.result=!1,a.message=c.labels.title_is_required),e&&!a.result&&this.show_failure_message(a.message),a}}),o={extract_rule_data:function(e){return{enabled:p("#urcr-enable-access-rule").is(":checked"),logic_map:this.extract_conditional_logic_map(e.find(".urcr-conditional-logic-map-container > .urcr-conditional-logic-item")),target_contents:this.extract_target_contents(e),actions:this.extract_rule_actions()}},extract_conditional_logic_map:function(e,t){var a,r,n=e.data("type"),i=e.data("store-id"),c={};return t=g.if_empty(t,!1),e&&e instanceof jQuery&&(!t||i&&""!==i||(i=g.generate_unique_string()),n&&""!==n&&(c="group"===n?(t=e.children(".urcr-cld-wrapper").children(".urcr-conditional-logic-definitions").children(".urcr-conditional-logic-item"),a=[],r=e.find(".urcr-logic-gate-"+i+".is-active").data("value"),t.each(function(){a.push(o.extract_conditional_logic_map(p(this)))}),{type:"group",id:i,logic_gate:r,conditions:a}):"user_state"===n?{type:n,id:i,value:(t=e.find(".urbg-item-"+i+".is-active")).length?t.data("value"):null}:"access_period"===n?($select_value=e.find("select").val(),$input_value=e.find("input").val(),{type:n,id:i,value:$access_period_value={select:$select_value,input:$input_value}}):{type:n,id:i,value:e.find("select, input").val()})),c},extract_target_contents:function(e,t){var a,r,n,i=[];return t=g.if_empty(t,!0),e&&e instanceof jQuery&&($targets=e.find(".urcr-target-content")).length&&$targets.each(function(){n=p(this).data("store-id"),r=p(this).find(".urcr-content-target-input").val(),a=p(this).data("type"),n&&""!==n||!t||(n=g.generate_unique_string()),n={id:n,type:a,value:r},"taxonomy"===a&&(n.taxonomy=r,n.value=p(this).find(".urcr-terms-selector").val()),i.push(n)}),i},extract_rule_actions:function(e,t,a,r){var n,i,c,o,l,s,u,_,d=[];return t=g.if_empty(t,!0),a=g.if_empty(a,!0),r=g.if_empty(r,!0),(e=e||p(".urcr-rule-actions-container"))&&e instanceof jQuery&&(p("#urcr-rule-action-message-input-tmce").trigger("click"),n=e.find(".urcr-rule-action-type-input").val(),e=e.find('.urcr-rule-action-type-input option[value="'+n+'"]').text(),i=(i=tinyMCE.get("urcr-rule-action-message-input"))?i.getContent():"",c=p(".urcr-input-container .urcr-rule-access-control").val(),o=p(".urcrra-redirect-input-container .urcr-input").val(),l=p(".urcrra-redirect-to-local-page-input-container .urcr-input").val(),s=p(".urcrra-ur-form-input-container .urcr-input").val(),u=p(".urcrra-shortcode-input-container .urcr-input").val(),_=p(".urcrra-shortcode-input-container .urcrra-shortcode-args").val(),t&&i&&""!==i&&(i=encodeURIComponent(i)),a&&o&&""!==o&&(o=encodeURIComponent(o)),r&&_&&""!==_&&(_=encodeURIComponent(_)),d.push({id:g.generate_unique_string(),type:n,label:e||"",message:i||"",redirect_url:o||"",access_control:c||"",local_page:l||"",ur_form:s||"",shortcode:{tag:u||"",args:_||""}})),d}},e={render_access_rule:function(){var e=c.access_rule_data;c.rule_id&&""!==c.rule_id&&(p("h1.wp-heading-inline").text(c.labels.edit_access_rule),p(".urcr-content-access-rule-title-input").val(c.title),c.access_rule_data.enabled?(p("#urcr-enable-access-rule").attr("checked","checked"),p(".urcr-enable-access-rule-label").text(c.labels.enabled)):(p("#urcr-enable-access-rule").attr("checked",!1),p(".urcr-enable-access-rule-label").text(c.labels.disabled)),c.is_draft?p(".urcr-save-rule-as-draft").text(c.labels.save_draft):p(".urcr-save-rule").text(c.labels.save_rule)),c.is_draft&&p(".urcr-save-rule").text(c.labels.publish_rule),c.rule_id&&""!==c.rule_id&&e?(e.logic_map?this.render_conditional_logic_map(e.logic_map,p(".urcr-conditional-logic-map-container")):n&&console.warn("Logic map is unavailable",e.logic_map),e.actions?this.render_rule_actions(e.actions):n&&console.warn("Rule action is unavailable",e.actions),e.target_contents?this.render_target_contents(e.target_contents):n&&console.warn("Target contents are unavailable",e.target_contents),g.init_all_enhanced_select(),g.init_all_flatpickr(),g.init_all_tooltips()):(n&&!e&&c.rule_id&&console.warn("URCR: Content access rule data is unavailable. It means the rule was unable to be localized or parsed in the server. Could be because of invalid rule ID or invalid rule data.",e),i.add_new_group(p(".urcr-conditional-logic-map-container"))),p(".urcr-widget-header-label").first().text(c.labels.main_logic_group),p(".urcr-spinner-container").remove(),p(".urcrcl-trash").first().remove()},render_conditional_logic_map:function(e,t){if(t=g.if_empty(t,p(".urcr-conditional-logic-map-container")),e&&t&&t instanceof jQuery){if("group"===e.type){i.add_new_group(t,e),t=p("#urcr-conditional-logic-definitions-"+e.id);for(var a=0;a<e.conditions.length;a++){var r=e.conditions[a];this.render_conditional_logic_map(r,t)}}else i.add_new_field(e.type,t,e);return!0}return!1},render_target_contents:function(e,t){if(t=g.if_empty(t,p(".urcr-target-contents-container")),e&&t&&t instanceof jQuery){for(var a=0;a<e.length;a++){var r=e[a];r.type&&l.add_new_target(r.type,t,r)}return!0}return!1},render_rule_actions:function(e,t){if(t=g.if_empty(t,p(".urcr-rule-actions-container")),e&&Array.isArray(e)&&t&&t instanceof jQuery){for(var a=0;a<e.length;a++){var r=e[a];r.type,p(".urcr-rule-action-type-input").val(r.type),p(".urcrra-ur-form-input").val(r.ur_form),p(".urcrra-shortcode-input").val(r.shortcode.tag),p(".urcrra-shortcode-args").val(decodeURIComponent(r.shortcode.args)),p(".urcrra-redirect-input-container .urcr-input").val(decodeURIComponent(r.redirect_url)),p(".urcrra-redirect-to-local-page-input-container .urcr-input").val(r.local_page);for(a=0;a<tinymce.editors.length;a+=1){var n=tinymce.editors[a];if("urcr-rule-action-message-input"===n.id){n.on("init",function(e){e.target.setContent(decodeURIComponent(r.message))});break}}s.updateToggleRuleActionInput(r.type)}return!0}return!1}},i={init:function(){this.init_conditional_logic_field_creation_handler(),this.init_conditional_logic_group_creation_handler(),this.init_conditional_logic_field_deletion_handler()},init_conditional_logic_field_creation_handler:function(){p(document.body).on("change",".urcr-add-new-conditional-logic-field",function(){var e=p(this).val();i.add_new_field(e,p(this).closest(".urcr-settings-widget").children(".urcr-cld-wrapper").children(".urcr-conditional-logic-definitions")),g.init_all_enhanced_select(),g.init_all_flatpickr(),g.init_all_tooltips()})},init_conditional_logic_group_creation_handler:function(){p(document.body).on("click",".urcr-add-new-conditional-logic-group",function(){var e=p(this).closest(".urcr-settings-widget").children(".urcr-cld-wrapper").children(".urcr-conditional-logic-definitions");i.add_new_group(e)})},init_conditional_logic_field_deletion_handler:function(){p(document.body).on("click",".urcrcl-trash",function(){($this=p(this)).closest(".urcr-conditional-logic-item").is(".urcr-conditional-logic-map-container > .urcr-settings-widget")||Swal.fire({title:c.labels.are_you_sure,text:c.labels.clfog_deletion_message,icon:"warning",customClass:{confirmButton:"button button-danger",cancelButton:"button button-secondary ur-mr-1"},showCancelButton:!0,confirmButtonText:c.labels["delete"],reverseButtons:!0}).then(function(e){e.value&&$this.closest(".urcr-conditional-logic-item").fadeOut({complete:function(){p(this).remove()}})})})},add_new_group:function(e,t){t=g.if_not_json_object(t,{});var a=c.templates.conditional_logic_group_template,r={ID:t.id||!0},t=[{placeholder:"logic_gate",tag:t.logic_gate||"",value:"is-active"}];g.insert_template(e,a,r,t)},add_new_field:function(e,t,a){switch(p("#"+t[0].id).closest(".inside").find("p.urcr-conditional-logic-warning").remove(),a=g.if_not_json_object(a,{}),e){case"roles":this.add_new_roles_field(t,a);break;case"user_registered_date":this.add_new_user_registered_date_picker(t,a);break;case"access_period":this.add_new_access_period_selector(t,a);break;case"user_state":this.add_new_user_state_selector(t,a);break;case"email_domain":this.add_new_email_domain_selector(t,a);break;case"post_count":this.add_new_post_count_selector(t,a);break;case"capabilities":this.add_new_capabilities_selector(t,a);break;case"registration_source":this.add_new_registration_source_selector(t,a)}},add_new_roles_field:function(e,t){t=g.if_not_json_object(t,{});var a=g.create_select_tag({className:"urcr-enhanced-select2 urcrcl-roles-selector widefat",multiple:!0,options:c.wp_roles,value:t.value||[]}),r=c.templates.conditional_logic_field_template;g.insert_template(e,r,{ID:t.id||!0,input:a,label:c.labels.roles,type:"roles",tooltip:c.labels.roles_tooltip})},add_new_user_registered_date_picker:function(e,t){var a=(t=g.if_not_json_object(t,{})).value?'value="'+t.value+'"':"",r=c.templates.conditional_logic_field_template;g.insert_template(e,r,{ID:t.id||!0,input:'<input class="urcr-flatpickr urcrcl-user-registered-date-picker widefat" type="text" data-mode="range" '+a+"/>",label:c.labels.user_registered_date,type:"user_registered_date",tooltip:c.labels.registered_date_tooltip})},add_new_access_period_selector:function(e,t){var a="undefined"!=typeof(t=g.if_not_json_object(t,{})).value&&""!==t.value?'value="'+t.value.input+'"':"",r="undefined"!=typeof t.value&&""!==t.value&&"During"==t.value.select?"selected=true":"",n="undefined"!=typeof t.value&&""!==t.value&&"After"==t.value.select?"selected=true":"";inputHtml='<select><option value="During" '+r+'>During</option><option value="After"  '+n+'>After</option></select><input type="number" min="1" '+a+"/> Days",template=c.templates.conditional_logic_field_template,g.insert_template(e,template,{ID:t.id||!0,input:inputHtml,label:c.labels.access_period,type:"access_period",tooltip:c.labels.access_period_tooltip})},add_new_user_state_selector:function(e,t){t=g.if_not_json_object(t,{});var a=c.templates.conditional_logic_field_template,r=ur_create_toggle_buttons({id:t.id||g.generate_unique_string(),className:"urcr-user-state",value:t.value,buttons:[{text:c.labels.logged_in,value:"logged-in"},{text:c.labels.logged_out,value:"logged-out"}]});g.insert_template(e,a,{ID:t.id||!0,input:r,label:c.labels.user_state,type:"user_state",tooltip:c.labels.user_state_tooltip})},add_new_email_domain_selector:function(e,t){var a=(t=g.if_not_json_object(t,{})).value?'value="'+t.value+'"':"",r=c.templates.conditional_logic_field_template;g.insert_template(e,r,{ID:t.id||!0,input:'<input class="urcrcl-email-domain-selector widefat" type="text" placeholder="Eg. gmail.com, yahoo.com"'+a+"/>",label:c.labels.email_domain,type:"email_domain",tooltip:c.labels.email_domains_tooltip})},add_new_post_count_selector:function(e,t){var a=(t=g.if_not_json_object(t,{})).value||0,r=c.templates.conditional_logic_field_template;g.insert_template(e,r,{ID:t.id||!0,input:'<input class="urcrcl-post-count-selector" type="number" min="0" value="'+a+'"/>',label:c.labels.post_count,type:"post_count",tooltip:c.labels.min_post_count_tooltip})},add_new_capabilities_selector:function(e,t){t=g.if_not_json_object(t,{});var a=g.create_select_tag({className:"urcr-enhanced-select2 urcrcl-capabilities-selector widefat",multiple:!0,options:c.wp_capabilities,value:t.value||[]}),r=c.templates.conditional_logic_field_template;g.insert_template(e,r,{ID:t.id||!0,input:a,label:c.labels.capabilities,type:"capabilities",tooltip:c.labels.capabilities_tooltip})},add_new_registration_source_selector:function(e,t){t=g.if_not_json_object(t,{});var a=g.create_select_tag({className:"urcr-enhanced-select2 urcrcl-rigistration-source-selector widefat",multiple:!0,options:c.registration_sources,value:t.value||[]}),r=c.templates.conditional_logic_field_template;g.insert_template(e,r,{ID:t.id||!0,input:a,label:c.labels.registration_source,type:"registration_source",tooltip:c.labels.registration_source_tooltip})}},l={init:function(){this.init_target_content_creation_handler(),this.init_subfield_creation_handler(),this.init_target_content_deletion_handler()},init_target_content_creation_handler:function(){p(document.body).on("change",".urcr-add-new-target-contents",function(){var e=p(this).val();l.add_new_target(e,p(this).closest(".urcr-settings-widget").find(".urcr-target-contents-container")),g.init_all_enhanced_select(),g.init_all_tooltips()})},init_subfield_creation_handler:function(){p(document.body).on("change",".urcr-taxonomy-selector",function(){var e=p(this).val(),e=c.terms_list[e]||{},e=g.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcr-terms-selector widefat",multiple:!0,options:e,data:{select2_class:"urcr-terms-selector-select2"}});p(this).closest(".urcr-input-container").find(".urcr-terms-selector").remove(),p(this).closest(".urcr-input-container").find(".urcr-terms-selector-select2").closest(".select2-container").remove(),p(this).closest(".urcr-input-container").append(e),g.init_all_enhanced_select()})},init_target_content_deletion_handler:function(){p(document.body).on("click",".urcr-trash-target-content",function(){var t=p(this);Swal.fire({title:c.labels.are_you_sure,text:c.labels.cannot_revert,icon:"warning",customClass:{confirmButton:"button button-danger",cancelButton:"button button-secondary ur-mr-1"},showCancelButton:!0,confirmButtonText:c.labels["delete"],reverseButtons:!0}).then(function(e){e.value&&t.closest(".urcr-target-content").fadeOut({complete:function(){p(this).remove()}})})})},add_new_target:function(e,t,a){switch(a=g.if_not_json_object(a,{}),e){case"post_types":this.add_new_post_types_target(t,a);break;case"taxonomy":this.add_new_taxonomy_target(t,a);break;case"wp_posts":this.add_new_post_targets_picker(t,a);break;case"wp_pages":this.add_new_page_targets_picker(t,a);break;case"whole_site":this.add_new_whole_site_targets_picker(t,a)}},add_new_post_types_target:function(e,t){t=g.if_not_json_object(t,{});var t=g.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcrcl-roles-selector widefat",multiple:!0,options:c.post_types,value:t.value}),a=c.templates.target_content_template;g.insert_template(e,a,{ID:!0,input:t,label:c.labels.post_types,type:"post_types",tooltip:c.labels.post_types_tooltip})},add_new_taxonomy_target:function(e,t){t=g.if_not_json_object(t,{});var a=g.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcr-taxonomy-selector widefat",options:c.taxonomies,prepend_empty_option:!0,data:{placeholder:"Select a taxonomy..."},value:t.taxonomy}),r=c.terms_list[t.taxonomy]||{},n="",i=c.templates.target_content_template;t.taxonomy&&""!==t.taxonomy&&(n=g.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcr-terms-selector widefat",multiple:!0,options:r,data:{select2_class:"urcr-terms-selector-select2"},value:t.value})),g.insert_template(e,i,{ID:!0,input:a+n,label:c.labels.taxonomy,type:"taxonomy",tooltip:c.labels.taxonomy_tooltip})},add_new_post_targets_picker:function(e,t){t=g.if_not_json_object(t,{});var t=g.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcrcl-capabilities-selector widefat",multiple:!0,options:c.posts,value:t.value}),a=c.templates.target_content_template;g.insert_template(e,a,{ID:!0,input:t,label:c.labels.pick_posts,type:"wp_posts",tooltip:c.labels.pick_posts_tooltip})},add_new_page_targets_picker:function(e,t){t=g.if_not_json_object(t,{});t=g.create_select_tag({className:"urcr-enhanced-select2 urcr-content-target-input urcrcl-capabilities-selector widefat",multiple:!0,options:c.pages,value:t.value});template=c.templates.target_content_template,g.insert_template(e,template,{ID:!0,input:t,label:c.labels.pick_pages,type:"wp_pages",tooltip:c.labels.pick_pages_tooltip})},add_new_whole_site_targets_picker:function(e,t){t=g.if_not_json_object(t,{});t=g.create_switch_tag({divClassName:"user-registration-switch ur-ml-auto",inputClassName:"user-registration-switch__control hide-show-check enabled",labelClassName:"urcr-enable-access-rule-label",default_checked:'checked="checked"',disabled:'disabled="true"',"default":"Enabled",id:"urcr_whole_site_restriction"});template=c.templates.target_content_template,g.insert_template(e,template,{ID:!0,input:t,label:c.labels.whole_site,type:"whole_site",tooltip:c.labels.whole_site_tooltip})}},s={init:function(){this.fill_options(),this.init_rule_action_input_switcher()},fill_options:function(){var e=g.create_select_tag({className:"urcr-enhanced-select2 urcr-input urcrra-ur-form-input",options:c.ur_forms,prepend_empty_option:!0,data:{placeholder:c.labels.select_ur_form},style:"width: 100% !important;"}),t=g.create_select_tag({className:"urcr-enhanced-select2 urcr-input urcrra-shortcode-input",options:c.shortcodes,prepend_empty_option:!0,data:{placeholder:c.labels.select_ur_shortcode},style:"width: 100% !important;"}),a='<input class="widefat urcrra-shortcode-args" type="text" placeholder="'+c.labels.enter_shortcode_args+'">',r=g.create_select_tag({className:"urcr-enhanced-select2 urcr-input urcrra-redirect-to-local-page-input",options:c.pages,prepend_empty_option:!0,data:{placeholder:c.labels.select_a_page},style:"width: 100% !important;"});p(".urcrra-ur-form-input-container .urcr-body").html(e),p(".urcrra-shortcode-input-container .urcr-body").html(t+a),p(".urcrra-redirect-to-local-page-input-container .urcr-body").html(r)},init_rule_action_input_switcher:function(){p(document.body).on("change",".urcr-rule-action-type-input",function(){s.updateToggleRuleActionInput(p(this).val())})},updateToggleRuleActionInput:function(e){var t=null;switch(e){case"message":t=p(".urcrra-message-input-container");break;case"redirect":t=p(".urcrra-redirect-input-container");break;case"redirect_to_local_page":t=p(".urcrra-redirect-to-local-page-input-container");break;case"ur-form":t=p(".urcrra-ur-form-input-container");break;case"shortcode":t=p(".urcrra-shortcode-input-container")}p(".urcr-rule-action-input-container.urcr-active").slideUp(400),p(".urcr-rule-action-input-container.urcr-active").removeClass("urcr-active"),t&&(t.slideDown(400),t.addClass("urcr-active"))}},a={init:function(){this.init_access_rule_state_label_toggler(),this.init_toggle_animate_title_editor_handler(),this.init_tabs_switcher(),this.init_widgets_toggler(),p(document.body).on("urcr_initializations_complete",function(){a.enable_constant_selection()})},init_access_rule_state_label_toggler:function(){p(document.body).on("change","#urcr-enable-access-rule",function(){p(this).is(":checked")?p(".urcr-enable-access-rule-label").text(c.labels.enabled):p(".urcr-enable-access-rule-label").text(c.labels.disabled)})},init_toggle_animate_title_editor_handler:function(){p(document.body).on("click",".user-registration-editable-title__icon",function(){var e=p(this).siblings(".user-registration-editable-title__input");e.hasClass("is-editing")||e.trigger("focus"),e.toggleClass("is-editing")})},init_tabs_switcher:function(){p(document.body).on("click",".urcr-nav-tab-wrapper .urcr-tab",function(e){e.preventDefault(),p(this).is(".nav-tab-active")||(p(".urcr-nav-tab-wrapper .urcr-tab.nav-tab-active").removeClass("nav-tab-active"),p(this).addClass("nav-tab-active"),(e=p(this).data("tab-content-selector"))&&(p(".urcr-tab-contents-wrapper .urcr-tab-content.urcr-tab-content-active").slideUp(300),p(e).slideDown(300),p(".urcr-tab-contents-wrapper .urcr-tab-content.urcr-tab-content-active").removeClass("urcr-tab-content-active"),p(e).addClass("urcr-tab-content-active")),g.init_all_enhanced_select())})},init_widgets_toggler:function(){var t=["select","input","button","option"];p(document.body).on("click",".urcr-settings-widget .urcr-settings-widget-header",function(e){t.includes(e.target.tagName.toLowerCase())||p(e.target).is(".urcrcl-trash")||p(e.target).closest(".select2").length||p(e.target).is(".urbg-item")||(p(this).closest(".urcr-settings-widget").toggleClass("closed"),g.init_all_enhanced_select())})},enable_constant_selection:function(){p(document.body).on("change",".urcr-constant-selection-enabled",function(){p(this).find(".urcr-logic-field-placeholder").prop("selected",!0)})}},r={create_rule:function(e){var t;g.validate_access_rule_form().result&&(e=g.if_empty(e,p(".urcr-content-access-rule-creator-form")),e=o.extract_rule_data(e),t=p(".urcr-save-rule"),g.append_spinner(t),g.toggleSaveButtons(!0),this.send_data({action:"urcr_create_access_rule",title:p(".urcr-content-access-rule-title-input").val(),access_rule_data:JSON.stringify(e)},{success:function(e){c.rule_id=e.data.rule_id,g.updateBrowserLocationURL(),t.text(c.labels.save_rule),p("h1.wp-heading-inline").text(c.labels.edit_access_rule),p(".urcr-save-rule-as-draft").remove(),e.success?g.show_success_message(e.data.message):g.show_failure_message(e.data.message)},failure:function(e,t){g.show_failure_message(c.labels.network_error+" ("+t+")")},complete:function(){g.remove_spinner(t),g.toggleSaveButtons(!1)}}))},save_rule:function(e){var t,a,r;g.validate_access_rule_form().result&&(c.rule_id&&""!==c.rule_id?(e=g.if_empty(e,p(".urcr-content-access-rule-creator-form")),t=o.extract_rule_data(e),a=p(".urcr-save-rule"),r=function(){g.append_spinner(a),g.toggleSaveButtons(!0),this.send_data({action:"urcr_save_access_rule",rule_id:c.rule_id,title:p(".urcr-content-access-rule-title-input").val(),access_rule_data:JSON.stringify(t)},{success:function(e){p(".urcr-save-rule-as-draft").remove(),a.text(c.labels.save_rule),e.success?g.show_success_message(e.data.message):g.show_failure_message(e.data.message)},failure:function(e,t){g.show_failure_message(c.labels.network_error+" ("+t+")")},complete:function(){g.remove_spinner(a),g.toggleSaveButtons(!1)}})}.bind(this),c.is_draft?Swal.fire({title:c.labels.are_you_sure,text:c.labels.publish_draft_warning,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:c.labels.publish}).then(function(e){e.value&&(c.is_draft=!1,r())}):r()):n&&console.error("Rule cannot be saved without an ID",c.rule_id))},save_rule_as_draft:function(e){var t,a;g.validate_access_rule_form().result&&(e=g.if_empty(e,p(".urcr-content-access-rule-creator-form")),e=o.extract_rule_data(e),t=p(".urcr-save-rule-as-draft"),a=p(".urcr-save-rule"),g.append_spinner(t),g.toggleSaveButtons(!0),this.send_data({action:"urcr_save_access_rule_as_draft",rule_id:c.rule_id&&""!==c.rule_id?c.rule_id:"",title:p(".urcr-content-access-rule-title-input").val(),access_rule_data:JSON.stringify(e)},{success:function(e){c.rule_id=e.data.rule_id,g.updateBrowserLocationURL(),a.text(c.labels.publish_rule),t.text(c.labels.save_draft),c.is_draft=!0,e.success?g.show_success_message(e.data.message):g.show_failure_message(e.data.message)},failure:function(e,t){g.show_failure_message(c.labels.network_error+" ("+t+")")},complete:function(){g.remove_spinner(t),g.toggleSaveButtons(!1)}}))},send_data:function(e,t){var a="function"==typeof t.success?t.success:function(){},r="function"==typeof t.failure?t.failure:function(){},n="function"==typeof t.beforeSend?t.beforeSend:function(){},t="function"==typeof t.complete?t.complete:function(){};!e._wpnonce&&c&&(e._wpnonce=c._nonce),p.ajax({type:"post",dataType:"json",url:c.ajax_url,data:e,beforeSend:n,success:a,error:r,complete:t})}}}(jQuery,window.urcr_localized_data,window.urcr_localized_data.URCR_DEBUG);