(()=>{var e={6815:e=>{e.exports=Backbone.Collection.extend({last:function(){return this.at(this.size()-1)}})},9494:(e,t,i)=>{var a=i(6815),s=i(4778);e.exports=a.extend({model:Backbone.Model.extend({defaults:{hash:"",label:""}}),add_page:function(e,t){var i=new s({hash:e,label:t});return this.add(i)}})},4778:e=>{e.exports=Backbone.Model.extend({defaults:{ID:"",hash:"",label:"",full_link:!1},initialize:function(e){this.get("ID")||this.set("ID",e.label.split(" ").join("").toLowerCase()),this.set("full_link",e.hash.match(/^http/))},get_url:function(){return this.get("full_link")?this.get("hash"):"#"+this.get("hash")}})},6854:(e,t,i)=>{var a,s=i(9494),n=i(2046),r=i(2557);a=jQuery,e.exports=Backbone.Router.extend({view:null,$el:a("#tab-admin-dashboard-wrapper"),routes:{dashboard:"dashboard"},breadcrumbs:{col:null,view:null},init_breadcrumbs:function(){this.breadcrumbs.col=new s,this.breadcrumbs.view=new n({collection:this.breadcrumbs.col})},set_page:function(e,t,i){this.breadcrumbs.col.reset(),i=i||{},this.breadcrumbs.col.add_page(ThriveAbAdmin.dash_url,ThriveAbAdmin.t.Thrive_Dashboard,!0),_.each(i,_.bind((function(e){this.breadcrumbs.col.add_page(e.route,e.label)}),this)),this.breadcrumbs.col.add_page("",t);var s=a("head > title");this.original_title||(this.original_title=s.html()),s.html(t+" &lsaquo; "+this.original_title)},dashboard:function(){this.set_page("dashboard",ThriveAbAdmin.t.Dashboard);var e=this;TVE_Dash.showLoader(),this.view&&this.view.remove(),jQuery.ajax({cache:!1,url:ThriveAbAdmin.ajax.url,method:"POST",dataType:"json",data:{route:"testsforadmin",action:ThriveAbAdmin.ajax.action,custom:ThriveAbAdmin.ajax.controller_action,nonce:ThriveAbAdmin.ajax.nonce}}).done((function(t){e.view=new r({running_tests:new Backbone.Collection(t.running_tests),completed_tests:new Backbone.Collection(t.completed_tests),dashboard_stats:t.dashboard_stats}),e.$el.html(e.view.render().$el),TVE_Dash.hideLoader()}))}})},2046:e=>{var t;t=jQuery,e.exports=Backbone.View.extend({el:t("#tab-breadcrumbs-wrapper")[0],template:TVE_Dash.tpl("breadcrumbs"),initialize:function(){this.$title=t("head > title"),this.original_title=this.$title.html(),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"add",this.render)},render:function(){this.$el.empty().html(this.template({links:this.collection}))}})},2557:(e,t,i)=>{var a=i(1359),s=i(5526);e.exports=Backbone.View.extend({template:TVE_Dash.tpl("dashboard"),events:{"keyup .tab-running-search-input":"search_tests","keyup .tab-completed-search-input":"search_tests"},running_test_pagination:null,completed_test_pagination:null,initialize:function(e){this.running_tests=e.running_tests,this.completed_tests=e.completed_tests,this.dashboard_stats=e.dashboard_stats,this.listenTo(this.completed_tests,"remove",(function(){this.completed_test_pagination.changePage()}),this)},render:function(){return this.$el.html(this.template({stats:this.dashboard_stats})),this.render_running_tests(),this.render_completed_tests(),this},render_running_tests:function(){var e=new a({template_item:TVE_Dash.tpl("running-test-item"),template_no_item:TVE_Dash.tpl("running-test-no-item"),template_no_search_item:TVE_Dash.tpl("running-test-no-search-item"),el:this.$el.find(".tab-running-test-items-list"),collection:this.running_tests});this.running_test_pagination=new s({collection:this.running_tests,view:e,el:this.$el.find(".tab-running-pagination")}),this.running_test_pagination.changePage()},render_completed_tests:function(){var e=new a({template_item:TVE_Dash.tpl("completed-test-item"),template_no_item:TVE_Dash.tpl("completed-test-no-item"),template_no_search_item:TVE_Dash.tpl("completed-test-no-search-item"),el:this.$el.find(".tab-completed-test-items-list"),collection:this.completed_tests});this.completed_test_pagination=new s({collection:this.completed_tests,view:e,el:this.$el.find(".tab-completed-pagination")}),this.completed_test_pagination.changePage()},search_tests:function(e){var t,i=jQuery(e.target).val();if(-1!==e.currentTarget.className.indexOf("running"))t=this.running_test_pagination;else{if(-1===e.currentTarget.className.indexOf("completed"))return;t=this.completed_test_pagination}t.changePage(null,{page:1,search_by:i})}})},8274:(e,t,i)=>{var a=i(8469);e.exports=Backbone.View.extend({template:"",tagName:"tr",events:{"click .tab-delete-test":"delete_test"},initialize:function(e){this.template=e.template},render:function(){return this.$el.html(this.template({model:this.model})),this},delete_test:function(){"completed"===this.model.get("status")&&TVE_Dash.modal(a,{submit:_.bind((function(){TVE_Dash.showLoader();var e=this;jQuery.ajax({cache:!1,url:ThriveAbAdmin.ajax.url,method:"POST",dataType:"json",data:{id:this.model.get("id"),page_id:this.model.get("page_id"),route:"deletecompletedtestadmin",action:ThriveAbAdmin.ajax.action,custom:ThriveAbAdmin.ajax.controller_action,nonce:ThriveAbAdmin.ajax.nonce}}).done((function(t){t.success?(e.collection.remove(e.model),TVE_Dash.success(t.text)):TVE_Dash.err(t.text),TVE_Dash.hideLoader()}))}),this),title:"",description:TVE_Dash.sprintf(ThriveAbAdmin.t.about_to_delete_variation,["<strong>"+this.model.get("title")+"</strong>"]),btn_yes_txt:ThriveAbAdmin.t.yes,btn_no_txt:ThriveAbAdmin.t.no,"max-width":"20%",width:"20%"})}})},1359:(e,t,i)=>{var a=i(8274);e.exports=Backbone.View.extend({template:"",events:{},initialize:function(e){this.template_item=e.template_item,this.template_no_item=e.template_no_item,this.template_no_search_item=e.template_no_search_item,this.collection=e.collection},render:function(e,t){var i=this.collection;if(this.$el.empty(),void 0!==e&&(i=new Backbone.Collection(e)),0===i.length){var a=this.template_no_item();"search_by"===t&&(a=this.template_no_search_item()),this.$el.html(a)}else i.each(this.renderOne,this);return this},renderOne:function(e){var t=new a({template:this.template_item,collection:this.collection,model:e});this.$el.append(t.render().$el)}})},5526:e=>{e.exports=Backbone.View.extend({template:TVE_Dash.tpl("pagination"),events:{"click a.page":"changePage","change .tab-items-per-page":"changeItemPerPage"},currentPage:1,pageCount:1,itemsPerPage:10,total_items:0,collection:null,params:null,view:null,initialize:function(e){this.collection=e.collection,this.view=e.view},changeItemPerPage:function(e){this.itemsPerPage=jQuery(e.target).val(),this.changePage(null,{page:1})},changePage:function(e,t){var i={itemsPerPage:this.itemsPerPage};if(e&&void 0!==e.currentTarget?i.page=jQuery(e.currentTarget).attr("value"):t&&void 0!==t.page?i.page=parseInt(t.page):i.page=this.currentPage,i.page<1&&(i.page=1),void 0!==t&&void 0!==t.search_by&&(this.search_by=t.search_by),i.search_by=this.search_by?this.search_by.toLowerCase():"",void 0!==this.view&&null!=this.view){this.updateParams(i.page,this.collection.length);var a,s=this.collection.clone(),n=(this.currentPage-1)*this.itemsPerPage,r=[],o="";if(void 0!==s.comparator&&s.sort(),i.search_by){for(var l in s.each((function(e){var t=e.get("title").toLowerCase(),a=JSON.stringify(e.get("goal_pages")).toLowerCase(),s=e.get("page_title").toLowerCase();-1===t.indexOf(i.search_by)&&-1===a.indexOf(i.search_by)&&-1===s.indexOf(i.search_by)&&r.push(e)})),r)s.remove(r[l]);o="search_by"}a=s.chain().rest(n).first(this.itemsPerPage).value(),this.view.render(a,o),this.render()}return!1},updateParams:function(e,t){this.currentPage=e,this.total_items=t,this.pageCount=Math.ceil(this.total_items/this.itemsPerPage)},setupParams:function(e){this.currentPage=e,this.total_items=this.collection.length,this.pageCount=Math.ceil(this.total_items/this.itemsPerPage)},render:function(){return this.$el.html(this.template({currentPage:parseInt(this.currentPage),pageCount:parseInt(this.pageCount),total_items:parseInt(this.total_items),itemsPerPage:parseInt(this.itemsPerPage)})),TVE_Dash.materialize(this.$el),this}})},8469:e=>{e.exports=TVE_Dash.views.Modal.extend({template:TVE_Dash.tpl("modals/html-delete"),events:{"click .tvd-modal-submit":"submit"},initialize:function(e){TVE_Dash.views.Modal.prototype.initialize.apply(this,arguments),this.$el.addClass("tvd-red")},render:function(){return TVE_Dash.views.Modal.prototype.render.apply(this,arguments),this.$(".tvd-modal-close").addClass("tvd-white-text"),this},submit:function(){if("function"!=typeof this.data.submit)throw new Error("Submit data not implemented");this.data.submit.apply(this,arguments),this.close()}})}},t={};function i(a){var s=t[a];if(void 0!==s)return s.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,i),n.exports}jQuery((function(){var e=window.ThriveAbAdmin||{},t=i(6854);Backbone.emulateHTTP=!0,e.router=new t,e.router.init_breadcrumbs(),Backbone.history.stop(),Backbone.history.start(),Backbone.history.fragment||e.router.navigate("#dashboard",{trigger:!0})}))})();