(()=>{function t(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,n)}return o}function e(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var n,i=window.TVE||{},a=!1;(n=jQuery)(window).on("tcb_main_ready",(function(){["tvo_display","tvo_capture"].includes(i.CONST.post.post_type)&&(a=!0,i.StorageManager.unset("tvo_block-"+i.CONST.post.ID)),i.main.on("device_change",(function(){i.inner_$(".thrlider-slider").each((function(){i.inner_$(this).parents('[id*="thrlider"]').thrlider("redraw")}))})),i.main.on("tcb_auth_login",(function(t){TVO_Front.nonce=t.rest_nonce})),i.add_action("tve.save_post.success",(function(){i.StorageManager.set("tvo_block-"+i.CONST.post.ID,!0)})),i.add_filter("editor_loaded_callback",(function(){a&&i.Editor_Page.focus_element(i.Editor_Page.editor.children().first())})),i.add_filter("tcb.form.input.labels",(function(t){return e(e({},t),{role:"Role",website_url:"Website URL",title:"Title ",question:"Question"})})),i.TVO={captureSettingsModal:{},captureTemplateModal:{},displaySettingsModal:{},displayTemplateModal:{},defaults:{display:{template:"grid/default-template-grid",tags:[],testimonials:[],name:"",show_title:1,show_role:1,show_site:0,type:"display",max_testimonials:0},capture:{id:0,template:"default-template",type:"capture",name_label:"Full Name",title_label:"Testimonial Title",email_label:"Email",role_label:"Role",website_url_label:"Website URL",name_required:1,title_required:0,email_required:0,role_required:0,role_display:0,title_display:0,image_display:1,reCaptcha_option:0,on_success_option:"message",on_success:"Thanks for submitting your testimonial.",button_text:"Submit",questions:["What was your experience with our product like?"],placeholders:[""],questions_required:[1],tags:"",color_class:""}},config:{key:"__CONFIG_tvo_shortcode__",update:function(t,e,o){var n=this.get();n[e]=o,this.save(n)},save:function(t,e){if(t.hasClass("thrive-shortcode-config")||(t=t.find(".thrive-shortcode-config")),0===t.length)return!1;t.html(this.key+JSON.stringify(e).replace(/\\"/g,"_tve_quote_")+this.key)},get:function(t){if(t.hasClass("thrive-shortcode-config")||(t=t.find(".thrive-shortcode-config")),0===t.length)return!1;var e=new RegExp(this.key,"g");return JSON.parse(t.html().replace(/_tveutf8_/g,"\\u").replace(e,"").replace(/\\\'/g,"'").replace(/_tve_quote_/g,'\\"'))}},getWrapper:function(t,e){var o=t.find(e);return 0===o.length&&(o=n("<div>").attr("."===e[0]?"class":"id",e.substring(1)).appendTo(t)),o},ajaxRender:function(t,e){t.$el.addClass("loading");var o=this;n.ajax({headers:{"X-WP-Nonce":TVO_Front.nonce},cache:!1,data:{config:e},method:"POST",url:TVO_Front.routes.shortcodes+"/render"}).done((function(e){o.updateElement(i.ActiveElement,e,t),i.ActiveElement.find('[id*="thrlider"]').thrlider("redraw")})).fail((function(t){console.error(t)}))},updateElement:function(t,e,o){var a={};for(var s in t.attr("data-update-styles")&&(a=n.extend({},i.TVO.config.get(t.find(".thrive-shortcode-config")).custom_css),t.removeAttr("data-update-styles"),e.config.custom_css=a),t.removeClass("tcb-elem-placeholder"),t.empty(),i.TVO.config.save(i.TVO.getWrapper(t,".thrive-shortcode-config").hide(),e.config),i.TVO.getWrapper(t,".thrive-shortcode-html").html(e.html),a)t.find(s).attr("data-css",a[s]);t.data("config",e.config),setTimeout((function(){o.component&&o.component.update(),i.Editor_Page.reposition_icons()}),500),o.close(),o.$el.removeClass("loading"),i.Editor_Page.focus_element(t)}},i.Views.Components.ovation_capture=i.Views.Base.component.extend({controls_init:function(t){this.template_modal=new i.TVO.captureTemplateModal({el:i.modal.get_element("capture-testimonial-templates-lightbox")}),this.settings_modal=new i.TVO.captureSettingsModal({el:i.modal.get_element("capture-form-settings-lightbox")}),t.ButtonColor.getButtonStyle=function(){var t="";switch(i.ActiveElement.data("config").template){case"default-template":case"set1-template":t="background";break;case"set2-template":t="border-color"}return t},t.ButtonColor.update=function(){this.setValue(this.applyTo().css(this.getButtonStyle()))},t.ButtonColor.input=function(t){var e={},o=this.getButtonStyle(),n=i.ActiveElement.find(".thrive-shortcode-config"),a=i.TVO.config.get(n);e[o]=t+"!important","border-color"===o&&(e.color=t+"!important"),this.applyTo().head_css(e),a.custom_css=a.custom_css||{},a.custom_css[this.model.to]=this.applyTo().data("css"),i.TVO.config.save(n,a)}},placeholder_action:function(t){t.data("config",i.TVO.defaults.capture),this.template_modal.open({template:i.TVO.defaults.capture.template,component:this})},before_update:function(){var t=i.ActiveElement,e=i.TVO.config.get(t)||i.TVO.defaults.capture;t.data("config",e)},change_template:function(){var t=i.ActiveElement.data("config");this.template_modal.open({template:t.template,component:this})},form_settings:function(){var t=i.ActiveElement.data("config");this.settings_modal.open({config:t,component:this})}}),i.TVO.captureTemplateModal=i.modal.base.extend({before_open:function(t){t.template&&t.template.length>0&&this.$(".tvo-template").each((function(){this.dataset.value===t.template?this.classList.add("current"):this.classList.remove("current")})),this.component=t.component},save:function(){var t=i.ActiveElement.data("config");t.template=this.$(".tvo-template.current").data("value"),i.TVO.ajaxRender(this,t)},select:function(t,e){e.parentNode.childNodes.forEach((function(t){t.nodeType!==Node.TEXT_NODE&&t.classList.remove("current")})),e.classList.add("current")}}),i.TVO.captureSettingsModal=i.modal.base.extend({before_open:function(t){var e=t.config||{};this.applySettings(e),this.component=t.component},save:function(){i.TVO.ajaxRender(this,this.readSettings(i.ActiveElement.data("config")))},applySettings:function(t){this.$(".tvo_config_field").each((function(){"checkbox"===this.type?this.checked=1===parseInt(t[this.name]):this.value=t[this.name]})),this.$(".tvo-question").remove(),t.questions.forEach((function(e,o){n("<div>",{class:"tvo-row tvo-collapse tvo-question"+(0===o?" tvo-default-question":""),html:TVO_Front.tpl("new-question")({index:o,question:e,config:t})}).insertBefore(".tvo-add-question")})),this.$(".tvo-all-tags").val(t.tags).trigger("change")},readSettings:function(t){return this.$(".tvo_config_field").each((function(){t[this.name]="checkbox"===this.type?this.checked?1:0:this.value})),t.tags=this.$(".tvo-all-tags").val(),t.questions=[],t.placeholders=[],t.questions_required=[],this.$(".tvo-question").each((function(e){var o=n(this);t.questions[e]=o.find(".tvo-question-input").val(),t.placeholders[e]=o.find(".tvo-placeholder-input").val(),t.questions_required[e]=o.find(".tvo-required").is(":checked")?1:0})),t}}),i.Views.Components.ovation_display=i.Views.Base.component.extend({controls_init:function(t){var e=this;this.template_modal=new i.TVO.displayTemplateModal({el:i.modal.get_element("display-testimonial-templates-lightbox")}),this.settings_modal=new i.modal.base({el:i.modal.get_element("display-settings-lightbox")}),_.each(t,(function(t){t.update=function(){this.setValue(this.applyTo().css(t.model.config.style))},t.input=function(e){var o={},n=i.ActiveElement.find(".thrive-shortcode-config"),a=i.TVO.config.get(n);-1!==t.model.config.style.indexOf("border")&&(o.border="1px solid"),o[t.model.config.style]=e+"!important",this.applyTo().head_css(o,!1,"",!1,i.CONST.global_css_prefix+" "),a.custom_css=a.custom_css||{},a.custom_css[t.model.to]=this.applyTo().first().data("css"),i.TVO.config.save(n,a)}})),n(document).on("tvo.get.shortcode",(function(t,o){var n=i.ActiveElement.data("config");o.template=n.template,o.id&&delete o.id,i.TVO.ajaxRender(e.settings_modal,_.extend(n,o))})),n(document).on("tvo.save.shortcode",(function(t,o){var a=i.ActiveElement,s=a.data("config");s=_.extend(s,o),e.settings_modal.$el.addClass("loading"),n.ajax({headers:{"X-WP-Nonce":TVO_Front.nonce},cache:!1,url:TVO_Front.routes.shortcodes,type:"POST",data:{name:s.name,type:"display",config:s,content:"",html:1}}).done((function(t){i.TVO.updateElement(a,t,e.settings_modal)}))}))},placeholder_action:function(){i.ActiveElement.data("config",i.TVO.defaults.display),this.template_modal.open({init:!0,template:i.TVO.defaults.display.template,component:this})},after_update:function(){var t=i.ActiveElement,e=i.TVO.config.get(t)||i.TVO.defaults.display;TVO_Front.active_config=e,t.data("config",e),_.each(this.controls,(function(t){setTimeout((function(){0===t.applyTo().length?t.hide():t.show()}),10)}))},display_settings:function(t,e,o){this.settings_modal.open(),Backbone.history.stop(),Backbone.history.start(),o=o||"#pre-select",TVO_Front.router.navigate(o,{trigger:!0})},change_template:function(){var t=i.ActiveElement.data("config");this.template_modal.open({template:t.template,component:this})}}),i.TVO.displayTemplateModal=i.modal.base.extend({before_open:function(t){t.template&&t.template.length>0&&this.$(".tvo-template").each((function(){this.dataset.value===t.template?this.classList.add("current"):this.classList.remove("current")})),this.init=t&&t.init,this.component=t&&t.component},save:function(){var t=i.ActiveElement.data("config");t.custom_css&&(t.custom_css={}),t.template=this.$(".tvo-template.current").data("value"),this.init?(i.ActiveElement.data("config",t),this.close(),this.component.display_settings({},{},"#start")):i.TVO.ajaxRender(this,t)},select:function(t,e){e.parentNode.childNodes.forEach((function(t){t.nodeType!==Node.TEXT_NODE&&t.classList.remove("current")})),e.classList.add("current")}}),i.add_filter("should_have_width_on_float",(function(t){return t.push("thrv_tvo_capture_testimonials"),t}))}))})();