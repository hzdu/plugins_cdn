jQuery(function(s){var i,c=s("#yith-wcbm-badge-type").data("type"),l=s("#yith-wcbm-advanced-bg-color"),o=s("#yith-wcbm-advanced-text-color"),n=s("#preview-style-badge"),v=s("#yith-wcbm-advanced-badge"),d=s("#yith-wcbm-css-badge"),r=s("#yith-wcbm-css-bg-color"),h=s("#yith-wcbm-css-text-color"),m=s("#yith-wcbm-css-text"),b=1,e=0,u=0,a=s("#preview-bg"),g=a.offset().top-60,t=s("#yith-wcbm-badge-type"),y=s("#yith-wcbm-image-url"),p=s("#btn-text"),w=s("#btn-css"),F=s("#btn-image"),f=s("#btn-advanced"),x=s(".button-select-image"),k=s(".button-select-advanced"),_=s(".button-select-css"),C=s("#preview-badge"),A=s("#yith-wcbm-position"),I=s(".half-left"),S=s(".half-right"),E=s(".tab-container"),O=s("#yith-wcbm-txt-color"),T=s("#yith-wcbm-text"),N=s("#yith-wcbm-bg-color"),W=s("#yith-wcbm-width"),z=s("#yith-wcbm-height"),H=s("#yith-wcbm-border-top-left-radius"),j=s("#yith-wcbm-border-top-right-radius"),B=s("#yith-wcbm-border-bottom-right-radius"),D=s("#yith-wcbm-border-bottom-left-radius"),L=s("#yith-wcbm-padding-top"),P=s("#yith-wcbm-padding-left"),$=s("#yith-wcbm-padding-bottom"),X=s("#yith-wcbm-padding-right"),Y=s("#yith-wcbm-font-size"),J=s("#yith-wcbm-line-height"),Q=s("#yith-wcbm-opacity"),U=s("#yith-wcbm-rotation-x"),Z=s("#yith-wcbm-rotation-y"),q=s("#yith-wcbm-rotation-z"),G=s("#yith-wcbm-pos-top"),K=s("#yith-wcbm-pos-bottom"),M=s("#yith-wcbm-pos-left"),R=s("#yith-wcbm-pos-right"),V=s("#yith-wcbm-pos-top-center"),tt=s("#yith-wcbm-pos-bottom-center"),at=s("#yith-wcbm-pos-left-center"),et=s("#yith-wcbm-pos-right-center"),it=s("#yith-wcbm-pos-center"),ct=s("#yith-wcbm-flip-text-horizontally"),lt=s("#yith-wcbm-flip-text-vertically"),st=(s("#output-opacity"),C=s("#preview-badge"),s("#custom-image-badges")),ot=(s("#yith-wcbm-advanced-options"),s("#yith-wcbm-advanced-message-not-config")),nt=s("#preview-loader"),vt=s(".yith-wcbm-advanced-colors"),dt=s("#yith-wcbm-advanced-display"),rt=new Array(1,1,1,1,0,1,1,1,1,0),ht=new Array(0,1,1,1,1,0,1,0,1,1),mt=new Array("#66B909","#FF6621","#FF6621","#00DDBF","","#A527F0","#7428F9","#4090FF","#FF6621",""),bt=new Array("#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF","","#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF",""),ut=new Array(rt,mt,bt,ht),gt=new Array("NEW!","BEST","ON SALE","New!","SALE!","SALE!","SALE!","NEW"),yt=new Array("#3986C6","#4AC393","#FFFFFF","#F78E35","#45D0EB","#F66600","#F66600","#3E93FF"),pt=new Array("#FFFFFF","#FFFFFF","#61C300","#FFFFFF","#FFFFFF","#000000","#FFFFFF","#FFFFFF"),wt=new Array(gt,yt,pt),Ft=function(){I.removeAttr("style"),S.removeAttr("style"),S.height()>I.height()?I.height(S.height()):S.height(I.height())},ft=function(){var t=s.isNumeric(G.val())?G.val()+"px":G.val(),a=s.isNumeric(K.val())?K.val()+"px":K.val(),e=s.isNumeric(M.val())?M.val()+"px":M.val(),i=s.isNumeric(R.val())?R.val()+"px":R.val();"calc(50%"==t.substr(0,8)&&(t="calc(50% - "+C.outerHeight()/2+"px)",G.val(t)),"calc(50%"==e.substr(0,8)&&(e="calc(50% - "+C.outerWidth()/2+"px)",M.val(e)),C.css({top:t,bottom:a,left:e,right:i,opacity:Q.val()/100});var c="rotateX("+parseInt(U.val())+"deg) rotateY("+parseInt(Z.val())+"deg) rotateZ("+parseInt(q.val())+"deg)";C.css({transform:c,"-ms-transform":c,"-webkit-transform":c});var l="";l+=ct.is(":checked")?" scaleX(-1)":"",l+=lt.is(":checked")?" scaleY(-1)":"",C.find(".yith-wcbm-badge-text").css({transform:l,"-ms-transform":l,"-webkit-transform":l})},xt=function(){switch(c){case"image":C.removeAttr("style"),n.html(""),C.html('<img src="'+y.val()+'" />'),ft();break;case"css":nt.fadeIn(400),C.removeAttr("style"),C.removeClass("yith-wcbm-on-sale-badge-advanced"),C.addClass("yith-wcbm-css-badge"),C.html('<div class="yith-wcbm-css-s1"></div><div class="yith-wcbm-css-s2"></div><div class="yith-wcbm-css-text"><div class="yith-wcbm-badge-text">'+m.val()+"</div></div>"),ft(),window.clearTimeout(i),i=setTimeout(function(){s.ajax({type:"POST",data:{id_badge_style:d.val(),color:r.val().slice(1),text_color:h.val().slice(1),action:"yith_get_css_badge_style"},url:ajaxurl,success:function(t){n.html(s("<style></style>").html(t)),nt.fadeOut(200),C.height(C.height()).width(C.width()+1),ft()}})},500);break;case"advanced":nt.fadeIn(400),C.removeAttr("style"),C.removeClass("yith-wcbm-css-badge"),C.addClass("yith-wcbm-on-sale-badge-advanced"),C.html('<div class="yith-wcbm-shape1"></div><div class="yith-wcbm-shape2"></div><div class="yith-wcbm-badge-text-advanced"><div class="yith-wcbm-simbol-sale">On Sale</div><div class="yith-wcbm yith-wcbm-simbol-sale-exclamation">Sale!</div><div class="yith-wcbm-simbol-percent">%</div><div class="yith-wcbm-simbol-off">OFF</div><div class="yith-wcbm-sale-percent">50</div><div class="yith-wcbm-save">Save $15</div><div class="yith-wcbm-saved-money">15$</div><div class="yith-wcbm-saved-money-value">15</div><div class="yith-wcbm-saved-money-currency">$</div></div>'),ft(),1==b&&(C.hide(),b=0),window.clearTimeout(i),i=setTimeout(function(){s.ajax({type:"POST",data:{id_badge_style:v.val(),color:l.val().slice(1),text_color:o.val().slice(1),flip_text_horizontally:ct.is(":checked")?1:0,flip_text_vertically:lt.is(":checked")?1:0,action:"yith_get_advanced_badge_style"},url:ajaxurl,success:function(t){n.html(s("<style></style>").html(t)),C.fadeIn("fast"),nt.fadeOut(200),ft()}})},500);break;default:C.html('<div class="yith-wcbm-badge-text">'+T.val()+"</div>"),n.html(""),ft();var t="auto"!=W.val()?W.val()+"px":"auto",a="auto"!=z.val()?z.val()+"px":"auto";C.css({color:O.val(),"background-color":N.val(),width:t,height:a,"border-top-left-radius":H.val()+"px","border-top-right-radius":j.val()+"px","border-bottom-right-radius":B.val()+"px","border-bottom-left-radius":D.val()+"px","padding-top":L.val()+"px","padding-left":P.val()+"px","padding-bottom":$.val()+"px","padding-right":X.val()+"px","font-size":Y.val()+"px"});var e=J.val();-1!=e?C.css("line-height",e+"px"):"auto"==a?C.css("line-height",Y.val()+"px"):C.css("line-height",a)}},kt=function(){x.click(function(){var t=s(this).attr("badge_image_url");y.val(t),xt(),x.removeClass("yith-wcbm-select-image-btn-selected"),s(this).addClass("yith-wcbm-select-image-btn-selected")});var t=0;if(x.each(function(){s(this).attr("badge_image_url")==y.val()&&(s(this).addClass("yith-wcbm-select-image-btn-selected"),t=1)}),0==t&&0<y.val().length){var a='<div class="yith-wcbm-select-image-btn button-select-image" badge_image_url="'+y.val()+'" style="background-image:url('+y.val()+')"></div>';s("#custom-image-badges").append(a),x=s(".button-select-image"),kt()}0==t&&0==y.val().length&&x.first().trigger("click"),Ft()};switch(ot.hide(),xt(),s(document).on("change paste keyup input focus","#yith-wcbm-rotation-x, #yith-wcbm-rotation-y, #yith-wcbm-rotation-z",function(){ft()}),s("input.update-preview").on("change paste keyup input focus",function(){xt()}),A.on("change",function(){switch(A.val()){case"top-left":G.val(0),K.val("auto"),M.val(0),R.val("auto");break;case"top-right":G.val(0),K.val("auto"),M.val("auto"),R.val(0);break;case"bottom-left":G.val("auto"),K.val(0),M.val(0),R.val("auto");break;case"bottom-right":G.val("auto"),K.val(0),M.val("auto"),R.val(0)}xt()}),s(".yith-wcbm-color-picker").wpColorPicker({change:xt}),s(".iris-palette").on("click",function(){setTimeout(xt,1)}),E.tabs(),c){case"css":E.tabs("option","active",1);break;case"image":E.tabs("option","active",2);break;case"advanced":E.tabs("option","active",3)}Ft(),s("input.yith-wcbm-range-input").on("input",function(){s(this).closest("div").find(".yith-wcbm-range-output").html(s(this).val())}),s(window).scroll(function(){if(s(window).scrollTop()>g){var t=s(window).scrollTop()-g;a.stop().animate({top:t+"px"},0)}else a.stop().animate({top:"0"},0)}),C.draggable({containment:".half-right",stop:function(){var t=s(this).position(),a=parseInt(t.left),e=parseInt(t.top),i=C.outerWidth(),c=C.outerHeight();"top-left"==A.val()?(G.val(e),K.val("auto"),M.val(a),R.val("auto")):"top-right"==A.val()?(G.val(e),K.val("auto"),M.val("auto"),R.val(150-a-i)):"bottom-left"==A.val()?(G.val("auto"),K.val(150-e-c),M.val(a),R.val("auto")):"bottom-right"==A.val()&&(G.val("auto"),K.val(150-e-c),M.val("auto"),R.val(150-a-i))},grid:[1,1],drag:function(){var t=s(this).position(),a=parseInt(t.left),e=parseInt(t.top),i=C.outerWidth(),c=C.outerHeight();"top-left"==A.val()?(G.val(e),K.val("auto"),M.val(a),R.val("auto")):"top-right"==A.val()?(G.val(e),K.val("auto"),M.val("auto"),R.val(150-a-i)):"bottom-left"==A.val()?(G.val("auto"),K.val(150-e-c),M.val(a),R.val("auto")):"bottom-right"==A.val()&&(G.val("auto"),K.val(150-e-c),M.val("auto"),R.val(150-a-i))}}),p.on("click",function(){t.val("text"),c="text",Ft(),xt()}),w.on("click",function(){t.val("css"),c="css",Ft(),xt()}),F.on("click",function(){t.val("image"),c="image",Ft(),xt()}),f.on("click",function(){t.val("advanced"),c="advanced",Ft(),b=0,xt()}),kt(),k.click(function(){var t=s(this).attr("badge_advanced_index");v.val(t);var a=parseInt(v.val())-1;1==ut[0][a]?(e||(l.val(ut[1][a]),o.val(ut[2][a]),l.trigger("change"),o.trigger("change")),e=0,vt.fadeIn("fast")):vt.fadeOut("fast"),1==ut[3][a]?dt.fadeIn("fast"):dt.fadeOut("fast"),xt(),k.removeClass("yith-wcbm-select-image-btn-selected"),s(this).addClass("yith-wcbm-select-image-btn-selected")}),k.each(function(){s(this).attr("badge_advanced_index")==v.val()&&(s(this).addClass("yith-wcbm-select-image-btn-selected"),e=""==l.val()&&""==o.val()?0:1,s(this).trigger("click"))}),_.click(function(){var t=s(this).attr("badge_css_index");d.val(t);var a=parseInt(d.val())-1;u||(m.val(wt[0][a]),r.val(wt[1][a]),h.val(wt[2][a]),r.trigger("change"),h.trigger("change")),u=0,xt(),_.removeClass("yith-wcbm-select-image-btn-selected"),s(this).addClass("yith-wcbm-select-image-btn-selected")}),_.each(function(){s(this).attr("badge_css_index")==d.val()&&(s(this).addClass("yith-wcbm-select-image-btn-selected"),u=""==r.val()&&""==h.val()&&""==m.val()?0:1,s(this).trigger("click"))}),s("#upload-btn").on("click",function(t){t.preventDefault();var i=wp.media({title:"Upload Image",multiple:!1}).open().on("select",function(t){var a=i.state().get("selection").first().toJSON().url,e='<div class="yith-wcbm-select-image-btn button-select-image" badge_image_url="'+a+'" style="background-image:url('+a+')"></div>';st.append(e),x=s(".button-select-image"),kt()})}),s("#view-post-btn").hide(),V.on("click",function(){G.val("0"),K.val("auto"),M.val("calc(50% - "+C.outerWidth()/2+"px)"),R.val("auto"),xt()}),tt.on("click",function(){G.val("auto"),K.val("0"),M.val("calc(50% - "+C.outerWidth()/2+"px)"),R.val("auto"),xt()}),at.on("click",function(){G.val("calc(50% - "+C.outerHeight()/2+"px)"),K.val("auto"),M.val("0"),R.val("auto"),xt()}),et.on("click",function(){G.val("calc(50% - "+C.outerHeight()/2+"px)"),K.val("auto"),M.val("auto"),R.val("0"),xt()}),it.on("click",function(){G.val("calc(50% - "+C.outerHeight()/2+"px)"),K.val("auto"),M.val("calc(50% - "+C.outerWidth()/2+"px)"),R.val("auto"),xt()}),dt.find("input[type=radio]").on("change",function(){"amount"===dt.find("input[type=radio]:checked").val()?(C.removeClass("yith-wcbm-advanced-display-percentage"),C.addClass("yith-wcbm-advanced-display-amount")):(C.removeClass("yith-wcbm-advanced-display-amount"),C.addClass("yith-wcbm-advanced-display-percentage"))}).trigger("change");var _t=s("#yith-wcbm-3d-rotation-table"),Ct=_t.find(".yith-wcbm-range-input"),At=_t.find(".yith-wcbm-range-output");s("#yith-wcbm-rotation-mode-change").on("click",function(t){"slider"==s(this).data("value")?(Ct.attr("type","number"),At.hide(),s(this).data("value","number"),s(this).html(yith_wcbm_language.slider)):(Ct.attr("type","range"),At.show(),s(this).data("value","slider"),s(this).html(yith_wcbm_language.number))})});