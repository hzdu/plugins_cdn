(function($){var prefix='automatorwp-';var _prefix='automatorwp_activecampaign_';$('body').on('click','.automatorwp_settings #'+_prefix+'authorize',function(e){e.preventDefault();var button=$(this);var wrapper=button.parent();var url=$('#'+_prefix+'url').val();var key=$('#'+_prefix+'key').val();var response_wrap=wrapper.find('#'+_prefix+'response');if(!response_wrap.length){wrapper.append('<div id="'+_prefix+'response" style="display: none; margin-top: 10px;"></div>');response_wrap=wrapper.find('#'+_prefix+'response')}
if(url.length===0||key.length===0){response_wrap.addClass('automatorwp-notice-error');response_wrap.html('All fields are required to connect with ActiveCampaign');response_wrap.slideDown('fast');return}
response_wrap.slideUp('fast');response_wrap.attr('class','');wrapper.append('<span class="spinner is-active" style="float: none;"></span>');button.prop('disabled',!0);$.post(ajaxurl,{action:'automatorwp_activecampaign_authorize',nonce:automatorwp_activecampaign.nonce,url:url,key:key,},function(response){response_wrap.addClass('automatorwp-notice-'+(response.success===!0?'success':'error'));response_wrap.html((response.data.message!==undefined?response.data.message:response.data));response_wrap.slideDown('fast');wrapper.find('.spinner').remove();if(response.success===!0&&response.data.redirect_url!==undefined){window.location=response.data.redirect_url;return}
button.prop('disabled',!1)})});$('body').on('click','.automatorwp_settings #'+_prefix+'refresh',function(e){e.preventDefault();var button=$(this);var wrapper=button.parent();var webhook=$('#'+_prefix+'webhook').val();var response_wrap=wrapper.find('#'+_prefix+'response');if(!response_wrap.length){wrapper.append('<div id="'+_prefix+'response" style="display: none; margin-top: 10px;"></div>');response_wrap=wrapper.find('#'+_prefix+'response')}
response_wrap.slideUp('fast');response_wrap.attr('class','');$('<span class="spinner is-active" style="float: none;"></span>').insertAfter(button);button.prop('disabled',!0);$.post(ajaxurl,{action:'automatorwp_activecampaign_refresh',nonce:automatorwp_activecampaign.nonce,webhook:webhook,},function(response){response_wrap.addClass('automatorwp-notice-'+(response.success===!0?'success':'error'));response_wrap.html((response.data.message!==undefined?response.data.message:response.data));response_wrap.slideDown('fast');wrapper.find('.spinner').remove();if(response.success===!0&&response.data.redirect_url!==undefined){window.location=response.data.redirect_url;return}
button.prop('disabled',!1)})});$('body').on('click','.automatorwp-view-webhook',function(e){e.preventDefault();$(this).parent().next().slideDown('fast')})})(jQuery)