"use strict";jQuery(window).on("elementor/frontend/init",(()=>{elementorFrontend.hooks.addAction("frontend/element_ready/woocommerce-photo-reviews-form.default",(function(e){if(!window.elementor)return;e.find(".woocommerce-photo-reviews-form-container").find(".wcpr-rating").hide().before('<p class="stars">                    <span>                        <a class="star-1" href="#">1</a>                        <a class="star-2" href="#">2</a>                        <a class="star-3" href="#">3</a>                        <a class="star-4" href="#">4</a>                        <a class="star-5" href="#">5</a>                    </span>                </p>')}))})),jQuery(document).ready((function(e){e("body").on("init",".wcpr-rating",(function(){e(".wcpr-rating").hide().before('<p class="stars">                        <span>                            <a class="star-1" href="#">1</a>                            <a class="star-2" href="#">2</a>                            <a class="star-3" href="#">3</a>                            <a class="star-4" href="#">4</a>                            <a class="star-5" href="#">5</a>                        </span>                    </p>')})).on("click","#respond p.stars a",(function(){var r=e(this),o=e(this).closest("#respond").find("#wcpr-rating"),t=e(this).closest(".stars");return o.val(r.text()),r.siblings("a").removeClass("active"),r.addClass("active"),t.addClass("selected"),!1})).on("click","#respond #submit",(function(){var r=e(this).closest("#respond").find("#wcpr-rating"),o=r.val();if(r.length>0&&!o&&"yes"===woocommerce_photo_reviews_form_params.review_rating_required)return window.alert(woocommerce_photo_reviews_form_params.i18n_required_rating_text),!1})),e("#wcpr-rating").trigger("init");let r=woocommerce_photo_reviews_form_params.max_files;e(".wcpr-comment-form").on("change",".wcpr_image_upload",(function(o){if(e(this).parent().find(".wcpr-selected-image-container").html(""),this.files.length>r)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.warning_max_files),e(this).val(""),!1;this.files.length>0&&(jQuery(".wcpr-comment-form-error-wraps").addClass("wcpr-hidden"),function(r){let o=1024*parseFloat(woocommerce_photo_reviews_params.max_file_size);for(let i=0;i<r.files.length;i++){var t=new FileReader;t.onload=function(t){let m="";r.files[i].size>o?m=woocommerce_photo_reviews_params.warning_max_file_size.replace("%file_name%",r.files[i].name):-1===woocommerce_photo_reviews_params.upload_allow.indexOf(r.files[i].type)&&(m=woocommerce_photo_reviews_params.warning_upload_allow.replace("%file_name%",r.files[i].name)),e(r).parent().find(".wcpr-selected-image-container").append(a(t.target.result,r.files[i].name,m))},t.readAsDataURL(r.files[i])}}(this))})).find(".star-5").trigger("click");let o=1==woocommerce_photo_reviews_form_params.image_caption_enable,t=woocommerce_photo_reviews_form_params.i18n_image_caption;function a(e,r,a=""){let i,m=`<img title="${r}" src="${e}" class="wcpr-selected-image-preview">`;return e.indexOf("data:video/")>-1&&(m=`<video class="wcpr-selected-image-preview" height="100%" width="100%" src="${e}" controls >${r}</video>`),i=a?`<div class="wcpr-selected-image">${m}<div class="wcpr-selected-image-info"><div class="wcpr-selected-image-name wcpr-comment-form-error" >${a}</div></div></div>`:o?`<div class="wcpr-selected-image">${m}<div class="wcpr-selected-image-info"><div class="wcpr-selected-image-name" title="${r}">${r}</div><input class="wcpr-selected-image-caption" type="text" name="wcpr_image_caption[]" placeholder="${t}"></div></div>`:`<div class="wcpr-selected-image">${m}<div class="wcpr-selected-image-info"><div class="wcpr-selected-image-name" title="${r}">${r}</div></div></div>`,i}e(".woocommerce-photo-reviews-form-container").find('input[type="submit"]').on("click",(function(r){let o=e(this);if(o.hasClass("viwcpr_form_checked"))return!0;let t=o.closest(".woocommerce-photo-reviews-form-container"),a=t.find('textarea[id="comment"]')||t.find('textarea[name="comment"]'),i=t.find('input[name="author"]'),m=t.find('input[name="email"]');jQuery(".wcpr-comment-form-error-wraps").addClass("wcpr-hidden"),jQuery(".wcpr-comment-form-notify-wraps").addClass("wcpr-hidden");let s=t.find("#rating"),c=s.val();if(s.length>0&&!c&&"yes"===woocommerce_photo_reviews_params.review_rating_required)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_params.i18n_required_rating_text),r.preventDefault(),!1;if(a.length>0){let e=a.val();if(!e&&1!=woocommerce_photo_reviews_params.allow_empty_comment)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_params.i18n_required_comment_text),r.preventDefault(),a.focus(),!1;let o=parseInt(woocommerce_photo_reviews_params.minimum_comment_length);if(o&&o>e.length)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_params.i18n_minimum_comment_text),r.preventDefault(),a.focus(),!1}if("on"===woocommerce_photo_reviews_form_params.enable_photo){let e=t.find(".wcpr_image_upload");if(e.length>0){let o=e.get(0).files,t=parseInt(o.length);if("on"===woocommerce_photo_reviews_form_params.required_image&&0===t)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.warning_required_image),!1;if(t>woocommerce_photo_reviews_form_params.max_files)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.warning_max_files),r.preventDefault(),!1;let a=[],i=1024*parseFloat(woocommerce_photo_reviews_params.max_file_size);if(jQuery.each(o,(function(e,r){if(r.size>i)return a.push("<p>"+woocommerce_photo_reviews_params.warning_max_file_size.replace("%file_name%",r.name)+"</p>"),!0;-1===woocommerce_photo_reviews_params.upload_allow.indexOf(r.type)&&a.push("<p>"+woocommerce_photo_reviews_params.warning_upload_allow.replace("%file_name%",r.name)+"</p>")})),a.length)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(a.join("")),r.preventDefault(),!1}else if("on"===woocommerce_photo_reviews_form_params.required_image)return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.warning_required_image),!1}if(i.length>0&&i.attr("required")&&!i.val())return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.i18n_required_name_text),r.preventDefault(),i.focus(),!1;if(m.length>0&&m.attr("required")&&!m.val())return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.i18n_required_email_text),r.preventDefault(),m.focus(),!1;if(!1===t.find('input[name="wcpr_gdpr_checkbox"]').prop("checked"))return jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(woocommerce_photo_reviews_form_params.warning_gdpr),r.preventDefault(),!1;if(jQuery(".wcpr-comment-form-notify-wraps").removeClass("wcpr-hidden"),woocommerce_photo_reviews_form_params.restrict_number_of_reviews){o.attr("type","button"),async function(){let r="";return await new Promise((function(o){let t=jQuery(".woocommerce-photo-reviews-form-container form").serialize();e.ajax({type:"post",url:woocommerce_photo_reviews_form_params.wc_ajax_url.toString().replace("%%endpoint%%","viwcpr_restrict_number_of_reviews"),data:t,success:function(e){e.error&&(r=e.error),o(r)},error:function(e){r="-1"===e.responseText?e.statusText:e.responseText,o(r)}})})),r}().then((function(e){if(o.attr("type","submit"),e)return jQuery(".wcpr-comment-form-notify-wraps").addClass("wcpr-hidden"),jQuery(".wcpr-comment-form-error-wraps").removeClass("wcpr-hidden").html(e),r.preventDefault(),!1;o.addClass("viwcpr_form_checked").trigger("click")}))}})),e(document).on("click",".woocommerce-photo-reviews-form-main,.woocommerce-photo-reviews-form-main-close",(function(){e(this).closest(".woocommerce-photo-reviews-form-container").addClass("woocommerce-photo-reviews-form-popup-hide"),wcpr_enable_scroll()})),e(document).on("click",".woocommerce-photo-reviews-form-button-add-review",(function(){e(this).closest(".woocommerce-photo-reviews-form-container").removeClass("woocommerce-photo-reviews-form-popup-hide"),wcpr_disable_scroll()})),e(document).on("click",".woocommerce-photo-reviews-form-main-inner",(function(e){e.stopPropagation()}))}));