jQuery(document).ready(function(s){"use strict";var c=s(".urcma-endpoints-options-wrapper");function d(t){var e=tinyMCEPreInit.mceInit,n=Object.keys(e)[0],a=e[n],i=tinyMCEPreInit.qtInit,i=e[Object.keys(i)[0]];a.selector=t,a.body_class=a.body_class.replace(n,t),i.id=t,tinyMCE.init(a),tinyMCE.execCommand("mceRemoveEditor",!0,t),tinyMCE.execCommand("mceAddEditor",!0,t),quicktags(i),QTags._buttonsInit()}"undefined"!=typeof s.fn.sortable&&s(".urcma-endpoint-tabs").sortable({containment:".urcma-endpoint-tabs",tolerance:"pointer",revert:"invalid",forceHelperSize:!0}),s("form#mainform").on("submit",function(t){var n,e;"undefined"!=typeof s.fn.sortable&&(n=[],s(".urcma-endpoint-selector").each(function(t){var e={type:s(this).data("type"),id:s(this).attr("id")};n.push(e)}),e=JSON.stringify(n),s("input.endpoints-order").val(e))}),c.on("change",function(t,e){void 0!==e&&d(e.find("textarea").attr("id"))}),s(document).on("click",".add_new_field",function(t){t.stopPropagation();var n='<i class="dashicons dashicons-plus-alt"></i>',t=urcma_params.add_new_tab_title.replace("%str%"," ");Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:n+'<span class="user-registration-swal2-modal__title">'+t+"</span>",text:urcma_params.select_field_type_description,input:"select",inputOptions:{endpoint:"Endpoint",link:"Link"},inputPlaceholder:urcma_params.select_field_type_placeholder,showCloseButton:!1,showCancelButton:!0,cancelButtonColor:"#DD6B55",allowOutsideClick:!1,inputValidator:t=>{if(!t)return urcma_params.select_field_validation_message}}).then(function(t){var e;t.value&&(e=t.value,t=urcma_params.add_new_tab_title.replace("%str%",e),Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",title:n+'<span class="user-registration-swal2-modal__title">'+t+"</span>",text:urcma_params.field_title_description.replace("%str%",e),input:"text",inputAttributes:{autocapitalize:"off"},inputValidator:t=>{if(!t)return urcma_params.field_title_validation_message.replace("%str%",e)},showCloseButton:!1,showCancelButton:!0,cancelButtonColor:"#DD6B55",allowOutsideClick:!1}).then(function(t){t.value&&(t=t.value,s(this).add_new_field_handler(e,t))}))})}),s.fn.add_new_field_handler=function(i,r){var o=s(this);s.ajax({url:urcma_params.ajaxurl,data:{target:i,field_name:r,action:urcma_params.action_add},dataType:"json",beforeSend:function(){},success:function(t){var e,n,a;o.find(".loader").hide(),t.error||c.find('[data-id="'+t.field+'"]').length?Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:"Oops...",text:t.error}):(Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"success",html:r.toUpperCase()+" "+urcma_params.add_endpoint_success_message.replace("%str%",i)}).then(function(t){s(".button-primary").trigger("click")}),e=s(t.html),n=s(".urcma-endpoints-options-wrapper"),s(".urcma-endpoint-tabs > .urcma-endpoint-selector").removeClass("active"),n.find(".urcma-endpoint-content").attr("style","display:none;"),a='<div class="ur-sidebar-nav-tab urcma-endpoint-selector ui-sortable-handle active" id="'+t.field+'" data-id="'+t.endpoint_label+'" data-type="'+t.type+'">\n'+t.endpoint_label+"</div>",s(".urcma-endpoint-tabs > .urcma-endpoint-selector").last().after(a),s(".urcma-endpoints-options-wrapper .urcma-endpoint-content").last().after(e),t=t.field,n.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),n.find("#"+t).find(".urcma-endpoint-header").removeAttr("style"),n.find("#"+t).find(".urcma-endpoint-options").removeAttr("style"),l(e.find("select")),d(e.find("textarea").attr("id")))}})},s(document).on("click",".remove-trigger",function(){var n=s(this).data("endpoint"),a=s("input.endpoint-to-remove");if(void 0===n||!a.length)return!1;Swal.fire({icon:"warning",customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",text:urcma_params.remove_alert,showCloseButton:!0,confirmButtonText:"OK"}).then(function(t){if(1!=t.value)return!1;var e=a.val(),t=e.length?e.split(","):[];t.push(n),a.val(t.join(",")),s("#"+n).remove(),s(".urcma-endpoints-wrapper").find("#"+n).remove();e=s(".urcma-endpoints-options-wrapper"),t=s(".urcma-endpoint-selector:first");t.addClass("active");t=t.attr("id");e.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),e.find("#"+t).removeAttr("style"),e.find("#"+t).find(".urcma-endpoint-header").removeAttr("style"),e.find("#"+t).find(".urcma-endpoint-options").removeAttr("style")})}),s(document).ready(function(){var e=s(".urcma-endpoints-options-wrapper"),t=s(".urcma-endpoints-list nav"),n=s(".urcma-endpoint-selector:first");n.addClass("active");n=n.attr("id");e.find(".urcma-endpoint-content .urcma-endpoint-header").attr("style","display:none;"),e.find("#"+n).find(".urcma-endpoint-header").removeAttr("style"),e.find("#"+n).find(".urcma-endpoint-options").removeAttr("style"),t.find(".urcma-endpoint-selector").on("click",function(){var t=s(this).attr("id");s(this).siblings().removeClass("active"),s(this).addClass("active"),e.find(".urcma-endpoint-content").attr("style","display:none;"),e.find("#"+t).removeAttr("style"),e.find(".urcma-endpoint-content .urcma-endpoint-header").removeAttr("style"),e.find("#"+t).find(".urcma-endpoint-options").removeAttr("style")})});function t(t){"internal"===t.val()?(s(t).closest(".urcma-endpoint-options").find("#urcma_link_endpoint_select_page").closest("tr").show(),s(t).closest(".urcma-endpoint-options").find(".urcma_url_input").closest("tr").hide()):(s(t).closest(".urcma-endpoint-options").find("#urcma_link_endpoint_select_page").closest("tr").hide(),s(t).closest(".urcma-endpoint-options").find(".urcma_url_input").closest("tr").show())}function a(t){return s('<span><i class="fa fa-'+t.text+'"></i>   '+t.text+"</span>")}function l(t,n){"undefined"!=typeof s.fn.select2&&s.each(t,function(){var t,e=s(this).hasClass("icon-select")?(t=s(this).data("value"),{templateResult:a,width:"100%"}):n?{width:"100%"}:{minimumResultsForSearch:10};s(this).select2(e),void 0!==t&&t&&s(this).val(t).change()})}s(document).on("change",".hide-show-check",function(){var t,e,n;t="checkbox",e=s(this),n=e.closest(".urcma-endpoint-content").find(".hide-show-check"),e="checkbox"==t?e:n.first(),!0==(t=!!(e.is(":checked")&&"checkbox"==t||!e.is(":checked")&&"link"==t))?(n.prop("checked",t),n.closest(".urcma-endpoint-header-option").find(".user-registration-switch__control").addClass("enabled"),n.closest(".urcma-endpoint-header-option").find("label").html(urcma_params.enable_endpoint)):(n.removeAttr("checked",t),n.closest(".urcma-endpoint-header-option").find(".user-registration-switch__control").removeClass("enabled"),n.closest(".urcma-endpoint-header-option").find("label").html(urcma_params.disable_endpoint))}),s(document).on("change keyup",".urcma_slug_input",function(){var n=s(this);s(".urcma-endpoint-options").find(".urcma_slug_input").each(function(t,e){e=s(e);e.is(n)||s.trim(e.val())===s.trim(n.val())&&(Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:"Oops...",text:urcma_params.same_slug_error_message}),s(".swal2-confirm").on("click",function(){s(".submit").find(".button-primary").attr("disabled","disabled")}))}),s(".submit").find(".button-primary").removeAttr("disabled")}),s(document).on("change keyup",".urcma_label_input",function(){var n=s(this);s(".urcma-endpoint-options").find(".urcma_label_input").each(function(t,e){e=s(e);e.is(n)||s.trim(e.val())===s.trim(n.val())&&(Swal.fire({customClass:"user-registration-swal2-modal user-registration-swal2-modal--center",icon:"error",title:"Oops...",text:urcma_params.same_label_error_message}),s(".swal2-confirm").on("click",function(){s(".submit").find(".button-primary").attr("disabled","disabled")}))}),s(".submit").find(".button-primary").removeAttr("disabled")}),s(document).find(".urcma_link_endpoint_type").each(function(){t(s(this))}),s(document).on("change",".urcma_link_endpoint_type",function(){t(s(this))}),l(c.find("select").not(".urcma_link_endpoint_type"),!0)});