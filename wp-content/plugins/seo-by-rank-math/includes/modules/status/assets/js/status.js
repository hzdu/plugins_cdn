!function(){"use strict";var t,e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},a=jQuery,n=e.n(a),o=lodash,r=rankMathAnalyzer,s=wp.i18n;function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}(t=n())((function(){var e=t(".rank-math-tab-nav");function a(a,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;n=n||"error";var r=t('<div class="notice is-dismissible rank-math-tool-notice"><p></p></div>');r.hide().addClass("notice-"+n).find("p").text(a),e.prev(".notice").remove(),e.before(r),r.slideDown(),t("html,body").animate({scrollTop:r.offset().top-50},"slow"),t(document).trigger("wp-updates-notice-added"),o&&setTimeout((function(){r.fadeOut()}),o)}var n=0,c=rankMath.batchSize,d=100/rankMath.totalPosts,u=[],l=0;function f(e,a){var i={};return a.addClass("disabled"),new Promise((function(t){(0,o.forEach)(e,(function(t,e){if(-1===u.indexOf(e)){u.push(e);var a=new r.ResultManager,n=wp.i18n,s=new r.Paper;s.setTitle(t.title),s.setDescription(t.description),s.setText(t.content),s.setKeyword(t.keyword),s.setKeywords(t.keywords),s.setPermalink(t.url),s.setUrl(t.url),t.thumbnail&&s.setThumbnail(t.thumbnail),s.setContentAI(t.hasContentAi);var c=function(t){var e=rankMath.assessor.researchesTests;return e=(0,o.difference)(e,["keywordNotUsed"]),t.isProduct?e=(0,o.difference)(e,["keywordInSubheadings","linksHasExternals","linksNotAllExternals","linksHasInternal","titleSentiment","titleHasNumber","contentHasTOC"]):e}(t);new r.Analyzer({i18n:n,analysis:c}).analyzeSome(c,s).then((function(n){a.update(s.getKeyword(),n,!0);var o=a.getScore(t.keyword);t.isProduct&&(o=t.isReviewEnabled?o+1:o,o=t.hasProductSchema?o+1:o),i[e]=o}))}})),t()})).then((function(){t.ajax({url:rankMath.api.root+"rankmath/v1/updateSeoScore",method:"POST",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",rankMath.restNonce)},data:{action:"rank_math_update_seo_score",postScores:i},success:function(e){1==e&&(l+=c,n+=d*c,t(".progress-bar span").css("width",n+"%"),t(".count span").text(l),l>=rankMath.totalPosts?(t(".progress-bar span").css("width","100%"),t(".count span").text(rankMath.totalPosts),t(".rank-math-modal-footer").removeClass("hidden")):(a.data("args",{offset:l}),h(a)))},error:function(e){t(".rank-math-modal-footer").removeClass("hidden").find("p").text((0,s.__)("Something went wrong. Please refresh the page and try again.","rank-math"))}})}))}function h(e){var n=e.data("action"),o=e.data("args");t.ajax({url:rankMath.api.root+"rankmath/v1/toolsAction",method:"POST",beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",rankMath.restNonce)},data:{action:n,args:o}}).always((function(){e.removeAttr("disabled")})).fail((function(t){t&&(t.responseJSON&&t.responseJSON.message?a(t.responseJSON.message):a(t.statusText))})).done((function(t){if(t){if("update_seo_score"===n)return void f(t,e);if("string"==typeof t)return void a(t,"success",!1);if("object"===i(t)&&t.status&&t.message)return void a(t.message,t.status,!1)}a((0,s.__)("Something went wrong. Please try again later.","rank-math"))}))}t(".tools-action").on("click",(function(e){e.preventDefault();var a=t(this);return a.data("confirm")&&!confirm(a.data("confirm"))||(a.attr("disabled","disabled"),"update_seo_score"===a.data("action")&&t(".rank-math-modal-update-score").addClass("show"),h(a)),!1})),t(".rank-math-modal .rank-math-modal-close").on("click",(function(){if(void 0!==rankMath.startUpdateScore&&rankMath.startUpdateScore)return window.close(),!0;t(this).closest(".rank-math-modal").css("display","none")})),void 0!==rankMath.startUpdateScore&&rankMath.startUpdateScore&&t('.tools-action[data-action="update_seo_score"]').trigger("click")}))}();