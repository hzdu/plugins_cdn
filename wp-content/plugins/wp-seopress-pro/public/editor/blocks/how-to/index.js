!function(){"use strict";var e=window.wp.i18n,t=window.wp.blocks,s=window.wp.element,o=window.wp.data;const r=e=>{let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},n=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"display",n="",i="",a="",l="";if(t=parseInt(t)?parseInt(t):0,s=parseInt(s)?parseInt(s):0,o=parseInt(o)?parseInt(o):0,"schema"===r)i=t?`${t}D`:"",a=s?`${s}H`:"",l=o?`${o}M`:"",n=`${t>0||s>0||o>0?"P":""}${i}${s>0||o>0?"T":""}${a}${l}`;else{i=t>0?(0,e.sprintf)((0,e._n)("%1$s day","%1$s days",t,"wp-seopress-pro"),t):"",a=s>0?(0,e.sprintf)((0,e._n)("%1$s hour","%1$s hours",s,"wp-seopress-pro"),s):"",l=o>0?(0,e.sprintf)((0,e._n)("%1$s minute","%1$s minutes",o,"wp-seopress-pro"),o):"";const r=[i,a,l].filter((e=>""!==e));n=r.length?r.join(", "):""}return n};var i=window.wp.url,a=window.wp.blockEditor;(0,t.registerBlockType)("wpseopress/how-to-step",{title:(0,e.__)("How To Step","wp-seopress-pro"),description:(0,e.__)("Display a tutorial step.","wp-seopress-pro"),edit:function(t){let{attributes:n,setAttributes:l}=t,{title:c,description:p,schema:d}=n;const u=(e,t)=>{const s={...d,"@type":"HowToStep"};switch(e){case"title":s.name=t,s.url=(0,o.select)("core/editor").getPermalink()+"#"+(0,i.cleanForSlug)(t);break;case"description":s.text=r(t);const e=t.match(/src="(.*?)"/);e&&e[1]&&(s.image=e[1])}l({schema:s,[e]:t})};return(0,s.createElement)("li",(0,a.useBlockProps)(),(0,s.createElement)(a.RichText,{tagName:"strong",value:c,className:"wpseopress-how-to-step-title",onChange:e=>u("title",e),placeholder:(0,e.__)("Type a title","wp-seopress-pro")}),(0,s.createElement)(a.RichText,{tagName:"div",value:p,multiline:!0,className:"wpseopress-how-to-step-description",onChange:e=>u("description",e),placeholder:(0,e.__)("Type a description","wp-seopress-pro")}))},save:function(e){let{attributes:t}=e;const{title:o,description:r}=t;return(0,s.createElement)("li",a.useBlockProps.save(),o&&(0,s.createElement)(a.RichText.Content,{tagName:"strong",id:(0,i.cleanForSlug)(o),value:o,className:"wpseopress-how-to-step-title"}),(0,s.createElement)(a.RichText.Content,{tagName:"div",value:r,className:"wpseopress-how-to-step-description"}))}});var l=window.wp.components,c=t=>{let{attributes:o,updateField:r}=t;const{durationDays:n,durationHours:i,durationMinutes:c,estimatedCost:p,unorderedList:d}=o;return(0,s.createElement)(a.InspectorControls,null,(0,s.createElement)(l.PanelBody,{title:(0,e.__)("Block settings","wp-seopress-pro")},(0,s.createElement)(l.PanelRow,null,(0,s.createElement)(l.CheckboxControl,{label:(0,e.__)("Display as unordered list.","wp-seopress-pro"),checked:d,onChange:e=>r("unorderedList",e)})),(0,s.createElement)(l.PanelRow,null,(0,s.createElement)(l.TextControl,{label:(0,e.__)("Estimated cost","wp-seopress-pro"),value:p,onChange:e=>r("estimatedCost",e)})),(0,s.createElement)(l.PanelRow,{className:"totalTime-controls"},(0,s.createElement)(l.TextControl,{type:"number",min:"0",label:(0,e.__)("Days","wp-seopress-pro"),value:n,onChange:e=>r("durationDays",e)}),(0,s.createElement)(l.TextControl,{type:"number",min:"0",label:(0,e.__)("Hours","wp-seopress-pro"),value:i,onChange:e=>r("durationHours",e)}),(0,s.createElement)(l.TextControl,{type:"number",min:"0",label:(0,e.__)("Minutes","wp-seopress-pro"),value:c,onChange:e=>r("durationMinutes",e)}))))},p=t=>(0,s.createElement)(a.Inserter,{rootClientId:t.clientId,renderToggle:t=>{let{onToggle:o,disabled:r}=t;return(0,s.createElement)(l.Button,{className:"add-step-button",onClick:o,disabled:r,text:(0,e.__)("Add step","wp-seopress-pro"),icon:"insert"})},isAppender:!0}),d=t=>{let{estimatedCost:o}=t;return o?(0,s.createElement)("p",{className:"wpseopress-how-to-estimated-cost"},(0,e.sprintf)((0,e.__)("Estimated cost: %1$s","wp-seopress-pro"),o)):""},u=t=>{let{durationDays:o,durationHours:r,durationMinutes:i}=t;const a=n(o,r,i,"display");return a?(0,s.createElement)("p",{className:"wpseopress-how-to-total-time"},(0,e.sprintf)("Total time: %1$s",a)):""};(0,t.registerBlockType)("wpseopress/how-to",{title:(0,e.__)("How to","wp-seopress-pro"),description:(0,e.__)("Display a tutorial block.","wp-seopress-pro"),keywords:[(0,e.__)("How to","wp-seopress-pro"),(0,e.__)("Tutorial","wp-seopress-pro")],edit:function(t){let{attributes:i,setAttributes:l,clientId:m}=t;const{description:w,schema:h,durationDays:g,durationHours:E,durationMinutes:_,unorderedList:b,estimatedCost:T}=i,y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s={...h,"@context":"https://schema.org","@type":"HowTo",name:(0,o.select)("core/editor").getEditedPostAttribute("title")},i=(0,o.select)("core/editor").getEditedPostAttribute("featured_media");if(i){const e=(0,o.select)("core").getMedia(i),t=e&&e.source_url?e.source_url:"";delete s.image,t&&(s.image=t)}switch(e){case"description":s.description=r(t),""===s.description&&delete s.description;break;case"durationDays":s.totalTime=n(t,E,_,"schema"),s.totalTime||delete s.totalTime;break;case"durationHours":s.totalTime=n(g,t,_,"schema"),s.totalTime||delete s.totalTime;break;case"durationMinutes":s.totalTime=n(g,E,t,"schema"),s.totalTime||delete s.totalTime;break;case"estimatedCost":s.estimatedCost=t,s.estimatedCost||delete s.estimatedCost}l({schema:s,[e]:t})},C=()=>{const e=(0,o.select)("core/block-editor").getBlock(m).innerBlocks||[];let t=[];return e.length&&(t=e.reduce(((e,t)=>(void 0!==t.attributes.schema&&e.push(t.attributes.schema),e)),[])),t},v=(0,o.subscribe)((e=>{const t=(0,o.select)("core/editor").isSavingPost();if((0,o.select)("core/editor").isAutosavingPost()||t)return;const s=(0,o.select)("core/block-editor").isBlockSelected(m),r=(0,o.select)("core/block-editor").hasSelectedInnerBlock(m);(s||r)&&(v(),(()=>{v();const e={...h,"@context":"https://schema.org","@type":"HowTo",name:(0,o.select)("core/editor").getEditedPostAttribute("title"),step:C()};JSON.stringify(h.step)!==JSON.stringify(e.step)&&(v(),l({schema:e}))})())})),k=b?"ul":"ol";return(0,s.createElement)("div",(0,a.useBlockProps)(),(0,s.createElement)(c,{attributes:i,updateField:y}),(0,s.createElement)(a.RichText,{tagName:"div",value:w,multiline:!0,className:"wpseopress-how-to-description",onChange:e=>y("description",e),placeholder:(0,e.__)("Type in a tutorial description or introduction","wp-seopress-pro")}),(0,s.createElement)(d,{estimatedCost:T}),(0,s.createElement)(u,{durationDays:g,durationHours:E,durationMinutes:_}),(0,s.createElement)(k,{className:"wpseopress-how-to-steps"},(0,s.createElement)(a.InnerBlocks,{allowedBlocks:["wpseopress/how-to-step"],renderAppender:()=>(0,s.createElement)(p,{clientId:m})})))},save:function(e){let{attributes:t}=e;const{description:o,schema:r,unorderedList:n,durationDays:i,durationHours:l,durationMinutes:c,estimatedCost:p}=t,m=n?"ul":"ol";return(0,s.createElement)("div",a.useBlockProps.save(),o&&(0,s.createElement)(a.RichText.Content,{tagName:"div",value:o,className:"wpseopress-how-to-description"}),(0,s.createElement)(d,{estimatedCost:p}),(0,s.createElement)(u,{durationDays:i,durationHours:l,durationMinutes:c}),(0,s.createElement)(m,{className:"wpseopress-how-to-steps"},(0,s.createElement)(a.InnerBlocks.Content,null)),(0,s.createElement)("script",{type:"application/ld+json"},JSON.stringify(r)))}})}();