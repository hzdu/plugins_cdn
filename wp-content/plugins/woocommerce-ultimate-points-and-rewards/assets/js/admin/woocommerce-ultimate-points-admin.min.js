/*! woocommerce-ultimate-points-and-rewards 04-05-2018 */
!function(a){a(document).ready(function(){a('#notify_user_wp_color').wpColorPicker();a(".mwb_wpr_common_table").css("display","none"),jQuery(".mwb_table").addClass("mwb_table_full_width"),a(".mwb_points_update").click(function(){var b=a(this).data("id"),c=a(document).find("#user_points_"+b).val();if(c=Number(c),c>0&&c===parseInt(c,10)){jQuery("#mwb_wpr_loader").show();var d={action:"mwb_wpr_points_update",points:c,user_id:b,mwb_nonce:mwb_wpr.mwb_wpr_nonce};a.ajax({url:mwb_wpr.ajaxurl,type:"POST",data:d,success:function(a){jQuery("#mwb_wpr_loader").hide()}})}else alert(mwb_wpr.validpoint)}),jQuery("#mwb_wpr_general_product_list").length>0&&jQuery(document).find("#mwb_wpr_general_product_list").select2(),window.onload=function(){for(var b=a(".mwb_wpr_repeat:last").data("id"),c=0;b>=c;c++)jQuery(document).find("#mwb_wpr_membership_category_list_"+c).select2(),jQuery(document).find("#mwb_wpr_membership_product_list_"+c).select2()},a(document).on("change",".mwb_wpr_common_class_categ",function(){var b=a(this).data("id"),c=a("#mwb_wpr_membership_category_list_"+b).val();jQuery("#mwb_wpr_loader").show();var d={action:"mwb_wpr_select_category",mwb_wpr_categ_list:c,mwb_nonce:mwb_wpr.mwb_wpr_nonce};a.ajax({url:mwb_wpr.ajaxurl,type:"POST",data:d,dataType:"json",success:function(a){if("success"==a.result){var c=a.data,d="";for(var e in c)d+='<option value="'+e+'">'+c[e]+"</option>";jQuery("#mwb_wpr_membership_product_list_"+b).html(d),jQuery("#mwb_wpr_membership_product_list_"+b).select2(),jQuery("#mwb_wpr_loader").hide()}}})}),jQuery(document).on("click",".mwb_wpr_repeat_button",function(){var b=!1,c="",d=a(".mwb_wpr_repeat:last").data("id"),e=a("#mwb_wpr_membership_level_name_"+d).val(),f=a("#mwb_wpr_membership_level_value_"+d).val(),g=a("#mwb_wpr_membership_category_list_"+d).val(),h=(a("#mwb_wpr_membership_product_list_"+d).val(),a("#mwb_wpr_membership_discount_"+d).val());if(e&&f&&g&&h||(e?a("#mwb_wpr_membership_level_name_"+d).removeClass("mwb_wpr_error_notice"):(b=!0,c+='<div class="notice notice-error is-dismissible"><p><strong>'+mwb_wpr.LevelName_notice+"</strong></p></div>",a("#mwb_wpr_membership_level_name_"+d).addClass("mwb_wpr_error_notice")),f?a("#mwb_wpr_membership_level_value_"+d).removeClass("mwb_wpr_error_notice"):(b=!0,c+='<div class="notice notice-error is-dismissible"><p><strong>'+mwb_wpr.LevelValue_notice+"</strong></p></div>",a("#mwb_wpr_membership_level_value_"+d).addClass("mwb_wpr_error_notice")),g?a("#mwb_wpr_membership_category_list_"+d).removeClass("mwb_wpr_error_notice"):(b=!0,c+='<div class="notice notice-error is-dismissible"><p><strong>'+mwb_wpr.CategValue_notice+"</strong></p></div>",a("#mwb_wpr_membership_category_list_"+d).addClass("mwb_wpr_error_notice")),h?a("#mwb_wpr_membership_discount_"+d).removeClass("mwb_wpr_error_notice"):(b=!0,c+='<div class="notice notice-error is-dismissible"><p><strong>'+mwb_wpr.Discount_notice+"</strong></p></div>",a("#mwb_wpr_membership_discount_"+d).addClass("mwb_wpr_error_notice"))),b)a(".notice.notice-error.is-dismissible").each(function(){a(this).remove()}),a(".notice.notice-success.is-dismissible").each(function(){a(this).remove()}),a("html, body").animate({scrollTop:a(".mwb_wpr_setting").offset().top},800),a(c).insertAfter(a("h1.mwb_wpr_setting"));else{d=parseInt(d)+1;var i="",j="",k=mwb_wpr.Categ_option,l=[];for(var m in k)l=k[m].cat_name,cat_id=k[m].id,console.log(cat_id),j+='<option value="'+cat_id+'">'+l+"</option>";i+='<div id ="mwb_wpr_parent_repeatable_'+d+'" data-id="'+d+'" class="mwb_wpr_repeat">',i+='<table class="mwb_wpr_repeatable_section">',i+='<tr valign="top"><th scope="row" class="titledesc"><label for="mwb_wpr_membership_level_name">'+mwb_wpr.Labeltext+"</label></th>",i+='<td class="forminp forminp-text"><label for="mwb_wpr_membership_level_name"><input type="text" name="mwb_wpr_membership_level_name_'+d+'" value="" id="mwb_wpr_membership_level_name_'+d+'" class="text_points" required>'+mwb_wpr.Labelname+'</label><input type="button" value='+mwb_wpr.Remove_text+' class="button-primary woocommerce-save-button mwb_wpr_remove_button" id="'+d+'"></td></tr>',i+='<tr valign="top"><th scope="row" class="titledesc"><label for="mwb_wpr_membership_level_value">'+mwb_wpr.Points+'</label></th><td class="forminp forminp-text"><label for="mwb_wpr_membership_level_value"><input type="number" min="1" value="" name="mwb_wpr_membership_level_value_'+d+'" id="mwb_wpr_membership_level_value_'+d+'" class="input-text" required></label></td></tr>',i+='<tr valign="top"><th scope="row" class="titledesc"><label for="mwb_wpr_membership_expiration">'+mwb_wpr.Exp_period+'</label></th><td class="forminp forminp-text"><input type="number" min="1" value="" name="mwb_wpr_membership_expiration_'+d+'"id="mwb_wpr_membership_expiration_'+d+'" class="input-text"><select id="mwb_wpr_membership_expiration_days_'+d+'" name="mwb_wpr_membership_expiration_days_'+d+'"><option value="days">'+mwb_wpr.Days+'</option><option value="weeks">'+mwb_wpr.Weeks+'</option><option value="months">'+mwb_wpr.Months+'</option><option value="years">'+mwb_wpr.Years+"</option>",i+='<tr valign="top"><th scope="row" class="titledesc"><label for="mwb_wpr_membership_category_list">'+mwb_wpr.Categ_text+'</label></th><td class="forminp forminp-text"><select id="mwb_wpr_membership_category_list_'+d+'" required="true" class="mwb_wpr_common_class_categ" data-id="'+d+'" multiple="multiple" name="mwb_wpr_membership_category_list_'+d+'[]">'+j+"</select></td></tr>",i+='<tr valign="top"><th scope="row" class="titledesc"><label for="mwb_wpr_membership_product_list">'+mwb_wpr.Prod_text+'</label></th><td class="forminp forminp-text"><select id="mwb_wpr_membership_product_list_'+d+'" multiple="multiple" name="mwb_wpr_membership_product_list_'+d+'[]"></select></td></tr>',i+='<tr valign="top"><th scope="row" class="titledesc"><label for="mwb_wpr_membership_discount">'+mwb_wpr.Discounttext+'</label></th><td class="forminp forminp-text"><label for="mwb_wpr_membership_discount"><input type="number" min="1" value="" max="100" name="mwb_wpr_membership_discount_'+d+'" id="mwb_wpr_membership_discount_'+d+'" class="input-text" required></label></td><input type = "hidden" value="'+d+'" name="hidden_count"></tr></table></div>',a(".parent_of_div").append(i),a("#mwb_wpr_parent_repeatable_"+d).find("#mwb_wpr_membership_category_list_"+d).select2(),a("#mwb_wpr_parent_repeatable_"+d).find("#mwb_wpr_membership_product_list_"+d).select2()}}),jQuery(document).on("click",".mwb_wpr_remove_button",function(){var b=a(this).attr("id");0==b&&(a(document).find(".mwb_wpr_repeat_button").hide(),a("#mwb_wpr_membership_setting_enable").attr("checked",!1)),a("#mwb_wpr_parent_repeatable_"+b).remove()}),a(document).on("click",".mwb_wpr_email_wrapper_text",function(){a(this).siblings(".mwb_wpr_email_wrapper_content").slideToggle()}),a(document).on("click",".mwb_wpr_submit_per_category",function(){var b=a(this).attr("id"),c=a("#mwb_wpr_points_to_per_categ_"+b).val(),d=[];if(c.length>0)if(c%1===0&&c>0)jQuery("#mwb_wpr_loader").show(),d={action:"mwb_wpr_per_pro_category",mwb_wpr_categ_id:b,mwb_wpr_categ_point:c,mwb_nonce:mwb_wpr.mwb_wpr_nonce},a.ajax({url:mwb_wpr.ajaxurl,type:"POST",data:d,dataType:"json",success:function(b){if("success"==b.result){var c=b.category_id,d=b.categ_point;jQuery("#mwb_wpr_points_to_per_categ_"+c).val(d),a(".notice.notice-error.is-dismissible").each(function(){a(this).remove()}),a(".notice.notice-success.is-dismissible").each(function(){a(this).remove()}),a("html, body").animate({scrollTop:a(".woocommerce_page_mwb-wpr-setting").offset().top},800);var e='<div class="notice notice-success is-dismissible"><p><strong>'+mwb_wpr.success_assign+"</strong></p></div>";a(e).insertAfter(a("h1.mwb_wpr_setting")),jQuery("#mwb_wpr_loader").hide()}}});else{a(".notice.notice-error.is-dismissible").each(function(){a(this).remove()}),a(".notice.notice-success.is-dismissible").each(function(){a(this).remove()}),a("html, body").animate({scrollTop:a(".woocommerce_page_mwb-wpr-setting").offset().top},800);var e='<div class="notice notice-error is-dismissible"><p><strong>'+mwb_wpr.error_assign+"</strong></p></div>";a(e).insertAfter(a("h1.mwb_wpr_setting"))}else jQuery("#mwb_wpr_loader").show(),d={action:"mwb_wpr_per_pro_category",mwb_wpr_categ_id:b,mwb_wpr_categ_point:c,mwb_nonce:mwb_wpr.mwb_wpr_nonce},a.ajax({url:mwb_wpr.ajaxurl,type:"POST",data:d,dataType:"json",success:function(b){if("success"==b.result){var c=b.category_id,d=b.categ_point;jQuery("#mwb_wpr_points_to_per_categ_"+c).val(d),a(".notice.notice-error.is-dismissible").each(function(){a(this).remove()}),a(".notice.notice-success.is-dismissible").each(function(){a(this).remove()}),a("html, body").animate({scrollTop:a(".woocommerce_page_mwb-wpr-setting").offset().top},800);var e='<div class="notice notice-success is-dismissible"><p><strong>'+mwb_wpr.success_remove+"</strong></p></div>";a(e).insertAfter(a("h1.mwb_wpr_setting")),jQuery("#mwb_wpr_loader").hide()}}})}),a(document).find("#mwb_wpr_restrictions_for_purchasing_cat").select2(),a(document).find("#mwb_wpr_restrictions_for_purchasing_pro").select2(),a(document).on("change","select#product-type",function(){var b=a("select#product-type").val();"variable"==b&&a(".mwb_points_product_value_field ").remove()}),a(document).on("click",".mwb_wpr_common_slider",function(){a(this).siblings(".mwb_wpr_common_table").slideToggle("fast"),a(this).children(".mwb_wpr_open_toggle").toggleClass("mwb_wpr_plus_icon")}),a("#mwb_wpr_license_save").on("click",function(){a(".licennse_notification").html("");var b=a("#mwb_wpr_license_key").val();return""==b?(a("#mwb_wpr_license_key").css("border","1px solid red"),!1):(a("#mwb_wpr_license_key").css("border","none"),a(".loading_image").show(),void a.ajax({url:mwb_wpr.ajaxurl,type:"POST",dataType:"json",data:{action:"mwb_wpr_register_license",mwb_nonce:mwb_wpr.mwb_wpr_nonce,license_key:b},success:function(b){""==b.msg&&(b.msg="Something Went Wrong! Please try again"),a(".loading_image").hide(),console.log(b),1==b.status?(a(".licennse_notification").css("color","green"),a(".licennse_notification").html(b.msg),window.location.href=mwb_wpr.mwb_wpr_url):(a(".licennse_notification").css("color","red"),a(".licennse_notification").html(b.msg))}}))})}),jQuery(document).ready(function(){function a(b){var c=mwb_wpr.pointer.pointers_generate_first[b],d=jQuery.extend(c.options,{close:function(){c.next?a(c.next):jQuery.ajax({url:mwb_wpr.ajaxurl,type:"POST",data:{action:"mwb_wpr_wp_pointer_end_section",mwb_wpr_finish:"finish"},success:function(a){}})}}),e=jQuery(c.target).pointer(d);e.pointer("open"),jQuery("a.close").html('<a class="button-primary" href="#">Next</a>')}var b=mwb_wpr.pointer;b.pointers_generate_1&&jQuery.each(b.pointers_generate_first,function(b){return a(b),!1})})}(jQuery);