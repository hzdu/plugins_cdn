!function(c){var l={data:{},init:function(){c(document).ready(l.ready),l.data.isFetchConditionalBlock=!1,l.bindUIActions()},ready:function(){},bindUIActions:function(){c(document).on("change",".ur-enable-conditional-logic",function(i){0===c(this).parents("div#user_registration_form_setting_enable_submit_conditional_logic_field").next(".urcl-conditional-logic-container").length?c(this).is(":checked")&&!l.data.isFetchConditionalBlock&&(l.data.isFetchConditionalBlock=!0,l.fetchConditionalBlock(c(this))):l.showHideConditionalBlock(i)}),c(document).on("click",'.ui-tabs-tab[aria-controls="ur-tab-field-settings"]',function(i){c("#user_registration_form_setting_enable_submit_conditional_logic").is(":checked")&&!l.data.isFetchConditionalBlock&&(l.data.isFetchConditionalBlock=!0,l.fetchConditionalBlock(c("#user_registration_form_setting_enable_submit_conditional_logic")))}),c(document).on("click",".urcl-submit-conditional-container .add",function(){var i=c(this).closest("ul.urcl-role-logic-box"),t=i.data("last-key");connectionId=c(this).parents("div.urcl-submit-logic-wrap").data("group").match(/condition_(\d+)/)[1],t=t||i.data("last-or-key"),l.addAndCondtion(i,t,connectionId)}),c(document).on("click",".urcl-submit-conditional-container .urcl-add-or-condition",function(){var i=c(this).parent("div.urcl-submit-logic-wrap").data("group").match(/condition_(\d+)/)[1];l.addOrCondtion(i,c(this))}),c(document).on("click",".urcl-submit-conditional-container .remove",function(){l.removeCondtion(c(this))}),c(document).on("click",".urcl-conditional-logic-container .urcl-add-new-condition",function(){l.addNewCondtion(c(this))}),c(document).on("click",".urcl-submit-conditional-container .urcl-remove-condition",function(){l.removeNewCondtion(c(this))}),c(document).on("change",".urcl-submit-conditional-container .urcl-conditional-group .urcl-field-conditional-field-select",function(){l.replace_field_values(".urcl-conditional-group",this)}),c(document).on("change",".urcl-submit-conditional-container .urcl-conditional-or-group .urcl-field-conditional-field-select",function(){l.replace_field_values(".urcl-conditional-or-group",this)})},showHideConditionalBlock:function(i){var t=c(i.target),e=t.is(":checked"),i=t.parents("div#user_registration_form_setting_enable_submit_conditional_logic_field").next(".urcl-conditional-logic-container");i.length<=0&&e&&!l.data.isFetchConditionalBlock&&(l.data.isFetchConditionalBlock=!0,l.fetchConditionalBlock(t)),e?i.show():i.hide()},fetchConditionalBlock:function(o){var i=new URLSearchParams(window.location.search).get("edit-registration");c.ajax({url:urcl_params.ajax_url,type:"POST",data:{_wpnonce:urcl_params.nonce,action:"urcl_fetch_conditional_block",formID:i},dataType:"json",success:function(i){var t,e,n;i.success&&((t=o.parents("div#user_registration_form_setting_enable_submit_conditional_logic_field")).next(".urcl-submit-conditional-container").length||(l.data.template=i.data.template,i.data.html?c(i.data.html).insertAfter(t):(e=c("<div>",{"class":"urcl-form-settings-container urcl-conditional-logic-container"}),n=c("<div>",{"class":"urcl-submit-conditional-container"}),e.append(n),n.html(i.data.template),c(e).insertAfter(t))))},error:function(i,t,e){}})},addAndCondtion:function(i,t,e){var n=c(l.data.template).find("li.urcl-conditional-group").clone();n.find(".urcl-form-group select.urcl-field-conditional-field-select option:not(:first)").remove(),n.find(".urcl-form-group select.urcl-field-conditional-field-select").append(l.get_fields_list()),n.attr("data-key",++t),n.find("select.urcl-field-conditional-field-select").attr("name","user_registration_form_fields[condition_"+e+"]["+t+"]"),n.find("div.urcl-operator").find("select.urcl-submit-field").attr("name","user_registration_form_fields[condition_"+e+"]["+t+"]"),n.find("input.urcl-form-settings-field.urcl-submit-field").attr("name","user_registration_form_value[condition_"+e+"]["+t+"]"),i.data("last-key",t),i.find(".urcl-conditional-or-group").length&&n.addClass("urcl-conditional-or-group").removeClass("urcl-conditional-group"),i.append(n)},addOrCondtion:function(i,t){var e=c(l.data.template).find("li.urcl-conditional-group").clone();e.find(".urcl-form-group select.urcl-field-conditional-field-select option:not(:first)").remove(),e.find(".urcl-form-group select.urcl-field-conditional-field-select").append(l.get_fields_list()),e.find("li.urcl-conditional-group").addClass("urcl-conditional-or-group").removeClass("urcl-conditional-group"),e.find("select.urcl-field-conditional-field-select").attr("name","user_registration_form_fields[condition_"+i+"][1]"),e.find("div.urcl-operator").find("select.urcl-submit-field").attr("name","user_registration_form_fields[condition_"+i+"][1]"),e.find("input.urcl-form-settings-field.urcl-submit-field").attr("name","user_registration_form_value[condition_"+i+"][1]");var n='<p class="urcl-or-label"> '+urcl_params.or_text+" </p>";n+='<ul class="urcl-form-settings-logic-box urcl-or-groups urcl-role-logic-box" data-group ="'+i+'" data-last-key="1">',n+='<li class="urcl-conditional-or-group" data-key="1">',n+=e.html(),n+="</li>",t.before(n+="</ul>")},removeCondtion:function(i){var t=i.parents("ul.urcl-role-logic-box"),e=i.parents("li"),i=i.parents("div.urcl-submit-logic-wrap");1<i.find("li").length&&(t.hasClass("urcl-or-groups")?1===t.find("li").length?(t.prev("p.urcl-or-label").remove(),t.remove()):2===t.find("li").length&&2===i.find("li").length?(t.prev("p.urcl-or-label").remove(),t.removeClass("urcl-or-groups"),e.addClass("urcl-conditional-group").removeClass("urcl-conditional-or-group")):e.remove():1===t.find("li").length&&2===i.find("li").length?(t.remove(),i.find("ul.urcl-role-logic-box").prev("p.urcl-or-label").remove(),i.find("ul.urcl-role-logic-box").removeClass("urcl-or-groups"),i.find("ul.urcl-role-logic-box").find("li").addClass("urcl-conditional-group").removeClass("urcl-conditional-or-group")):e.remove()),$allUl=i.find(".urcl-form-settings-logic-box"),$allUl.length&&$allUl.first().prev().hasClass("urcl-or-label")&&($allUl.first().prev().remove(),$allUl.find(".urcl-conditional-or-group").addClass(".urcl-conditional-group").removeClass(".urcl-conditional-or-group"))},addNewCondtion:function(i){var t=c(l.data.template).clone(),e=i.data("last-conditionid");t.find("[data-group]").attr("data-group",e),t.find(".urcl-form-group select.urcl-field-conditional-field-select option:not(:first)").remove(),t.find(".urcl-form-group select.urcl-field-conditional-field-select").append(l.get_fields_list()),t.find("div.urcl-assign-role").find("select.urcl-form-settings-field urcl-submit-field").attr("name","user_registration_form_conditional_user_role[condition_"+e+"]"),t.find("select.urcl-field-conditional-field-select").attr("name","user_registration_form_fields[condition_"+e+"][1]"),t.find("div.urcl-operator").find("select.urcl-submit-field").attr("name","user_registration_form_fields[condition_"+e+"][1]"),t.find("input.urcl-form-settings-field.urcl-submit-field").attr("name","user_registration_form_value[condition_"+e+"][1]").val(""),i.data("last-conditionid",e+1),1===i.parents(".urcl-conditional-logic-container").find(".urcl-submit-conditional-container").find(".urcl-submit-logic-wrap").length&&i.parents(".urcl-conditional-logic-container").find(".urcl-submit-conditional-container").find(".urcl-submit-logic-wrap").append('<button class="urcl-remove-condition"></button>'),i.prev("div.urcl-submit-conditional-container").append(t)},removeNewCondtion:function(i){var t=i.parents("div.urcl-submit-conditional-container");1<t.find(".urcl-submit-logic-wrap").length&&(i.parent(".urcl-submit-logic-wrap").remove(),1==t.find(".urcl-submit-logic-wrap").length&&t.find(".urcl-submit-logic-wrap").find(".urcl-remove-condition").remove())},get_fields_list:function(){var n="";return c(".ur-grid-lists .ur-selected-item .ur-general-setting").each(function(){var i,t=c(this).closest(".ur-selected-item").find(" .ur-admin-template .ur-label label").text(),e=c(this).closest(".ur-selected-item").find(" .ur-admin-template .ur-field").data("field-key");"section_title"==e||"html"==e||"wysiwyg"==e||"billing_address_title"==e||"shipping_address_title"==e||void 0!==(i=c(this).find("[data-field='field_name']").val())&&(n+='<option value="'+i+'" data-type="'+e+'">'+t+"</option>")}),n},replace_field_values:function(t,e){var o=c("option:selected",e).attr("data-type"),l=c("option:selected",e).val();let r=c(e).closest(t).find(".urcl-value").children().first();e=r.attr("name"),t=r.attr("class");if(["checkbox","radio","select","country","billing_country","shipping_country","select2","multi_select2"].includes(o)){let i=[],n="<option value>"+urcl_params.select_option_placeholder+"</option>";if(["select","select2","multi_select2"].includes(o))i=c('.ur-selected-inputs .ur-selected-item .ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-field option").map(function(){return c(this).val()});else if(["country","billing_country","shipping_country"].includes(o)){let e=[];c('.ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-advance-selected_countries select option:selected").each(function(){var i=c(this).val(),t=c(this).text();e.push('<option value="'+i+'">'+t+"</option>")}),n=e.join("")}else i=c('.ur-selected-inputs .ur-selected-item .ur-general-setting-field-name input[value="'+l+'"]').closest(".ur-selected-item").find(".ur-field input").map(function(){return c(this).val()});1==i.length&&""===i[0]?n='<option value="1">'+urcl_data.checkbox_checked+"</option>":c(i).each(function(i,t){n+='<option value="'+t+'">'+t+"</option>"}),r.replaceWith('<select name="'+e+'" class="'+t+'">'+n+"</select>")}else r.replaceWith('<input type="text" name="'+e+'" class="'+t+'">')}};l.init()}(jQuery);