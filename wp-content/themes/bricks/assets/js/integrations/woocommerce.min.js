function bricksWooRefreshCartFragments(){if("undefined"!=typeof woocommerce_params){var e=woocommerce_params.wc_ajax_url;e=e.replace("%%endpoint%%","get_refreshed_fragments"),jQuery.post(e,(function(e,t){e.fragments&&bricksWooReplaceFragments(e.fragments),jQuery("body").trigger("wc_fragments_refreshed")}))}}function bricksWooReplaceFragments(e){e&&jQuery.each(e,(function(e,t){var r=jQuery(e);r&&r.replaceWith(t)}))}function bricksWooMiniCartHideDetailsClickOutside(){const e=e=>{if(!e.classList.contains("cart-detail"))return;e.classList.remove("active");const t=e.closest(".brxe-woocommerce-mini-cart");t&&t.classList.toggle("show-cart-details")},t=bricksQuerySelectorAll(document,".cart-detail");t&&t.forEach((function(t){document.addEventListener("click",(function(r){r.target.closest(".mini-cart-link")||!t.classList.contains("active")||r.target.closest(".cart-detail")||e(t)}))}));const r=bricksQuerySelectorAll(document,".cart-detail .bricks-mini-cart-close");r&&r.forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault();const r=t.target.closest(".cart-detail");r&&e(r)}))}))}function bricksWooMiniModalsToggle(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-toggle-target");if(t){document.querySelectorAll(".bricks-woo-toggle").forEach((function(e){var r=e.getAttribute("data-toggle-target");if(r!==t){var o=e.querySelector(r);if(null!==o&&o.classList.contains("active")){o.classList.remove("active");var c=e.closest(".brxe-woocommerce-mini-cart");c&&c.classList.remove("show-cart-details")}}}));var r=document.querySelector(t);if(null!==r){r.classList.toggle("active");var o=r.closest(".brxe-woocommerce-mini-cart");o&&o.classList.toggle("show-cart-details")}}}function bricksWooProductGallery(){bricksIsFrontend||void 0===jQuery(this).wc_product_gallery||jQuery(".woocommerce-product-gallery").each((function(){jQuery(this).trigger("wc-product-gallery-before-init",[this,window.wc_single_product_params]),jQuery(this).wc_product_gallery(window.wc_single_product_params),jQuery(this).trigger("wc-product-gallery-after-init",[this,window.wc_single_product_params])}))}function bricksWooQuantityTriggers(){bricksQuerySelectorAll(document,"form .quantity .action").forEach((function(e){e.classList.contains("brx-initialized")||(e.classList.add("brx-initialized"),e.addEventListener("click",(function(e){e.preventDefault();var t=e.target.closest(".quantity").querySelector(".qty:not([readonly])");if(!t)return;var r=document.querySelector('button[name="update_cart"]');r&&(r.removeAttribute("disabled"),r.setAttribute("aria-disabled","false")),e.target.classList.contains("plus")?t.stepUp():e.target.classList.contains("minus")&&t.stepDown();const o=new Event("change",{bubbles:!0});t.dispatchEvent(o)})))}))}function bricksWooProductsFilter(){bricksQuerySelectorAll(document,".brxe-woocommerce-products-filter .filter-item").forEach((function(e){function t(e){e.target.closest("form").submit()}function r(e){e.target.closest(".filter-item").classList.toggle("open")}bricksQuerySelectorAll(e,".dropdown").forEach((function(e){e.addEventListener("change",t)})),bricksQuerySelectorAll(e,'input[type="radio"], input[type="checkbox"]').forEach((function(e){e.addEventListener("change",t),e.addEventListener("click",t)})),bricksQuerySelectorAll(e,".double-slider-wrap").forEach((function(e){bricksWooProductsFilterInitSlider(e)})),bricksQuerySelectorAll(e,".title").forEach((function(e){e.onclick=r}))}))}function bricksWooMiniModals(){document.querySelectorAll(".bricks-woo-toggle").forEach((function(e){e.addEventListener("click",bricksWooMiniModalsToggle),e.hasAttribute("data-open-on-add-to-cart")&&jQuery(document.body).on("added_to_cart",(function(t,r,o,c){e.click()}))}))}function bricksWooProductsFilterInitSlider(e){var t=e.querySelector("input.lower"),r=e.querySelector("input.upper");t.oninput=bricksWooProductsFilterUpdateSliderValue,r.oninput=bricksWooProductsFilterUpdateSliderValue;var o=parseInt(t.value),c=parseInt(r.value);bricksWooProductsFilterRenderSliderValues(t.parentNode,o,c),t.addEventListener("change",(function(){e.closest("form").submit()})),r.addEventListener("change",(function(){e.closest("form").submit()}))}function bricksWooProductsFilterUpdateSliderValue(e){var t=e.target.parentNode,r=t.querySelector("input.lower"),o=t.querySelector("input.upper"),c=parseInt(r.value),i=parseInt(o.value);i<c+4&&(r.value=i-4,o.value=c+4,c==r.min&&(o.value=4),i==o.max&&(r.value=parseInt(o.max)-4)),bricksWooProductsFilterRenderSliderValues(t,c,i)}function bricksWooProductsFilterRenderSliderValues(e,t,r){var o=e.getAttribute("data-currency"),c=e.querySelector("label.lower"),i=e.querySelector("label.upper"),a=e.querySelector(".value.lower"),n=e.querySelector(".value.upper");a.innerText=c.innerText+": "+o+t,n.innerText=i.innerText+": "+o+r}function bricksWooAjaxAddToCartInit(e){if(!window.bricksWooCommerce.ajaxAddToCartEnabled)return;let t=document;e&&document.querySelector(e)&&(t=document.querySelector(e));bricksQuerySelectorAll(t,".single_add_to_cart_button").forEach((function(e){e.addEventListener("click",(function(t){if(t.preventDefault(),e.classList.contains("disabled"))return;const r=e.closest("form.cart");"get"===r.getAttribute("method")?r.submit():bricksWooAddToCart(r)}))}));const r=function(e){let t={addingHTML:bricksWooCommerce.ajaxAddingText,addedHTML:bricksWooCommerce.ajaxAddedText};return e.closest(".brxe-product-add-to-cart")&&(t=e.closest(".brxe-product-add-to-cart")?.getAttribute("data-bricks-ajax-add-to-cart")||t),"string"==typeof t?JSON.parse(t):t};jQuery("body").on("adding_to_cart",(function(e,t,o){t[0].setAttribute("disabled","disabled"),t[0].classList.add("disabled","bricks-cart-adding");const c=r(t[0]);c&&c.addingHTML&&(t[0].innerHTML=c.addingHTML)})),jQuery("body").on("added_to_cart",(function(e,t,o,c){c[0].removeAttribute("disabled"),c[0].classList.add("bricks-cart-added"),c[0].classList.remove("disabled","bricks-cart-adding");const i=r(c[0]);i&&i.addedHTML&&c.html(i.addedHTML)}))}function bricksWooAddToCart(e){if("undefined"==typeof woocommerce_params)return;const t=e.querySelector(".single_add_to_cart_button"),r=new FormData(e),o={};if(o.product_id=t.value,o.quantity=r.get("quantity"),o.product_type="simple",e.classList.contains("variations_form")){o.product_id=r.get("product_id"),o.quantity=r.get("quantity"),o.variation_id=r.get("variation_id"),o.product_type="variable";const e={};for(const t of r.entries())t[0].indexOf("attribute_")>-1&&(e[t[0]]=t[1]);o.variation=e}if(e.classList.contains("grouped_form")){o.product_id=r.get("add-to-cart");const e={};for(const t of r.entries())if(t[0].indexOf("quantity")>-1&&t[1]>0){e[t[0].replace("quantity[","").replace("]","")]=t[1]}o.products=e,o.product_type="grouped"}if("grouped"===o.product_type&&0===Object.keys(o.products).length)return;for(const e of r.entries())"product_id"===e[0]||"quantity"===e[0]||"variation_id"===e[0]||"add-to-cart"===e[0]||e[0].indexOf("attribute_")>-1||(o[e[0]]=e[1]);jQuery("body").trigger("adding_to_cart",[jQuery(t),o]);const c=woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","bricks_add_to_cart");jQuery.ajax({type:"POST",url:c,data:o,dataType:"json",success:function(e){e.error&&e.product_url?window.location=e.product_url:"undefined"!=typeof wc_add_to_cart_params&&"yes"===wc_add_to_cart_params.cart_redirect_after_add&&wc_add_to_cart_params.cart_url?window.location=wc_add_to_cart_params.cart_url:(e.fragments&&(bricksWooReplaceFragments(e.fragments),jQuery("body").trigger("wc_fragments_refreshed")),jQuery("body").trigger("added_to_cart",[e.fragments,e.cart_hash,jQuery(t)]))},error:function(e){e.error&&e.product_url&&(window.location=e.product_url)},complete:function(e){}})}function bricksWooCheckoutSubmitBehavior(){if("undefined"==typeof wc_checkout_params||!wc_checkout_params.is_checkout)return;const e=jQuery("form.checkout");e&&e.one("checkout_place_order",(function(e,t){"object"==typeof t&&"function"==typeof t.submit_error&&(t.submit_error=function(e){const r=jQuery(".brxe-woocommerce-notice");r.length>0?r.html(e):(jQuery(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),t.$checkout_form.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>")),t.$checkout_form.removeClass("processing").unblock(),t.$checkout_form.find(".input-text, select, input:checkbox").trigger("validate").trigger("blur"),t.scroll_to_notices(),jQuery(document.body).trigger("checkout_error",[e])},"function"==typeof t.scroll_to_notices&&(t.scroll_to_notices=function(){const e=jQuery(".woocommerce-NoticeGroup-updateOrderReview, .woocommerce-NoticeGroup-checkout, .brxe-woocommerce-notice");e.length||(e=jQuery("form.checkout")),jQuery.scroll_to_notices(e)}))}))}document.addEventListener("DOMContentLoaded",(function(e){bricksWooProductsFilter(),bricksWooMiniModals(),bricksWooMiniCartHideDetailsClickOutside(),bricksWooAjaxAddToCartInit(),bricksWooCheckoutSubmitBehavior(),jQuery(document.body).on("updated_cart_totals",(function(){bricksWooQuantityTriggers(),bricksLazyLoad()})),setTimeout((function(){bricksWooQuantityTriggers()}),150)}));
