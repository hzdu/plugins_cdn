function bricksAdminClassicEditor(){var e=document.getElementById("bricks-editor"),t=document.getElementById("postdivrich");if(e&&t){var i=document.createElement("button");i.type="button",i.id="switch-bricks",i.classList.add("wp-switch-editor","switch-bricks"),i.innerText=window.bricksData.title;var n=t.querySelector(".wp-editor-tabs");n&&n.appendChild(i),e.after(t),document.addEventListener("click",(function(i){"switch-bricks"===i.target.id?(i.preventDefault(),i.stopPropagation(),t.style.display="none",e.style.display="block",document.getElementById("bricks-editor-mode").value="bricks"):-1!==["content-html","content-tmce"].indexOf(i.target.id)&&(t.style.display="block",e.style.display="none",document.getElementById("bricks-editor-mode").value="wordpress")}))}}function bricksAdminImport(){var e=document.getElementById("bricks-admin-import-form");if(e){var t=document.getElementById("bricks-admin-import-action"),i=document.getElementById("bricks-admin-import-form-wrapper"),n=document.querySelector("#wpbody-content .page-title-action");if(n)n.after(t),n.after(i),document.querySelectorAll(".bricks-admin-import-toggle").forEach((function(e){e.addEventListener("click",(function(){i.style.display="block"===i.style.display?"none":"block"}))})),e.addEventListener("submit",(function(t){t.preventDefault();for(var i=new FormData(e),n=document.getElementById("bricks_import_files").files,r=0;r<n.length;r++){var a=n[r];i.append("files["+r+"]",a)}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:i,processData:!1,contentType:!1,success:function(e){location.reload()}})}))}}function bricksAdminSaveLicenseKey(){var e=document.getElementById("bricks-license-key-form");if(e){var t=e.action.value,i=e.nonce.value,n=e.querySelector("input[type=submit]");e.addEventListener("submit",(function(r){r.preventDefault(),n.disabled=!0;var a=e.license_key.value;jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:t,licenseKey:a,nonce:i},success:function(i){"bricks_deactivate_license"===t?location.reload():"bricks_activate_license"===t&&(i.success?(i.data.hasOwnProperty("message")&&(e.querySelector(".success-message").innerHTML=i.data.message),setTimeout((()=>{location.reload()}),1e3)):(n.disabled=!1,i.data.hasOwnProperty("message")&&(e.querySelector(".error-message").innerHTML=i.data.message)))}})}))}}function bricksAdminToggleLicenseKey(){var e=document.getElementById("bricks-toggle-license-key");e&&e.addEventListener("click",(function(e){e.preventDefault(),e.target.classList.contains("dashicons-hidden")?(e.target.classList.remove("dashicons-hidden"),e.target.classList.add("dashicons-visibility"),e.target.previousElementSibling.type="text"):(e.target.classList.remove("dashicons-visibility"),e.target.classList.add("dashicons-hidden"),e.target.previousElementSibling.type="password")}))}function bricksAdminSettings(){var e=document.querySelector("#bricks-settings");if(e){for(var t=document.querySelectorAll("#bricks-settings-tabs-wrapper a"),i=e.querySelectorAll("table"),n=0;n<t.length;n++)t[n].addEventListener("click",(function(e){e.preventDefault();var i=e.target.getAttribute("data-tab-id");if(i){location.hash=i,window.scrollTo({top:0});for(var n=0;n<t.length;n++)t[n].classList.remove("nav-tab-active");e.target.classList.add("nav-tab-active"),u(i)}}));var r=location.hash.replace("#","");if(r){var a=document.querySelector('[data-tab-id="'+r+'"]');a&&a.click()}var s=e.querySelector(".submit-wrapper"),c=e.querySelector(".spinner.saving");if(e){e.addEventListener("submit",(function(e){e.preventDefault()}));var o=e.querySelector('input[name="save"]');o&&o.addEventListener("click",(function(t){s&&s.remove(),c&&c.classList.add("is-active"),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_save_settings",formData:jQuery(e).serialize(),nonce:window.bricksData.nonce},success:function(e){let t=window.location.hash;window.location.href=window.location.search+=`&bricks_notice=settings_saved${t}`}})}));var d=e.querySelector('input[name="reset"]');d&&d.addEventListener("click",(function(e){confirm(bricksData.cofirmResetSettings)&&(s&&s.remove(),c&&c.classList.add("is-active"),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_reset_settings",nonce:window.bricksData.nonce},success:function(){window.location.href=window.location.search+="&bricks_notice=settings_resetted"}}))}));var l=e.querySelector('input[name="executeCodeDisabled"]');l&&l.addEventListener("click",(function(t){e.querySelectorAll('input[name^="executeCodeCapabilities"').forEach((function(e){e.disabled=t.target.checked}))}))}}function u(e){document.getElementById(e);for(var t=0;t<i.length;t++){var n=i[t];n.getAttribute("id")===e?n.classList.add("active"):n.classList.remove("active")}}}function bricksAdminGenerateCssFiles(){button=document.querySelector("#bricks-css-loading-generate button"),button&&button.addEventListener("click",(function(e){e.preventDefault(),button.setAttribute("disabled","disabled"),button.classList.add("wait");var t=document.querySelector("#bricks-css-loading-generate .results");if(t){t.classList.remove("hide");var i=t.querySelector("ul"),n=t.querySelector(".count"),r=t.querySelector(".done");i.innerHTML="",n.innerHTML=0,r&&r.remove();var a=t.querySelector(".end");a&&a.remove()}jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_get_css_files_list"},success:function(e){bricksAdminGenerateCssFile(0,i,n,e.data)}})}))}function bricksAdminBreakpointsRegenerateCssFiles(){let e=document.getElementById("breakpoints-regenerate-css-files");if(!e)return;let t=e.querySelector("i");e.addEventListener("click",(function(i){i.preventDefault(),jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_bricks_css_files"},beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait"),t.classList.add("hide")},success:function(i){e.removeAttribute("disabled"),e.classList.remove("wait"),t.classList.remove("hide"),console.warn("bricks_regenerate_bricks_css_files",i.data)}})}))}function bricksAdminGenerateCssFile(e,t,i,n){return jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_regenerate_css_file",data:n[e],index:e},success:function(e){var n=!!e.data.hasOwnProperty("file_name")&&e.data.file_name;if(n){var r="",a=i?parseInt(i.innerText):0;Array.isArray(n)?n.forEach((function(e){r+="<li>"+e+"</li>",a++})):(r+="<li>"+n+"</li>",a++),e.success||(r=r.replace("<li>",'<li class="error">')),t&&t.insertAdjacentHTML("afterbegin",r),i&&(i.innerText=a)}}}).then((function(r){if(e===n.length){var a=document.querySelector("#bricks-css-loading-generate button");a.removeAttribute("disabled"),a.classList.remove("wait");var s=document.querySelector("#bricks-css-loading-generate .info");s&&s.remove(),t&&t.insertAdjacentHTML("beforebegin",'<div class="done">... THE END :)</div>')}else bricksAdminGenerateCssFile(e+1,t,i,n)}))}function bricksAdminRunConverter(){var e=document.getElementById("bricks-run-converter");e&&e.addEventListener("click",(function(t){t.preventDefault();let i={action:"bricks_get_converter_items",convert:[]};document.getElementById("convert_element_ids_classes").checked&&i.convert.push("elementClasses"),document.getElementById("convert_container").checked&&i.convert.push("container"),document.getElementById("add_position_relative").checked&&i.convert.push("addPositionRelative"),document.getElementById("entry_animation_to_interaction").checked&&i.convert.push("entryAnimationToInteraction"),i.convert.length&&jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:i,beforeSend:()=>{e.setAttribute("disabled","disabled"),e.classList.add("wait")},success:e=>{console.info("bricks_get_converter_items",e.data);bricksAdminConvert(0,e.data.items,e.data.convert)}})}))}function bricksAdminConvert(e,t,i){return jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_run_converter",data:t[e],convert:i},success:function(n){var r=document.getElementById("bricks-run-converter"),a=r.parentNode.querySelector(".results");if(a)a&&0===e&&(a.querySelector("ul").innerHTML="");else{(a=document.createElement("div")).classList.add("results");var s=document.createElement("ul");a.appendChild(s),r.parentNode.appendChild(a)}var c,o=!!n.data.hasOwnProperty("label")&&n.data.label;o&&((c=document.createElement("li")).innerHTML=o,a.querySelector("ul").prepend(c));(console.warn("run_converter",e,o,n.data),e===t.length)?(r.removeAttribute("disabled"),r.classList.remove("wait"),(c=document.createElement("li")).classList.add("done"),c.innerText="... THE END :)",a.querySelector("ul").prepend(c)):bricksAdminConvert(e+1,t,i)}})}function bricksTemplateShortcodeCopyToClipboard(){var e=document.querySelectorAll(".bricks-copy-to-clipboard");e&&e.forEach((function(e){e.addEventListener("click",(function(t){if(navigator.clipboard){if(!window.isSecureContext)return void alert("Clipboard API rejected: Not in secure context (HTTPS)");if(e.classList.contains("copied"))return void t.preventDefault();var i=e.value,n=e.getAttribute("data-success");navigator.clipboard.writeText(i),e.value=n,e.classList.add("copied"),setTimeout((function(){e.value=i,e.classList.remove("copied")}),2e3)}}))}))}function bricksDismissHttpsNotice(){setTimeout((()=>{let e=document.querySelector(".brxe-https-notice .notice-dismiss");e&&e.addEventListener("click",(function(){jQuery.ajax({type:"POST",url:bricksData.ajaxUrl,data:{action:"bricks_dismiss_https_notice",nonce:bricksData.nonce}})}))}),400)}document.addEventListener("DOMContentLoaded",(function(e){bricksAdminClassicEditor(),bricksAdminImport(),bricksAdminSaveLicenseKey(),bricksAdminToggleLicenseKey(),bricksAdminSettings(),bricksAdminRunConverter(),bricksAdminBreakpointsRegenerateCssFiles(),bricksAdminGenerateCssFiles(),bricksTemplateShortcodeCopyToClipboard(),bricksDismissHttpsNotice()}));
