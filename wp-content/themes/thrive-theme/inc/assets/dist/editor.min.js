!function(){var e={2773:function(e,t,s){s(2810);class i{static get hoverClass(){return"section-hover"}constructor(){this.listenersInit()}listenersInit(e){const t=e=>{e.find(" > div").on("mouseenter",(e=>{this.showIcons(e.currentTarget)})).on("mouseleave",(e=>{this.hideIcons(e.currentTarget)}))};void 0===e?Object.values(TVE.Theme.$sections).forEach(t):t(TVE.Theme.$sections[e])}showIcons(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];TVE.Theme.FLAGS.doingResize?this.hideIcons(e):e&&!e.parentElement.classList.contains(i.hoverClass)&&(t&&i.clearHoverClass(),e.parentElement.classList.add(i.hoverClass))}hideIcons(e){e?e.parentElement.classList.remove(i.hoverClass):i.clearHoverClass()}static clearHoverClass(){TVE.inner.$body.find("."+i.hoverClass).removeClass(i.hoverClass)}}e.exports=i},2810:function(e){function t(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function s(e){for(var s=1;s<arguments.length;s++){var n=null!=arguments[s]?arguments[s]:{};s%2?t(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const n=()=>TVE.inner.window.ThriveTheme.sidebar;class o{static get prefix(){return":not(#layout)"}get selector(){return`.thrive-layout-${this.ID}`}constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.ID=e,this.setMeta(t)}getMeta(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?this.meta[e]:this.meta}setMeta(e){e&&e.meta_input&&!e.meta_input.content_width&&(e.meta_input.content_width=o.getContentWidth()),this.meta=e.meta_input}name(){let e="Custom";if(this.ID){const t=TVE.CONST.theme.layouts.find((e=>e.ID===this.ID));t&&(e=t.post_title)}return e}save(e,t){TVE.Theme.utils.loadingMessage("Saving Layout"),TVE.$.ajax({url:TVE.CONST.theme.routes.layouts,type:"POST",data:{post_title:e},headers:{"X-WP-Nonce":TVE.CONST.rest_nonce}}).done((s=>{this.convertCss(s),TVE.CONST.theme.layouts.push({ID:s,post_title:e}),this.update(!0),"function"==typeof t&&t(s)})).fail((()=>{TVE.page_message("Error saving the layout!",!0,3e3)})).always((()=>{TVE.Theme.utils.loadingMessage(!1)}))}update(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.ID)return!e&&TVE.Theme.utils.loadingMessage("Updating layout"),TVE.$.ajax({url:`${TVE.CONST.theme.routes.layouts}/${this.ID}`,type:"POST",data:{meta_input:s({template_id:TVE.Theme.template.ID,style:{css:this.getStyle()}},o.getDataFromPage())},headers:{"X-WP-Nonce":TVE.CONST.rest_nonce}}).done((e=>{const t=TVE.CONST.theme.layouts.findIndex((t=>t.ID===e.data.ID));-1===t?TVE.CONST.theme.layouts.push(e.data):TVE.CONST.theme.layouts[t]=e.data,o.getStyleNode().html(e.style),TVE.head_css_remove(TVE.Theme.utils.escapedRegEx(o.prefix,"g"),"_ALL"),TVE.do_action("theme.layout.after_update")})).fail((e=>{TVE.page_message("Error saving the layout!",!0,3e3)})).always((e=>{setTimeout((()=>{TVE.Theme.utils.loadingMessage(!1)}),2e3)}));TVE.page_message("Unknown layout to save!",!0,300)}static load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:TVE.$.noop;e=parseInt(e),t=parseInt(t),e!==t&&(TVE.Theme.utils.loadingMessage("Loading layout"),TVE.$.ajax({url:`${TVE.CONST.theme.routes.layouts}/${e}`,type:"GET",headers:{"X-WP-Nonce":TVE.CONST.rest_nonce}}).done((i=>{t&&TVE.inner.$body.removeClass(`thrive-layout-${t}`),TVE.inner.$body.addClass(`thrive-layout-${e}`),o.getStyleNode().html(i.style),o.fixLayoutStructure(i),TVE.head_css_remove(TVE.Theme.utils.escapedRegEx(o.prefix,"g"),"_ALL"),setTimeout((()=>{TVE.Theme.utils.loadingMessage(!1),TVE.Theme.content.updateResizeHandlersPosition(),TVE.PostList.layout.masonryRedo(),TVE.Theme.utils.loadingMessage("Updating also the template!","save-template"),TVE.Theme.content.save((()=>{TVE.Theme.utils.loadingMessage(!1,"save-template"),"function"==typeof s&&s(e)}),!0,!0)}),42)})).fail((()=>{TVE.page_message("Error loading layout!",!0,3e3),TVE.Theme.utils.loadingMessage(!1)})))}static getStyleNode(){let e=TVE.inner.jQuery("#thrive-theme-layout-css");return 0===e.length&&(e=TVE.inner.jQuery('<style id="thrive-theme-layout-css" type="text/css"></style>'),e.insertBefore(TVE.inner.jQuery("#thrive-template-css"))),e}getStyle(){const e=TVE.stylesheet;TVE.stylesheet=o.getStyleNode()[0].sheet;const t=this.convertSelector(TVE.CSS_Rule_Cache.getCssForSelector(this.selector),this.selector);TVE.stylesheet=e;const s=TVE.$.extend(!0,{},t,this.convertSelector(TVE.CSS_Rule_Cache.getCssForSelector(o.prefix),TVE.Theme.CONST.body_class));for(const e in s)s.hasOwnProperty(e)&&(s[e]=_.map(s[e],((e,t)=>t+"{"+_.map(e,((e,t)=>`${t}:${e}`)).join("; ")+"}")).join(""));return s}convertSelector(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s={};for(const i in e)if(e.hasOwnProperty(i)&&"@imports"!==i){s[i]={};for(const n in e[i])if(e[i].hasOwnProperty(n)){const a=n.replace(o.prefix,"").replace(t,this.selector).trim();s[i][a]=e[i][n]}}return s}convertCss(e){TVE.inner.$body.addClass(`thrive-layout-${e}`);const t=o.getStyleNode(),s=t.html().replace(TVE.Theme.utils.escapedRegEx(`thrive-layout-${this.ID}`,"g"),`thrive-layout-${e}`);t.html(s),TVE.inner.$body.removeClass(`thrive-layout-${this.ID}`),this.ID=e}static hasUnsavedChanges(){const e=o.getInstance().getMeta();let t=void 0!==_.find(o.getDataFromPage(),((t,s)=>e[s]!==t));return t||(t=_.some(TVE.CSS_Rule_Cache.getCssForSelector(o.prefix),(e=>Object.values(e).length>0))),t}static fixLayoutStructure(e){const t=!!parseInt(e.meta_input.hide_sidebar);TVE.Theme.$main.toggleClass(TVE.Theme.constants.identifiers.FLIP_SECTIONS_CLASS,!!parseInt(e.meta_input.sidebar_on_left)),TVE.Theme.$sections.sidebar.toggleClass(TVE.Theme.constants.identifiers.HIDE_SECTION_CLASS,t),n().isOffScreen()&&(t?n()._get("off-screen").destroy():n().offScreenRefresh())}static getDataFromPage(){return{sidebar_on_left:TVE.Theme.$main.hasClass(TVE.Theme.constants.identifiers.FLIP_SECTIONS_CLASS)?1:0,content_width:this.getContentWidth(),hide_sidebar:this.isSidebarHidden()}}static isSidebarHidden(){return TVE.Theme.$sections.sidebar.hasClass(TVE.Theme.constants.identifiers.HIDE_SECTION_CLASS)?1:0}static getContentWidth(){return o.isFullWidth()?"100%":o.getWidth("content")}static setWidth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?(TVE.Theme.FLAGS.LAYOUT_CSS_WRITE=!0,TVE.Theme.$wrapper.head_css({[`--layout-${t}-width`]:e}),TVE.Theme.FLAGS.LAYOUT_CSS_WRITE=!1,TVE.Theme.$wrapper.tcbCss(`--layout-${t}-width`,"")):TVE.Theme.$wrapper.tcbCss(`--layout-${t}-width`,e),o}static getWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return TVE.Theme.$wrapper.tcbCss(`--layout-${e}-width`)}static isFullWidth(){return"100%"===o.getWidth("background")}static getInstance(){const e=TVE.Theme.models.Content.getLayoutId();return new o(e,TVE.CONST.theme.layouts.find((t=>t.ID===e)))}}e.exports=o}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,s),o.exports}(e=>{const t=s(2773),i={init:function(){TVE.Theme=TVE.Theme||{},TVE.Theme.CONST=thrive_page_params,TVE.CONST.theme.is_theme_template?(TVE.Theme.content.init_selectors(),this.initColumns(),TVE.Theme.sectionHover=new t,TVE.inner.$body.addClass(TVE.Theme.constants.identifiers.EDITOR_CLASS)):TVE.Theme.content.init_selectors(TVE.Editor_Page.editor),this.disableClicks(),TVE.inner_$("html").on("mousedown",(e=>{"HTML"===e.target.tagName&&e.stopPropagation()})),TVE.Theme.$wrapper.on("click",this.focusEditorWrapper),"tcb_symbol"!==TVE.CONST.post.post_type&&setTimeout(this.selectFirstElement,100),TVE.add_action("theme.section.after_insert.sidebar",this.initColumns),TVE.do_action("theme.editor.init")},focusEditorWrapper:function(){TVE.main.EditMode.element()||TVE.Theme.$wrapper.is(TVE.ActiveElement)||TVE.Editor_Page.focus_element(TVE.Theme.$wrapper)},selectFirstElement:function(){let e=TVE.Theme.$wrapper;TVE.Theme.selectedSection&&(e=TVE.Theme.$sections[TVE.Theme.selectedSection]),TVE.Editor_Page.focus_element(e)},disableClicks:()=>{e("a[onclick]").each((function(){e(this).data("onclick",this.onclick),this.onclick=()=>!1}))},initColumns:function(){let t,s,i,n,o;const a=TVE.Theme.$main.find(TVE.Theme.constants.identifiers.MAIN_COLUMNS_SEPARATOR),r=_.throttle((()=>{o.html(`${i}%`),n.html(parseFloat(100-i-t).toFixed(2)+"%")}),50);if(TVE.Theme.$sections.sidebar){let l;TVE.Theme.$sections.sidebar.resizable({minWidth:50,handles:"w,e",start:function(){TVE.Theme.FLAGS.doingResize=!0,l=TVE.getComputedStyle(TVE.Theme.$main[0],"width"),s=TVE.getComputedStyle(a[0],"width"),t=parseFloat(s/l*100).toFixed(2),o=e('<div class="resize-percentage">').appendTo(TVE.Theme.$sections.sidebar),n=e('<div class="resize-percentage">').appendTo(TVE.Theme.$sections.content)},resize:function(e,s){i=Math.max(parseFloat(s.size.width/l*100+t/2).toFixed(2),0),TVE.Theme.$main.tcbCss("--sidebar-size",`${i}%`),TVE.Theme.$sections.sidebar.css({width:"",left:""}),r()},stop:function(){TVE.Theme.FLAGS.LAYOUT_CSS_WRITE=!0,TVE.Theme.$main.head_css({"--sidebar-size":`${i}%`}),TVE.Theme.FLAGS.LAYOUT_CSS_WRITE=!1,TVE.Theme.$main.tcbCss("--sidebar-size",""),TVE.PostList.layout.masonryRedo(),o.remove(),n.remove(),TVE.Theme.FLAGS.doingResize=!1}})}TVE.Theme.content.updateResizeHandlersPosition()}};e(window).on("tcb-ready",i.init.bind(i))})(jQuery)}();