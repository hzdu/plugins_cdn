/**
 * This file holds the main javascript functions needed for the google maps widget in backend (get coordinates from address, etc.)
 *
 * @author		Christian "Kriesi" Budschedl
 * @copyright	Copyright ( c ) Christian Budschedl
 * @link		http://kriesi.at
 * @link		http://aviathemes.com
 * @since		Version 1.1
 * @package 	AviaFramework
 */
!function(a){"use strict";var i="";a((function(){var i="avia_google_maps";a("body").avia_google_maps_options(),a(document).on("widget-added",(function(o,n){if(a("body").hasClass("block-editor-page")){var e=(n=a(n)).find('form input[name="widget-id"]');if(0!=e.length)e.val().search(i)<0||a("body").avia_google_maps_options(n)}})),a(document).ajaxSuccess((function(o,n,e){void 0!==e.data&&void 0!==e.data.search&&-1!==e.data.search("action=save-widget")&&-1!==e.data.search("id_base="+i)&&a("body").avia_google_maps_options()}))})),a.fn.avia_google_maps_options=function(o){var n=a(void 0===o?"body":o);n.find(".avia-find-coordinates-wrapper,.avia-loading-coordinates").hide(),n.find(".avia-coordinates-help-link").on("click",(function(a){a.preventDefault(),(i=jQuery(this).parents(".widget-content")).find(".avia-coordinates-help-link").hide(),i.find(".avia-coordinates-wrapper").hide(),i.find(".avia-find-coordinates-wrapper").show()})),n.find(".avia-populate-coordinates").on("click",(function(a){a.preventDefault();var o=(i=jQuery(this).parents(".widget-content")).find(".avia-map-street-address").val(),n=i.find(".avia-map-city").val(),e=i.find(".avia-map-state").val(),t=i.find(".avia-map-postcode").val(),d=i.find(".avia-map-country").val();i.find(".avia-loading-coordinates").show(),function(a){(new google.maps.Geocoder).geocode({address:a},(function(o,n){var e="";n===google.maps.GeocoderStatus.OK?function(a,o){i.find(".avia-map-lat").val(a),i.find(".avia-map-lng").val(o)}(o[0].geometry.location.lat(),o[0].geometry.location.lng()):n===google.maps.GeocoderStatus.ZERO_RESULTS?e=a.replace(/\s/g,"").length?AviaMapTranslation.latitude+" "+a+" "+AviaMapTranslation.notfound:AviaMapTranslation.insertaddress:n===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&(e=AviaMapTranslation.toomanyrequests);""!==e&&alert(e),i.find(".avia-coordinates-help-link").show(),i.find(".avia-find-coordinates-wrapper").fadeOut("fast"),i.find(".avia-loading-coordinates").hide(),i.find(".avia-coordinates-wrapper").show()}))}(o+" "+n+" "+e+" "+t+" "+d)}))}}(jQuery);