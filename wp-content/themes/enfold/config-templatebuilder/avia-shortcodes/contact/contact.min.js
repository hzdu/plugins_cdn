!function(a){a.fn.avia_ajax_form=function(r){var e=a.extend({sendPath:"send.php",responseContainer:".ajaxresponse"},r);return this.each((function(){var r=a(this),t=!1,i=r.data("fields-with-error"),s={formElements:r.find("textarea, select, input[type=text], input[type=checkbox], input[type=hidden]"),validationError:!1,button:r.find("input:submit"),dataObj:{},withError:[]},o=r.next(e.responseContainer).eq(0);s.button.on("click",(function(n){if(s.validationError=!1,s.datastring="ajax=true",s.formElements=r.find("textarea, select, input[type=text], input[type=checkbox], input[type=hidden], input[type=email]"),s.formElements.each((function(e){var t,i,o=a(this),n=o.parent(),l=o.val(),d=n.find("label").text().replace(/\*/g,"").trim(),v=o.attr("name"),c=o.attr("class"),h=!0;if(o.is(":checkbox")&&(l=!!o.is(":checked")||""),s.dataObj[v]=encodeURIComponent(l),c&&c.match(/is_empty/)&&(""==l||null==l?(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)):n.removeClass("valid error ajax_alert").addClass("valid"),h=!1),c&&c.match(/is_email/)&&(l.match(/^[\w|\.|\-]+@\w[\w|\.|\-]*\.[a-zA-Z]{2,20}$/)?n.removeClass("valid error ajax_alert").addClass("valid"):(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)),h=!1),c&&c.match(/is_ext_email/)&&(l.match(/^[\w\.\-ÄÖÜäöü]+@\w[\w\.\-ÄÖÜäöü]*\.[a-zA-Z]{2,20}$/)?n.removeClass("valid error ajax_alert").addClass("valid"):(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)),h=!1),c&&c.match(/is_special_email/)&&(l.match(/^[a-zA-Z0-9.!#$%&'*+\-\/=?^_`{|}~ÄÖÜäöü]+@\w[\w\.\-ÄÖÜäöü]*\.[a-zA-Z]{2,20}$/)?n.removeClass("valid error ajax_alert").addClass("valid"):(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)),h=!1),c&&c.match(/is_phone/)&&(l.match(/^(\d|\s|\-|\/|\(|\)|\[|\]|e|x|t|ension|\.|\+|\_|\,|\:|\;){3,}$/)?n.removeClass("valid error ajax_alert").addClass("valid"):(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)),h=!1),c&&c.match(/is_number/)&&(l.match(/^-?\s*(0|[1-9]\d*)([\.,]\d+)?$/)?n.removeClass("valid error ajax_alert").addClass("valid"):(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)),h=!1),c&&c.match(/is_positiv_number/)&&("number"!==(i=typeof(t=l))&&"string"!==i||isNaN(t-parseFloat(t))||""==l||l<0?(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0,s.withError.push(d)):n.removeClass("valid error ajax_alert").addClass("valid"),h=!1),c&&c.match(/captcha/)&&!c.match(/recaptcha/)){var m=r.find("#"+v+"_verifier").val(),u=m.charAt(m.length-1);l!=m.charAt(u)?(n.removeClass("valid error ajax_alert").addClass("error"),s.validationError=!0):n.removeClass("valid error ajax_alert").addClass("valid"),h=!1}h&&""!=l&&n.removeClass("valid error ajax_alert").addClass("valid")})),r.find(".av-fields-with-error").remove(),0==s.validationError)r.data("av-custom-send")?function(){if(t)return!1;t=!0;var i=s.button.val();s.button.addClass("av-sending-button"),s.button.val(s.button.data("sending-label")),s.dataObj.ajax_mailchimp=!0;var n=r.data("avia-redirect")||!1,l=r.attr("action"),d=r.find(".av-form-error-container"),v=r.data("avia-form-id");a.ajax({url:l,type:"POST",data:s.dataObj,beforeSend:function(){d.length&&d.slideUp(400,(function(){d.remove(),a("body").trigger("av_resize_finished")}))},success:function(d){var c=jQuery("<div>").append(jQuery.parseHTML(d)),h=c.find(".av-form-error-container");if(h.length)t=!1,r.prepend(h),h.css({display:"none"}).slideDown(400,(function(){a("body").trigger("av_resize_finished")})),s.button.removeClass("av-sending-button"),s.button.val(i);else if(n&&l!=n)r.attr("action",n),location.href=n;else{var m=c.find(e.responseContainer+"_"+v);o.html(m).removeClass("hidden").css({display:"block"}),r.slideUp(400,(function(){o.slideDown(400,(function(){a("body").trigger("av_resize_finished")})),s.formElements.val("")}))}},error:function(){},complete:function(){}})}():function(){if(t)return!1;if(s.button.hasClass("avia_button_inactive"))return!1;t=!0,s.button.addClass("av-sending-button"),s.button.val(s.button.data("sending-label"));var i=r.data("avia-redirect")||!1,n=r.attr("action");if(r.is(".av-form-labels-style"))return;o.load(n+" "+e.responseContainer,s.dataObj,(function(){i&&n!=i?(r.attr("action",i),location.href=i):(o.removeClass("hidden").css({display:"block"}),r.slideUp(400,(function(){o.slideDown(400,(function(){a("body").trigger("av_resize_finished")})),s.formElements.val("")})))}))}();else if(r.is(".av-show-form-errors")&&s.withError.length>0){var l=s.withError.join(", "),d=a('<p class="av-fields-with-error"></p').insertAfter(a(s.button).parent());let r=i?i+" ":"Found errors in the following field(s): ";d.text(r+l),s.withError=[]}return!1})),a.avia_utilities.isMobile&&s.formElements.each((function(r){var e=a(this);e.hasClass("is_email")&&e.attr("type","email")}))}))}}(jQuery);