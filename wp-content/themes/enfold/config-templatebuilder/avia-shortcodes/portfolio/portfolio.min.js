!function(i){"use strict";i.avia_utilities=i.avia_utilities||{},i.fn.avia_iso_sort=function(t){return this.each((function(){var t=i("body"),e=i(this),a=e.data("portfolio-id"),o=e.closest(".av-portfolio-grid-sorting-container, .entry-content-wrapper, .avia-fullwidth-portfolio"),n=o.find('.sort_width_container[data-portfolio-id="'+a+'"]').find("#js_sort_items").css({visibility:"visible",opacity:0}),s=n.find("a"),r=e.find(".grid-image"),l=(i(".post-entry",e),!t.hasClass("rtl"));function c(){e.addClass("isotope_activated").isotope({layoutMode:"fitRows",itemSelector:".flex_column",originLeft:l}),e.isotope("on","layoutComplete",(function(){e.css({overflow:"visible"}),t.trigger("av_resize_finished")})),!0,setTimeout((function(){o.addClass("avia_sortable_active")}),0)}s.on("click",(function(){var t=i(this),a=t.data("filter"),n=t.html(),r=o.find(".av-current-sort-title");return r.length&&r.html(n),s.removeClass("active_sort"),t.addClass("active_sort"),e.attr("id","grid_id_"+a),o.find(".open_container .ajax_controlls .avia_close").trigger("click"),e.isotope({layoutMode:"fitRows",itemSelector:".flex_column",filter:"."+a,originLeft:l}),!1})),i(window).on("debouncedresize",(function(){c()})),i.avia_utilities.preload({container:e,single_callback:function(){n.animate({opacity:1},400),c(),setTimeout((function(){c()})),r.css({height:"auto"}).each((function(t){var e=i(this);setTimeout((function(){e.animate({opacity:1},1500)}),100*t)}))}})}))},i.fn.avia_portfolio_preview=function(t){var e=i(window),a=i("body"),o=(i.avia_utilities.isMobile,i.extend({},{open_in:".portfolio-details-inner",easing:"easeOutQuint",timing:800,transition:"slide"},t));return this.each((function(){var t,n,s=i(this),r=s.data("portfolio-id"),l=i('.portfolio_preview_container[data-portfolio-id="'+r+'"]'),c=l.find(o.open_in),d=s.find(".grid-entry"),_={},f=!1,v=!1,p=!1,u=!1,m=i.avia_utilities.loading();(t={load_item:function(e){e.preventDefault();var a=i(this).parents(".post-entry").eq(0),o="ID_"+a.data("ajax-id"),n=d.index(a);if(o===f||1==v)return!1;v=!0,s.find(".active_portfolio_item").removeClass("active_portfolio_item"),a.addClass("active_portfolio_item"),m.show(),t.ajax_get_contents(o,n)},scroll_top:function(){setTimeout((function(){var t=l.offset().top-175,a=e.scrollTop();(a>t||t-a>100)&&i("html:not(:animated),body:not(:animated)").animate({scrollTop:t},o.timing,o.easing)}),10)},attach_item:function(t){_[t]=i(_[t]).appendTo(c),u=!0},remove_video:function(){var i=l.find("iframe, .avia-video").parents(".ajax_slide:not(.open_slide)");i.length>0&&(i.remove(),_["ID_"+i.data("slideId")]=void 0)},show_item:function(e,n){if(e===f)return!1;if(v=!0,m.hide(),!1===f)l.addClass("open_container"),_[e].addClass("open_slide"),t.scroll_top(),l.css({display:"none"}).slideDown(o.timing,o.easing,(function(){u&&(i.avia_utilities.activate_shortcode_scripts(_[e]),i.avia_utilities.avia_ajax_call(_[e]),a.trigger("av_resize_finished"),u=!1),t.remove_video(),a.trigger("av_resize_finished")})),p=n,f=e,v=!1;else{t.scroll_top();var s={zIndex:3},r=o.easing;p>n&&(s.left="-110%"),"fade"===o.transition&&(s.left="0%",s.opacity=0,r="easeOutQuad"),c.height(c.height()),_[e].css(s).avia_animate({left:"0%",opacity:1},o.timing,r),_[f].avia_animate({opacity:0},o.timing,r,(function(){_[f].attr({style:""}).removeClass("open_slide"),_[e].addClass("open_slide"),c.avia_animate({height:_[e].outerHeight()+2},o.timing/2,o.easing,(function(){c.attr({style:""}),f=e,p=n,v=!1,t.remove_video(),u&&(a.trigger("av_resize_finished"),i.avia_utilities.activate_shortcode_scripts(_[e]),i.avia_utilities.avia_ajax_call(_[e]),u=!1)}))}))}},ajax_get_contents:function(e,a){if(void 0===_[e]){var o=i("#avia-tmpl-portfolio-preview-"+e.replace(/ID_/,""));0==o.length&&setTimeout((function(){t.ajax_get_contents(e,a)}),500),_[e]=o.html(),_[e]=_[e].replace("/*<![CDATA[*/","").replace("*]]>",""),t.attach_item(e),i.avia_utilities.preload({container:_[e],single_callback:function(){t.show_item(e,a)}})}else t.show_item(e,a)},add_controls:function(){n=l.find(".ajax_controlls"),l.avia_keyboard_controls({27:".avia_close",37:".ajax_previous",39:".ajax_next"}),d.each((function(){var e=i(this);e.addClass("no_combo").on("click",(function(i){if(e.find(".slideshow_overlay").length)return i.stopPropagation(),t.load_item.apply(e.find("a").eq(0)),!1}))}))},control_click:function(){var e,n=s.find(".active_portfolio_item").data("ajax-id"),r=s.find(".post-entry-"+n);switch(this.hash){case"#next":(e=r.nextAll(".post-entry:visible").eq(0).find("a").eq(0)).length||(e=i(".post-entry:visible",s).eq(0).find("a").eq(0)),e.trigger("click");break;case"#prev":(e=r.prevAll(".post-entry:visible").eq(0).find("a").eq(0)).length||(e=i(".post-entry:visible",s).last().find("a").eq(0)),e.trigger("click");break;case"#close":v=!0,l.slideUp(o.timing,o.easing,(function(){s.find(".active_portfolio_item").removeClass("active_portfolio_item"),_[f].attr({style:""}).removeClass("open_slide"),l.removeClass("open_container"),v=f=p=!1,t.remove_video(),a.trigger("av_resize_finished")}))}return!1},resize_reset:function(){!1===f&&(c.html(""),_=[])}}).add_controls(),s.on("click","a",t.load_item),n.on("click","a",t.control_click),e.on("debouncedresize",t.resize_reset)}))}}(jQuery);