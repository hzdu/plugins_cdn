!function(i){"use strict";i.AviaccordionSlider=function(t,e){this.$slider=i(e),this.$inner=this.$slider.find(".aviaccordion-inner"),this.$slides=this.$inner.find(".aviaccordion-slide"),this.$images=this.$inner.find(".aviaccordion-image"),this.$last=this.$slides.last(),this.$titles=this.$slider.find(".aviaccordion-preview"),this.$titlePos=this.$slider.find(".aviaccordion-preview-title-pos"),this.$titleWrap=this.$slider.find(".aviaccordion-preview-title-wrap"),this.$win=i(window),void 0===i.avia_utilities.supported.transition&&(i.avia_utilities.supported.transition=i.avia_utilities.supports("transition")),this.options={},this.browserPrefix=i.avia_utilities.supported.transition,this.cssActive=!1!==this.browserPrefix,this.transform3d=-1!==document.documentElement.className.indexOf("avia_transform3d"),this.isMobile=i.avia_utilities.isMobile,this.isTouchDevice=i.avia_utilities.isTouchDevice,this.property=this.browserPrefix+"transform",this.count=this.$slides.length,this.open=!1,this.autoplay=!1,this.increaseTitle=this.$slider.is(".aviaccordion-title-on-hover"),this._init(t)},i.AviaccordionSlider.defaults={interval:5,autoplay:!0,loop_autoplay:"endless"},i.AviaccordionSlider.prototype={_init:function(t){var e=this;this.options=this._setOptions(t),i.avia_utilities.preload({container:this.$slider,single_callback:function(){e._kickOff()}})},_setOptions:function(t){var e=this.$slider.data("slideshow-options");return"object"==typeof e?i.extend({},i.AviaccordionSlider.defaults,t,e):i.extend({},i.AviaccordionSlider.defaults,t,this.$slider.data())},_kickOff:function(){var i=this;i._calcMovement(),i._bindEvents(),i._showImages(),i._autoplay()},_autoplay:function(){var i=this;i.options.autoplay&&(i.autoplay=setInterval((function(){if(i.open=!1===i.open?0:i.open+1,i.open>=i.count){if("once"==i.options.loop_autoplay)return clearInterval(i.autoplay),i.options.autoplay=!1,void(i.autoplay=!1);i.open=0}i._move({},i.open)}),1e3*i.options.interval))},_showImages:function(){var t=this,e=300*this.count;this.cssActive&&setTimeout((function(){t.$slider.addClass("av-animation-active")}),10),this.$images.each((function(t){var e=i(this);setTimeout((function(){e.avia_animate({opacity:1},400,(function(){e.css(i.avia_utilities.supported.transition+"transform","none")}))}),300*(t+1))})),t.increaseTitle&&(e=0),this.$titlePos.each((function(t){var s=i(this);setTimeout((function(){s.avia_animate({opacity:1},200,(function(){s.css(i.avia_utilities.supported.transition+"transform","none")}))}),e+100*(t+1))}))},_bindEvents:function(){var i=this.isMobile?"click":"mouseenter";this.$slider.on(i,".aviaccordion-slide",this._move.bind(this)),this.$slider.on("mouseleave",".aviaccordion-inner",this._move.bind(this)),this.$win.on("debouncedresize",this._calcMovement.bind(this)),this.$slider.on("av-prev av-next",this._moveTo.bind(this)),(this.isMobile||this.isTouchDevice)&&this.$slider.avia_swipe_trigger({next:this.$slider,prev:this.$slider,event:{prev:"av-prev",next:"av-next"}})},_titleHeight:function(){var t=0;this.$titleWrap.css({height:"auto"}).each((function(){var e=i(this).outerHeight();e>t&&(t=e)})).css({height:t+2})},_calcMovement:function(t,e){var s=this,a=this.$slider.width(),o=this.$last.data("av-left"),n=this.$images.last().width()||a,r=Math.floor(100/a*n),c=r*s.count,l=100-r,h=l>o/3?l:0,d=h/(s.count-1),v=n;if(c<110&&!1!==e){var u=this.$slider.height()/c*110;return this.$slider.css({"max-height":u}),void s._calcMovement(t,!1)}d<2&&(h=0),this.$slides.each((function(t){var e=i(this),a=0,o=0,n=e.data("av-left");o=0!==h?r+(a=d*t)-d:100-(a=n/Math.abs(3))/t*(s.count-t),1==t&&s.increaseTitle&&(v=o+1),s.cssActive&&(a-=n,o-=n,n=0),e.data("av-calc-default",n),e.data("av-calc-left",a),e.data("av-calc-right",o)})),s.increaseTitle&&s.$titles.css({width:v+"%"})},_moveTo:function(i){var t="av-next"==i.type?1:-1,e=!1===this.open?0:this.open+t;e>=0&&e<this.$slides.length&&this._move(i,e)},_move:function(t,e){var s=this,a=t.currentTarget,o=void 0!==e?e:this.$slides.index(a);this.open=o,s.autoplay&&void 0!==a&&(clearInterval(s.autoplay),s.autoplay=!1),this.$slides.removeClass("aviaccordion-active-slide").each((function(e){var a=i(this),n=a.data(),r=e<=o?n.avCalcLeft:n.avCalcRight,c={},l="mouseleave"==t.type?1:0;o===e&&s.$titleWrap.eq(e)&&a.addClass("aviaccordion-active-slide"),l&&(r=n.avCalcDefault,this.open=!1),s.cssActive?(c[s.property]=s.transform3d?"translate3d("+r+"%, 0, 0)":"translate("+r+"%,0)",a.css(c)):(c.left=r+"%",a.stop().animate(c,700,"easeOutQuint"))}))}},i.fn.aviaccordion=function(t){return this.each((function(){i.data(this,"AviaccordionSlider")||(i.data(this,"AviaccordionSlider",1),new i.AviaccordionSlider(t,this))}))}}(jQuery);